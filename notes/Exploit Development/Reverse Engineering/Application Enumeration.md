---
tags:
  - Advanced
  - Binary_Exploitation
  - Debugging
  - Exploitation
  - Reverse_Engineering
  - Windows
---

## Application Enumeration
resources: [Attack Surface Analysis](https://owasp.org/www-community/controls/Attack_Surface_Analysis_Cheat_Sheet)

> Identify potential attack vectors in target applications before vulnerability research.

### Identify Network Services
> Find listening ports and services.

```cmd
netstat -ano | findstr LISTENING
```

```powershell
Get-NetTCPConnection -State Listen | Select-Object LocalPort, OwningProcess
```

### Identify Process Details
> Get information about target process.

```cmd
tasklist /FI "PID eq <PID>" /V
wmic process where "ProcessId=<PID>" get CommandLine,ExecutablePath
```

### List Loaded DLLs
> Identify modules loaded by target process.

```text
0:000> lm
0:000> !dlls
```

### Find Entry Points
> [!info] Identify how application receives input:
> - **Network sockets**: recv, recvfrom, WSARecv
> - **File I/O**: ReadFile, fread, fgets
> - **User input**: GetWindowText, scanf
> - **Registry**: RegQueryValueEx
> - **Environment**: GetEnvironmentVariable

### Search for Dangerous Functions in IDA
> Find potentially vulnerable function calls.

```text
; In IDA: View -> Open Subviews -> Imports
; Look for:
strcpy, strcat, sprintf, vsprintf
memcpy, memmove
gets, scanf
recv, recvfrom, WSARecv
ReadFile, fread
```

### Cross-Reference Dangerous Functions
> Find where vulnerable functions are called.

```text
; In IDA, on import:
Press X to see all cross-references
Double-click to navigate to call site
Analyze data flow to find user-controlled input
```

### Identify Protocol Structure
> Understand application's network protocol.

```text
1. Capture traffic with Wireshark
2. Look for patterns (headers, lengths, delimiters)
3. Identify text vs binary protocols
4. Find authentication mechanisms
```

### Dynamic Analysis Setup
> Prepare for runtime analysis.

```text
1. Install application in isolated VM
2. Take snapshot before testing
3. Configure debugger (WinDbg/x64dbg)
4. Set up network capture
5. Create Python client for interaction
```

### Common Vulnerability Patterns [Knowledge]
> [!important] What to look for during enumeration:
> - **Buffer overflows**: Fixed-size buffers with unbounded input
> - **Format strings**: User input passed to printf-family functions
> - **Integer overflows**: Size calculations before memory allocation
> - **Use-after-free**: Object lifetime management issues
> - **Race conditions**: TOCTOU (time-of-check-time-of-use)

### Document Attack Surface
> Create inventory of potential entry points.

```text
| Port  | Protocol | Handler Function | Input Type  | Notes           |
|-------|----------|------------------|-------------|-----------------|
| 9999  | TCP      | sub_401000       | Binary      | Custom protocol |
| 80    | HTTP     | sub_402000       | Text        | REST API        |
```

