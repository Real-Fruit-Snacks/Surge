---
tags:
  - Advanced
  - Binary_Exploitation
  - Debugging
  - Exploitation
  - WinDbg
  - Windows
---

## WinDbg Memory Operations
resources: [WinDbg Commands](https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/commands)

> Memory inspection and manipulation commands for exploit development and analysis.

### Disassemble Memory
> View assembly instructions at an address.

```text
u <Address>                 ; Unassemble from address
u eip                       ; Unassemble from current instruction
u eip L10                   ; Unassemble 10 instructions
uf <Function>               ; Unassemble entire function
```

### Display Memory
> Read and display memory contents in various formats.

```text
db <Address>                ; Display bytes
dw <Address>                ; Display words (2 bytes)
dd <Address>                ; Display dwords (4 bytes)
dq <Address>                ; Display qwords (8 bytes)
da <Address>                ; Display ASCII string
du <Address>                ; Display Unicode string
```

### Display Memory with Length
> Specify how much memory to display.

```text
db <Address> L<Count>       ; Display Count bytes
dd esp L10                  ; Display 10 dwords at ESP
db poi(esp) L20             ; Display 20 bytes at address pointed by ESP
```

### Display Memory at Register
> Common patterns for examining stack and registers.

```text
dd esp                      ; View stack top
dd ebp                      ; View stack frame
db eax                      ; View bytes at EAX
dd poi(ebp+8)               ; Dereference pointer at EBP+8
```

### Dump Structures
> Display known Windows structures.

```text
dt ntdll!_TEB               ; Display TEB structure definition
dt ntdll!_TEB @$teb         ; Display TEB for current thread
dt ntdll!_PEB @$peb         ; Display PEB for current process
dt ntdll!_LDR_DATA_TABLE_ENTRY <Address>
```

### List Structure Fields
> View specific structure members.

```text
dt ntdll!_PEB @$peb Ldr                    ; Show only Ldr field
dt ntdll!_PEB @$peb Ldr.InMemoryOrderModuleList
```

### Write to Memory
> Modify memory contents during debugging.

```text
eb <Address> <Bytes>        ; Edit bytes
ew <Address> <Words>        ; Edit words
ed <Address> <Dwords>       ; Edit dwords
ea <Address> "<String>"     ; Edit ASCII string
eu <Address> "<String>"     ; Edit Unicode string
```

### Write Examples
> Common memory modification patterns.

```text
eb eip 90 90 90 90          ; Write NOPs at EIP
ed esp 41414141             ; Write AAAA at ESP
ea 0x00401000 "test"        ; Write string at address
```

### Search Memory
> Find patterns in the memory space.

```text
s -b <Start> L<Length> <Pattern>   ; Search bytes
s -a <Start> L<Length> "string"    ; Search ASCII
s -u <Start> L<Length> "string"    ; Search Unicode
s -d <Start> L<Length> <Dword>     ; Search dword
```

### Search Examples
> Common search operations.

```text
s -a 0 L?80000000 "password"       ; Search all memory for ASCII
s -b esp L1000 41 42 43 44         ; Search stack for ABCD
s -d 0x10000000 L?10000000 0xffe4  ; Search for JMP ESP opcode bytes
```

### Search for Instructions
> Find specific opcodes in memory.

```text
# <Address> L<Length> <Pattern>    ; Search for instruction pattern
# 0x10000000 L1000 jmp esp         ; Find JMP ESP instruction
```

### Memory Protection
> Check memory page protections.

```text
!vprot <Address>            ; Display virtual memory protection
!address <Address>          ; Display detailed address info
!address -summary           ; Memory summary
```

### Pointer Dereferencing
> Use poi() to dereference pointers.

```text
dd poi(esp)                 ; Display dword at address stored in ESP
dd poi(poi(esp))            ; Double dereference
db poi(ebp+8) L10           ; Display bytes at first argument
```

