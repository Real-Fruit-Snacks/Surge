---
tags:
  - Discovery
  - Foundational
  - Nmap
  - Reconnaissance
---

## NSE Vulnerability Scanning
resources: [HackTricks - Nmap](https://book.hacktricks.wiki/en/generic-methodologies-and-resources/pentesting-network/index.html#nmap)

> [!info] NSE scripts extend **Nmap** functionality. Scripts in **vuln** category detect vulnerabilities. **safe** scripts won't crash targets, **intrusive** scripts might.

### List Vuln Scripts
```bash
cat /usr/share/nmap/scripts/script.db | grep "\"vuln\""
```

### Run All Vuln Scripts
```bash
sudo nmap -sV -p <Port> --script "vuln" <Target>
```

### Vulners Script
> [!tip] Queries **Vulners** database for CVEs matching detected service versions. Requires successful service detection (**-sV**). Shows CVSS scores and exploit links marked with *EXPLOIT*.

```bash
sudo nmap -sV --script vulners <Target>
```

### Run Script by Category
```bash
nmap --script vuln <Target>
```

### Run Script by Name
```bash
nmap --script http-vuln-cve2021-41773 <Target>
```

### Run Multiple Scripts
```bash
nmap --script "vuln,safe" <Target>
```

### Run Scripts with Wildcard
```bash
nmap --script "http-*" <Target>
```

### Custom NSE Scripts [optional]
> [!danger] Download NSE scripts for specific CVEs from GitHub. Always verify scripts are safe before running - malicious scripts can compromise your system.

#### Add Custom Script
```bash
sudo cp <Script>.nse /usr/share/nmap/scripts/
```

#### Update Script Database
```bash
sudo nmap --script-updatedb
```

#### Run Custom Script
```bash
sudo nmap -sV -p <Port> --script "<ScriptName>" <Target>
```
